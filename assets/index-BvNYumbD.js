function NM(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var ir=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Z_(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function IM(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var Q_={exports:{}},Rd={},ew={exports:{}},rt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ec=Symbol.for("react.element"),LM=Symbol.for("react.portal"),DM=Symbol.for("react.fragment"),UM=Symbol.for("react.strict_mode"),kM=Symbol.for("react.profiler"),OM=Symbol.for("react.provider"),FM=Symbol.for("react.context"),BM=Symbol.for("react.forward_ref"),jM=Symbol.for("react.suspense"),zM=Symbol.for("react.memo"),VM=Symbol.for("react.lazy"),b0=Symbol.iterator;function HM(t){return t===null||typeof t!="object"?null:(t=b0&&t[b0]||t["@@iterator"],typeof t=="function"?t:null)}var tw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},nw=Object.assign,rw={};function Na(t,e,n){this.props=t,this.context=e,this.refs=rw,this.updater=n||tw}Na.prototype.isReactComponent={};Na.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Na.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function iw(){}iw.prototype=Na.prototype;function Mg(t,e,n){this.props=t,this.context=e,this.refs=rw,this.updater=n||tw}var Cg=Mg.prototype=new iw;Cg.constructor=Mg;nw(Cg,Na.prototype);Cg.isPureReactComponent=!0;var T0=Array.isArray,sw=Object.prototype.hasOwnProperty,Ag={current:null},ow={key:!0,ref:!0,__self:!0,__source:!0};function aw(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)sw.call(e,r)&&!ow.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:ec,type:t,key:s,ref:o,props:i,_owner:Ag.current}}function GM(t,e){return{$$typeof:ec,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Rg(t){return typeof t=="object"&&t!==null&&t.$$typeof===ec}function WM(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var M0=/\/+/g;function Nf(t,e){return typeof t=="object"&&t!==null&&t.key!=null?WM(""+t.key):e.toString(36)}function vu(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case ec:case LM:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+Nf(o,0):r,T0(i)?(n="",t!=null&&(n=t.replace(M0,"$&/")+"/"),vu(i,e,n,"",function(c){return c})):i!=null&&(Rg(i)&&(i=GM(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(M0,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",T0(t))for(var a=0;a<t.length;a++){s=t[a];var l=r+Nf(s,a);o+=vu(s,e,n,l,i)}else if(l=HM(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=r+Nf(s,a++),o+=vu(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function wc(t,e,n){if(t==null)return t;var r=[],i=0;return vu(t,r,"","",function(s){return e.call(n,s,i++)}),r}function $M(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Sn={current:null},xu={transition:null},XM={ReactCurrentDispatcher:Sn,ReactCurrentBatchConfig:xu,ReactCurrentOwner:Ag};function lw(){throw Error("act(...) is not supported in production builds of React.")}rt.Children={map:wc,forEach:function(t,e,n){wc(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return wc(t,function(){e++}),e},toArray:function(t){return wc(t,function(e){return e})||[]},only:function(t){if(!Rg(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};rt.Component=Na;rt.Fragment=DM;rt.Profiler=kM;rt.PureComponent=Mg;rt.StrictMode=UM;rt.Suspense=jM;rt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=XM;rt.act=lw;rt.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=nw({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=Ag.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)sw.call(e,l)&&!ow.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:ec,type:t.type,key:i,ref:s,props:r,_owner:o}};rt.createContext=function(t){return t={$$typeof:FM,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:OM,_context:t},t.Consumer=t};rt.createElement=aw;rt.createFactory=function(t){var e=aw.bind(null,t);return e.type=t,e};rt.createRef=function(){return{current:null}};rt.forwardRef=function(t){return{$$typeof:BM,render:t}};rt.isValidElement=Rg;rt.lazy=function(t){return{$$typeof:VM,_payload:{_status:-1,_result:t},_init:$M}};rt.memo=function(t,e){return{$$typeof:zM,type:t,compare:e===void 0?null:e}};rt.startTransition=function(t){var e=xu.transition;xu.transition={};try{t()}finally{xu.transition=e}};rt.unstable_act=lw;rt.useCallback=function(t,e){return Sn.current.useCallback(t,e)};rt.useContext=function(t){return Sn.current.useContext(t)};rt.useDebugValue=function(){};rt.useDeferredValue=function(t){return Sn.current.useDeferredValue(t)};rt.useEffect=function(t,e){return Sn.current.useEffect(t,e)};rt.useId=function(){return Sn.current.useId()};rt.useImperativeHandle=function(t,e,n){return Sn.current.useImperativeHandle(t,e,n)};rt.useInsertionEffect=function(t,e){return Sn.current.useInsertionEffect(t,e)};rt.useLayoutEffect=function(t,e){return Sn.current.useLayoutEffect(t,e)};rt.useMemo=function(t,e){return Sn.current.useMemo(t,e)};rt.useReducer=function(t,e,n){return Sn.current.useReducer(t,e,n)};rt.useRef=function(t){return Sn.current.useRef(t)};rt.useState=function(t){return Sn.current.useState(t)};rt.useSyncExternalStore=function(t,e,n){return Sn.current.useSyncExternalStore(t,e,n)};rt.useTransition=function(){return Sn.current.useTransition()};rt.version="18.3.1";ew.exports=rt;var S=ew.exports;const mt=Z_(S),cw=NM({__proto__:null,default:mt},[S]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qM=S,YM=Symbol.for("react.element"),KM=Symbol.for("react.fragment"),JM=Object.prototype.hasOwnProperty,ZM=qM.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,QM={key:!0,ref:!0,__self:!0,__source:!0};function uw(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)JM.call(e,r)&&!QM.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:YM,type:t,key:s,ref:o,props:i,_owner:ZM.current}}Rd.Fragment=KM;Rd.jsx=uw;Rd.jsxs=uw;Q_.exports=Rd;var f=Q_.exports,dw={exports:{}},$n={},fw={exports:{}},hw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(L,H){var j=L.length;L.push(H);e:for(;0<j;){var ee=j-1>>>1,ve=L[ee];if(0<i(ve,H))L[ee]=H,L[j]=ve,j=ee;else break e}}function n(L){return L.length===0?null:L[0]}function r(L){if(L.length===0)return null;var H=L[0],j=L.pop();if(j!==H){L[0]=j;e:for(var ee=0,ve=L.length,Be=ve>>>1;ee<Be;){var Ue=2*(ee+1)-1,Q=L[Ue],oe=Ue+1,X=L[oe];if(0>i(Q,j))oe<ve&&0>i(X,Q)?(L[ee]=X,L[oe]=j,ee=oe):(L[ee]=Q,L[Ue]=j,ee=Ue);else if(oe<ve&&0>i(X,j))L[ee]=X,L[oe]=j,ee=oe;else break e}}return H}function i(L,H){var j=L.sortIndex-H.sortIndex;return j!==0?j:L.id-H.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,d=null,h=3,m=!1,x=!1,v=!1,g=typeof setTimeout=="function"?setTimeout:null,p=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(L){for(var H=n(c);H!==null;){if(H.callback===null)r(c);else if(H.startTime<=L)r(c),H.sortIndex=H.expirationTime,e(l,H);else break;H=n(c)}}function w(L){if(v=!1,_(L),!x)if(n(l)!==null)x=!0,z(E);else{var H=n(c);H!==null&&W(w,H.startTime-L)}}function E(L,H){x=!1,v&&(v=!1,p(P),P=-1),m=!0;var j=h;try{for(_(H),d=n(l);d!==null&&(!(d.expirationTime>H)||L&&!N());){var ee=d.callback;if(typeof ee=="function"){d.callback=null,h=d.priorityLevel;var ve=ee(d.expirationTime<=H);H=t.unstable_now(),typeof ve=="function"?d.callback=ve:d===n(l)&&r(l),_(H)}else r(l);d=n(l)}if(d!==null)var Be=!0;else{var Ue=n(c);Ue!==null&&W(w,Ue.startTime-H),Be=!1}return Be}finally{d=null,h=j,m=!1}}var M=!1,T=null,P=-1,C=5,b=-1;function N(){return!(t.unstable_now()-b<C)}function U(){if(T!==null){var L=t.unstable_now();b=L;var H=!0;try{H=T(!0,L)}finally{H?O():(M=!1,T=null)}}else M=!1}var O;if(typeof y=="function")O=function(){y(U)};else if(typeof MessageChannel<"u"){var V=new MessageChannel,Y=V.port2;V.port1.onmessage=U,O=function(){Y.postMessage(null)}}else O=function(){g(U,0)};function z(L){T=L,M||(M=!0,O())}function W(L,H){P=g(function(){L(t.unstable_now())},H)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(L){L.callback=null},t.unstable_continueExecution=function(){x||m||(x=!0,z(E))},t.unstable_forceFrameRate=function(L){0>L||125<L?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<L?Math.floor(1e3/L):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(L){switch(h){case 1:case 2:case 3:var H=3;break;default:H=h}var j=h;h=H;try{return L()}finally{h=j}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(L,H){switch(L){case 1:case 2:case 3:case 4:case 5:break;default:L=3}var j=h;h=L;try{return H()}finally{h=j}},t.unstable_scheduleCallback=function(L,H,j){var ee=t.unstable_now();switch(typeof j=="object"&&j!==null?(j=j.delay,j=typeof j=="number"&&0<j?ee+j:ee):j=ee,L){case 1:var ve=-1;break;case 2:ve=250;break;case 5:ve=1073741823;break;case 4:ve=1e4;break;default:ve=5e3}return ve=j+ve,L={id:u++,callback:H,priorityLevel:L,startTime:j,expirationTime:ve,sortIndex:-1},j>ee?(L.sortIndex=j,e(c,L),n(l)===null&&L===n(c)&&(v?(p(P),P=-1):v=!0,W(w,j-ee))):(L.sortIndex=ve,e(l,L),x||m||(x=!0,z(E))),L},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(L){var H=h;return function(){var j=h;h=H;try{return L.apply(this,arguments)}finally{h=j}}}})(hw);fw.exports=hw;var eC=fw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tC=S,Gn=eC;function le(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var pw=new Set,Rl={};function so(t,e){ua(t,e),ua(t+"Capture",e)}function ua(t,e){for(Rl[t]=e,t=0;t<e.length;t++)pw.add(e[t])}var ui=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),cp=Object.prototype.hasOwnProperty,nC=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,C0={},A0={};function rC(t){return cp.call(A0,t)?!0:cp.call(C0,t)?!1:nC.test(t)?A0[t]=!0:(C0[t]=!0,!1)}function iC(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function sC(t,e,n,r){if(e===null||typeof e>"u"||iC(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function En(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var ln={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){ln[t]=new En(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];ln[e]=new En(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){ln[t]=new En(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){ln[t]=new En(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){ln[t]=new En(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){ln[t]=new En(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){ln[t]=new En(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){ln[t]=new En(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){ln[t]=new En(t,5,!1,t.toLowerCase(),null,!1,!1)});var Pg=/[\-:]([a-z])/g;function Ng(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Pg,Ng);ln[e]=new En(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Pg,Ng);ln[e]=new En(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Pg,Ng);ln[e]=new En(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){ln[t]=new En(t,1,!1,t.toLowerCase(),null,!1,!1)});ln.xlinkHref=new En("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){ln[t]=new En(t,1,!1,t.toLowerCase(),null,!0,!0)});function Ig(t,e,n,r){var i=ln.hasOwnProperty(e)?ln[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(sC(e,n,i,r)&&(n=null),r||i===null?rC(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var xi=tC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Sc=Symbol.for("react.element"),Fo=Symbol.for("react.portal"),Bo=Symbol.for("react.fragment"),Lg=Symbol.for("react.strict_mode"),up=Symbol.for("react.profiler"),mw=Symbol.for("react.provider"),gw=Symbol.for("react.context"),Dg=Symbol.for("react.forward_ref"),dp=Symbol.for("react.suspense"),fp=Symbol.for("react.suspense_list"),Ug=Symbol.for("react.memo"),Ui=Symbol.for("react.lazy"),vw=Symbol.for("react.offscreen"),R0=Symbol.iterator;function Wa(t){return t===null||typeof t!="object"?null:(t=R0&&t[R0]||t["@@iterator"],typeof t=="function"?t:null)}var Ut=Object.assign,If;function al(t){if(If===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);If=e&&e[1]||""}return`
`+If+t}var Lf=!1;function Df(t,e){if(!t||Lf)return"";Lf=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{Lf=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?al(t):""}function oC(t){switch(t.tag){case 5:return al(t.type);case 16:return al("Lazy");case 13:return al("Suspense");case 19:return al("SuspenseList");case 0:case 2:case 15:return t=Df(t.type,!1),t;case 11:return t=Df(t.type.render,!1),t;case 1:return t=Df(t.type,!0),t;default:return""}}function hp(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Bo:return"Fragment";case Fo:return"Portal";case up:return"Profiler";case Lg:return"StrictMode";case dp:return"Suspense";case fp:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case gw:return(t.displayName||"Context")+".Consumer";case mw:return(t._context.displayName||"Context")+".Provider";case Dg:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Ug:return e=t.displayName||null,e!==null?e:hp(t.type)||"Memo";case Ui:e=t._payload,t=t._init;try{return hp(t(e))}catch{}}return null}function aC(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return hp(e);case 8:return e===Lg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function es(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function xw(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function lC(t){var e=xw(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Ec(t){t._valueTracker||(t._valueTracker=lC(t))}function yw(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=xw(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function zu(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function pp(t,e){var n=e.checked;return Ut({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function P0(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=es(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function _w(t,e){e=e.checked,e!=null&&Ig(t,"checked",e,!1)}function mp(t,e){_w(t,e);var n=es(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?gp(t,e.type,n):e.hasOwnProperty("defaultValue")&&gp(t,e.type,es(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function N0(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function gp(t,e,n){(e!=="number"||zu(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var ll=Array.isArray;function Jo(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+es(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function vp(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(le(91));return Ut({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function I0(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(le(92));if(ll(n)){if(1<n.length)throw Error(le(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:es(n)}}function ww(t,e){var n=es(e.value),r=es(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function L0(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Sw(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function xp(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Sw(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var bc,Ew=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(bc=bc||document.createElement("div"),bc.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=bc.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Pl(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var gl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},cC=["Webkit","ms","Moz","O"];Object.keys(gl).forEach(function(t){cC.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),gl[e]=gl[t]})});function bw(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||gl.hasOwnProperty(t)&&gl[t]?(""+e).trim():e+"px"}function Tw(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=bw(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var uC=Ut({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function yp(t,e){if(e){if(uC[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(le(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(le(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(le(61))}if(e.style!=null&&typeof e.style!="object")throw Error(le(62))}}function _p(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wp=null;function kg(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Sp=null,Zo=null,Qo=null;function D0(t){if(t=rc(t)){if(typeof Sp!="function")throw Error(le(280));var e=t.stateNode;e&&(e=Dd(e),Sp(t.stateNode,t.type,e))}}function Mw(t){Zo?Qo?Qo.push(t):Qo=[t]:Zo=t}function Cw(){if(Zo){var t=Zo,e=Qo;if(Qo=Zo=null,D0(t),e)for(t=0;t<e.length;t++)D0(e[t])}}function Aw(t,e){return t(e)}function Rw(){}var Uf=!1;function Pw(t,e,n){if(Uf)return t(e,n);Uf=!0;try{return Aw(t,e,n)}finally{Uf=!1,(Zo!==null||Qo!==null)&&(Rw(),Cw())}}function Nl(t,e){var n=t.stateNode;if(n===null)return null;var r=Dd(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(le(231,e,typeof n));return n}var Ep=!1;if(ui)try{var $a={};Object.defineProperty($a,"passive",{get:function(){Ep=!0}}),window.addEventListener("test",$a,$a),window.removeEventListener("test",$a,$a)}catch{Ep=!1}function dC(t,e,n,r,i,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(u){this.onError(u)}}var vl=!1,Vu=null,Hu=!1,bp=null,fC={onError:function(t){vl=!0,Vu=t}};function hC(t,e,n,r,i,s,o,a,l){vl=!1,Vu=null,dC.apply(fC,arguments)}function pC(t,e,n,r,i,s,o,a,l){if(hC.apply(this,arguments),vl){if(vl){var c=Vu;vl=!1,Vu=null}else throw Error(le(198));Hu||(Hu=!0,bp=c)}}function oo(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Nw(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function U0(t){if(oo(t)!==t)throw Error(le(188))}function mC(t){var e=t.alternate;if(!e){if(e=oo(t),e===null)throw Error(le(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return U0(i),t;if(s===r)return U0(i),e;s=s.sibling}throw Error(le(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(le(189))}}if(n.alternate!==r)throw Error(le(190))}if(n.tag!==3)throw Error(le(188));return n.stateNode.current===n?t:e}function Iw(t){return t=mC(t),t!==null?Lw(t):null}function Lw(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Lw(t);if(e!==null)return e;t=t.sibling}return null}var Dw=Gn.unstable_scheduleCallback,k0=Gn.unstable_cancelCallback,gC=Gn.unstable_shouldYield,vC=Gn.unstable_requestPaint,Vt=Gn.unstable_now,xC=Gn.unstable_getCurrentPriorityLevel,Og=Gn.unstable_ImmediatePriority,Uw=Gn.unstable_UserBlockingPriority,Gu=Gn.unstable_NormalPriority,yC=Gn.unstable_LowPriority,kw=Gn.unstable_IdlePriority,Pd=null,Br=null;function _C(t){if(Br&&typeof Br.onCommitFiberRoot=="function")try{Br.onCommitFiberRoot(Pd,t,void 0,(t.current.flags&128)===128)}catch{}}var br=Math.clz32?Math.clz32:EC,wC=Math.log,SC=Math.LN2;function EC(t){return t>>>=0,t===0?32:31-(wC(t)/SC|0)|0}var Tc=64,Mc=4194304;function cl(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Wu(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=cl(a):(s&=o,s!==0&&(r=cl(s)))}else o=n&~i,o!==0?r=cl(o):s!==0&&(r=cl(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-br(e),i=1<<n,r|=t[n],e&=~i;return r}function bC(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function TC(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-br(s),a=1<<o,l=i[o];l===-1?(!(a&n)||a&r)&&(i[o]=bC(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function Tp(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Ow(){var t=Tc;return Tc<<=1,!(Tc&4194240)&&(Tc=64),t}function kf(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function tc(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-br(e),t[e]=n}function MC(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-br(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function Fg(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-br(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var gt=0;function Fw(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Bw,Bg,jw,zw,Vw,Mp=!1,Cc=[],Wi=null,$i=null,Xi=null,Il=new Map,Ll=new Map,Fi=[],CC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function O0(t,e){switch(t){case"focusin":case"focusout":Wi=null;break;case"dragenter":case"dragleave":$i=null;break;case"mouseover":case"mouseout":Xi=null;break;case"pointerover":case"pointerout":Il.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ll.delete(e.pointerId)}}function Xa(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=rc(e),e!==null&&Bg(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function AC(t,e,n,r,i){switch(e){case"focusin":return Wi=Xa(Wi,t,e,n,r,i),!0;case"dragenter":return $i=Xa($i,t,e,n,r,i),!0;case"mouseover":return Xi=Xa(Xi,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return Il.set(s,Xa(Il.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Ll.set(s,Xa(Ll.get(s)||null,t,e,n,r,i)),!0}return!1}function Hw(t){var e=zs(t.target);if(e!==null){var n=oo(e);if(n!==null){if(e=n.tag,e===13){if(e=Nw(n),e!==null){t.blockedOn=e,Vw(t.priority,function(){jw(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function yu(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Cp(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);wp=r,n.target.dispatchEvent(r),wp=null}else return e=rc(n),e!==null&&Bg(e),t.blockedOn=n,!1;e.shift()}return!0}function F0(t,e,n){yu(t)&&n.delete(e)}function RC(){Mp=!1,Wi!==null&&yu(Wi)&&(Wi=null),$i!==null&&yu($i)&&($i=null),Xi!==null&&yu(Xi)&&(Xi=null),Il.forEach(F0),Ll.forEach(F0)}function qa(t,e){t.blockedOn===e&&(t.blockedOn=null,Mp||(Mp=!0,Gn.unstable_scheduleCallback(Gn.unstable_NormalPriority,RC)))}function Dl(t){function e(i){return qa(i,t)}if(0<Cc.length){qa(Cc[0],t);for(var n=1;n<Cc.length;n++){var r=Cc[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Wi!==null&&qa(Wi,t),$i!==null&&qa($i,t),Xi!==null&&qa(Xi,t),Il.forEach(e),Ll.forEach(e),n=0;n<Fi.length;n++)r=Fi[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Fi.length&&(n=Fi[0],n.blockedOn===null);)Hw(n),n.blockedOn===null&&Fi.shift()}var ea=xi.ReactCurrentBatchConfig,$u=!0;function PC(t,e,n,r){var i=gt,s=ea.transition;ea.transition=null;try{gt=1,jg(t,e,n,r)}finally{gt=i,ea.transition=s}}function NC(t,e,n,r){var i=gt,s=ea.transition;ea.transition=null;try{gt=4,jg(t,e,n,r)}finally{gt=i,ea.transition=s}}function jg(t,e,n,r){if($u){var i=Cp(t,e,n,r);if(i===null)$f(t,e,r,Xu,n),O0(t,r);else if(AC(i,t,e,n,r))r.stopPropagation();else if(O0(t,r),e&4&&-1<CC.indexOf(t)){for(;i!==null;){var s=rc(i);if(s!==null&&Bw(s),s=Cp(t,e,n,r),s===null&&$f(t,e,r,Xu,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else $f(t,e,r,null,n)}}var Xu=null;function Cp(t,e,n,r){if(Xu=null,t=kg(r),t=zs(t),t!==null)if(e=oo(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Nw(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Xu=t,null}function Gw(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(xC()){case Og:return 1;case Uw:return 4;case Gu:case yC:return 16;case kw:return 536870912;default:return 16}default:return 16}}var zi=null,zg=null,_u=null;function Ww(){if(_u)return _u;var t,e=zg,n=e.length,r,i="value"in zi?zi.value:zi.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return _u=i.slice(t,1<r?1-r:void 0)}function wu(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Ac(){return!0}function B0(){return!1}function Xn(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Ac:B0,this.isPropagationStopped=B0,this}return Ut(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Ac)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Ac)},persist:function(){},isPersistent:Ac}),e}var Ia={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Vg=Xn(Ia),nc=Ut({},Ia,{view:0,detail:0}),IC=Xn(nc),Of,Ff,Ya,Nd=Ut({},nc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Hg,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ya&&(Ya&&t.type==="mousemove"?(Of=t.screenX-Ya.screenX,Ff=t.screenY-Ya.screenY):Ff=Of=0,Ya=t),Of)},movementY:function(t){return"movementY"in t?t.movementY:Ff}}),j0=Xn(Nd),LC=Ut({},Nd,{dataTransfer:0}),DC=Xn(LC),UC=Ut({},nc,{relatedTarget:0}),Bf=Xn(UC),kC=Ut({},Ia,{animationName:0,elapsedTime:0,pseudoElement:0}),OC=Xn(kC),FC=Ut({},Ia,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),BC=Xn(FC),jC=Ut({},Ia,{data:0}),z0=Xn(jC),zC={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},VC={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},HC={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function GC(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=HC[t])?!!e[t]:!1}function Hg(){return GC}var WC=Ut({},nc,{key:function(t){if(t.key){var e=zC[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=wu(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?VC[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Hg,charCode:function(t){return t.type==="keypress"?wu(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?wu(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),$C=Xn(WC),XC=Ut({},Nd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),V0=Xn(XC),qC=Ut({},nc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Hg}),YC=Xn(qC),KC=Ut({},Ia,{propertyName:0,elapsedTime:0,pseudoElement:0}),JC=Xn(KC),ZC=Ut({},Nd,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),QC=Xn(ZC),eA=[9,13,27,32],Gg=ui&&"CompositionEvent"in window,xl=null;ui&&"documentMode"in document&&(xl=document.documentMode);var tA=ui&&"TextEvent"in window&&!xl,$w=ui&&(!Gg||xl&&8<xl&&11>=xl),H0=" ",G0=!1;function Xw(t,e){switch(t){case"keyup":return eA.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function qw(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var jo=!1;function nA(t,e){switch(t){case"compositionend":return qw(e);case"keypress":return e.which!==32?null:(G0=!0,H0);case"textInput":return t=e.data,t===H0&&G0?null:t;default:return null}}function rA(t,e){if(jo)return t==="compositionend"||!Gg&&Xw(t,e)?(t=Ww(),_u=zg=zi=null,jo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return $w&&e.locale!=="ko"?null:e.data;default:return null}}var iA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function W0(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!iA[t.type]:e==="textarea"}function Yw(t,e,n,r){Mw(r),e=qu(e,"onChange"),0<e.length&&(n=new Vg("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var yl=null,Ul=null;function sA(t){oS(t,0)}function Id(t){var e=Ho(t);if(yw(e))return t}function oA(t,e){if(t==="change")return e}var Kw=!1;if(ui){var jf;if(ui){var zf="oninput"in document;if(!zf){var $0=document.createElement("div");$0.setAttribute("oninput","return;"),zf=typeof $0.oninput=="function"}jf=zf}else jf=!1;Kw=jf&&(!document.documentMode||9<document.documentMode)}function X0(){yl&&(yl.detachEvent("onpropertychange",Jw),Ul=yl=null)}function Jw(t){if(t.propertyName==="value"&&Id(Ul)){var e=[];Yw(e,Ul,t,kg(t)),Pw(sA,e)}}function aA(t,e,n){t==="focusin"?(X0(),yl=e,Ul=n,yl.attachEvent("onpropertychange",Jw)):t==="focusout"&&X0()}function lA(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Id(Ul)}function cA(t,e){if(t==="click")return Id(e)}function uA(t,e){if(t==="input"||t==="change")return Id(e)}function dA(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Cr=typeof Object.is=="function"?Object.is:dA;function kl(t,e){if(Cr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!cp.call(e,i)||!Cr(t[i],e[i]))return!1}return!0}function q0(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Y0(t,e){var n=q0(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=q0(n)}}function Zw(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Zw(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Qw(){for(var t=window,e=zu();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=zu(t.document)}return e}function Wg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function fA(t){var e=Qw(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Zw(n.ownerDocument.documentElement,n)){if(r!==null&&Wg(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=Y0(n,s);var o=Y0(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var hA=ui&&"documentMode"in document&&11>=document.documentMode,zo=null,Ap=null,_l=null,Rp=!1;function K0(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Rp||zo==null||zo!==zu(r)||(r=zo,"selectionStart"in r&&Wg(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),_l&&kl(_l,r)||(_l=r,r=qu(Ap,"onSelect"),0<r.length&&(e=new Vg("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=zo)))}function Rc(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Vo={animationend:Rc("Animation","AnimationEnd"),animationiteration:Rc("Animation","AnimationIteration"),animationstart:Rc("Animation","AnimationStart"),transitionend:Rc("Transition","TransitionEnd")},Vf={},eS={};ui&&(eS=document.createElement("div").style,"AnimationEvent"in window||(delete Vo.animationend.animation,delete Vo.animationiteration.animation,delete Vo.animationstart.animation),"TransitionEvent"in window||delete Vo.transitionend.transition);function Ld(t){if(Vf[t])return Vf[t];if(!Vo[t])return t;var e=Vo[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in eS)return Vf[t]=e[n];return t}var tS=Ld("animationend"),nS=Ld("animationiteration"),rS=Ld("animationstart"),iS=Ld("transitionend"),sS=new Map,J0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function us(t,e){sS.set(t,e),so(e,[t])}for(var Hf=0;Hf<J0.length;Hf++){var Gf=J0[Hf],pA=Gf.toLowerCase(),mA=Gf[0].toUpperCase()+Gf.slice(1);us(pA,"on"+mA)}us(tS,"onAnimationEnd");us(nS,"onAnimationIteration");us(rS,"onAnimationStart");us("dblclick","onDoubleClick");us("focusin","onFocus");us("focusout","onBlur");us(iS,"onTransitionEnd");ua("onMouseEnter",["mouseout","mouseover"]);ua("onMouseLeave",["mouseout","mouseover"]);ua("onPointerEnter",["pointerout","pointerover"]);ua("onPointerLeave",["pointerout","pointerover"]);so("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));so("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));so("onBeforeInput",["compositionend","keypress","textInput","paste"]);so("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));so("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));so("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ul="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),gA=new Set("cancel close invalid load scroll toggle".split(" ").concat(ul));function Z0(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,pC(r,e,void 0,t),t.currentTarget=null}function oS(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;Z0(i,a,c),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;Z0(i,a,c),s=l}}}if(Hu)throw t=bp,Hu=!1,bp=null,t}function Ct(t,e){var n=e[Dp];n===void 0&&(n=e[Dp]=new Set);var r=t+"__bubble";n.has(r)||(aS(e,t,2,!1),n.add(r))}function Wf(t,e,n){var r=0;e&&(r|=4),aS(n,t,r,e)}var Pc="_reactListening"+Math.random().toString(36).slice(2);function Ol(t){if(!t[Pc]){t[Pc]=!0,pw.forEach(function(n){n!=="selectionchange"&&(gA.has(n)||Wf(n,!1,t),Wf(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Pc]||(e[Pc]=!0,Wf("selectionchange",!1,e))}}function aS(t,e,n,r){switch(Gw(e)){case 1:var i=PC;break;case 4:i=NC;break;default:i=jg}n=i.bind(null,e,n,t),i=void 0,!Ep||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function $f(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=zs(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}Pw(function(){var c=s,u=kg(n),d=[];e:{var h=sS.get(t);if(h!==void 0){var m=Vg,x=t;switch(t){case"keypress":if(wu(n)===0)break e;case"keydown":case"keyup":m=$C;break;case"focusin":x="focus",m=Bf;break;case"focusout":x="blur",m=Bf;break;case"beforeblur":case"afterblur":m=Bf;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=j0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=DC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=YC;break;case tS:case nS:case rS:m=OC;break;case iS:m=JC;break;case"scroll":m=IC;break;case"wheel":m=QC;break;case"copy":case"cut":case"paste":m=BC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=V0}var v=(e&4)!==0,g=!v&&t==="scroll",p=v?h!==null?h+"Capture":null:h;v=[];for(var y=c,_;y!==null;){_=y;var w=_.stateNode;if(_.tag===5&&w!==null&&(_=w,p!==null&&(w=Nl(y,p),w!=null&&v.push(Fl(y,w,_)))),g)break;y=y.return}0<v.length&&(h=new m(h,x,null,n,u),d.push({event:h,listeners:v}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",h&&n!==wp&&(x=n.relatedTarget||n.fromElement)&&(zs(x)||x[di]))break e;if((m||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,m?(x=n.relatedTarget||n.toElement,m=c,x=x?zs(x):null,x!==null&&(g=oo(x),x!==g||x.tag!==5&&x.tag!==6)&&(x=null)):(m=null,x=c),m!==x)){if(v=j0,w="onMouseLeave",p="onMouseEnter",y="mouse",(t==="pointerout"||t==="pointerover")&&(v=V0,w="onPointerLeave",p="onPointerEnter",y="pointer"),g=m==null?h:Ho(m),_=x==null?h:Ho(x),h=new v(w,y+"leave",m,n,u),h.target=g,h.relatedTarget=_,w=null,zs(u)===c&&(v=new v(p,y+"enter",x,n,u),v.target=_,v.relatedTarget=g,w=v),g=w,m&&x)t:{for(v=m,p=x,y=0,_=v;_;_=fo(_))y++;for(_=0,w=p;w;w=fo(w))_++;for(;0<y-_;)v=fo(v),y--;for(;0<_-y;)p=fo(p),_--;for(;y--;){if(v===p||p!==null&&v===p.alternate)break t;v=fo(v),p=fo(p)}v=null}else v=null;m!==null&&Q0(d,h,m,v,!1),x!==null&&g!==null&&Q0(d,g,x,v,!0)}}e:{if(h=c?Ho(c):window,m=h.nodeName&&h.nodeName.toLowerCase(),m==="select"||m==="input"&&h.type==="file")var E=oA;else if(W0(h))if(Kw)E=uA;else{E=lA;var M=aA}else(m=h.nodeName)&&m.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(E=cA);if(E&&(E=E(t,c))){Yw(d,E,n,u);break e}M&&M(t,h,c),t==="focusout"&&(M=h._wrapperState)&&M.controlled&&h.type==="number"&&gp(h,"number",h.value)}switch(M=c?Ho(c):window,t){case"focusin":(W0(M)||M.contentEditable==="true")&&(zo=M,Ap=c,_l=null);break;case"focusout":_l=Ap=zo=null;break;case"mousedown":Rp=!0;break;case"contextmenu":case"mouseup":case"dragend":Rp=!1,K0(d,n,u);break;case"selectionchange":if(hA)break;case"keydown":case"keyup":K0(d,n,u)}var T;if(Gg)e:{switch(t){case"compositionstart":var P="onCompositionStart";break e;case"compositionend":P="onCompositionEnd";break e;case"compositionupdate":P="onCompositionUpdate";break e}P=void 0}else jo?Xw(t,n)&&(P="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(P="onCompositionStart");P&&($w&&n.locale!=="ko"&&(jo||P!=="onCompositionStart"?P==="onCompositionEnd"&&jo&&(T=Ww()):(zi=u,zg="value"in zi?zi.value:zi.textContent,jo=!0)),M=qu(c,P),0<M.length&&(P=new z0(P,t,null,n,u),d.push({event:P,listeners:M}),T?P.data=T:(T=qw(n),T!==null&&(P.data=T)))),(T=tA?nA(t,n):rA(t,n))&&(c=qu(c,"onBeforeInput"),0<c.length&&(u=new z0("onBeforeInput","beforeinput",null,n,u),d.push({event:u,listeners:c}),u.data=T))}oS(d,e)})}function Fl(t,e,n){return{instance:t,listener:e,currentTarget:n}}function qu(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Nl(t,n),s!=null&&r.unshift(Fl(t,s,i)),s=Nl(t,e),s!=null&&r.push(Fl(t,s,i))),t=t.return}return r}function fo(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Q0(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&c!==null&&(a=c,i?(l=Nl(n,s),l!=null&&o.unshift(Fl(n,l,a))):i||(l=Nl(n,s),l!=null&&o.push(Fl(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var vA=/\r\n?/g,xA=/\u0000|\uFFFD/g;function ex(t){return(typeof t=="string"?t:""+t).replace(vA,`
`).replace(xA,"")}function Nc(t,e,n){if(e=ex(e),ex(t)!==e&&n)throw Error(le(425))}function Yu(){}var Pp=null,Np=null;function Ip(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Lp=typeof setTimeout=="function"?setTimeout:void 0,yA=typeof clearTimeout=="function"?clearTimeout:void 0,tx=typeof Promise=="function"?Promise:void 0,_A=typeof queueMicrotask=="function"?queueMicrotask:typeof tx<"u"?function(t){return tx.resolve(null).then(t).catch(wA)}:Lp;function wA(t){setTimeout(function(){throw t})}function Xf(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Dl(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Dl(e)}function qi(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function nx(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var La=Math.random().toString(36).slice(2),Ur="__reactFiber$"+La,Bl="__reactProps$"+La,di="__reactContainer$"+La,Dp="__reactEvents$"+La,SA="__reactListeners$"+La,EA="__reactHandles$"+La;function zs(t){var e=t[Ur];if(e)return e;for(var n=t.parentNode;n;){if(e=n[di]||n[Ur]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=nx(t);t!==null;){if(n=t[Ur])return n;t=nx(t)}return e}t=n,n=t.parentNode}return null}function rc(t){return t=t[Ur]||t[di],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ho(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(le(33))}function Dd(t){return t[Bl]||null}var Up=[],Go=-1;function ds(t){return{current:t}}function At(t){0>Go||(t.current=Up[Go],Up[Go]=null,Go--)}function bt(t,e){Go++,Up[Go]=t.current,t.current=e}var ts={},gn=ds(ts),Pn=ds(!1),Zs=ts;function da(t,e){var n=t.type.contextTypes;if(!n)return ts;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Nn(t){return t=t.childContextTypes,t!=null}function Ku(){At(Pn),At(gn)}function rx(t,e,n){if(gn.current!==ts)throw Error(le(168));bt(gn,e),bt(Pn,n)}function lS(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(le(108,aC(t)||"Unknown",i));return Ut({},n,r)}function Ju(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ts,Zs=gn.current,bt(gn,t),bt(Pn,Pn.current),!0}function ix(t,e,n){var r=t.stateNode;if(!r)throw Error(le(169));n?(t=lS(t,e,Zs),r.__reactInternalMemoizedMergedChildContext=t,At(Pn),At(gn),bt(gn,t)):At(Pn),bt(Pn,n)}var ri=null,Ud=!1,qf=!1;function cS(t){ri===null?ri=[t]:ri.push(t)}function bA(t){Ud=!0,cS(t)}function fs(){if(!qf&&ri!==null){qf=!0;var t=0,e=gt;try{var n=ri;for(gt=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}ri=null,Ud=!1}catch(i){throw ri!==null&&(ri=ri.slice(t+1)),Dw(Og,fs),i}finally{gt=e,qf=!1}}return null}var Wo=[],$o=0,Zu=null,Qu=0,Zn=[],Qn=0,Qs=null,ii=1,si="";function Is(t,e){Wo[$o++]=Qu,Wo[$o++]=Zu,Zu=t,Qu=e}function uS(t,e,n){Zn[Qn++]=ii,Zn[Qn++]=si,Zn[Qn++]=Qs,Qs=t;var r=ii;t=si;var i=32-br(r)-1;r&=~(1<<i),n+=1;var s=32-br(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,ii=1<<32-br(e)+i|n<<i|r,si=s+t}else ii=1<<s|n<<i|r,si=t}function $g(t){t.return!==null&&(Is(t,1),uS(t,1,0))}function Xg(t){for(;t===Zu;)Zu=Wo[--$o],Wo[$o]=null,Qu=Wo[--$o],Wo[$o]=null;for(;t===Qs;)Qs=Zn[--Qn],Zn[Qn]=null,si=Zn[--Qn],Zn[Qn]=null,ii=Zn[--Qn],Zn[Qn]=null}var zn=null,jn=null,Rt=!1,xr=null;function dS(t,e){var n=tr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function sx(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,zn=t,jn=qi(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,zn=t,jn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Qs!==null?{id:ii,overflow:si}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=tr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,zn=t,jn=null,!0):!1;default:return!1}}function kp(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Op(t){if(Rt){var e=jn;if(e){var n=e;if(!sx(t,e)){if(kp(t))throw Error(le(418));e=qi(n.nextSibling);var r=zn;e&&sx(t,e)?dS(r,n):(t.flags=t.flags&-4097|2,Rt=!1,zn=t)}}else{if(kp(t))throw Error(le(418));t.flags=t.flags&-4097|2,Rt=!1,zn=t}}}function ox(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;zn=t}function Ic(t){if(t!==zn)return!1;if(!Rt)return ox(t),Rt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Ip(t.type,t.memoizedProps)),e&&(e=jn)){if(kp(t))throw fS(),Error(le(418));for(;e;)dS(t,e),e=qi(e.nextSibling)}if(ox(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(le(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){jn=qi(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}jn=null}}else jn=zn?qi(t.stateNode.nextSibling):null;return!0}function fS(){for(var t=jn;t;)t=qi(t.nextSibling)}function fa(){jn=zn=null,Rt=!1}function qg(t){xr===null?xr=[t]:xr.push(t)}var TA=xi.ReactCurrentBatchConfig;function Ka(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(le(309));var r=n.stateNode}if(!r)throw Error(le(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(le(284));if(!n._owner)throw Error(le(290,t))}return t}function Lc(t,e){throw t=Object.prototype.toString.call(e),Error(le(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function ax(t){var e=t._init;return e(t._payload)}function hS(t){function e(p,y){if(t){var _=p.deletions;_===null?(p.deletions=[y],p.flags|=16):_.push(y)}}function n(p,y){if(!t)return null;for(;y!==null;)e(p,y),y=y.sibling;return null}function r(p,y){for(p=new Map;y!==null;)y.key!==null?p.set(y.key,y):p.set(y.index,y),y=y.sibling;return p}function i(p,y){return p=Zi(p,y),p.index=0,p.sibling=null,p}function s(p,y,_){return p.index=_,t?(_=p.alternate,_!==null?(_=_.index,_<y?(p.flags|=2,y):_):(p.flags|=2,y)):(p.flags|=1048576,y)}function o(p){return t&&p.alternate===null&&(p.flags|=2),p}function a(p,y,_,w){return y===null||y.tag!==6?(y=th(_,p.mode,w),y.return=p,y):(y=i(y,_),y.return=p,y)}function l(p,y,_,w){var E=_.type;return E===Bo?u(p,y,_.props.children,w,_.key):y!==null&&(y.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Ui&&ax(E)===y.type)?(w=i(y,_.props),w.ref=Ka(p,y,_),w.return=p,w):(w=Au(_.type,_.key,_.props,null,p.mode,w),w.ref=Ka(p,y,_),w.return=p,w)}function c(p,y,_,w){return y===null||y.tag!==4||y.stateNode.containerInfo!==_.containerInfo||y.stateNode.implementation!==_.implementation?(y=nh(_,p.mode,w),y.return=p,y):(y=i(y,_.children||[]),y.return=p,y)}function u(p,y,_,w,E){return y===null||y.tag!==7?(y=Xs(_,p.mode,w,E),y.return=p,y):(y=i(y,_),y.return=p,y)}function d(p,y,_){if(typeof y=="string"&&y!==""||typeof y=="number")return y=th(""+y,p.mode,_),y.return=p,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Sc:return _=Au(y.type,y.key,y.props,null,p.mode,_),_.ref=Ka(p,null,y),_.return=p,_;case Fo:return y=nh(y,p.mode,_),y.return=p,y;case Ui:var w=y._init;return d(p,w(y._payload),_)}if(ll(y)||Wa(y))return y=Xs(y,p.mode,_,null),y.return=p,y;Lc(p,y)}return null}function h(p,y,_,w){var E=y!==null?y.key:null;if(typeof _=="string"&&_!==""||typeof _=="number")return E!==null?null:a(p,y,""+_,w);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Sc:return _.key===E?l(p,y,_,w):null;case Fo:return _.key===E?c(p,y,_,w):null;case Ui:return E=_._init,h(p,y,E(_._payload),w)}if(ll(_)||Wa(_))return E!==null?null:u(p,y,_,w,null);Lc(p,_)}return null}function m(p,y,_,w,E){if(typeof w=="string"&&w!==""||typeof w=="number")return p=p.get(_)||null,a(y,p,""+w,E);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Sc:return p=p.get(w.key===null?_:w.key)||null,l(y,p,w,E);case Fo:return p=p.get(w.key===null?_:w.key)||null,c(y,p,w,E);case Ui:var M=w._init;return m(p,y,_,M(w._payload),E)}if(ll(w)||Wa(w))return p=p.get(_)||null,u(y,p,w,E,null);Lc(y,w)}return null}function x(p,y,_,w){for(var E=null,M=null,T=y,P=y=0,C=null;T!==null&&P<_.length;P++){T.index>P?(C=T,T=null):C=T.sibling;var b=h(p,T,_[P],w);if(b===null){T===null&&(T=C);break}t&&T&&b.alternate===null&&e(p,T),y=s(b,y,P),M===null?E=b:M.sibling=b,M=b,T=C}if(P===_.length)return n(p,T),Rt&&Is(p,P),E;if(T===null){for(;P<_.length;P++)T=d(p,_[P],w),T!==null&&(y=s(T,y,P),M===null?E=T:M.sibling=T,M=T);return Rt&&Is(p,P),E}for(T=r(p,T);P<_.length;P++)C=m(T,p,P,_[P],w),C!==null&&(t&&C.alternate!==null&&T.delete(C.key===null?P:C.key),y=s(C,y,P),M===null?E=C:M.sibling=C,M=C);return t&&T.forEach(function(N){return e(p,N)}),Rt&&Is(p,P),E}function v(p,y,_,w){var E=Wa(_);if(typeof E!="function")throw Error(le(150));if(_=E.call(_),_==null)throw Error(le(151));for(var M=E=null,T=y,P=y=0,C=null,b=_.next();T!==null&&!b.done;P++,b=_.next()){T.index>P?(C=T,T=null):C=T.sibling;var N=h(p,T,b.value,w);if(N===null){T===null&&(T=C);break}t&&T&&N.alternate===null&&e(p,T),y=s(N,y,P),M===null?E=N:M.sibling=N,M=N,T=C}if(b.done)return n(p,T),Rt&&Is(p,P),E;if(T===null){for(;!b.done;P++,b=_.next())b=d(p,b.value,w),b!==null&&(y=s(b,y,P),M===null?E=b:M.sibling=b,M=b);return Rt&&Is(p,P),E}for(T=r(p,T);!b.done;P++,b=_.next())b=m(T,p,P,b.value,w),b!==null&&(t&&b.alternate!==null&&T.delete(b.key===null?P:b.key),y=s(b,y,P),M===null?E=b:M.sibling=b,M=b);return t&&T.forEach(function(U){return e(p,U)}),Rt&&Is(p,P),E}function g(p,y,_,w){if(typeof _=="object"&&_!==null&&_.type===Bo&&_.key===null&&(_=_.props.children),typeof _=="object"&&_!==null){switch(_.$$typeof){case Sc:e:{for(var E=_.key,M=y;M!==null;){if(M.key===E){if(E=_.type,E===Bo){if(M.tag===7){n(p,M.sibling),y=i(M,_.props.children),y.return=p,p=y;break e}}else if(M.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Ui&&ax(E)===M.type){n(p,M.sibling),y=i(M,_.props),y.ref=Ka(p,M,_),y.return=p,p=y;break e}n(p,M);break}else e(p,M);M=M.sibling}_.type===Bo?(y=Xs(_.props.children,p.mode,w,_.key),y.return=p,p=y):(w=Au(_.type,_.key,_.props,null,p.mode,w),w.ref=Ka(p,y,_),w.return=p,p=w)}return o(p);case Fo:e:{for(M=_.key;y!==null;){if(y.key===M)if(y.tag===4&&y.stateNode.containerInfo===_.containerInfo&&y.stateNode.implementation===_.implementation){n(p,y.sibling),y=i(y,_.children||[]),y.return=p,p=y;break e}else{n(p,y);break}else e(p,y);y=y.sibling}y=nh(_,p.mode,w),y.return=p,p=y}return o(p);case Ui:return M=_._init,g(p,y,M(_._payload),w)}if(ll(_))return x(p,y,_,w);if(Wa(_))return v(p,y,_,w);Lc(p,_)}return typeof _=="string"&&_!==""||typeof _=="number"?(_=""+_,y!==null&&y.tag===6?(n(p,y.sibling),y=i(y,_),y.return=p,p=y):(n(p,y),y=th(_,p.mode,w),y.return=p,p=y),o(p)):n(p,y)}return g}var ha=hS(!0),pS=hS(!1),ed=ds(null),td=null,Xo=null,Yg=null;function Kg(){Yg=Xo=td=null}function Jg(t){var e=ed.current;At(ed),t._currentValue=e}function Fp(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function ta(t,e){td=t,Yg=Xo=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Rn=!0),t.firstContext=null)}function sr(t){var e=t._currentValue;if(Yg!==t)if(t={context:t,memoizedValue:e,next:null},Xo===null){if(td===null)throw Error(le(308));Xo=t,td.dependencies={lanes:0,firstContext:t}}else Xo=Xo.next=t;return e}var Vs=null;function Zg(t){Vs===null?Vs=[t]:Vs.push(t)}function mS(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,Zg(e)):(n.next=i.next,i.next=n),e.interleaved=n,fi(t,r)}function fi(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var ki=!1;function Qg(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function gS(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ai(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Yi(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,ct&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,fi(t,n)}return i=r.interleaved,i===null?(e.next=e,Zg(r)):(e.next=i.next,i.next=e),r.interleaved=e,fi(t,n)}function Su(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Fg(t,n)}}function lx(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function nd(t,e,n,r){var i=t.updateQueue;ki=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?s=c:o.next=c,o=l;var u=t.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(s!==null){var d=i.baseState;o=0,u=c=l=null,a=s;do{var h=a.lane,m=a.eventTime;if((r&h)===h){u!==null&&(u=u.next={eventTime:m,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var x=t,v=a;switch(h=e,m=n,v.tag){case 1:if(x=v.payload,typeof x=="function"){d=x.call(m,d,h);break e}d=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=v.payload,h=typeof x=="function"?x.call(m,d,h):x,h==null)break e;d=Ut({},d,h);break e;case 2:ki=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,h=i.effects,h===null?i.effects=[a]:h.push(a))}else m={eventTime:m,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=m,l=d):u=u.next=m,o|=h;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;h=a,a=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(!0);if(u===null&&(l=d),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);to|=o,t.lanes=o,t.memoizedState=d}}function cx(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(le(191,i));i.call(r)}}}var ic={},jr=ds(ic),jl=ds(ic),zl=ds(ic);function Hs(t){if(t===ic)throw Error(le(174));return t}function ev(t,e){switch(bt(zl,e),bt(jl,t),bt(jr,ic),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:xp(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=xp(e,t)}At(jr),bt(jr,e)}function pa(){At(jr),At(jl),At(zl)}function vS(t){Hs(zl.current);var e=Hs(jr.current),n=xp(e,t.type);e!==n&&(bt(jl,t),bt(jr,n))}function tv(t){jl.current===t&&(At(jr),At(jl))}var It=ds(0);function rd(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Yf=[];function nv(){for(var t=0;t<Yf.length;t++)Yf[t]._workInProgressVersionPrimary=null;Yf.length=0}var Eu=xi.ReactCurrentDispatcher,Kf=xi.ReactCurrentBatchConfig,eo=0,Dt=null,$t=null,tn=null,id=!1,wl=!1,Vl=0,MA=0;function cn(){throw Error(le(321))}function rv(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Cr(t[n],e[n]))return!1;return!0}function iv(t,e,n,r,i,s){if(eo=s,Dt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Eu.current=t===null||t.memoizedState===null?PA:NA,t=n(r,i),wl){s=0;do{if(wl=!1,Vl=0,25<=s)throw Error(le(301));s+=1,tn=$t=null,e.updateQueue=null,Eu.current=IA,t=n(r,i)}while(wl)}if(Eu.current=sd,e=$t!==null&&$t.next!==null,eo=0,tn=$t=Dt=null,id=!1,e)throw Error(le(300));return t}function sv(){var t=Vl!==0;return Vl=0,t}function Lr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return tn===null?Dt.memoizedState=tn=t:tn=tn.next=t,tn}function or(){if($t===null){var t=Dt.alternate;t=t!==null?t.memoizedState:null}else t=$t.next;var e=tn===null?Dt.memoizedState:tn.next;if(e!==null)tn=e,$t=t;else{if(t===null)throw Error(le(310));$t=t,t={memoizedState:$t.memoizedState,baseState:$t.baseState,baseQueue:$t.baseQueue,queue:$t.queue,next:null},tn===null?Dt.memoizedState=tn=t:tn=tn.next=t}return tn}function Hl(t,e){return typeof e=="function"?e(t):e}function Jf(t){var e=or(),n=e.queue;if(n===null)throw Error(le(311));n.lastRenderedReducer=t;var r=$t,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,c=s;do{var u=c.lane;if((eo&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=d,o=r):l=l.next=d,Dt.lanes|=u,to|=u}c=c.next}while(c!==null&&c!==s);l===null?o=r:l.next=a,Cr(r,e.memoizedState)||(Rn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,Dt.lanes|=s,to|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Zf(t){var e=or(),n=e.queue;if(n===null)throw Error(le(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);Cr(s,e.memoizedState)||(Rn=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function xS(){}function yS(t,e){var n=Dt,r=or(),i=e(),s=!Cr(r.memoizedState,i);if(s&&(r.memoizedState=i,Rn=!0),r=r.queue,ov(SS.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||tn!==null&&tn.memoizedState.tag&1){if(n.flags|=2048,Gl(9,wS.bind(null,n,r,i,e),void 0,null),rn===null)throw Error(le(349));eo&30||_S(n,e,i)}return i}function _S(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Dt.updateQueue,e===null?(e={lastEffect:null,stores:null},Dt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function wS(t,e,n,r){e.value=n,e.getSnapshot=r,ES(e)&&bS(t)}function SS(t,e,n){return n(function(){ES(e)&&bS(t)})}function ES(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Cr(t,n)}catch{return!0}}function bS(t){var e=fi(t,1);e!==null&&Tr(e,t,1,-1)}function ux(t){var e=Lr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Hl,lastRenderedState:t},e.queue=t,t=t.dispatch=RA.bind(null,Dt,t),[e.memoizedState,t]}function Gl(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Dt.updateQueue,e===null?(e={lastEffect:null,stores:null},Dt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function TS(){return or().memoizedState}function bu(t,e,n,r){var i=Lr();Dt.flags|=t,i.memoizedState=Gl(1|e,n,void 0,r===void 0?null:r)}function kd(t,e,n,r){var i=or();r=r===void 0?null:r;var s=void 0;if($t!==null){var o=$t.memoizedState;if(s=o.destroy,r!==null&&rv(r,o.deps)){i.memoizedState=Gl(e,n,s,r);return}}Dt.flags|=t,i.memoizedState=Gl(1|e,n,s,r)}function dx(t,e){return bu(8390656,8,t,e)}function ov(t,e){return kd(2048,8,t,e)}function MS(t,e){return kd(4,2,t,e)}function CS(t,e){return kd(4,4,t,e)}function AS(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function RS(t,e,n){return n=n!=null?n.concat([t]):null,kd(4,4,AS.bind(null,e,t),n)}function av(){}function PS(t,e){var n=or();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&rv(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function NS(t,e){var n=or();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&rv(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function IS(t,e,n){return eo&21?(Cr(n,e)||(n=Ow(),Dt.lanes|=n,to|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Rn=!0),t.memoizedState=n)}function CA(t,e){var n=gt;gt=n!==0&&4>n?n:4,t(!0);var r=Kf.transition;Kf.transition={};try{t(!1),e()}finally{gt=n,Kf.transition=r}}function LS(){return or().memoizedState}function AA(t,e,n){var r=Ji(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},DS(t))US(e,n);else if(n=mS(t,e,n,r),n!==null){var i=wn();Tr(n,t,r,i),kS(n,e,r)}}function RA(t,e,n){var r=Ji(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(DS(t))US(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,Cr(a,o)){var l=e.interleaved;l===null?(i.next=i,Zg(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=mS(t,e,i,r),n!==null&&(i=wn(),Tr(n,t,r,i),kS(n,e,r))}}function DS(t){var e=t.alternate;return t===Dt||e!==null&&e===Dt}function US(t,e){wl=id=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function kS(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Fg(t,n)}}var sd={readContext:sr,useCallback:cn,useContext:cn,useEffect:cn,useImperativeHandle:cn,useInsertionEffect:cn,useLayoutEffect:cn,useMemo:cn,useReducer:cn,useRef:cn,useState:cn,useDebugValue:cn,useDeferredValue:cn,useTransition:cn,useMutableSource:cn,useSyncExternalStore:cn,useId:cn,unstable_isNewReconciler:!1},PA={readContext:sr,useCallback:function(t,e){return Lr().memoizedState=[t,e===void 0?null:e],t},useContext:sr,useEffect:dx,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,bu(4194308,4,AS.bind(null,e,t),n)},useLayoutEffect:function(t,e){return bu(4194308,4,t,e)},useInsertionEffect:function(t,e){return bu(4,2,t,e)},useMemo:function(t,e){var n=Lr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Lr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=AA.bind(null,Dt,t),[r.memoizedState,t]},useRef:function(t){var e=Lr();return t={current:t},e.memoizedState=t},useState:ux,useDebugValue:av,useDeferredValue:function(t){return Lr().memoizedState=t},useTransition:function(){var t=ux(!1),e=t[0];return t=CA.bind(null,t[1]),Lr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Dt,i=Lr();if(Rt){if(n===void 0)throw Error(le(407));n=n()}else{if(n=e(),rn===null)throw Error(le(349));eo&30||_S(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,dx(SS.bind(null,r,s,t),[t]),r.flags|=2048,Gl(9,wS.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=Lr(),e=rn.identifierPrefix;if(Rt){var n=si,r=ii;n=(r&~(1<<32-br(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Vl++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=MA++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},NA={readContext:sr,useCallback:PS,useContext:sr,useEffect:ov,useImperativeHandle:RS,useInsertionEffect:MS,useLayoutEffect:CS,useMemo:NS,useReducer:Jf,useRef:TS,useState:function(){return Jf(Hl)},useDebugValue:av,useDeferredValue:function(t){var e=or();return IS(e,$t.memoizedState,t)},useTransition:function(){var t=Jf(Hl)[0],e=or().memoizedState;return[t,e]},useMutableSource:xS,useSyncExternalStore:yS,useId:LS,unstable_isNewReconciler:!1},IA={readContext:sr,useCallback:PS,useContext:sr,useEffect:ov,useImperativeHandle:RS,useInsertionEffect:MS,useLayoutEffect:CS,useMemo:NS,useReducer:Zf,useRef:TS,useState:function(){return Zf(Hl)},useDebugValue:av,useDeferredValue:function(t){var e=or();return $t===null?e.memoizedState=t:IS(e,$t.memoizedState,t)},useTransition:function(){var t=Zf(Hl)[0],e=or().memoizedState;return[t,e]},useMutableSource:xS,useSyncExternalStore:yS,useId:LS,unstable_isNewReconciler:!1};function mr(t,e){if(t&&t.defaultProps){e=Ut({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Bp(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Ut({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Od={isMounted:function(t){return(t=t._reactInternals)?oo(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=wn(),i=Ji(t),s=ai(r,i);s.payload=e,n!=null&&(s.callback=n),e=Yi(t,s,i),e!==null&&(Tr(e,t,i,r),Su(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=wn(),i=Ji(t),s=ai(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Yi(t,s,i),e!==null&&(Tr(e,t,i,r),Su(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=wn(),r=Ji(t),i=ai(n,r);i.tag=2,e!=null&&(i.callback=e),e=Yi(t,i,r),e!==null&&(Tr(e,t,r,n),Su(e,t,r))}};function fx(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!kl(n,r)||!kl(i,s):!0}function OS(t,e,n){var r=!1,i=ts,s=e.contextType;return typeof s=="object"&&s!==null?s=sr(s):(i=Nn(e)?Zs:gn.current,r=e.contextTypes,s=(r=r!=null)?da(t,i):ts),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Od,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function hx(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Od.enqueueReplaceState(e,e.state,null)}function jp(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},Qg(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=sr(s):(s=Nn(e)?Zs:gn.current,i.context=da(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Bp(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Od.enqueueReplaceState(i,i.state,null),nd(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function ma(t,e){try{var n="",r=e;do n+=oC(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Qf(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function zp(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var LA=typeof WeakMap=="function"?WeakMap:Map;function FS(t,e,n){n=ai(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){ad||(ad=!0,Jp=r),zp(t,e)},n}function BS(t,e,n){n=ai(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){zp(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){zp(t,e),typeof r!="function"&&(Ki===null?Ki=new Set([this]):Ki.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function px(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new LA;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=XA.bind(null,t,e,n),e.then(t,t))}function mx(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function gx(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=ai(-1,1),e.tag=2,Yi(n,e,1))),n.lanes|=1),t)}var DA=xi.ReactCurrentOwner,Rn=!1;function _n(t,e,n,r){e.child=t===null?pS(e,null,n,r):ha(e,t.child,n,r)}function vx(t,e,n,r,i){n=n.render;var s=e.ref;return ta(e,i),r=iv(t,e,n,r,s,i),n=sv(),t!==null&&!Rn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,hi(t,e,i)):(Rt&&n&&$g(e),e.flags|=1,_n(t,e,r,i),e.child)}function xx(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!mv(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,jS(t,e,s,r,i)):(t=Au(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:kl,n(o,r)&&t.ref===e.ref)return hi(t,e,i)}return e.flags|=1,t=Zi(s,r),t.ref=e.ref,t.return=e,e.child=t}function jS(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(kl(s,r)&&t.ref===e.ref)if(Rn=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(Rn=!0);else return e.lanes=t.lanes,hi(t,e,i)}return Vp(t,e,n,r,i)}function zS(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},bt(Yo,On),On|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,bt(Yo,On),On|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,bt(Yo,On),On|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,bt(Yo,On),On|=r;return _n(t,e,i,n),e.child}function VS(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Vp(t,e,n,r,i){var s=Nn(n)?Zs:gn.current;return s=da(e,s),ta(e,i),n=iv(t,e,n,r,s,i),r=sv(),t!==null&&!Rn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,hi(t,e,i)):(Rt&&r&&$g(e),e.flags|=1,_n(t,e,n,i),e.child)}function yx(t,e,n,r,i){if(Nn(n)){var s=!0;Ju(e)}else s=!1;if(ta(e,i),e.stateNode===null)Tu(t,e),OS(e,n,r),jp(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=n.contextType;typeof c=="object"&&c!==null?c=sr(c):(c=Nn(n)?Zs:gn.current,c=da(e,c));var u=n.getDerivedStateFromProps,d=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==c)&&hx(e,o,r,c),ki=!1;var h=e.memoizedState;o.state=h,nd(e,r,o,i),l=e.memoizedState,a!==r||h!==l||Pn.current||ki?(typeof u=="function"&&(Bp(e,n,u,r),l=e.memoizedState),(a=ki||fx(e,n,a,r,h,l,c))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=c,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,gS(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:mr(e.type,a),o.props=c,d=e.pendingProps,h=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=sr(l):(l=Nn(n)?Zs:gn.current,l=da(e,l));var m=n.getDerivedStateFromProps;(u=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==d||h!==l)&&hx(e,o,r,l),ki=!1,h=e.memoizedState,o.state=h,nd(e,r,o,i);var x=e.memoizedState;a!==d||h!==x||Pn.current||ki?(typeof m=="function"&&(Bp(e,n,m,r),x=e.memoizedState),(c=ki||fx(e,n,c,r,h,x,l)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,x,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,x,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=x),o.props=r,o.state=x,o.context=l,r=c):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),r=!1)}return Hp(t,e,n,r,s,i)}function Hp(t,e,n,r,i,s){VS(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&ix(e,n,!1),hi(t,e,s);r=e.stateNode,DA.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=ha(e,t.child,null,s),e.child=ha(e,null,a,s)):_n(t,e,a,s),e.memoizedState=r.state,i&&ix(e,n,!0),e.child}function HS(t){var e=t.stateNode;e.pendingContext?rx(t,e.pendingContext,e.pendingContext!==e.context):e.context&&rx(t,e.context,!1),ev(t,e.containerInfo)}function _x(t,e,n,r,i){return fa(),qg(i),e.flags|=256,_n(t,e,n,r),e.child}var Gp={dehydrated:null,treeContext:null,retryLane:0};function Wp(t){return{baseLanes:t,cachePool:null,transitions:null}}function GS(t,e,n){var r=e.pendingProps,i=It.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),bt(It,i&1),t===null)return Op(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=jd(o,r,0,null),t=Xs(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Wp(n),e.memoizedState=Gp,t):lv(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return UA(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Zi(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=Zi(a,s):(s=Xs(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?Wp(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=Gp,r}return s=t.child,t=s.sibling,r=Zi(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function lv(t,e){return e=jd({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Dc(t,e,n,r){return r!==null&&qg(r),ha(e,t.child,null,n),t=lv(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function UA(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=Qf(Error(le(422))),Dc(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=jd({mode:"visible",children:r.children},i,0,null),s=Xs(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&ha(e,t.child,null,o),e.child.memoizedState=Wp(o),e.memoizedState=Gp,s);if(!(e.mode&1))return Dc(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(le(419)),r=Qf(s,r,void 0),Dc(t,e,o,r)}if(a=(o&t.childLanes)!==0,Rn||a){if(r=rn,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,fi(t,i),Tr(r,t,i,-1))}return pv(),r=Qf(Error(le(421))),Dc(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=qA.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,jn=qi(i.nextSibling),zn=e,Rt=!0,xr=null,t!==null&&(Zn[Qn++]=ii,Zn[Qn++]=si,Zn[Qn++]=Qs,ii=t.id,si=t.overflow,Qs=e),e=lv(e,r.children),e.flags|=4096,e)}function wx(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Fp(t.return,e,n)}function eh(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function WS(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(_n(t,e,r.children,n),r=It.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&wx(t,n,e);else if(t.tag===19)wx(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(bt(It,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&rd(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),eh(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&rd(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}eh(e,!0,n,null,s);break;case"together":eh(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Tu(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function hi(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),to|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(le(153));if(e.child!==null){for(t=e.child,n=Zi(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Zi(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function kA(t,e,n){switch(e.tag){case 3:HS(e),fa();break;case 5:vS(e);break;case 1:Nn(e.type)&&Ju(e);break;case 4:ev(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;bt(ed,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(bt(It,It.current&1),e.flags|=128,null):n&e.child.childLanes?GS(t,e,n):(bt(It,It.current&1),t=hi(t,e,n),t!==null?t.sibling:null);bt(It,It.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return WS(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),bt(It,It.current),r)break;return null;case 22:case 23:return e.lanes=0,zS(t,e,n)}return hi(t,e,n)}var $S,$p,XS,qS;$S=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};$p=function(){};XS=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Hs(jr.current);var s=null;switch(n){case"input":i=pp(t,i),r=pp(t,r),s=[];break;case"select":i=Ut({},i,{value:void 0}),r=Ut({},r,{value:void 0}),s=[];break;case"textarea":i=vp(t,i),r=vp(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Yu)}yp(n,r);var o;n=null;for(c in i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var a=i[c];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Rl.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in r){var l=r[c];if(a=i!=null?i[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Rl.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Ct("scroll",t),s||a===l||(s=[])):(s=s||[]).push(c,l))}n&&(s=s||[]).push("style",n);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};qS=function(t,e,n,r){n!==r&&(e.flags|=4)};function Ja(t,e){if(!Rt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function un(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function OA(t,e,n){var r=e.pendingProps;switch(Xg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return un(e),null;case 1:return Nn(e.type)&&Ku(),un(e),null;case 3:return r=e.stateNode,pa(),At(Pn),At(gn),nv(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Ic(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,xr!==null&&(em(xr),xr=null))),$p(t,e),un(e),null;case 5:tv(e);var i=Hs(zl.current);if(n=e.type,t!==null&&e.stateNode!=null)XS(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(le(166));return un(e),null}if(t=Hs(jr.current),Ic(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Ur]=e,r[Bl]=s,t=(e.mode&1)!==0,n){case"dialog":Ct("cancel",r),Ct("close",r);break;case"iframe":case"object":case"embed":Ct("load",r);break;case"video":case"audio":for(i=0;i<ul.length;i++)Ct(ul[i],r);break;case"source":Ct("error",r);break;case"img":case"image":case"link":Ct("error",r),Ct("load",r);break;case"details":Ct("toggle",r);break;case"input":P0(r,s),Ct("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Ct("invalid",r);break;case"textarea":I0(r,s),Ct("invalid",r)}yp(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&Nc(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Nc(r.textContent,a,t),i=["children",""+a]):Rl.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Ct("scroll",r)}switch(n){case"input":Ec(r),N0(r,s,!0);break;case"textarea":Ec(r),L0(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=Yu)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Sw(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Ur]=e,t[Bl]=r,$S(t,e,!1,!1),e.stateNode=t;e:{switch(o=_p(n,r),n){case"dialog":Ct("cancel",t),Ct("close",t),i=r;break;case"iframe":case"object":case"embed":Ct("load",t),i=r;break;case"video":case"audio":for(i=0;i<ul.length;i++)Ct(ul[i],t);i=r;break;case"source":Ct("error",t),i=r;break;case"img":case"image":case"link":Ct("error",t),Ct("load",t),i=r;break;case"details":Ct("toggle",t),i=r;break;case"input":P0(t,r),i=pp(t,r),Ct("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Ut({},r,{value:void 0}),Ct("invalid",t);break;case"textarea":I0(t,r),i=vp(t,r),Ct("invalid",t);break;default:i=r}yp(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?Tw(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Ew(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Pl(t,l):typeof l=="number"&&Pl(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Rl.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Ct("scroll",t):l!=null&&Ig(t,s,l,o))}switch(n){case"input":Ec(t),N0(t,r,!1);break;case"textarea":Ec(t),L0(t);break;case"option":r.value!=null&&t.setAttribute("value",""+es(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?Jo(t,!!r.multiple,s,!1):r.defaultValue!=null&&Jo(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Yu)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return un(e),null;case 6:if(t&&e.stateNode!=null)qS(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(le(166));if(n=Hs(zl.current),Hs(jr.current),Ic(e)){if(r=e.stateNode,n=e.memoizedProps,r[Ur]=e,(s=r.nodeValue!==n)&&(t=zn,t!==null))switch(t.tag){case 3:Nc(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Nc(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Ur]=e,e.stateNode=r}return un(e),null;case 13:if(At(It),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Rt&&jn!==null&&e.mode&1&&!(e.flags&128))fS(),fa(),e.flags|=98560,s=!1;else if(s=Ic(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(le(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(le(317));s[Ur]=e}else fa(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;un(e),s=!1}else xr!==null&&(em(xr),xr=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||It.current&1?qt===0&&(qt=3):pv())),e.updateQueue!==null&&(e.flags|=4),un(e),null);case 4:return pa(),$p(t,e),t===null&&Ol(e.stateNode.containerInfo),un(e),null;case 10:return Jg(e.type._context),un(e),null;case 17:return Nn(e.type)&&Ku(),un(e),null;case 19:if(At(It),s=e.memoizedState,s===null)return un(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)Ja(s,!1);else{if(qt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=rd(t),o!==null){for(e.flags|=128,Ja(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return bt(It,It.current&1|2),e.child}t=t.sibling}s.tail!==null&&Vt()>ga&&(e.flags|=128,r=!0,Ja(s,!1),e.lanes=4194304)}else{if(!r)if(t=rd(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Ja(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Rt)return un(e),null}else 2*Vt()-s.renderingStartTime>ga&&n!==1073741824&&(e.flags|=128,r=!0,Ja(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Vt(),e.sibling=null,n=It.current,bt(It,r?n&1|2:n&1),e):(un(e),null);case 22:case 23:return hv(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?On&1073741824&&(un(e),e.subtreeFlags&6&&(e.flags|=8192)):un(e),null;case 24:return null;case 25:return null}throw Error(le(156,e.tag))}function FA(t,e){switch(Xg(e),e.tag){case 1:return Nn(e.type)&&Ku(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return pa(),At(Pn),At(gn),nv(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return tv(e),null;case 13:if(At(It),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(le(340));fa()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return At(It),null;case 4:return pa(),null;case 10:return Jg(e.type._context),null;case 22:case 23:return hv(),null;case 24:return null;default:return null}}var Uc=!1,pn=!1,BA=typeof WeakSet=="function"?WeakSet:Set,Te=null;function qo(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Bt(t,e,r)}else n.current=null}function Xp(t,e,n){try{n()}catch(r){Bt(t,e,r)}}var Sx=!1;function jA(t,e){if(Pp=$u,t=Qw(),Wg(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,c=0,u=0,d=t,h=null;t:for(;;){for(var m;d!==n||i!==0&&d.nodeType!==3||(a=o+i),d!==s||r!==0&&d.nodeType!==3||(l=o+r),d.nodeType===3&&(o+=d.nodeValue.length),(m=d.firstChild)!==null;)h=d,d=m;for(;;){if(d===t)break t;if(h===n&&++c===i&&(a=o),h===s&&++u===r&&(l=o),(m=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=m}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Np={focusedElem:t,selectionRange:n},$u=!1,Te=e;Te!==null;)if(e=Te,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Te=t;else for(;Te!==null;){e=Te;try{var x=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var v=x.memoizedProps,g=x.memoizedState,p=e.stateNode,y=p.getSnapshotBeforeUpdate(e.elementType===e.type?v:mr(e.type,v),g);p.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var _=e.stateNode.containerInfo;_.nodeType===1?_.textContent="":_.nodeType===9&&_.documentElement&&_.removeChild(_.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(le(163))}}catch(w){Bt(e,e.return,w)}if(t=e.sibling,t!==null){t.return=e.return,Te=t;break}Te=e.return}return x=Sx,Sx=!1,x}function Sl(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&Xp(e,n,s)}i=i.next}while(i!==r)}}function Fd(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function qp(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function YS(t){var e=t.alternate;e!==null&&(t.alternate=null,YS(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ur],delete e[Bl],delete e[Dp],delete e[SA],delete e[EA])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function KS(t){return t.tag===5||t.tag===3||t.tag===4}function Ex(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||KS(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Yp(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Yu));else if(r!==4&&(t=t.child,t!==null))for(Yp(t,e,n),t=t.sibling;t!==null;)Yp(t,e,n),t=t.sibling}function Kp(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Kp(t,e,n),t=t.sibling;t!==null;)Kp(t,e,n),t=t.sibling}var sn=null,gr=!1;function _i(t,e,n){for(n=n.child;n!==null;)JS(t,e,n),n=n.sibling}function JS(t,e,n){if(Br&&typeof Br.onCommitFiberUnmount=="function")try{Br.onCommitFiberUnmount(Pd,n)}catch{}switch(n.tag){case 5:pn||qo(n,e);case 6:var r=sn,i=gr;sn=null,_i(t,e,n),sn=r,gr=i,sn!==null&&(gr?(t=sn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):sn.removeChild(n.stateNode));break;case 18:sn!==null&&(gr?(t=sn,n=n.stateNode,t.nodeType===8?Xf(t.parentNode,n):t.nodeType===1&&Xf(t,n),Dl(t)):Xf(sn,n.stateNode));break;case 4:r=sn,i=gr,sn=n.stateNode.containerInfo,gr=!0,_i(t,e,n),sn=r,gr=i;break;case 0:case 11:case 14:case 15:if(!pn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Xp(n,e,o),i=i.next}while(i!==r)}_i(t,e,n);break;case 1:if(!pn&&(qo(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Bt(n,e,a)}_i(t,e,n);break;case 21:_i(t,e,n);break;case 22:n.mode&1?(pn=(r=pn)||n.memoizedState!==null,_i(t,e,n),pn=r):_i(t,e,n);break;default:_i(t,e,n)}}function bx(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new BA),e.forEach(function(r){var i=YA.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function lr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:sn=a.stateNode,gr=!1;break e;case 3:sn=a.stateNode.containerInfo,gr=!0;break e;case 4:sn=a.stateNode.containerInfo,gr=!0;break e}a=a.return}if(sn===null)throw Error(le(160));JS(s,o,i),sn=null,gr=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){Bt(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)ZS(e,t),e=e.sibling}function ZS(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(lr(e,t),Ir(t),r&4){try{Sl(3,t,t.return),Fd(3,t)}catch(v){Bt(t,t.return,v)}try{Sl(5,t,t.return)}catch(v){Bt(t,t.return,v)}}break;case 1:lr(e,t),Ir(t),r&512&&n!==null&&qo(n,n.return);break;case 5:if(lr(e,t),Ir(t),r&512&&n!==null&&qo(n,n.return),t.flags&32){var i=t.stateNode;try{Pl(i,"")}catch(v){Bt(t,t.return,v)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&_w(i,s),_p(a,o);var c=_p(a,s);for(o=0;o<l.length;o+=2){var u=l[o],d=l[o+1];u==="style"?Tw(i,d):u==="dangerouslySetInnerHTML"?Ew(i,d):u==="children"?Pl(i,d):Ig(i,u,d,c)}switch(a){case"input":mp(i,s);break;case"textarea":ww(i,s);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var m=s.value;m!=null?Jo(i,!!s.multiple,m,!1):h!==!!s.multiple&&(s.defaultValue!=null?Jo(i,!!s.multiple,s.defaultValue,!0):Jo(i,!!s.multiple,s.multiple?[]:"",!1))}i[Bl]=s}catch(v){Bt(t,t.return,v)}}break;case 6:if(lr(e,t),Ir(t),r&4){if(t.stateNode===null)throw Error(le(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(v){Bt(t,t.return,v)}}break;case 3:if(lr(e,t),Ir(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Dl(e.containerInfo)}catch(v){Bt(t,t.return,v)}break;case 4:lr(e,t),Ir(t);break;case 13:lr(e,t),Ir(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(dv=Vt())),r&4&&bx(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(pn=(c=pn)||u,lr(e,t),pn=c):lr(e,t),Ir(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&t.mode&1)for(Te=t,u=t.child;u!==null;){for(d=Te=u;Te!==null;){switch(h=Te,m=h.child,h.tag){case 0:case 11:case 14:case 15:Sl(4,h,h.return);break;case 1:qo(h,h.return);var x=h.stateNode;if(typeof x.componentWillUnmount=="function"){r=h,n=h.return;try{e=r,x.props=e.memoizedProps,x.state=e.memoizedState,x.componentWillUnmount()}catch(v){Bt(r,n,v)}}break;case 5:qo(h,h.return);break;case 22:if(h.memoizedState!==null){Mx(d);continue}}m!==null?(m.return=h,Te=m):Mx(d)}u=u.sibling}e:for(u=null,d=t;;){if(d.tag===5){if(u===null){u=d;try{i=d.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=d.stateNode,l=d.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=bw("display",o))}catch(v){Bt(t,t.return,v)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(v){Bt(t,t.return,v)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:lr(e,t),Ir(t),r&4&&bx(t);break;case 21:break;default:lr(e,t),Ir(t)}}function Ir(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(KS(n)){var r=n;break e}n=n.return}throw Error(le(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Pl(i,""),r.flags&=-33);var s=Ex(t);Kp(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=Ex(t);Yp(t,a,o);break;default:throw Error(le(161))}}catch(l){Bt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function zA(t,e,n){Te=t,QS(t)}function QS(t,e,n){for(var r=(t.mode&1)!==0;Te!==null;){var i=Te,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Uc;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||pn;a=Uc;var c=pn;if(Uc=o,(pn=l)&&!c)for(Te=i;Te!==null;)o=Te,l=o.child,o.tag===22&&o.memoizedState!==null?Cx(i):l!==null?(l.return=o,Te=l):Cx(i);for(;s!==null;)Te=s,QS(s),s=s.sibling;Te=i,Uc=a,pn=c}Tx(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Te=s):Tx(t)}}function Tx(t){for(;Te!==null;){var e=Te;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:pn||Fd(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!pn)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:mr(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&cx(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}cx(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&Dl(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(le(163))}pn||e.flags&512&&qp(e)}catch(h){Bt(e,e.return,h)}}if(e===t){Te=null;break}if(n=e.sibling,n!==null){n.return=e.return,Te=n;break}Te=e.return}}function Mx(t){for(;Te!==null;){var e=Te;if(e===t){Te=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Te=n;break}Te=e.return}}function Cx(t){for(;Te!==null;){var e=Te;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Fd(4,e)}catch(l){Bt(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){Bt(e,i,l)}}var s=e.return;try{qp(e)}catch(l){Bt(e,s,l)}break;case 5:var o=e.return;try{qp(e)}catch(l){Bt(e,o,l)}}}catch(l){Bt(e,e.return,l)}if(e===t){Te=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Te=a;break}Te=e.return}}var VA=Math.ceil,od=xi.ReactCurrentDispatcher,cv=xi.ReactCurrentOwner,nr=xi.ReactCurrentBatchConfig,ct=0,rn=null,Wt=null,on=0,On=0,Yo=ds(0),qt=0,Wl=null,to=0,Bd=0,uv=0,El=null,Cn=null,dv=0,ga=1/0,ti=null,ad=!1,Jp=null,Ki=null,kc=!1,Vi=null,ld=0,bl=0,Zp=null,Mu=-1,Cu=0;function wn(){return ct&6?Vt():Mu!==-1?Mu:Mu=Vt()}function Ji(t){return t.mode&1?ct&2&&on!==0?on&-on:TA.transition!==null?(Cu===0&&(Cu=Ow()),Cu):(t=gt,t!==0||(t=window.event,t=t===void 0?16:Gw(t.type)),t):1}function Tr(t,e,n,r){if(50<bl)throw bl=0,Zp=null,Error(le(185));tc(t,n,r),(!(ct&2)||t!==rn)&&(t===rn&&(!(ct&2)&&(Bd|=n),qt===4&&Bi(t,on)),In(t,r),n===1&&ct===0&&!(e.mode&1)&&(ga=Vt()+500,Ud&&fs()))}function In(t,e){var n=t.callbackNode;TC(t,e);var r=Wu(t,t===rn?on:0);if(r===0)n!==null&&k0(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&k0(n),e===1)t.tag===0?bA(Ax.bind(null,t)):cS(Ax.bind(null,t)),_A(function(){!(ct&6)&&fs()}),n=null;else{switch(Fw(r)){case 1:n=Og;break;case 4:n=Uw;break;case 16:n=Gu;break;case 536870912:n=kw;break;default:n=Gu}n=a1(n,e1.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function e1(t,e){if(Mu=-1,Cu=0,ct&6)throw Error(le(327));var n=t.callbackNode;if(na()&&t.callbackNode!==n)return null;var r=Wu(t,t===rn?on:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=cd(t,r);else{e=r;var i=ct;ct|=2;var s=n1();(rn!==t||on!==e)&&(ti=null,ga=Vt()+500,$s(t,e));do try{WA();break}catch(a){t1(t,a)}while(!0);Kg(),od.current=s,ct=i,Wt!==null?e=0:(rn=null,on=0,e=qt)}if(e!==0){if(e===2&&(i=Tp(t),i!==0&&(r=i,e=Qp(t,i))),e===1)throw n=Wl,$s(t,0),Bi(t,r),In(t,Vt()),n;if(e===6)Bi(t,r);else{if(i=t.current.alternate,!(r&30)&&!HA(i)&&(e=cd(t,r),e===2&&(s=Tp(t),s!==0&&(r=s,e=Qp(t,s))),e===1))throw n=Wl,$s(t,0),Bi(t,r),In(t,Vt()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(le(345));case 2:Ls(t,Cn,ti);break;case 3:if(Bi(t,r),(r&130023424)===r&&(e=dv+500-Vt(),10<e)){if(Wu(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){wn(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Lp(Ls.bind(null,t,Cn,ti),e);break}Ls(t,Cn,ti);break;case 4:if(Bi(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-br(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=Vt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*VA(r/1960))-r,10<r){t.timeoutHandle=Lp(Ls.bind(null,t,Cn,ti),r);break}Ls(t,Cn,ti);break;case 5:Ls(t,Cn,ti);break;default:throw Error(le(329))}}}return In(t,Vt()),t.callbackNode===n?e1.bind(null,t):null}function Qp(t,e){var n=El;return t.current.memoizedState.isDehydrated&&($s(t,e).flags|=256),t=cd(t,e),t!==2&&(e=Cn,Cn=n,e!==null&&em(e)),t}function em(t){Cn===null?Cn=t:Cn.push.apply(Cn,t)}function HA(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!Cr(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Bi(t,e){for(e&=~uv,e&=~Bd,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-br(e),r=1<<n;t[n]=-1,e&=~r}}function Ax(t){if(ct&6)throw Error(le(327));na();var e=Wu(t,0);if(!(e&1))return In(t,Vt()),null;var n=cd(t,e);if(t.tag!==0&&n===2){var r=Tp(t);r!==0&&(e=r,n=Qp(t,r))}if(n===1)throw n=Wl,$s(t,0),Bi(t,e),In(t,Vt()),n;if(n===6)throw Error(le(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ls(t,Cn,ti),In(t,Vt()),null}function fv(t,e){var n=ct;ct|=1;try{return t(e)}finally{ct=n,ct===0&&(ga=Vt()+500,Ud&&fs())}}function no(t){Vi!==null&&Vi.tag===0&&!(ct&6)&&na();var e=ct;ct|=1;var n=nr.transition,r=gt;try{if(nr.transition=null,gt=1,t)return t()}finally{gt=r,nr.transition=n,ct=e,!(ct&6)&&fs()}}function hv(){On=Yo.current,At(Yo)}function $s(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,yA(n)),Wt!==null)for(n=Wt.return;n!==null;){var r=n;switch(Xg(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Ku();break;case 3:pa(),At(Pn),At(gn),nv();break;case 5:tv(r);break;case 4:pa();break;case 13:At(It);break;case 19:At(It);break;case 10:Jg(r.type._context);break;case 22:case 23:hv()}n=n.return}if(rn=t,Wt=t=Zi(t.current,null),on=On=e,qt=0,Wl=null,uv=Bd=to=0,Cn=El=null,Vs!==null){for(e=0;e<Vs.length;e++)if(n=Vs[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}Vs=null}return t}function t1(t,e){do{var n=Wt;try{if(Kg(),Eu.current=sd,id){for(var r=Dt.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}id=!1}if(eo=0,tn=$t=Dt=null,wl=!1,Vl=0,cv.current=null,n===null||n.return===null){qt=1,Wl=e,Wt=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=on,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var m=mx(o);if(m!==null){m.flags&=-257,gx(m,o,a,s,e),m.mode&1&&px(s,c,e),e=m,l=c;var x=e.updateQueue;if(x===null){var v=new Set;v.add(l),e.updateQueue=v}else x.add(l);break e}else{if(!(e&1)){px(s,c,e),pv();break e}l=Error(le(426))}}else if(Rt&&a.mode&1){var g=mx(o);if(g!==null){!(g.flags&65536)&&(g.flags|=256),gx(g,o,a,s,e),qg(ma(l,a));break e}}s=l=ma(l,a),qt!==4&&(qt=2),El===null?El=[s]:El.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var p=FS(s,l,e);lx(s,p);break e;case 1:a=l;var y=s.type,_=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(Ki===null||!Ki.has(_)))){s.flags|=65536,e&=-e,s.lanes|=e;var w=BS(s,a,e);lx(s,w);break e}}s=s.return}while(s!==null)}i1(n)}catch(E){e=E,Wt===n&&n!==null&&(Wt=n=n.return);continue}break}while(!0)}function n1(){var t=od.current;return od.current=sd,t===null?sd:t}function pv(){(qt===0||qt===3||qt===2)&&(qt=4),rn===null||!(to&268435455)&&!(Bd&268435455)||Bi(rn,on)}function cd(t,e){var n=ct;ct|=2;var r=n1();(rn!==t||on!==e)&&(ti=null,$s(t,e));do try{GA();break}catch(i){t1(t,i)}while(!0);if(Kg(),ct=n,od.current=r,Wt!==null)throw Error(le(261));return rn=null,on=0,qt}function GA(){for(;Wt!==null;)r1(Wt)}function WA(){for(;Wt!==null&&!gC();)r1(Wt)}function r1(t){var e=o1(t.alternate,t,On);t.memoizedProps=t.pendingProps,e===null?i1(t):Wt=e,cv.current=null}function i1(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=FA(n,e),n!==null){n.flags&=32767,Wt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{qt=6,Wt=null;return}}else if(n=OA(n,e,On),n!==null){Wt=n;return}if(e=e.sibling,e!==null){Wt=e;return}Wt=e=t}while(e!==null);qt===0&&(qt=5)}function Ls(t,e,n){var r=gt,i=nr.transition;try{nr.transition=null,gt=1,$A(t,e,n,r)}finally{nr.transition=i,gt=r}return null}function $A(t,e,n,r){do na();while(Vi!==null);if(ct&6)throw Error(le(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(le(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(MC(t,s),t===rn&&(Wt=rn=null,on=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||kc||(kc=!0,a1(Gu,function(){return na(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=nr.transition,nr.transition=null;var o=gt;gt=1;var a=ct;ct|=4,cv.current=null,jA(t,n),ZS(n,t),fA(Np),$u=!!Pp,Np=Pp=null,t.current=n,zA(n),vC(),ct=a,gt=o,nr.transition=s}else t.current=n;if(kc&&(kc=!1,Vi=t,ld=i),s=t.pendingLanes,s===0&&(Ki=null),_C(n.stateNode),In(t,Vt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(ad)throw ad=!1,t=Jp,Jp=null,t;return ld&1&&t.tag!==0&&na(),s=t.pendingLanes,s&1?t===Zp?bl++:(bl=0,Zp=t):bl=0,fs(),null}function na(){if(Vi!==null){var t=Fw(ld),e=nr.transition,n=gt;try{if(nr.transition=null,gt=16>t?16:t,Vi===null)var r=!1;else{if(t=Vi,Vi=null,ld=0,ct&6)throw Error(le(331));var i=ct;for(ct|=4,Te=t.current;Te!==null;){var s=Te,o=s.child;if(Te.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(Te=c;Te!==null;){var u=Te;switch(u.tag){case 0:case 11:case 15:Sl(8,u,s)}var d=u.child;if(d!==null)d.return=u,Te=d;else for(;Te!==null;){u=Te;var h=u.sibling,m=u.return;if(YS(u),u===c){Te=null;break}if(h!==null){h.return=m,Te=h;break}Te=m}}}var x=s.alternate;if(x!==null){var v=x.child;if(v!==null){x.child=null;do{var g=v.sibling;v.sibling=null,v=g}while(v!==null)}}Te=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,Te=o;else e:for(;Te!==null;){if(s=Te,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Sl(9,s,s.return)}var p=s.sibling;if(p!==null){p.return=s.return,Te=p;break e}Te=s.return}}var y=t.current;for(Te=y;Te!==null;){o=Te;var _=o.child;if(o.subtreeFlags&2064&&_!==null)_.return=o,Te=_;else e:for(o=y;Te!==null;){if(a=Te,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Fd(9,a)}}catch(E){Bt(a,a.return,E)}if(a===o){Te=null;break e}var w=a.sibling;if(w!==null){w.return=a.return,Te=w;break e}Te=a.return}}if(ct=i,fs(),Br&&typeof Br.onPostCommitFiberRoot=="function")try{Br.onPostCommitFiberRoot(Pd,t)}catch{}r=!0}return r}finally{gt=n,nr.transition=e}}return!1}function Rx(t,e,n){e=ma(n,e),e=FS(t,e,1),t=Yi(t,e,1),e=wn(),t!==null&&(tc(t,1,e),In(t,e))}function Bt(t,e,n){if(t.tag===3)Rx(t,t,n);else for(;e!==null;){if(e.tag===3){Rx(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ki===null||!Ki.has(r))){t=ma(n,t),t=BS(e,t,1),e=Yi(e,t,1),t=wn(),e!==null&&(tc(e,1,t),In(e,t));break}}e=e.return}}function XA(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=wn(),t.pingedLanes|=t.suspendedLanes&n,rn===t&&(on&n)===n&&(qt===4||qt===3&&(on&130023424)===on&&500>Vt()-dv?$s(t,0):uv|=n),In(t,e)}function s1(t,e){e===0&&(t.mode&1?(e=Mc,Mc<<=1,!(Mc&130023424)&&(Mc=4194304)):e=1);var n=wn();t=fi(t,e),t!==null&&(tc(t,e,n),In(t,n))}function qA(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),s1(t,n)}function YA(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(le(314))}r!==null&&r.delete(e),s1(t,n)}var o1;o1=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Pn.current)Rn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Rn=!1,kA(t,e,n);Rn=!!(t.flags&131072)}else Rn=!1,Rt&&e.flags&1048576&&uS(e,Qu,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Tu(t,e),t=e.pendingProps;var i=da(e,gn.current);ta(e,n),i=iv(null,e,r,t,i,n);var s=sv();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Nn(r)?(s=!0,Ju(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Qg(e),i.updater=Od,e.stateNode=i,i._reactInternals=e,jp(e,r,t,n),e=Hp(null,e,r,!0,s,n)):(e.tag=0,Rt&&s&&$g(e),_n(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Tu(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=JA(r),t=mr(r,t),i){case 0:e=Vp(null,e,r,t,n);break e;case 1:e=yx(null,e,r,t,n);break e;case 11:e=vx(null,e,r,t,n);break e;case 14:e=xx(null,e,r,mr(r.type,t),n);break e}throw Error(le(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:mr(r,i),Vp(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:mr(r,i),yx(t,e,r,i,n);case 3:e:{if(HS(e),t===null)throw Error(le(387));r=e.pendingProps,s=e.memoizedState,i=s.element,gS(t,e),nd(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=ma(Error(le(423)),e),e=_x(t,e,r,n,i);break e}else if(r!==i){i=ma(Error(le(424)),e),e=_x(t,e,r,n,i);break e}else for(jn=qi(e.stateNode.containerInfo.firstChild),zn=e,Rt=!0,xr=null,n=pS(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(fa(),r===i){e=hi(t,e,n);break e}_n(t,e,r,n)}e=e.child}return e;case 5:return vS(e),t===null&&Op(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,Ip(r,i)?o=null:s!==null&&Ip(r,s)&&(e.flags|=32),VS(t,e),_n(t,e,o,n),e.child;case 6:return t===null&&Op(e),null;case 13:return GS(t,e,n);case 4:return ev(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=ha(e,null,r,n):_n(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:mr(r,i),vx(t,e,r,i,n);case 7:return _n(t,e,e.pendingProps,n),e.child;case 8:return _n(t,e,e.pendingProps.children,n),e.child;case 12:return _n(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,bt(ed,r._currentValue),r._currentValue=o,s!==null)if(Cr(s.value,o)){if(s.children===i.children&&!Pn.current){e=hi(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=ai(-1,n&-n),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),Fp(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(le(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Fp(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}_n(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,ta(e,n),i=sr(i),r=r(i),e.flags|=1,_n(t,e,r,n),e.child;case 14:return r=e.type,i=mr(r,e.pendingProps),i=mr(r.type,i),xx(t,e,r,i,n);case 15:return jS(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:mr(r,i),Tu(t,e),e.tag=1,Nn(r)?(t=!0,Ju(e)):t=!1,ta(e,n),OS(e,r,i),jp(e,r,i,n),Hp(null,e,r,!0,t,n);case 19:return WS(t,e,n);case 22:return zS(t,e,n)}throw Error(le(156,e.tag))};function a1(t,e){return Dw(t,e)}function KA(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function tr(t,e,n,r){return new KA(t,e,n,r)}function mv(t){return t=t.prototype,!(!t||!t.isReactComponent)}function JA(t){if(typeof t=="function")return mv(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Dg)return 11;if(t===Ug)return 14}return 2}function Zi(t,e){var n=t.alternate;return n===null?(n=tr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Au(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")mv(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Bo:return Xs(n.children,i,s,e);case Lg:o=8,i|=8;break;case up:return t=tr(12,n,e,i|2),t.elementType=up,t.lanes=s,t;case dp:return t=tr(13,n,e,i),t.elementType=dp,t.lanes=s,t;case fp:return t=tr(19,n,e,i),t.elementType=fp,t.lanes=s,t;case vw:return jd(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case mw:o=10;break e;case gw:o=9;break e;case Dg:o=11;break e;case Ug:o=14;break e;case Ui:o=16,r=null;break e}throw Error(le(130,t==null?t:typeof t,""))}return e=tr(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function Xs(t,e,n,r){return t=tr(7,t,r,e),t.lanes=n,t}function jd(t,e,n,r){return t=tr(22,t,r,e),t.elementType=vw,t.lanes=n,t.stateNode={isHidden:!1},t}function th(t,e,n){return t=tr(6,t,null,e),t.lanes=n,t}function nh(t,e,n){return e=tr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function ZA(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=kf(0),this.expirationTimes=kf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=kf(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function gv(t,e,n,r,i,s,o,a,l){return t=new ZA(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=tr(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Qg(s),t}function QA(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Fo,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function l1(t){if(!t)return ts;t=t._reactInternals;e:{if(oo(t)!==t||t.tag!==1)throw Error(le(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Nn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(le(171))}if(t.tag===1){var n=t.type;if(Nn(n))return lS(t,n,e)}return e}function c1(t,e,n,r,i,s,o,a,l){return t=gv(n,r,!0,t,i,s,o,a,l),t.context=l1(null),n=t.current,r=wn(),i=Ji(n),s=ai(r,i),s.callback=e??null,Yi(n,s,i),t.current.lanes=i,tc(t,i,r),In(t,r),t}function zd(t,e,n,r){var i=e.current,s=wn(),o=Ji(i);return n=l1(n),e.context===null?e.context=n:e.pendingContext=n,e=ai(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Yi(i,e,o),t!==null&&(Tr(t,i,o,s),Su(t,i,o)),o}function ud(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Px(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function vv(t,e){Px(t,e),(t=t.alternate)&&Px(t,e)}function eR(){return null}var u1=typeof reportError=="function"?reportError:function(t){console.error(t)};function xv(t){this._internalRoot=t}Vd.prototype.render=xv.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(le(409));zd(t,e,null,null)};Vd.prototype.unmount=xv.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;no(function(){zd(null,t,null,null)}),e[di]=null}};function Vd(t){this._internalRoot=t}Vd.prototype.unstable_scheduleHydration=function(t){if(t){var e=zw();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Fi.length&&e!==0&&e<Fi[n].priority;n++);Fi.splice(n,0,t),n===0&&Hw(t)}};function yv(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Hd(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Nx(){}function tR(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var c=ud(o);s.call(c)}}var o=c1(e,r,t,0,null,!1,!1,"",Nx);return t._reactRootContainer=o,t[di]=o.current,Ol(t.nodeType===8?t.parentNode:t),no(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var c=ud(l);a.call(c)}}var l=gv(t,0,!1,null,null,!1,!1,"",Nx);return t._reactRootContainer=l,t[di]=l.current,Ol(t.nodeType===8?t.parentNode:t),no(function(){zd(e,l,n,r)}),l}function Gd(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=ud(o);a.call(l)}}zd(e,o,t,i)}else o=tR(n,e,t,i,r);return ud(o)}Bw=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=cl(e.pendingLanes);n!==0&&(Fg(e,n|1),In(e,Vt()),!(ct&6)&&(ga=Vt()+500,fs()))}break;case 13:no(function(){var r=fi(t,1);if(r!==null){var i=wn();Tr(r,t,1,i)}}),vv(t,1)}};Bg=function(t){if(t.tag===13){var e=fi(t,134217728);if(e!==null){var n=wn();Tr(e,t,134217728,n)}vv(t,134217728)}};jw=function(t){if(t.tag===13){var e=Ji(t),n=fi(t,e);if(n!==null){var r=wn();Tr(n,t,e,r)}vv(t,e)}};zw=function(){return gt};Vw=function(t,e){var n=gt;try{return gt=t,e()}finally{gt=n}};Sp=function(t,e,n){switch(e){case"input":if(mp(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Dd(r);if(!i)throw Error(le(90));yw(r),mp(r,i)}}}break;case"textarea":ww(t,n);break;case"select":e=n.value,e!=null&&Jo(t,!!n.multiple,e,!1)}};Aw=fv;Rw=no;var nR={usingClientEntryPoint:!1,Events:[rc,Ho,Dd,Mw,Cw,fv]},Za={findFiberByHostInstance:zs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},rR={bundleType:Za.bundleType,version:Za.version,rendererPackageName:Za.rendererPackageName,rendererConfig:Za.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:xi.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Iw(t),t===null?null:t.stateNode},findFiberByHostInstance:Za.findFiberByHostInstance||eR,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Oc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Oc.isDisabled&&Oc.supportsFiber)try{Pd=Oc.inject(rR),Br=Oc}catch{}}$n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=nR;$n.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!yv(e))throw Error(le(200));return QA(t,e,null,n)};$n.createRoot=function(t,e){if(!yv(t))throw Error(le(299));var n=!1,r="",i=u1;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=gv(t,1,!1,null,null,n,!1,r,i),t[di]=e.current,Ol(t.nodeType===8?t.parentNode:t),new xv(e)};$n.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(le(188)):(t=Object.keys(t).join(","),Error(le(268,t)));return t=Iw(e),t=t===null?null:t.stateNode,t};$n.flushSync=function(t){return no(t)};$n.hydrate=function(t,e,n){if(!Hd(e))throw Error(le(200));return Gd(null,t,e,!0,n)};$n.hydrateRoot=function(t,e,n){if(!yv(t))throw Error(le(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=u1;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=c1(e,null,t,1,n??null,i,!1,s,o),t[di]=e.current,Ol(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Vd(e)};$n.render=function(t,e,n){if(!Hd(e))throw Error(le(200));return Gd(null,t,e,!1,n)};$n.unmountComponentAtNode=function(t){if(!Hd(t))throw Error(le(40));return t._reactRootContainer?(no(function(){Gd(null,null,t,!1,function(){t._reactRootContainer=null,t[di]=null})}),!0):!1};$n.unstable_batchedUpdates=fv;$n.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Hd(n))throw Error(le(200));if(t==null||t._reactInternals===void 0)throw Error(le(38));return Gd(t,e,n,!1,r)};$n.version="18.3.1-next-f1338f8080-20240426";function d1(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(d1)}catch(t){console.error(t)}}d1(),dw.exports=$n;var Da=dw.exports;const iR=Z_(Da);var f1,Ix=Da;f1=Ix.createRoot,Ix.hydrateRoot;/**
 * @remix-run/router v1.20.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function $l(){return $l=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},$l.apply(this,arguments)}var Hi;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Hi||(Hi={}));const Lx="popstate";function sR(t){t===void 0&&(t={});function e(r,i){let{pathname:s,search:o,hash:a}=r.location;return tm("",{pathname:s,search:o,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:p1(i)}return aR(e,n,null,t)}function Yt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function h1(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function oR(){return Math.random().toString(36).substr(2,8)}function Dx(t,e){return{usr:t.state,key:t.key,idx:e}}function tm(t,e,n,r){return n===void 0&&(n=null),$l({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Ua(e):e,{state:n,key:e&&e.key||r||oR()})}function p1(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Ua(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function aR(t,e,n,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:s=!1}=r,o=i.history,a=Hi.Pop,l=null,c=u();c==null&&(c=0,o.replaceState($l({},o.state,{idx:c}),""));function u(){return(o.state||{idx:null}).idx}function d(){a=Hi.Pop;let g=u(),p=g==null?null:g-c;c=g,l&&l({action:a,location:v.location,delta:p})}function h(g,p){a=Hi.Push;let y=tm(v.location,g,p);c=u()+1;let _=Dx(y,c),w=v.createHref(y);try{o.pushState(_,"",w)}catch(E){if(E instanceof DOMException&&E.name==="DataCloneError")throw E;i.location.assign(w)}s&&l&&l({action:a,location:v.location,delta:1})}function m(g,p){a=Hi.Replace;let y=tm(v.location,g,p);c=u();let _=Dx(y,c),w=v.createHref(y);o.replaceState(_,"",w),s&&l&&l({action:a,location:v.location,delta:0})}function x(g){let p=i.location.origin!=="null"?i.location.origin:i.location.href,y=typeof g=="string"?g:p1(g);return y=y.replace(/ $/,"%20"),Yt(p,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,p)}let v={get action(){return a},get location(){return t(i,o)},listen(g){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(Lx,d),l=g,()=>{i.removeEventListener(Lx,d),l=null}},createHref(g){return e(i,g)},createURL:x,encodeLocation(g){let p=x(g);return{pathname:p.pathname,search:p.search,hash:p.hash}},push:h,replace:m,go(g){return o.go(g)}};return v}var Ux;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Ux||(Ux={}));function lR(t,e,n){return n===void 0&&(n="/"),cR(t,e,n,!1)}function cR(t,e,n,r){let i=typeof e=="string"?Ua(e):e,s=v1(i.pathname||"/",n);if(s==null)return null;let o=m1(t);uR(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let c=wR(s);a=yR(o[l],c,r)}return a}function m1(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let i=(s,o,a)=>{let l={relativePath:a===void 0?s.path||"":a,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};l.relativePath.startsWith("/")&&(Yt(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let c=qs([r,l.relativePath]),u=n.concat(l);s.children&&s.children.length>0&&(Yt(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),m1(s.children,e,u,c)),!(s.path==null&&!s.index)&&e.push({path:c,score:vR(c,s.index),routesMeta:u})};return t.forEach((s,o)=>{var a;if(s.path===""||!((a=s.path)!=null&&a.includes("?")))i(s,o);else for(let l of g1(s.path))i(s,o,l)}),e}function g1(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),s=n.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let o=g1(r.join("/")),a=[];return a.push(...o.map(l=>l===""?s:[s,l].join("/"))),i&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function uR(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:xR(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const dR=/^:[\w-]+$/,fR=3,hR=2,pR=1,mR=10,gR=-2,kx=t=>t==="*";function vR(t,e){let n=t.split("/"),r=n.length;return n.some(kx)&&(r+=gR),e&&(r+=hR),n.filter(i=>!kx(i)).reduce((i,s)=>i+(dR.test(s)?fR:s===""?pR:mR),r)}function xR(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function yR(t,e,n){let{routesMeta:r}=t,i={},s="/",o=[];for(let a=0;a<r.length;++a){let l=r[a],c=a===r.length-1,u=s==="/"?e:e.slice(s.length)||"/",d=Ox({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),h=l.route;if(!d&&c&&n&&!r[r.length-1].route.index&&(d=Ox({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!d)return null;Object.assign(i,d.params),o.push({params:i,pathname:qs([s,d.pathname]),pathnameBase:CR(qs([s,d.pathnameBase])),route:h}),d.pathnameBase!=="/"&&(s=qs([s,d.pathnameBase]))}return o}function Ox(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=_R(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:r.reduce((c,u,d)=>{let{paramName:h,isOptional:m}=u;if(h==="*"){let v=a[d]||"";o=s.slice(0,s.length-v.length).replace(/(.)\/+$/,"$1")}const x=a[d];return m&&!x?c[h]=void 0:c[h]=(x||"").replace(/%2F/g,"/"),c},{}),pathname:s,pathnameBase:o,pattern:t}}function _R(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),h1(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function wR(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return h1(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function v1(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function SR(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?Ua(t):t;return{pathname:n?n.startsWith("/")?n:ER(n,e):e,search:AR(r),hash:RR(i)}}function ER(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function rh(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function bR(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function TR(t,e){let n=bR(t);return e?n.map((r,i)=>i===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function MR(t,e,n,r){r===void 0&&(r=!1);let i;typeof t=="string"?i=Ua(t):(i=$l({},t),Yt(!i.pathname||!i.pathname.includes("?"),rh("?","pathname","search",i)),Yt(!i.pathname||!i.pathname.includes("#"),rh("#","pathname","hash",i)),Yt(!i.search||!i.search.includes("#"),rh("#","search","hash",i)));let s=t===""||i.pathname==="",o=s?"/":i.pathname,a;if(o==null)a=n;else{let d=e.length-1;if(!r&&o.startsWith("..")){let h=o.split("/");for(;h[0]==="..";)h.shift(),d-=1;i.pathname=h.join("/")}a=d>=0?e[d]:"/"}let l=SR(i,a),c=o&&o!=="/"&&o.endsWith("/"),u=(s||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const qs=t=>t.join("/").replace(/\/\/+/g,"/"),CR=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),AR=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,RR=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function PR(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const x1=["post","put","patch","delete"];new Set(x1);const NR=["get",...x1];new Set(NR);/**
 * React Router v6.27.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Xl(){return Xl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Xl.apply(this,arguments)}const _v=S.createContext(null),IR=S.createContext(null),Wd=S.createContext(null),$d=S.createContext(null),ao=S.createContext({outlet:null,matches:[],isDataRoute:!1}),y1=S.createContext(null);function Xd(){return S.useContext($d)!=null}function qd(){return Xd()||Yt(!1),S.useContext($d).location}function _1(t){S.useContext(Wd).static||S.useLayoutEffect(t)}function hs(){let{isDataRoute:t}=S.useContext(ao);return t?$R():LR()}function LR(){Xd()||Yt(!1);let t=S.useContext(_v),{basename:e,future:n,navigator:r}=S.useContext(Wd),{matches:i}=S.useContext(ao),{pathname:s}=qd(),o=JSON.stringify(TR(i,n.v7_relativeSplatPath)),a=S.useRef(!1);return _1(()=>{a.current=!0}),S.useCallback(function(c,u){if(u===void 0&&(u={}),!a.current)return;if(typeof c=="number"){r.go(c);return}let d=MR(c,JSON.parse(o),s,u.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:qs([e,d.pathname])),(u.replace?r.replace:r.push)(d,u.state,u)},[e,r,o,s,t])}function DR(){let{matches:t}=S.useContext(ao),e=t[t.length-1];return e?e.params:{}}function UR(t,e){return kR(t,e)}function kR(t,e,n,r){Xd()||Yt(!1);let{navigator:i}=S.useContext(Wd),{matches:s}=S.useContext(ao),o=s[s.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let c=qd(),u;if(e){var d;let g=typeof e=="string"?Ua(e):e;l==="/"||(d=g.pathname)!=null&&d.startsWith(l)||Yt(!1),u=g}else u=c;let h=u.pathname||"/",m=h;if(l!=="/"){let g=l.replace(/^\//,"").split("/");m="/"+h.replace(/^\//,"").split("/").slice(g.length).join("/")}let x=lR(t,{pathname:m}),v=zR(x&&x.map(g=>Object.assign({},g,{params:Object.assign({},a,g.params),pathname:qs([l,i.encodeLocation?i.encodeLocation(g.pathname).pathname:g.pathname]),pathnameBase:g.pathnameBase==="/"?l:qs([l,i.encodeLocation?i.encodeLocation(g.pathnameBase).pathname:g.pathnameBase])})),s,n,r);return e&&v?S.createElement($d.Provider,{value:{location:Xl({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:Hi.Pop}},v):v}function OR(){let t=WR(),e=PR(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return S.createElement(S.Fragment,null,S.createElement("h2",null,"Unexpected Application Error!"),S.createElement("h3",{style:{fontStyle:"italic"}},e),n?S.createElement("pre",{style:i},n):null,null)}const FR=S.createElement(OR,null);class BR extends S.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?S.createElement(ao.Provider,{value:this.props.routeContext},S.createElement(y1.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function jR(t){let{routeContext:e,match:n,children:r}=t,i=S.useContext(_v);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),S.createElement(ao.Provider,{value:e},r)}function zR(t,e,n,r){var i;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var s;if(!n)return null;if(n.errors)t=n.matches;else if((s=r)!=null&&s.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,a=(i=n)==null?void 0:i.errors;if(a!=null){let u=o.findIndex(d=>d.route.id&&(a==null?void 0:a[d.route.id])!==void 0);u>=0||Yt(!1),o=o.slice(0,Math.min(o.length,u+1))}let l=!1,c=-1;if(n&&r&&r.v7_partialHydration)for(let u=0;u<o.length;u++){let d=o[u];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(c=u),d.route.id){let{loaderData:h,errors:m}=n,x=d.route.loader&&h[d.route.id]===void 0&&(!m||m[d.route.id]===void 0);if(d.route.lazy||x){l=!0,c>=0?o=o.slice(0,c+1):o=[o[0]];break}}}return o.reduceRight((u,d,h)=>{let m,x=!1,v=null,g=null;n&&(m=a&&d.route.id?a[d.route.id]:void 0,v=d.route.errorElement||FR,l&&(c<0&&h===0?(x=!0,g=null):c===h&&(x=!0,g=d.route.hydrateFallbackElement||null)));let p=e.concat(o.slice(0,h+1)),y=()=>{let _;return m?_=v:x?_=g:d.route.Component?_=S.createElement(d.route.Component,null):d.route.element?_=d.route.element:_=u,S.createElement(jR,{match:d,routeContext:{outlet:u,matches:p,isDataRoute:n!=null},children:_})};return n&&(d.route.ErrorBoundary||d.route.errorElement||h===0)?S.createElement(BR,{location:n.location,revalidation:n.revalidation,component:v,error:m,children:y(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):y()},null)}var w1=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(w1||{}),dd=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(dd||{});function VR(t){let e=S.useContext(_v);return e||Yt(!1),e}function HR(t){let e=S.useContext(IR);return e||Yt(!1),e}function GR(t){let e=S.useContext(ao);return e||Yt(!1),e}function S1(t){let e=GR(),n=e.matches[e.matches.length-1];return n.route.id||Yt(!1),n.route.id}function WR(){var t;let e=S.useContext(y1),n=HR(dd.UseRouteError),r=S1(dd.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function $R(){let{router:t}=VR(w1.UseNavigateStable),e=S1(dd.UseNavigateStable),n=S.useRef(!1);return _1(()=>{n.current=!0}),S.useCallback(function(i,s){s===void 0&&(s={}),n.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,Xl({fromRouteId:e},s)))},[t,e])}function Ds(t){Yt(!1)}function XR(t){let{basename:e="/",children:n=null,location:r,navigationType:i=Hi.Pop,navigator:s,static:o=!1,future:a}=t;Xd()&&Yt(!1);let l=e.replace(/^\/*/,"/"),c=S.useMemo(()=>({basename:l,navigator:s,static:o,future:Xl({v7_relativeSplatPath:!1},a)}),[l,a,s,o]);typeof r=="string"&&(r=Ua(r));let{pathname:u="/",search:d="",hash:h="",state:m=null,key:x="default"}=r,v=S.useMemo(()=>{let g=v1(u,l);return g==null?null:{location:{pathname:g,search:d,hash:h,state:m,key:x},navigationType:i}},[l,u,d,h,m,x,i]);return v==null?null:S.createElement(Wd.Provider,{value:c},S.createElement($d.Provider,{children:n,value:v}))}function qR(t){let{children:e,location:n}=t;return UR(nm(e),n)}new Promise(()=>{});function nm(t,e){e===void 0&&(e=[]);let n=[];return S.Children.forEach(t,(r,i)=>{if(!S.isValidElement(r))return;let s=[...e,i];if(r.type===S.Fragment){n.push.apply(n,nm(r.props.children,s));return}r.type!==Ds&&Yt(!1),!r.props.index||!r.props.children||Yt(!1);let o={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=nm(r.props.children,s)),n.push(o)}),n}/**
 * React Router DOM v6.27.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function rm(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let r=t[n];return e.concat(Array.isArray(r)?r.map(i=>[n,i]):[[n,r]])},[]))}function YR(t,e){let n=rm(t);return e&&e.forEach((r,i)=>{n.has(i)||e.getAll(i).forEach(s=>{n.append(i,s)})}),n}const KR="6";try{window.__reactRouterVersion=KR}catch{}const JR="startTransition",Fx=cw[JR];function ZR(t){let{basename:e,children:n,future:r,window:i}=t,s=S.useRef();s.current==null&&(s.current=sR({window:i,v5Compat:!0}));let o=s.current,[a,l]=S.useState({action:o.action,location:o.location}),{v7_startTransition:c}=r||{},u=S.useCallback(d=>{c&&Fx?Fx(()=>l(d)):l(d)},[l,c]);return S.useLayoutEffect(()=>o.listen(u),[o,u]),S.createElement(XR,{basename:e,children:n,location:a.location,navigationType:a.action,navigator:o,future:r})}var Bx;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Bx||(Bx={}));var jx;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(jx||(jx={}));function QR(t){let e=S.useRef(rm(t)),n=S.useRef(!1),r=qd(),i=S.useMemo(()=>YR(r.search,n.current?null:e.current),[r.search]),s=hs(),o=S.useCallback((a,l)=>{const c=rm(typeof a=="function"?a(i):a);n.current=!0,s("?"+c,l)},[s,i]);return[i,o]}/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e2=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),E1=(...t)=>t.filter((e,n,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===n).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var t2={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n2=S.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:i="",children:s,iconNode:o,...a},l)=>S.createElement("svg",{ref:l,...t2,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:E1("lucide",i),...a},[...o.map(([c,u])=>S.createElement(c,u)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const We=(t,e)=>{const n=S.forwardRef(({className:r,...i},s)=>S.createElement(n2,{ref:s,iconNode:e,className:E1(`lucide-${e2(t)}`,r),...i}));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zx=We("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r2=We("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fd=We("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i2=We("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s2=We("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vx=We("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o2=We("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a2=We("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wv=We("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yd=We("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const im=We("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l2=We("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b1=We("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c2=We("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u2=We("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hx=We("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d2=We("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T1=We("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f2=We("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gx=We("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h2=We("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p2=We("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wx=We("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m2=We("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M1=We("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g2=We("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v2=We("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C1=We("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x2=We("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $x=We("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y2=We("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xx=We("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ra=We("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _2=We("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w2=We("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qx=We("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S2=We("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A1=We("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E2=We("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hd=We("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b2=We("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yx=We("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T2=We("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);function M2(t,e){typeof t=="function"?t(e):t!=null&&(t.current=e)}function R1(...t){return e=>t.forEach(n=>M2(n,e))}function kt(...t){return S.useCallback(R1(...t),t)}var va=S.forwardRef((t,e)=>{const{children:n,...r}=t,i=S.Children.toArray(n),s=i.find(C2);if(s){const o=s.props.children,a=i.map(l=>l===s?S.Children.count(o)>1?S.Children.only(null):S.isValidElement(o)?o.props.children:null:l);return f.jsx(sm,{...r,ref:e,children:S.isValidElement(o)?S.cloneElement(o,void 0,a):null})}return f.jsx(sm,{...r,ref:e,children:n})});va.displayName="Slot";var sm=S.forwardRef((t,e)=>{const{children:n,...r}=t;if(S.isValidElement(n)){const i=R2(n);return S.cloneElement(n,{...A2(r,n.props),ref:e?R1(e,i):i})}return S.Children.count(n)>1?S.Children.only(null):null});sm.displayName="SlotClone";var P1=({children:t})=>f.jsx(f.Fragment,{children:t});function C2(t){return S.isValidElement(t)&&t.type===P1}function A2(t,e){const n={...e};for(const r in e){const i=t[r],s=e[r];/^on[A-Z]/.test(r)?i&&s?n[r]=(...a)=>{s(...a),i(...a)}:i&&(n[r]=i):r==="style"?n[r]={...i,...s}:r==="className"&&(n[r]=[i,s].filter(Boolean).join(" "))}return{...t,...n}}function R2(t){var r,i;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(i=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:i.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function N1(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(n=N1(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function I1(){for(var t,e,n=0,r="",i=arguments.length;n<i;n++)(t=arguments[n])&&(e=N1(t))&&(r&&(r+=" "),r+=e);return r}const Kx=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,Jx=I1,Sv=(t,e)=>n=>{var r;if((e==null?void 0:e.variants)==null)return Jx(t,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:i,defaultVariants:s}=e,o=Object.keys(i).map(c=>{const u=n==null?void 0:n[c],d=s==null?void 0:s[c];if(u===null)return null;const h=Kx(u)||Kx(d);return i[c][h]}),a=n&&Object.entries(n).reduce((c,u)=>{let[d,h]=u;return h===void 0||(c[d]=h),c},{}),l=e==null||(r=e.compoundVariants)===null||r===void 0?void 0:r.reduce((c,u)=>{let{class:d,className:h,...m}=u;return Object.entries(m).every(x=>{let[v,g]=x;return Array.isArray(g)?g.includes({...s,...a}[v]):{...s,...a}[v]===g})?[...c,d,h]:c},[]);return Jx(t,o,l,n==null?void 0:n.class,n==null?void 0:n.className)},Ev="-",P2=t=>{const e=I2(t),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=t;return{getClassGroupId:o=>{const a=o.split(Ev);return a[0]===""&&a.length!==1&&a.shift(),L1(a,e)||N2(o)},getConflictingClassGroupIds:(o,a)=>{const l=n[o]||[];return a&&r[o]?[...l,...r[o]]:l}}},L1=(t,e)=>{var o;if(t.length===0)return e.classGroupId;const n=t[0],r=e.nextPart.get(n),i=r?L1(t.slice(1),r):void 0;if(i)return i;if(e.validators.length===0)return;const s=t.join(Ev);return(o=e.validators.find(({validator:a})=>a(s)))==null?void 0:o.classGroupId},Zx=/^\[(.+)\]$/,N2=t=>{if(Zx.test(t)){const e=Zx.exec(t)[1],n=e==null?void 0:e.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}},I2=t=>{const{theme:e,prefix:n}=t,r={nextPart:new Map,validators:[]};return D2(Object.entries(t.classGroups),n).forEach(([s,o])=>{om(o,r,s,e)}),r},om=(t,e,n,r)=>{t.forEach(i=>{if(typeof i=="string"){const s=i===""?e:Qx(e,i);s.classGroupId=n;return}if(typeof i=="function"){if(L2(i)){om(i(r),e,n,r);return}e.validators.push({validator:i,classGroupId:n});return}Object.entries(i).forEach(([s,o])=>{om(o,Qx(e,s),n,r)})})},Qx=(t,e)=>{let n=t;return e.split(Ev).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},L2=t=>t.isThemeGetter,D2=(t,e)=>e?t.map(([n,r])=>{const i=r.map(s=>typeof s=="string"?e+s:typeof s=="object"?Object.fromEntries(Object.entries(s).map(([o,a])=>[e+o,a])):s);return[n,i]}):t,U2=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,n=new Map,r=new Map;const i=(s,o)=>{n.set(s,o),e++,e>t&&(e=0,r=n,n=new Map)};return{get(s){let o=n.get(s);if(o!==void 0)return o;if((o=r.get(s))!==void 0)return i(s,o),o},set(s,o){n.has(s)?n.set(s,o):i(s,o)}}},D1="!",k2=t=>{const{separator:e,experimentalParseClassName:n}=t,r=e.length===1,i=e[0],s=e.length,o=a=>{const l=[];let c=0,u=0,d;for(let g=0;g<a.length;g++){let p=a[g];if(c===0){if(p===i&&(r||a.slice(g,g+s)===e)){l.push(a.slice(u,g)),u=g+s;continue}if(p==="/"){d=g;continue}}p==="["?c++:p==="]"&&c--}const h=l.length===0?a:a.substring(u),m=h.startsWith(D1),x=m?h.substring(1):h,v=d&&d>u?d-u:void 0;return{modifiers:l,hasImportantModifier:m,baseClassName:x,maybePostfixModifierPosition:v}};return n?a=>n({className:a,parseClassName:o}):o},O2=t=>{if(t.length<=1)return t;const e=[];let n=[];return t.forEach(r=>{r[0]==="["?(e.push(...n.sort(),r),n=[]):n.push(r)}),e.push(...n.sort()),e},F2=t=>({cache:U2(t.cacheSize),parseClassName:k2(t),...P2(t)}),B2=/\s+/,j2=(t,e)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:i}=e,s=[],o=t.trim().split(B2);let a="";for(let l=o.length-1;l>=0;l-=1){const c=o[l],{modifiers:u,hasImportantModifier:d,baseClassName:h,maybePostfixModifierPosition:m}=n(c);let x=!!m,v=r(x?h.substring(0,m):h);if(!v){if(!x){a=c+(a.length>0?" "+a:a);continue}if(v=r(h),!v){a=c+(a.length>0?" "+a:a);continue}x=!1}const g=O2(u).join(":"),p=d?g+D1:g,y=p+v;if(s.includes(y))continue;s.push(y);const _=i(v,x);for(let w=0;w<_.length;++w){const E=_[w];s.push(p+E)}a=c+(a.length>0?" "+a:a)}return a};function z2(){let t=0,e,n,r="";for(;t<arguments.length;)(e=arguments[t++])&&(n=U1(e))&&(r&&(r+=" "),r+=n);return r}const U1=t=>{if(typeof t=="string")return t;let e,n="";for(let r=0;r<t.length;r++)t[r]&&(e=U1(t[r]))&&(n&&(n+=" "),n+=e);return n};function V2(t,...e){let n,r,i,s=o;function o(l){const c=e.reduce((u,d)=>d(u),t());return n=F2(c),r=n.cache.get,i=n.cache.set,s=a,a(l)}function a(l){const c=r(l);if(c)return c;const u=j2(l,n);return i(l,u),u}return function(){return s(z2.apply(null,arguments))}}const Mt=t=>{const e=n=>n[t]||[];return e.isThemeGetter=!0,e},k1=/^\[(?:([a-z-]+):)?(.+)\]$/i,H2=/^\d+\/\d+$/,G2=new Set(["px","full","screen"]),W2=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,$2=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,X2=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,q2=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Y2=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Xr=t=>ia(t)||G2.has(t)||H2.test(t),wi=t=>ka(t,"length",rP),ia=t=>!!t&&!Number.isNaN(Number(t)),ih=t=>ka(t,"number",ia),Qa=t=>!!t&&Number.isInteger(Number(t)),K2=t=>t.endsWith("%")&&ia(t.slice(0,-1)),Ye=t=>k1.test(t),Si=t=>W2.test(t),J2=new Set(["length","size","percentage"]),Z2=t=>ka(t,J2,O1),Q2=t=>ka(t,"position",O1),eP=new Set(["image","url"]),tP=t=>ka(t,eP,sP),nP=t=>ka(t,"",iP),el=()=>!0,ka=(t,e,n)=>{const r=k1.exec(t);return r?r[1]?typeof e=="string"?r[1]===e:e.has(r[1]):n(r[2]):!1},rP=t=>$2.test(t)&&!X2.test(t),O1=()=>!1,iP=t=>q2.test(t),sP=t=>Y2.test(t),oP=()=>{const t=Mt("colors"),e=Mt("spacing"),n=Mt("blur"),r=Mt("brightness"),i=Mt("borderColor"),s=Mt("borderRadius"),o=Mt("borderSpacing"),a=Mt("borderWidth"),l=Mt("contrast"),c=Mt("grayscale"),u=Mt("hueRotate"),d=Mt("invert"),h=Mt("gap"),m=Mt("gradientColorStops"),x=Mt("gradientColorStopPositions"),v=Mt("inset"),g=Mt("margin"),p=Mt("opacity"),y=Mt("padding"),_=Mt("saturate"),w=Mt("scale"),E=Mt("sepia"),M=Mt("skew"),T=Mt("space"),P=Mt("translate"),C=()=>["auto","contain","none"],b=()=>["auto","hidden","clip","visible","scroll"],N=()=>["auto",Ye,e],U=()=>[Ye,e],O=()=>["",Xr,wi],V=()=>["auto",ia,Ye],Y=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],z=()=>["solid","dashed","dotted","double","none"],W=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],L=()=>["start","end","center","between","around","evenly","stretch"],H=()=>["","0",Ye],j=()=>["auto","avoid","all","avoid-page","page","left","right","column"],ee=()=>[ia,Ye];return{cacheSize:500,separator:":",theme:{colors:[el],spacing:[Xr,wi],blur:["none","",Si,Ye],brightness:ee(),borderColor:[t],borderRadius:["none","","full",Si,Ye],borderSpacing:U(),borderWidth:O(),contrast:ee(),grayscale:H(),hueRotate:ee(),invert:H(),gap:U(),gradientColorStops:[t],gradientColorStopPositions:[K2,wi],inset:N(),margin:N(),opacity:ee(),padding:U(),saturate:ee(),scale:ee(),sepia:H(),skew:ee(),space:U(),translate:U()},classGroups:{aspect:[{aspect:["auto","square","video",Ye]}],container:["container"],columns:[{columns:[Si]}],"break-after":[{"break-after":j()}],"break-before":[{"break-before":j()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...Y(),Ye]}],overflow:[{overflow:b()}],"overflow-x":[{"overflow-x":b()}],"overflow-y":[{"overflow-y":b()}],overscroll:[{overscroll:C()}],"overscroll-x":[{"overscroll-x":C()}],"overscroll-y":[{"overscroll-y":C()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[v]}],"inset-x":[{"inset-x":[v]}],"inset-y":[{"inset-y":[v]}],start:[{start:[v]}],end:[{end:[v]}],top:[{top:[v]}],right:[{right:[v]}],bottom:[{bottom:[v]}],left:[{left:[v]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Qa,Ye]}],basis:[{basis:N()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Ye]}],grow:[{grow:H()}],shrink:[{shrink:H()}],order:[{order:["first","last","none",Qa,Ye]}],"grid-cols":[{"grid-cols":[el]}],"col-start-end":[{col:["auto",{span:["full",Qa,Ye]},Ye]}],"col-start":[{"col-start":V()}],"col-end":[{"col-end":V()}],"grid-rows":[{"grid-rows":[el]}],"row-start-end":[{row:["auto",{span:[Qa,Ye]},Ye]}],"row-start":[{"row-start":V()}],"row-end":[{"row-end":V()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Ye]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Ye]}],gap:[{gap:[h]}],"gap-x":[{"gap-x":[h]}],"gap-y":[{"gap-y":[h]}],"justify-content":[{justify:["normal",...L()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...L(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...L(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[y]}],px:[{px:[y]}],py:[{py:[y]}],ps:[{ps:[y]}],pe:[{pe:[y]}],pt:[{pt:[y]}],pr:[{pr:[y]}],pb:[{pb:[y]}],pl:[{pl:[y]}],m:[{m:[g]}],mx:[{mx:[g]}],my:[{my:[g]}],ms:[{ms:[g]}],me:[{me:[g]}],mt:[{mt:[g]}],mr:[{mr:[g]}],mb:[{mb:[g]}],ml:[{ml:[g]}],"space-x":[{"space-x":[T]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[T]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Ye,e]}],"min-w":[{"min-w":[Ye,e,"min","max","fit"]}],"max-w":[{"max-w":[Ye,e,"none","full","min","max","fit","prose",{screen:[Si]},Si]}],h:[{h:[Ye,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Ye,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Ye,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Ye,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Si,wi]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",ih]}],"font-family":[{font:[el]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Ye]}],"line-clamp":[{"line-clamp":["none",ia,ih]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Xr,Ye]}],"list-image":[{"list-image":["none",Ye]}],"list-style-type":[{list:["none","disc","decimal",Ye]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[p]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[p]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...z(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Xr,wi]}],"underline-offset":[{"underline-offset":["auto",Xr,Ye]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:U()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ye]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ye]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[p]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...Y(),Q2]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",Z2]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},tP]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[x]}],"gradient-via-pos":[{via:[x]}],"gradient-to-pos":[{to:[x]}],"gradient-from":[{from:[m]}],"gradient-via":[{via:[m]}],"gradient-to":[{to:[m]}],rounded:[{rounded:[s]}],"rounded-s":[{"rounded-s":[s]}],"rounded-e":[{"rounded-e":[s]}],"rounded-t":[{"rounded-t":[s]}],"rounded-r":[{"rounded-r":[s]}],"rounded-b":[{"rounded-b":[s]}],"rounded-l":[{"rounded-l":[s]}],"rounded-ss":[{"rounded-ss":[s]}],"rounded-se":[{"rounded-se":[s]}],"rounded-ee":[{"rounded-ee":[s]}],"rounded-es":[{"rounded-es":[s]}],"rounded-tl":[{"rounded-tl":[s]}],"rounded-tr":[{"rounded-tr":[s]}],"rounded-br":[{"rounded-br":[s]}],"rounded-bl":[{"rounded-bl":[s]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-s":[{"border-s":[a]}],"border-w-e":[{"border-e":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[p]}],"border-style":[{border:[...z(),"hidden"]}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[p]}],"divide-style":[{divide:z()}],"border-color":[{border:[i]}],"border-color-x":[{"border-x":[i]}],"border-color-y":[{"border-y":[i]}],"border-color-s":[{"border-s":[i]}],"border-color-e":[{"border-e":[i]}],"border-color-t":[{"border-t":[i]}],"border-color-r":[{"border-r":[i]}],"border-color-b":[{"border-b":[i]}],"border-color-l":[{"border-l":[i]}],"divide-color":[{divide:[i]}],"outline-style":[{outline:["",...z()]}],"outline-offset":[{"outline-offset":[Xr,Ye]}],"outline-w":[{outline:[Xr,wi]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:O()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[p]}],"ring-offset-w":[{"ring-offset":[Xr,wi]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",Si,nP]}],"shadow-color":[{shadow:[el]}],opacity:[{opacity:[p]}],"mix-blend":[{"mix-blend":[...W(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":W()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",Si,Ye]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[d]}],saturate:[{saturate:[_]}],sepia:[{sepia:[E]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[d]}],"backdrop-opacity":[{"backdrop-opacity":[p]}],"backdrop-saturate":[{"backdrop-saturate":[_]}],"backdrop-sepia":[{"backdrop-sepia":[E]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Ye]}],duration:[{duration:ee()}],ease:[{ease:["linear","in","out","in-out",Ye]}],delay:[{delay:ee()}],animate:[{animate:["none","spin","ping","pulse","bounce",Ye]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[w]}],"scale-x":[{"scale-x":[w]}],"scale-y":[{"scale-y":[w]}],rotate:[{rotate:[Qa,Ye]}],"translate-x":[{"translate-x":[P]}],"translate-y":[{"translate-y":[P]}],"skew-x":[{"skew-x":[M]}],"skew-y":[{"skew-y":[M]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Ye]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ye]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":U()}],"scroll-mx":[{"scroll-mx":U()}],"scroll-my":[{"scroll-my":U()}],"scroll-ms":[{"scroll-ms":U()}],"scroll-me":[{"scroll-me":U()}],"scroll-mt":[{"scroll-mt":U()}],"scroll-mr":[{"scroll-mr":U()}],"scroll-mb":[{"scroll-mb":U()}],"scroll-ml":[{"scroll-ml":U()}],"scroll-p":[{"scroll-p":U()}],"scroll-px":[{"scroll-px":U()}],"scroll-py":[{"scroll-py":U()}],"scroll-ps":[{"scroll-ps":U()}],"scroll-pe":[{"scroll-pe":U()}],"scroll-pt":[{"scroll-pt":U()}],"scroll-pr":[{"scroll-pr":U()}],"scroll-pb":[{"scroll-pb":U()}],"scroll-pl":[{"scroll-pl":U()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ye]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[Xr,wi,ih]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},aP=V2(oP);function wt(...t){return aP(I1(t))}const lP=Sv("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-all duration-300 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 hover:scale-105 hover:shadow-lg",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90 hover:scale-105",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground hover:scale-105",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80 hover:scale-105",ghost:"hover:bg-accent hover:text-accent-foreground hover:scale-105",link:"text-primary underline-offset-4 hover:underline hover:scale-105"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),Ze=S.forwardRef(({className:t,variant:e,size:n,asChild:r=!1,...i},s)=>{const o=r?va:"button";return f.jsx(o,{className:wt(lP({variant:e,size:n,className:t})),ref:s,...i})});Ze.displayName="Button";const _t=S.forwardRef(({className:t,...e},n)=>f.jsx("div",{ref:n,className:wt("rounded-lg border bg-card text-card-foreground shadow-sm",t),...e}));_t.displayName="Card";const _r=S.forwardRef(({className:t,...e},n)=>f.jsx("div",{ref:n,className:wt("flex flex-col space-y-1.5 p-6",t),...e}));_r.displayName="CardHeader";const wr=S.forwardRef(({className:t,...e},n)=>f.jsx("h3",{ref:n,className:wt("text-2xl font-semibold leading-none tracking-tight",t),...e}));wr.displayName="CardTitle";const cP=S.forwardRef(({className:t,...e},n)=>f.jsx("p",{ref:n,className:wt("text-sm text-muted-foreground",t),...e}));cP.displayName="CardDescription";const Lt=S.forwardRef(({className:t,...e},n)=>f.jsx("div",{ref:n,className:wt("p-6 pt-0",t),...e}));Lt.displayName="CardContent";const uP=S.forwardRef(({className:t,...e},n)=>f.jsx("div",{ref:n,className:wt("flex items-center p-6 pt-0",t),...e}));uP.displayName="CardFooter";const dP=Sv("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function ns({className:t,variant:e,...n}){return f.jsx("div",{className:wt(dP({variant:e}),t),...n})}const fP="modulepreload",hP=function(t){return"/"+t},ey={},lo=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(n.map(l=>{if(l=hP(l),l in ey)return;ey[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const d=document.createElement("link");if(d.rel=c?"stylesheet":fP,c||(d.as="script"),d.crossOrigin="",d.href=l,a&&d.setAttribute("nonce",a),document.head.appendChild(d),c)return new Promise((h,m)=>{d.addEventListener("load",h),d.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return i.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})},pP=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>lo(async()=>{const{default:r}=await Promise.resolve().then(()=>Oa);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)};class bv extends Error{constructor(e,n="FunctionsError",r){super(e),this.name=n,this.context=r}}class mP extends bv{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class ty extends bv{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class ny extends bv{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var am;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(am||(am={}));var gP=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function l(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):i(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})};class vP{constructor(e,{headers:n={},customFetch:r,region:i=am.Any}={}){this.url=e,this.headers=n,this.region=i,this.fetch=pP(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,n={}){var r;return gP(this,void 0,void 0,function*(){try{const{headers:i,method:s,body:o}=n;let a={},{region:l}=n;l||(l=this.region);const c=new URL(`${this.url}/${e}`);l&&l!=="any"&&(a["x-region"]=l,c.searchParams.set("forceFunctionRegion",l));let u;o&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",u=o):typeof o=="string"?(a["Content-Type"]="text/plain",u=o):typeof FormData<"u"&&o instanceof FormData?u=o:(a["Content-Type"]="application/json",u=JSON.stringify(o)));const d=yield this.fetch(c.toString(),{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),i),body:u}).catch(v=>{throw new mP(v)}),h=d.headers.get("x-relay-error");if(h&&h==="true")throw new ty(d);if(!d.ok)throw new ny(d);let m=((r=d.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),x;return m==="application/json"?x=yield d.json():m==="application/octet-stream"?x=yield d.blob():m==="text/event-stream"?x=d:m==="multipart/form-data"?x=yield d.formData():x=yield d.text(),{data:x,error:null,response:d}}catch(i){return{data:null,error:i,response:i instanceof ny||i instanceof ty?i.context:void 0}}})}}var An={},Tv={},Kd={},sc={},Jd={},Zd={},xP=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},xa=xP();const yP=xa.fetch,F1=xa.fetch.bind(xa),B1=xa.Headers,_P=xa.Request,wP=xa.Response,Oa=Object.freeze(Object.defineProperty({__proto__:null,Headers:B1,Request:_P,Response:wP,default:F1,fetch:yP},Symbol.toStringTag,{value:"Module"})),SP=IM(Oa);var Qd={};Object.defineProperty(Qd,"__esModule",{value:!0});let EP=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};Qd.default=EP;var j1=ir&&ir.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Zd,"__esModule",{value:!0});const bP=j1(SP),TP=j1(Qd);let MP=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=bP.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,n){return this.headers=Object.assign({},this.headers),this.headers[e]=n,this}then(e,n){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const r=this.fetch;let i=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var o,a,l;let c=null,u=null,d=null,h=s.status,m=s.statusText;if(s.ok){if(this.method!=="HEAD"){const p=await s.text();p===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?u=p:u=JSON.parse(p))}const v=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),g=(a=s.headers.get("content-range"))===null||a===void 0?void 0:a.split("/");v&&g&&g.length>1&&(d=parseInt(g[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(c={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,d=null,h=406,m="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{const v=await s.text();try{c=JSON.parse(v),Array.isArray(c)&&s.status===404&&(u=[],c=null,h=200,m="OK")}catch{s.status===404&&v===""?(h=204,m="No Content"):c={message:v}}if(c&&this.isMaybeSingle&&(!((l=c==null?void 0:c.details)===null||l===void 0)&&l.includes("0 rows"))&&(c=null,h=200,m="OK"),c&&this.shouldThrowOnError)throw new TP.default(c)}return{error:c,data:u,count:d,status:h,statusText:m}});return this.shouldThrowOnError||(i=i.catch(s=>{var o,a,l;return{error:{message:`${(o=s==null?void 0:s.name)!==null&&o!==void 0?o:"FetchError"}: ${s==null?void 0:s.message}`,details:`${(a=s==null?void 0:s.stack)!==null&&a!==void 0?a:""}`,hint:"",code:`${(l=s==null?void 0:s.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),i.then(e,n)}returns(){return this}overrideTypes(){return this}};Zd.default=MP;var CP=ir&&ir.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Jd,"__esModule",{value:!0});const AP=CP(Zd);let RP=class extends AP.default{select(e){let n=!1;const r=(e??"*").split("").map(i=>/\s/.test(i)&&!n?"":(i==='"'&&(n=!n),i)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:n=!0,nullsFirst:r,foreignTable:i,referencedTable:s=i}={}){const o=s?`${s}.order`:"order",a=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${a?`${a},`:""}${e}.${n?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:n,referencedTable:r=n}={}){const i=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(i,`${e}`),this}range(e,n,{foreignTable:r,referencedTable:i=r}={}){const s=typeof i>"u"?"offset":`${i}.offset`,o=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(s,`${e}`),this.url.searchParams.set(o,`${n-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:n=!1,settings:r=!1,buffers:i=!1,wal:s=!1,format:o="text"}={}){var a;const l=[e?"analyze":null,n?"verbose":null,r?"settings":null,i?"buffers":null,s?"wal":null].filter(Boolean).join("|"),c=(a=this.headers.Accept)!==null&&a!==void 0?a:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${c}"; options=${l};`,o==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};Jd.default=RP;var PP=ir&&ir.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(sc,"__esModule",{value:!0});const NP=PP(Jd);let IP=class extends NP.default{eq(e,n){return this.url.searchParams.append(e,`eq.${n}`),this}neq(e,n){return this.url.searchParams.append(e,`neq.${n}`),this}gt(e,n){return this.url.searchParams.append(e,`gt.${n}`),this}gte(e,n){return this.url.searchParams.append(e,`gte.${n}`),this}lt(e,n){return this.url.searchParams.append(e,`lt.${n}`),this}lte(e,n){return this.url.searchParams.append(e,`lte.${n}`),this}like(e,n){return this.url.searchParams.append(e,`like.${n}`),this}likeAllOf(e,n){return this.url.searchParams.append(e,`like(all).{${n.join(",")}}`),this}likeAnyOf(e,n){return this.url.searchParams.append(e,`like(any).{${n.join(",")}}`),this}ilike(e,n){return this.url.searchParams.append(e,`ilike.${n}`),this}ilikeAllOf(e,n){return this.url.searchParams.append(e,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(e,n){return this.url.searchParams.append(e,`ilike(any).{${n.join(",")}}`),this}is(e,n){return this.url.searchParams.append(e,`is.${n}`),this}in(e,n){const r=Array.from(new Set(n)).map(i=>typeof i=="string"&&new RegExp("[,()]").test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cs.{${n.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(n)}`),this}containedBy(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cd.{${n.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(n)}`),this}rangeGt(e,n){return this.url.searchParams.append(e,`sr.${n}`),this}rangeGte(e,n){return this.url.searchParams.append(e,`nxl.${n}`),this}rangeLt(e,n){return this.url.searchParams.append(e,`sl.${n}`),this}rangeLte(e,n){return this.url.searchParams.append(e,`nxr.${n}`),this}rangeAdjacent(e,n){return this.url.searchParams.append(e,`adj.${n}`),this}overlaps(e,n){return typeof n=="string"?this.url.searchParams.append(e,`ov.${n}`):this.url.searchParams.append(e,`ov.{${n.join(",")}}`),this}textSearch(e,n,{config:r,type:i}={}){let s="";i==="plain"?s="pl":i==="phrase"?s="ph":i==="websearch"&&(s="w");const o=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${s}fts${o}.${n}`),this}match(e){return Object.entries(e).forEach(([n,r])=>{this.url.searchParams.append(n,`eq.${r}`)}),this}not(e,n,r){return this.url.searchParams.append(e,`not.${n}.${r}`),this}or(e,{foreignTable:n,referencedTable:r=n}={}){const i=r?`${r}.or`:"or";return this.url.searchParams.append(i,`(${e})`),this}filter(e,n,r){return this.url.searchParams.append(e,`${n}.${r}`),this}};sc.default=IP;var LP=ir&&ir.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Kd,"__esModule",{value:!0});const tl=LP(sc);let DP=class{constructor(e,{headers:n={},schema:r,fetch:i}){this.url=e,this.headers=n,this.schema=r,this.fetch=i}select(e,{head:n=!1,count:r}={}){const i=n?"HEAD":"GET";let s=!1;const o=(e??"*").split("").map(a=>/\s/.test(a)&&!s?"":(a==='"'&&(s=!s),a)).join("");return this.url.searchParams.set("select",o),r&&(this.headers.Prefer=`count=${r}`),new tl.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:n,defaultToNull:r=!0}={}){const i="POST",s=[];if(this.headers.Prefer&&s.push(this.headers.Prefer),n&&s.push(`count=${n}`),r||s.push("missing=default"),this.headers.Prefer=s.join(","),Array.isArray(e)){const o=e.reduce((a,l)=>a.concat(Object.keys(l)),[]);if(o.length>0){const a=[...new Set(o)].map(l=>`"${l}"`);this.url.searchParams.set("columns",a.join(","))}}return new tl.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:n,ignoreDuplicates:r=!1,count:i,defaultToNull:s=!0}={}){const o="POST",a=[`resolution=${r?"ignore":"merge"}-duplicates`];if(n!==void 0&&this.url.searchParams.set("on_conflict",n),this.headers.Prefer&&a.push(this.headers.Prefer),i&&a.push(`count=${i}`),s||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(e)){const l=e.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(l.length>0){const c=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new tl.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:n}={}){const r="PATCH",i=[];return this.headers.Prefer&&i.push(this.headers.Prefer),n&&i.push(`count=${n}`),this.headers.Prefer=i.join(","),new tl.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const n="DELETE",r=[];return e&&r.push(`count=${e}`),this.headers.Prefer&&r.unshift(this.headers.Prefer),this.headers.Prefer=r.join(","),new tl.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};Kd.default=DP;var ef={},tf={};Object.defineProperty(tf,"__esModule",{value:!0});tf.version=void 0;tf.version="0.0.0-automated";Object.defineProperty(ef,"__esModule",{value:!0});ef.DEFAULT_HEADERS=void 0;const UP=tf;ef.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${UP.version}`};var z1=ir&&ir.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Tv,"__esModule",{value:!0});const kP=z1(Kd),OP=z1(sc),FP=ef;let BP=class V1{constructor(e,{headers:n={},schema:r,fetch:i}={}){this.url=e,this.headers=Object.assign(Object.assign({},FP.DEFAULT_HEADERS),n),this.schemaName=r,this.fetch=i}from(e){const n=new URL(`${this.url}/${e}`);return new kP.default(n,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new V1(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,n={},{head:r=!1,get:i=!1,count:s}={}){let o;const a=new URL(`${this.url}/rpc/${e}`);let l;r||i?(o=r?"HEAD":"GET",Object.entries(n).filter(([u,d])=>d!==void 0).map(([u,d])=>[u,Array.isArray(d)?`{${d.join(",")}}`:`${d}`]).forEach(([u,d])=>{a.searchParams.append(u,d)})):(o="POST",l=n);const c=Object.assign({},this.headers);return s&&(c.Prefer=`count=${s}`),new OP.default({method:o,url:a,headers:c,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}};Tv.default=BP;var Fa=ir&&ir.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(An,"__esModule",{value:!0});An.PostgrestError=An.PostgrestBuilder=An.PostgrestTransformBuilder=An.PostgrestFilterBuilder=An.PostgrestQueryBuilder=An.PostgrestClient=void 0;const H1=Fa(Tv);An.PostgrestClient=H1.default;const G1=Fa(Kd);An.PostgrestQueryBuilder=G1.default;const W1=Fa(sc);An.PostgrestFilterBuilder=W1.default;const $1=Fa(Jd);An.PostgrestTransformBuilder=$1.default;const X1=Fa(Zd);An.PostgrestBuilder=X1.default;const q1=Fa(Qd);An.PostgrestError=q1.default;var jP=An.default={PostgrestClient:H1.default,PostgrestQueryBuilder:G1.default,PostgrestFilterBuilder:W1.default,PostgrestTransformBuilder:$1.default,PostgrestBuilder:X1.default,PostgrestError:q1.default};const{PostgrestClient:zP,PostgrestQueryBuilder:yV,PostgrestFilterBuilder:_V,PostgrestTransformBuilder:wV,PostgrestBuilder:SV,PostgrestError:EV}=jP;function VP(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const HP=VP(),GP="2.11.15",WP=`realtime-js/${GP}`,$P="1.0.0",Y1=1e4,XP=1e3;var Tl;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Tl||(Tl={}));var hn;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(hn||(hn={}));var vr;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(vr||(vr={}));var lm;(function(t){t.websocket="websocket"})(lm||(lm={}));var Fs;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Fs||(Fs={}));class qP{constructor(){this.HEADER_LENGTH=1}decode(e,n){return e.constructor===ArrayBuffer?n(this._binaryDecode(e)):n(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const n=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,n,r)}_decodeBroadcast(e,n,r){const i=n.getUint8(1),s=n.getUint8(2);let o=this.HEADER_LENGTH+2;const a=r.decode(e.slice(o,o+i));o=o+i;const l=r.decode(e.slice(o,o+s));o=o+s;const c=JSON.parse(r.decode(e.slice(o,e.byteLength)));return{ref:null,topic:a,event:l,payload:c}}}let K1=class{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}};var Et;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(Et||(Et={}));const ry=(t,e,n={})=>{var r;const i=(r=n.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((s,o)=>(s[o]=YP(o,t,e,i),s),{})},YP=(t,e,n,r)=>{const i=e.find(a=>a.name===t),s=i==null?void 0:i.type,o=n[t];return s&&!r.includes(s)?J1(s,o):cm(o)},J1=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return QP(e,n)}switch(t){case Et.bool:return KP(e);case Et.float4:case Et.float8:case Et.int2:case Et.int4:case Et.int8:case Et.numeric:case Et.oid:return JP(e);case Et.json:case Et.jsonb:return ZP(e);case Et.timestamp:return eN(e);case Et.abstime:case Et.date:case Et.daterange:case Et.int4range:case Et.int8range:case Et.money:case Et.reltime:case Et.text:case Et.time:case Et.timestamptz:case Et.timetz:case Et.tsrange:case Et.tstzrange:return cm(e);default:return cm(e)}},cm=t=>t,KP=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},JP=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},ZP=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},QP=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,r=t[n];if(t[0]==="{"&&r==="}"){let s;const o=t.slice(1,n);try{s=JSON.parse("["+o+"]")}catch{s=o?o.split(","):[]}return s.map(a=>J1(e,a))}return t},eN=t=>typeof t=="string"?t.replace(" ","T"):t,Z1=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class sh{constructor(e,n,r={},i=Y1){this.channel=e,this.event=n,this.payload=r,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var r;return this._hasReceived(e)&&n((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var iy;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(iy||(iy={}));class Ml{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},i=>{const{onJoin:s,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Ml.syncState(this.state,i,s,o),this.pendingDiffs.forEach(l=>{this.state=Ml.syncDiff(this.state,l,s,o)}),this.pendingDiffs=[],a()}),this.channel._on(r.diff,{},i=>{const{onJoin:s,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=Ml.syncDiff(this.state,i,s,o),a())}),this.onJoin((i,s,o)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:s,newPresences:o})}),this.onLeave((i,s,o)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:s,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,r,i){const s=this.cloneDeep(e),o=this.transformState(n),a={},l={};return this.map(s,(c,u)=>{o[c]||(l[c]=u)}),this.map(o,(c,u)=>{const d=s[c];if(d){const h=u.map(g=>g.presence_ref),m=d.map(g=>g.presence_ref),x=u.filter(g=>m.indexOf(g.presence_ref)<0),v=d.filter(g=>h.indexOf(g.presence_ref)<0);x.length>0&&(a[c]=x),v.length>0&&(l[c]=v)}else a[c]=u}),this.syncDiff(s,{joins:a,leaves:l},r,i)}static syncDiff(e,n,r,i){const{joins:s,leaves:o}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return r||(r=()=>{}),i||(i=()=>{}),this.map(s,(a,l)=>{var c;const u=(c=e[a])!==null&&c!==void 0?c:[];if(e[a]=this.cloneDeep(l),u.length>0){const d=e[a].map(m=>m.presence_ref),h=u.filter(m=>d.indexOf(m.presence_ref)<0);e[a].unshift(...h)}r(a,u,l)}),this.map(o,(a,l)=>{let c=e[a];if(!c)return;const u=l.map(d=>d.presence_ref);c=c.filter(d=>u.indexOf(d.presence_ref)<0),e[a]=c,i(a,c,l),c.length===0&&delete e[a]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(r=>n(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,r)=>{const i=e[r];return"metas"in i?n[r]=i.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):n[r]=i,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var sy;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(sy||(sy={}));var oy;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(oy||(oy={}));var ni;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(ni||(ni={}));class Mv{constructor(e,n={config:{}},r){this.topic=e,this.params=n,this.socket=r,this.bindings={},this.state=hn.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new sh(this,vr.join,this.params,this.timeout),this.rejoinTimer=new K1(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=hn.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=hn.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=hn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=hn.errored,this.rejoinTimer.scheduleTimeout())}),this._on(vr.reply,{},(i,s)=>{this._trigger(this._replyEventName(s),i)}),this.presence=new Ml(this),this.broadcastEndpointURL=Z1(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,n=this.timeout){var r,i;if(this.socket.isConnected()||this.socket.connect(),this.state==hn.closed){const{config:{broadcast:s,presence:o,private:a}}=this.params;this._onError(u=>e==null?void 0:e(ni.CHANNEL_ERROR,u)),this._onClose(()=>e==null?void 0:e(ni.CLOSED));const l={},c={broadcast:s,presence:o,postgres_changes:(i=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(u=>u.filter))!==null&&i!==void 0?i:[],private:a};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:u})=>{var d;if(this.socket.setAuth(),u===void 0){e==null||e(ni.SUBSCRIBED);return}else{const h=this.bindings.postgres_changes,m=(d=h==null?void 0:h.length)!==null&&d!==void 0?d:0,x=[];for(let v=0;v<m;v++){const g=h[v],{filter:{event:p,schema:y,table:_,filter:w}}=g,E=u&&u[v];if(E&&E.event===p&&E.schema===y&&E.table===_&&E.filter===w)x.push(Object.assign(Object.assign({},g),{id:E.id}));else{this.unsubscribe(),this.state=hn.errored,e==null||e(ni.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=x,e&&e(ni.SUBSCRIBED);return}}).receive("error",u=>{this.state=hn.errored,e==null||e(ni.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(ni.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,r){return this._on(e,n,r)}async send(e,n={}){var r,i;if(!this._canPush()&&e.type==="broadcast"){const{event:s,payload:o}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:o,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(r=n.timeout)!==null&&r!==void 0?r:this.timeout);return await((i=c.body)===null||i===void 0?void 0:i.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var o,a,l;const c=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(a=(o=this.params)===null||o===void 0?void 0:o.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.ack)&&s("ok"),c.receive("ok",()=>s("ok")),c.receive("error",()=>s("error")),c.receive("timeout",()=>s("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=hn.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(vr.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(i=>{r=new sh(this,vr.leave,{},e),r.receive("ok",()=>{n(),i("ok")}).receive("timeout",()=>{n(),i("timed out")}).receive("error",()=>{i("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,n,r){const i=new AbortController,s=setTimeout(()=>i.abort(),r),o=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:i.signal}));return clearTimeout(s),o}_push(e,n,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new sh(this,e,n,r);return this._canPush()?i.send():(i.startTimeout(),this.pushBuffer.push(i)),i}_onMessage(e,n,r){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,r){var i,s;const o=e.toLocaleLowerCase(),{close:a,error:l,leave:c,join:u}=vr;if(r&&[a,l,c,u].indexOf(o)>=0&&r!==this._joinRef())return;let h=this._onMessage(o,n,r);if(n&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(m=>{var x,v,g;return((x=m.filter)===null||x===void 0?void 0:x.event)==="*"||((g=(v=m.filter)===null||v===void 0?void 0:v.event)===null||g===void 0?void 0:g.toLocaleLowerCase())===o}).map(m=>m.callback(h,r)):(s=this.bindings[o])===null||s===void 0||s.filter(m=>{var x,v,g,p,y,_;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in m){const w=m.id,E=(x=m.filter)===null||x===void 0?void 0:x.event;return w&&((v=n.ids)===null||v===void 0?void 0:v.includes(w))&&(E==="*"||(E==null?void 0:E.toLocaleLowerCase())===((g=n.data)===null||g===void 0?void 0:g.type.toLocaleLowerCase()))}else{const w=(y=(p=m==null?void 0:m.filter)===null||p===void 0?void 0:p.event)===null||y===void 0?void 0:y.toLocaleLowerCase();return w==="*"||w===((_=n==null?void 0:n.event)===null||_===void 0?void 0:_.toLocaleLowerCase())}else return m.type.toLocaleLowerCase()===o}).map(m=>{if(typeof h=="object"&&"ids"in h){const x=h.data,{schema:v,table:g,commit_timestamp:p,type:y,errors:_}=x;h=Object.assign(Object.assign({},{schema:v,table:g,commit_timestamp:p,eventType:y,new:{},old:{},errors:_}),this._getPayloadRecords(x))}m.callback(h,r)})}_isClosed(){return this.state===hn.closed}_isJoined(){return this.state===hn.joined}_isJoining(){return this.state===hn.joining}_isLeaving(){return this.state===hn.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,r){const i=e.toLocaleLowerCase(),s={type:i,filter:n,callback:r};return this.bindings[i]?this.bindings[i].push(s):this.bindings[i]=[s],this}_off(e,n){const r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(i=>{var s;return!(((s=i.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===r&&Mv.isEqual(i.filter,n))}),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const r in e)if(e[r]!==n[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(vr.close,{},e)}_onError(e){this._on(vr.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=hn.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=ry(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=ry(e.columns,e.old_record)),n}}const ay=()=>{},tN=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class nN{constructor(e,n){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Y1,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=ay,this.ref=0,this.logger=ay,this.conn=null,this.sendBuffer=[],this.serializer=new qP,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=s=>{let o;return s?o=s:typeof fetch>"u"?o=(...a)=>lo(async()=>{const{default:l}=await Promise.resolve().then(()=>Oa);return{default:l}},void 0).then(({default:l})=>l(...a)):o=fetch,(...a)=>o(...a)},this.endPoint=`${e}/${lm.websocket}`,this.httpEndpoint=Z1(e),n!=null&&n.transport?this.transport=n.transport:this.transport=null,n!=null&&n.params&&(this.params=n.params),n!=null&&n.timeout&&(this.timeout=n.timeout),n!=null&&n.logger&&(this.logger=n.logger),(n!=null&&n.logLevel||n!=null&&n.log_level)&&(this.logLevel=n.logLevel||n.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),n!=null&&n.heartbeatIntervalMs&&(this.heartbeatIntervalMs=n.heartbeatIntervalMs);const i=(r=n==null?void 0:n.params)===null||r===void 0?void 0:r.apikey;if(i&&(this.accessTokenValue=i,this.apiKey=i),this.reconnectAfterMs=n!=null&&n.reconnectAfterMs?n.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=n!=null&&n.encode?n.encode:(s,o)=>o(JSON.stringify(s)),this.decode=n!=null&&n.decode?n.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new K1(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(n==null?void 0:n.fetch),n!=null&&n.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(n==null?void 0:n.worker)||!1,this.workerUrl=n==null?void 0:n.workerUrl}this.accessToken=(n==null?void 0:n.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=HP),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:$P}))}disconnect(e,n){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,n??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(r=>r.teardown()))}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,n,r){this.logger(e,n,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Tl.connecting:return Fs.Connecting;case Tl.open:return Fs.Open;case Tl.closing:return Fs.Closing;default:return Fs.Closed}}isConnected(){return this.connectionState()===Fs.Open}channel(e,n={config:{}}){const r=`realtime:${e}`,i=this.getChannels().find(s=>s.topic===r);if(i)return i;{const s=new Mv(`realtime:${e}`,n,this);return this.channels.push(s),s}}push(e){const{topic:n,event:r,payload:i,ref:s}=e,o=()=>{this.encode(e,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${n} ${r} (${s})`,i),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){let n=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(r=>{const i={access_token:n,version:WP};n&&r.updateJoinPayload(i),r.joinedOnce&&r._isJoined()&&r._push(vr.access_token,{access_token:n})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(e=this.conn)===null||e===void 0||e.close(XP,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,n=>{let{topic:r,event:i,payload:s,ref:o}=n;r==="phoenix"&&i==="phx_reply"&&this.heartbeatCallback(n.payload.status=="ok"?"ok":"error"),o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${s.status||""} ${r} ${i} ${o&&"("+o+")"||""}`,s),Array.from(this.channels).filter(a=>a._isMember(r)).forEach(a=>a._trigger(i,s,o)),this.stateChangeCallbacks.message.forEach(a=>a(n))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(e=>e())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(n=>n(e))}_onConnError(e){this.log("transport",`${e}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(n=>n(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(vr.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const r=e.match(/\?/)?"&":"?",i=new URLSearchParams(n);return`${e}${r}${i}`}_workerObjectUrl(e){let n;if(e)n=e;else{const r=new Blob([tN],{type:"application/javascript"});n=URL.createObjectURL(r)}return n}}class Cv extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function en(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class rN extends Cv{constructor(e,n){super(e),this.name="StorageApiError",this.status=n}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class um extends Cv{constructor(e,n){super(e),this.name="StorageUnknownError",this.originalError=n}}var iN=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function l(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):i(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})};const Q1=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>lo(async()=>{const{default:r}=await Promise.resolve().then(()=>Oa);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},sN=()=>iN(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield lo(()=>Promise.resolve().then(()=>Oa),void 0)).Response:Response}),dm=t=>{if(Array.isArray(t))return t.map(n=>dm(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,r])=>{const i=n.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));e[i]=dm(r)}),e};var co=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function l(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):i(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})};const oh=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),oN=(t,e,n)=>co(void 0,void 0,void 0,function*(){const r=yield sN();t instanceof r&&!(n!=null&&n.noResolveJson)?t.json().then(i=>{e(new rN(oh(i),t.status||500))}).catch(i=>{e(new um(oh(i),i))}):e(new um(oh(t),t))}),aN=(t,e,n,r)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),r&&(i.body=JSON.stringify(r)),Object.assign(Object.assign({},i),n))};function oc(t,e,n,r,i,s){return co(this,void 0,void 0,function*(){return new Promise((o,a)=>{t(n,aN(e,r,i,s)).then(l=>{if(!l.ok)throw l;return r!=null&&r.noResolveJson?l:l.json()}).then(l=>o(l)).catch(l=>oN(l,a,r))})})}function pd(t,e,n,r){return co(this,void 0,void 0,function*(){return oc(t,"GET",e,n,r)})}function Oi(t,e,n,r,i){return co(this,void 0,void 0,function*(){return oc(t,"POST",e,r,i,n)})}function lN(t,e,n,r,i){return co(this,void 0,void 0,function*(){return oc(t,"PUT",e,r,i,n)})}function cN(t,e,n,r){return co(this,void 0,void 0,function*(){return oc(t,"HEAD",e,Object.assign(Object.assign({},n),{noResolveJson:!0}),r)})}function eE(t,e,n,r,i){return co(this,void 0,void 0,function*(){return oc(t,"DELETE",e,r,i,n)})}var Tn=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function l(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):i(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})};const uN={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},ly={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class dN{constructor(e,n={},r,i){this.url=e,this.headers=n,this.bucketId=r,this.fetch=Q1(i)}uploadOrUpdate(e,n,r,i){return Tn(this,void 0,void 0,function*(){try{let s;const o=Object.assign(Object.assign({},ly),i);let a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const l=o.metadata;typeof Blob<"u"&&r instanceof Blob?(s=new FormData,s.append("cacheControl",o.cacheControl),l&&s.append("metadata",this.encodeMetadata(l)),s.append("",r)):typeof FormData<"u"&&r instanceof FormData?(s=r,s.append("cacheControl",o.cacheControl),l&&s.append("metadata",this.encodeMetadata(l))):(s=r,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType,l&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),i!=null&&i.headers&&(a=Object.assign(Object.assign({},a),i.headers));const c=this._removeEmptyFolders(n),u=this._getFinalPath(c),d=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:e,body:s,headers:a},o!=null&&o.duplex?{duplex:o.duplex}:{})),h=yield d.json();return d.ok?{data:{path:c,id:h.Id,fullPath:h.Key},error:null}:{data:null,error:h}}catch(s){if(en(s))return{data:null,error:s};throw s}})}upload(e,n,r){return Tn(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,n,r)})}uploadToSignedUrl(e,n,r,i){return Tn(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(e),o=this._getFinalPath(s),a=new URL(this.url+`/object/upload/sign/${o}`);a.searchParams.set("token",n);try{let l;const c=Object.assign({upsert:ly.upsert},i),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",c.cacheControl)):(l=r,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const d=yield this.fetch(a.toString(),{method:"PUT",body:l,headers:u}),h=yield d.json();return d.ok?{data:{path:s,fullPath:h.Key},error:null}:{data:null,error:h}}catch(l){if(en(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,n){return Tn(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const i=Object.assign({},this.headers);n!=null&&n.upsert&&(i["x-upsert"]="true");const s=yield Oi(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:i}),o=new URL(this.url+s.url),a=o.searchParams.get("token");if(!a)throw new Cv("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:a},error:null}}catch(r){if(en(r))return{data:null,error:r};throw r}})}update(e,n,r){return Tn(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,n,r)})}move(e,n,r){return Tn(this,void 0,void 0,function*(){try{return{data:yield Oi(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(en(i))return{data:null,error:i};throw i}})}copy(e,n,r){return Tn(this,void 0,void 0,function*(){try{return{data:{path:(yield Oi(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(en(i))return{data:null,error:i};throw i}})}createSignedUrl(e,n,r){return Tn(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e),s=yield Oi(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:n},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${o}`)},{data:s,error:null}}catch(i){if(en(i))return{data:null,error:i};throw i}})}createSignedUrls(e,n,r){return Tn(this,void 0,void 0,function*(){try{const i=yield Oi(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:e},{headers:this.headers}),s=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:i.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${s}`):null})),error:null}}catch(i){if(en(i))return{data:null,error:i};throw i}})}download(e,n){return Tn(this,void 0,void 0,function*(){const i=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),o=s?`?${s}`:"";try{const a=this._getFinalPath(e);return{data:yield(yield pd(this.fetch,`${this.url}/${i}/${a}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if(en(a))return{data:null,error:a};throw a}})}info(e){return Tn(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{const r=yield pd(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:dm(r),error:null}}catch(r){if(en(r))return{data:null,error:r};throw r}})}exists(e){return Tn(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{return yield cN(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(en(r)&&r instanceof um){const i=r.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,n){const r=this._getFinalPath(e),i=[],s=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";s!==""&&i.push(s);const a=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});l!==""&&i.push(l);let c=i.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${r}${c}`)}}}remove(e){return Tn(this,void 0,void 0,function*(){try{return{data:yield eE(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(n){if(en(n))return{data:null,error:n};throw n}})}list(e,n,r){return Tn(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},uN),n),{prefix:e||""});return{data:yield Oi(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},r),error:null}}catch(i){if(en(i))return{data:null,error:i};throw i}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const n=[];return e.width&&n.push(`width=${e.width}`),e.height&&n.push(`height=${e.height}`),e.resize&&n.push(`resize=${e.resize}`),e.format&&n.push(`format=${e.format}`),e.quality&&n.push(`quality=${e.quality}`),n.join("&")}}const fN="2.7.1",hN={"X-Client-Info":`storage-js/${fN}`};var ho=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function l(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):i(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})};class pN{constructor(e,n={},r){this.url=e,this.headers=Object.assign(Object.assign({},hN),n),this.fetch=Q1(r)}listBuckets(){return ho(this,void 0,void 0,function*(){try{return{data:yield pd(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(en(e))return{data:null,error:e};throw e}})}getBucket(e){return ho(this,void 0,void 0,function*(){try{return{data:yield pd(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(n){if(en(n))return{data:null,error:n};throw n}})}createBucket(e,n={public:!1}){return ho(this,void 0,void 0,function*(){try{return{data:yield Oi(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(en(r))return{data:null,error:r};throw r}})}updateBucket(e,n){return ho(this,void 0,void 0,function*(){try{return{data:yield lN(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(en(r))return{data:null,error:r};throw r}})}emptyBucket(e){return ho(this,void 0,void 0,function*(){try{return{data:yield Oi(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(en(n))return{data:null,error:n};throw n}})}deleteBucket(e){return ho(this,void 0,void 0,function*(){try{return{data:yield eE(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(en(n))return{data:null,error:n};throw n}})}}class mN extends pN{constructor(e,n={},r){super(e,n,r)}from(e){return new dN(this.url,this.headers,e,this.fetch)}}const gN="2.52.1";let dl="";typeof Deno<"u"?dl="deno":typeof document<"u"?dl="web":typeof navigator<"u"&&navigator.product==="ReactNative"?dl="react-native":dl="node";const vN={"X-Client-Info":`supabase-js-${dl}/${gN}`},xN={headers:vN},yN={schema:"public"},_N={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},wN={};var SN=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function l(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):i(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})};const EN=t=>{let e;return t?e=t:typeof fetch>"u"?e=F1:e=fetch,(...n)=>e(...n)},bN=()=>typeof Headers>"u"?B1:Headers,TN=(t,e,n)=>{const r=EN(n),i=bN();return(s,o)=>SN(void 0,void 0,void 0,function*(){var a;const l=(a=yield e())!==null&&a!==void 0?a:t;let c=new i(o==null?void 0:o.headers);return c.has("apikey")||c.set("apikey",t),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),r(s,Object.assign(Object.assign({},o),{headers:c}))})};var MN=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function l(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):i(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})};function CN(t){return t.endsWith("/")?t:t+"/"}function AN(t,e){var n,r;const{db:i,auth:s,realtime:o,global:a}=t,{db:l,auth:c,realtime:u,global:d}=e,h={db:Object.assign(Object.assign({},l),i),auth:Object.assign(Object.assign({},c),s),realtime:Object.assign(Object.assign({},u),o),global:Object.assign(Object.assign(Object.assign({},d),a),{headers:Object.assign(Object.assign({},(n=d==null?void 0:d.headers)!==null&&n!==void 0?n:{}),(r=a==null?void 0:a.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>MN(this,void 0,void 0,function*(){return""})};return t.accessToken?h.accessToken=t.accessToken:delete h.accessToken,h}const tE="2.71.1",ko=30*1e3,fm=3,ah=fm*ko,RN="http://localhost:9999",PN="supabase.auth.token",NN={"X-Client-Info":`gotrue-js/${tE}`},hm="X-Supabase-Api-Version",nE={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},IN=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,LN=10*60*1e3;class Av extends Error{constructor(e,n,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=r}}function Xe(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class DN extends Av{constructor(e,n,r){super(e,n,r),this.name="AuthApiError",this.status=n,this.code=r}}function UN(t){return Xe(t)&&t.name==="AuthApiError"}class rE extends Av{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class ps extends Av{constructor(e,n,r,i){super(e,r,i),this.name=n,this.status=r}}class Pi extends ps{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function kN(t){return Xe(t)&&t.name==="AuthSessionMissingError"}class Fc extends ps{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Bc extends ps{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class jc extends ps{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function ON(t){return Xe(t)&&t.name==="AuthImplicitGrantRedirectError"}class cy extends ps{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class pm extends ps{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function lh(t){return Xe(t)&&t.name==="AuthRetryableFetchError"}class uy extends ps{constructor(e,n,r){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=r}}class mm extends ps{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const md="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),dy=` 	
\r=`.split(""),FN=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<dy.length;e+=1)t[dy[e].charCodeAt(0)]=-2;for(let e=0;e<md.length;e+=1)t[md[e].charCodeAt(0)]=e;return t})();function fy(t,e,n){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(md[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(md[r]),e.queuedBits-=6}}function iE(t,e,n){const r=FN[t];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)n(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function hy(t){const e=[],n=o=>{e.push(String.fromCodePoint(o))},r={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},s=o=>{zN(o,r,n)};for(let o=0;o<t.length;o+=1)iE(t.charCodeAt(o),i,s);return e.join("")}function BN(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function jN(t,e){for(let n=0;n<t.length;n+=1){let r=t.charCodeAt(n);if(r>55295&&r<=56319){const i=(r-55296)*1024&65535;r=(t.charCodeAt(n+1)-56320&65535|i)+65536,n+=1}BN(r,e)}}function zN(t,e,n){if(e.utf8seq===0){if(t<=127){n(t);return}for(let r=1;r<6;r+=1)if(!(t>>7-r&1)){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&n(e.codepoint)}}function VN(t){const e=[],n={queue:0,queuedBits:0},r=i=>{e.push(i)};for(let i=0;i<t.length;i+=1)iE(t.charCodeAt(i),n,r);return new Uint8Array(e)}function HN(t){const e=[];return jN(t,n=>e.push(n)),new Uint8Array(e)}function GN(t){const e=[],n={queue:0,queuedBits:0},r=i=>{e.push(i)};return t.forEach(i=>fy(i,n,r)),fy(null,n,r),e.join("")}function WN(t){return Math.round(Date.now()/1e3)+t}function $N(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const fr=()=>typeof window<"u"&&typeof document<"u",bs={tested:!1,writable:!1},sE=()=>{if(!fr())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(bs.tested)return bs.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),bs.tested=!0,bs.writable=!0}catch{bs.tested=!0,bs.writable=!1}return bs.writable};function XN(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((i,s)=>{e[s]=i})}catch{}return n.searchParams.forEach((r,i)=>{e[i]=r}),e}const oE=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>lo(async()=>{const{default:r}=await Promise.resolve().then(()=>Oa);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},qN=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",Oo=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},Ts=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},Ei=async(t,e)=>{await t.removeItem(e)};class nf{constructor(){this.promise=new nf.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}nf.promiseConstructor=Promise;function ch(t){const e=t.split(".");if(e.length!==3)throw new mm("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!IN.test(e[r]))throw new mm("JWT not in base64url format");return{header:JSON.parse(hy(e[0])),payload:JSON.parse(hy(e[1])),signature:VN(e[2]),raw:{header:e[0],payload:e[1]}}}async function YN(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function KN(t,e){return new Promise((r,i)=>{(async()=>{for(let s=0;s<1/0;s++)try{const o=await t(s);if(!e(s,null,o)){r(o);return}}catch(o){if(!e(s,o)){i(o);return}}})()})}function JN(t){return("0"+t.toString(16)).substr(-2)}function ZN(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=n.length;let i="";for(let s=0;s<56;s++)i+=n.charAt(Math.floor(Math.random()*r));return i}return crypto.getRandomValues(e),Array.from(e,JN).join("")}async function QN(t){const n=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",n),i=new Uint8Array(r);return Array.from(i).map(s=>String.fromCharCode(s)).join("")}async function eI(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await QN(t);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function po(t,e,n=!1){const r=ZN();let i=r;n&&(i+="/PASSWORD_RECOVERY"),await Oo(t,`${e}-code-verifier`,i);const s=await eI(r);return[s,r===s?"plain":"s256"]}const tI=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function nI(t){const e=t.headers.get(hm);if(!e||!e.match(tI))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function rI(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function iI(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const sI=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function mo(t){if(!sI.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function uh(){const t={};return new Proxy(t,{get:(e,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const r=n.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function py(t){return JSON.parse(JSON.stringify(t))}var oI=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const Us=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),aI=[502,503,504];async function my(t){var e;if(!qN(t))throw new pm(Us(t),0);if(aI.includes(t.status))throw new pm(Us(t),t.status);let n;try{n=await t.json()}catch(s){throw new rE(Us(s),s)}let r;const i=nI(t);if(i&&i.getTime()>=nE["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?r=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(r=n.error_code),r){if(r==="weak_password")throw new uy(Us(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new Pi}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((s,o)=>s&&typeof o=="string",!0))throw new uy(Us(n),t.status,n.weak_password.reasons);throw new DN(Us(n),t.status||500,r)}const lI=(t,e,n,r)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),i.body=JSON.stringify(r),Object.assign(Object.assign({},i),n))};async function tt(t,e,n,r){var i;const s=Object.assign({},r==null?void 0:r.headers);s[hm]||(s[hm]=nE["2024-01-01"].name),r!=null&&r.jwt&&(s.Authorization=`Bearer ${r.jwt}`);const o=(i=r==null?void 0:r.query)!==null&&i!==void 0?i:{};r!=null&&r.redirectTo&&(o.redirect_to=r.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await cI(t,e,n+a,{headers:s,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(l):{data:Object.assign({},l),error:null}}async function cI(t,e,n,r,i,s){const o=lI(e,r,i,s);let a;try{a=await t(n,Object.assign({},o))}catch(l){throw console.error(l),new pm(Us(l),0)}if(a.ok||await my(a),r!=null&&r.noResolveJson)return a;try{return await a.json()}catch(l){await my(l)}}function Qr(t){var e;let n=null;hI(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=WN(t.expires_in)));const r=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:r},error:null}}function gy(t){const e=Qr(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,r)=>n&&typeof r=="string",!0)&&(e.data.weak_password=t.weak_password),e}function ji(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function uI(t){return{data:t,error:null}}function dI(t){const{action_link:e,email_otp:n,hashed_token:r,redirect_to:i,verification_type:s}=t,o=oI(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:n,hashed_token:r,redirect_to:i,verification_type:s},l=Object.assign({},o);return{data:{properties:a,user:l},error:null}}function fI(t){return t}function hI(t){return t.access_token&&t.refresh_token&&t.expires_in}const dh=["global","local","others"];var pI=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};class mI{constructor({url:e="",headers:n={},fetch:r}){this.url=e,this.headers=n,this.fetch=oE(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,n=dh[0]){if(dh.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${dh.join(", ")}`);try{return await tt(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Xe(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,n={}){try{return await tt(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:ji})}catch(r){if(Xe(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:n}=e,r=pI(e,["options"]),i=Object.assign(Object.assign({},r),n);return"newEmail"in r&&(i.new_email=r==null?void 0:r.newEmail,delete i.newEmail),await tt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:dI,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(Xe(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await tt(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:ji})}catch(n){if(Xe(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,r,i,s,o,a,l;try{const c={nextPage:null,lastPage:0,total:0},u=await tt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(s=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:fI});if(u.error)throw u.error;const d=await u.json(),h=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,m=(l=(a=u.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return m.length>0&&(m.forEach(x=>{const v=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(x.split(";")[1].split("=")[1]);c[`${g}Page`]=v}),c.total=parseInt(h)),{data:Object.assign(Object.assign({},d),c),error:null}}catch(c){if(Xe(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){mo(e);try{return await tt(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:ji})}catch(n){if(Xe(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){mo(e);try{return await tt(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:ji})}catch(r){if(Xe(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,n=!1){mo(e);try{return await tt(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:ji})}catch(r){if(Xe(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){mo(e.userId);try{const{data:n,error:r}=await tt(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:n,error:r}}catch(n){if(Xe(n))return{data:null,error:n};throw n}}async _deleteFactor(e){mo(e.userId),mo(e.id);try{return{data:await tt(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(Xe(n))return{data:null,error:n};throw n}}}function vy(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}function gI(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const go={debug:!!(globalThis&&sE()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class aE extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class vI extends aE{}async function xI(t,e,n){go.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),go.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async i=>{if(i){go.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,i.name);try{return await n()}finally{go.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,i.name)}}else{if(e===0)throw go.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new vI(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(go.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}gI();const yI={url:RN,storageKey:PN,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:NN,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function xy(t,e,n){return await n()}const vo={};class ql{constructor(e){var n,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=ql.nextInstanceID,ql.nextInstanceID+=1,this.instanceID>0&&fr()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},yI),e);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new mI({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=oE(i.fetch),this.lock=i.lock||xy,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:fr()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=xI:this.lock=xy,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:sE()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=vy(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=vy(this.memoryStorage)),fr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}get jwks(){var e,n;return(n=(e=vo[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(e){vo[this.storageKey]=Object.assign(Object.assign({},vo[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,n;return(n=(e=vo[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){vo[this.storageKey]=Object.assign(Object.assign({},vo[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${tE}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const n=XN(window.location.href);let r="none";if(this._isImplicitGrantCallback(n)?r="implicit":await this._isPKCECallback(n)&&(r="pkce"),fr()&&this.detectSessionInUrl&&r!=="none"){const{data:i,error:s}=await this._getSessionFromURL(n,r);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),ON(s)){const l=(e=s.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:o,redirectType:a}=i;return this._debug("#_initialize()","detected session in URL",o,"redirect type",a),await this._saveSession(o),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return Xe(n)?{error:n}:{error:new rE("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,r,i;try{const s=await tt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(i=e==null?void 0:e.options)===null||i===void 0?void 0:i.captchaToken}},xform:Qr}),{data:o,error:a}=s;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if(Xe(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(e){var n,r,i;try{let s;if("email"in e){const{email:u,password:d,options:h}=e;let m=null,x=null;this.flowType==="pkce"&&([m,x]=await po(this.storage,this.storageKey)),s=await tt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:u,password:d,data:(n=h==null?void 0:h.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:m,code_challenge_method:x},xform:Qr})}else if("phone"in e){const{phone:u,password:d,options:h}=e;s=await tt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:d,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},channel:(i=h==null?void 0:h.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:Qr})}else throw new Bc("You must provide either an email or phone number and a password");const{data:o,error:a}=s;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if(Xe(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(e){try{let n;if("email"in e){const{email:s,password:o,options:a}=e;n=await tt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:gy})}else if("phone"in e){const{phone:s,password:o,options:a}=e;n=await tt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:gy})}else throw new Bc("You must provide either an email or phone number and a password");const{data:r,error:i}=n;return i?{data:{user:null,session:null},error:i}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new Fc}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:i})}catch(n){if(Xe(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(e){var n,r,i,s;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(i=e.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(s=e.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:n}=e;if(n==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}async signInWithSolana(e){var n,r,i,s,o,a,l,c,u,d,h,m;let x,v;if("message"in e)x=e.message,v=e.signature;else{const{chain:g,wallet:p,statement:y,options:_}=e;let w;if(fr())if(typeof p=="object")w=p;else{const M=window;if("solana"in M&&typeof M.solana=="object"&&("signIn"in M.solana&&typeof M.solana.signIn=="function"||"signMessage"in M.solana&&typeof M.solana.signMessage=="function"))w=M.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof p!="object"||!(_!=null&&_.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=p}const E=new URL((n=_==null?void 0:_.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in w&&w.signIn){const M=await w.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},_==null?void 0:_.signInWithSolana),{version:"1",domain:E.host,uri:E.href}),y?{statement:y}:null));let T;if(Array.isArray(M)&&M[0]&&typeof M[0]=="object")T=M[0];else if(M&&typeof M=="object"&&"signedMessage"in M&&"signature"in M)T=M;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in T&&"signature"in T&&(typeof T.signedMessage=="string"||T.signedMessage instanceof Uint8Array)&&T.signature instanceof Uint8Array)x=typeof T.signedMessage=="string"?T.signedMessage:new TextDecoder().decode(T.signedMessage),v=T.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in w)||typeof w.signMessage!="function"||!("publicKey"in w)||typeof w!="object"||!w.publicKey||!("toBase58"in w.publicKey)||typeof w.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");x=[`${E.host} wants you to sign in with your Solana account:`,w.publicKey.toBase58(),...y?["",y,""]:[""],"Version: 1",`URI: ${E.href}`,`Issued At: ${(i=(r=_==null?void 0:_.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((s=_==null?void 0:_.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${_.signInWithSolana.notBefore}`]:[],...!((o=_==null?void 0:_.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${_.signInWithSolana.expirationTime}`]:[],...!((a=_==null?void 0:_.signInWithSolana)===null||a===void 0)&&a.chainId?[`Chain ID: ${_.signInWithSolana.chainId}`]:[],...!((l=_==null?void 0:_.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${_.signInWithSolana.nonce}`]:[],...!((c=_==null?void 0:_.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${_.signInWithSolana.requestId}`]:[],...!((d=(u=_==null?void 0:_.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||d===void 0)&&d.length?["Resources",..._.signInWithSolana.resources.map(T=>`- ${T}`)]:[]].join(`
`);const M=await w.signMessage(new TextEncoder().encode(x),"utf8");if(!M||!(M instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");v=M}}try{const{data:g,error:p}=await tt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:x,signature:GN(v)},!((h=e.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(m=e.options)===null||m===void 0?void 0:m.captchaToken}}:null),xform:Qr});if(p)throw p;return!g||!g.session||!g.user?{data:{user:null,session:null},error:new Fc}:(g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),{data:Object.assign({},g),error:p})}catch(g){if(Xe(g))return{data:{user:null,session:null},error:g};throw g}}async _exchangeCodeForSession(e){const n=await Ts(this.storage,`${this.storageKey}-code-verifier`),[r,i]=(n??"").split("/");try{const{data:s,error:o}=await tt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:Qr});if(await Ei(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new Fc}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:i??null}),error:o})}catch(s){if(Xe(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(e){try{const{options:n,provider:r,token:i,access_token:s,nonce:o}=e,a=await tt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:i,access_token:s,nonce:o,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:Qr}),{data:l,error:c}=a;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new Fc}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(n){if(Xe(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(e){var n,r,i,s,o;try{if("email"in e){const{email:a,options:l}=e;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await po(this.storage,this.storageKey));const{error:d}=await tt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(n=l==null?void 0:l.data)!==null&&n!==void 0?n:{},create_user:(r=l==null?void 0:l.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:d}}if("phone"in e){const{phone:a,options:l}=e,{data:c,error:u}=await tt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(i=l==null?void 0:l.data)!==null&&i!==void 0?i:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(o=l==null?void 0:l.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u}}throw new Bc("You must provide either an email or phone number.")}catch(a){if(Xe(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var n,r;try{let i,s;"options"in e&&(i=(n=e.options)===null||n===void 0?void 0:n.redirectTo,s=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:o,error:a}=await tt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:i,xform:Qr});if(a)throw a;if(!o)throw new Error("An error occurred on token verification.");const l=o.session,c=o.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(Xe(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(e){var n,r,i;try{let s=null,o=null;return this.flowType==="pkce"&&([s,o]=await po(this.storage,this.storageKey)),await tt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&r!==void 0?r:void 0}),!((i=e==null?void 0:e.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:o}),headers:this.headers,xform:uI})}catch(s){if(Xe(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:r}=e;if(r)throw r;if(!n)throw new Pi;const{error:i}=await tt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:i}})}catch(e){if(Xe(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:r,type:i,options:s}=e,{error:o}=await tt(this.fetch,"POST",n,{headers:this.headers,body:{email:r,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:r,type:i,options:s}=e,{data:o,error:a}=await tt(this.fetch,"POST",n,{headers:this.headers,body:{phone:r,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:a}}throw new Bc("You must provide either an email or phone number and a type")}catch(n){if(Xe(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await r,await n()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=n();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await Ts(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<ah:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const o=await Ts(this.userStorage,this.storageKey+"-user");o!=null&&o.user?e.user=o.user:e.user=uh()}if(this.storage.isServer&&e.user){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,c,u)=>(!o&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,u))})}return{data:{session:e},error:null}}const{session:i,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{session:null},error:s}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await tt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:ji}):await this._useSession(async n=>{var r,i,s;const{data:o,error:a}=n;if(a)throw a;return!(!((r=o.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Pi}:await tt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(i=o.session)===null||i===void 0?void 0:i.access_token)!==null&&s!==void 0?s:void 0,xform:ji})})}catch(n){if(Xe(n))return kN(n)&&(await this._removeSession(),await Ei(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async r=>{const{data:i,error:s}=r;if(s)throw s;if(!i.session)throw new Pi;const o=i.session;let a=null,l=null;this.flowType==="pkce"&&e.email!=null&&([a,l]=await po(this.storage,this.storageKey));const{data:c,error:u}=await tt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:l}),jwt:o.access_token,xform:ji});if(u)throw u;return o.user=c.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(r){if(Xe(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Pi;const n=Date.now()/1e3;let r=n,i=!0,s=null;const{payload:o}=ch(e.access_token);if(o.exp&&(r=o.exp,i=r<=n),i){const{session:a,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!a)return{data:{user:null,session:null},error:null};s=a}else{const{data:a,error:l}=await this._getUser(e.access_token);if(l)throw l;s={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:r-n,expires_at:r},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(n){if(Xe(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var r;if(!e){const{data:o,error:a}=n;if(a)throw a;e=(r=o.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new Pi;const{session:i,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{user:null,session:null},error:s}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(Xe(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(e,n){try{if(!fr())throw new jc("No browser detected.");if(e.error||e.error_description||e.error_code)throw new jc(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new cy("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new jc("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new cy("No code detected.");const{data:y,error:_}=await this._exchangeCodeForSession(e.code);if(_)throw _;const w=new URL(window.location.href);return w.searchParams.delete("code"),window.history.replaceState(window.history.state,"",w.toString()),{data:{session:y.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:i,access_token:s,refresh_token:o,expires_in:a,expires_at:l,token_type:c}=e;if(!s||!a||!o||!c)throw new jc("No session defined in URL");const u=Math.round(Date.now()/1e3),d=parseInt(a);let h=u+d;l&&(h=parseInt(l));const m=h-u;m*1e3<=ko&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${d}s`);const x=h-d;u-x>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",x,h,u):u-x<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",x,h,u);const{data:v,error:g}=await this._getUser(s);if(g)throw g;const p={provider_token:r,provider_refresh_token:i,access_token:s,expires_in:d,expires_at:h,refresh_token:o,token_type:c,user:v.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:p,redirectType:e.type},error:null}}catch(r){if(Xe(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await Ts(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var r;const{data:i,error:s}=n;if(s)return{error:s};const o=(r=i.session)===null||r===void 0?void 0:r.access_token;if(o){const{error:a}=await this.admin.signOut(o,e);if(a&&!(UN(a)&&(a.status===404||a.status===401||a.status===403)))return{error:a}}return e!=="others"&&(await this._removeSession(),await Ei(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const n=$N(),r={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async n=>{var r,i;try{const{data:{session:s},error:o}=n;if(o)throw o;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(s){await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",s),console.error(s)}})}async resetPasswordForEmail(e,n={}){let r=null,i=null;this.flowType==="pkce"&&([r,i]=await po(this.storage,this.storageKey,!0));try{return await tt(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:i,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(s){if(Xe(s))return{data:null,error:s};throw s}}async getUserIdentities(){var e;try{const{data:n,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(n){if(Xe(n))return{data:null,error:n};throw n}}async linkIdentity(e){var n;try{const{data:r,error:i}=await this._useSession(async s=>{var o,a,l,c,u;const{data:d,error:h}=s;if(h)throw h;const m=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await tt(this.fetch,"GET",m,{headers:this.headers,jwt:(u=(c=d.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(i)throw i;return fr()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(Xe(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async n=>{var r,i;const{data:s,error:o}=n;if(o)throw o;return await tt(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(i=(r=s.session)===null||r===void 0?void 0:r.access_token)!==null&&i!==void 0?i:void 0})})}catch(n){if(Xe(n))return{data:null,error:n};throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const r=Date.now();return await KN(async i=>(i>0&&await YN(200*Math.pow(2,i-1)),this._debug(n,"refreshing attempt",i),await tt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Qr})),(i,s)=>{const o=200*Math.pow(2,i);return s&&lh(s)&&Date.now()+o-r<ko})}catch(r){if(this._debug(n,"error",r),Xe(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",r),fr()&&!n.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,n;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const i=await Ts(this.storage,this.storageKey);if(i&&this.userStorage){let o=await Ts(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:i.user},await Oo(this.userStorage,this.storageKey+"-user",o)),i.user=(e=o==null?void 0:o.user)!==null&&e!==void 0?e:uh()}else if(i&&!i.user&&!i.user){const o=await Ts(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(i.user=o.user,await Ei(this.storage,this.storageKey+"-user"),await Oo(this.storage,this.storageKey,i)):i.user=uh()}if(this._debug(r,"session from storage",i),!this._isValidSession(i)){this._debug(r,"session is not valid"),i!==null&&await this._removeSession();return}const s=((n=i.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<ah;if(this._debug(r,`session has${s?"":" not"} expired with margin of ${ah}s`),s){if(this.autoRefreshToken&&i.refresh_token){const{error:o}=await this._callRefreshToken(i.refresh_token);o&&(console.error(o),lh(o)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:a}=await this._getUser(i.access_token);!a&&(o!=null&&o.user)?(i.user=o.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(r,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(r,"error",i),console.error(i);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var n,r;if(!e)throw new Pi;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new nf;const{data:s,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!s.session)throw new Pi;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const a={session:s.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(s){if(this._debug(i,"error",s),Xe(s)){const o={session:null,error:s};return lh(s)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(o),o}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(s),s}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,n,r=!0){const i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",n,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:n});const s=[],o=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,n)}catch(l){s.push(l)}});if(await Promise.all(o),s.length>0){for(let a=0;a<s.length;a+=1)console.error(s[a]);throw s[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const n=Object.assign({},e),r=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&n.user&&await Oo(this.userStorage,this.storageKey+"-user",{user:n.user});const i=Object.assign({},n);delete i.user;const s=py(i);await Oo(this.storage,this.storageKey,s)}else{const i=py(n);await Oo(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),await Ei(this.storage,this.storageKey),await Ei(this.storage,this.storageKey+"-code-verifier"),await Ei(this.storage,this.storageKey+"-user"),this.userStorage&&await Ei(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&fr()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),ko);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:r}}=n;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((r.expires_at*1e3-e)/ko);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${ko}ms, refresh threshold is ${fm} ticks`),i<=fm&&await this._callRefreshToken(r.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof aE)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!fr()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,r){const i=[`provider=${encodeURIComponent(n)}`];if(r!=null&&r.redirectTo&&i.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&i.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[s,o]=await po(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(o)}`});i.push(a.toString())}if(r!=null&&r.queryParams){const s=new URLSearchParams(r.queryParams);i.push(s.toString())}return r!=null&&r.skipBrowserRedirect&&i.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var r;const{data:i,error:s}=n;return s?{data:null,error:s}:await tt(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(Xe(n))return{data:null,error:n};throw n}}async _enroll(e){try{return await this._useSession(async n=>{var r,i;const{data:s,error:o}=n;if(o)return{data:null,error:o};const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:c}=await tt(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});return c?{data:null,error:c}:(e.factorType==="totp"&&(!((i=l==null?void 0:l.totp)===null||i===void 0)&&i.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(n){if(Xe(n))return{data:null,error:n};throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:i,error:s}=n;if(s)return{data:null,error:s};const{data:o,error:a}=await tt(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:a})})}catch(n){if(Xe(n))return{data:null,error:n};throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:i,error:s}=n;return s?{data:null,error:s}:await tt(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(Xe(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(e){const{data:n,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){const{data:{user:e},error:n}=await this.getUser();if(n)return{data:null,error:n};const r=(e==null?void 0:e.factors)||[],i=r.filter(o=>o.factor_type==="totp"&&o.status==="verified"),s=r.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:r,totp:i,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var n,r;const{data:{session:i},error:s}=e;if(s)return{data:null,error:s};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=ch(i.access_token);let a=null;o.aal&&(a=o.aal);let l=a;((r=(n=i.user.factors)===null||n===void 0?void 0:n.filter(d=>d.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const u=o.amr||[];return{data:{currentLevel:a,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(e,n={keys:[]}){let r=n.keys.find(a=>a.kid===e);if(r)return r;const i=Date.now();if(r=this.jwks.keys.find(a=>a.kid===e),r&&this.jwks_cached_at+LN>i)return r;const{data:s,error:o}=await tt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=i,r=s.keys.find(a=>a.kid===e),!r)?null:r}async getClaims(e,n={}){try{let r=e;if(!r){const{data:m,error:x}=await this.getSession();if(x||!m.session)return{data:null,error:x};r=m.session.access_token}const{header:i,payload:s,signature:o,raw:{header:a,payload:l}}=ch(r);n!=null&&n.allowExpired||rI(s.exp);const c=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,n!=null&&n.keys?{keys:n.keys}:n==null?void 0:n.jwks);if(!c){const{error:m}=await this.getUser(r);if(m)throw m;return{data:{claims:s,header:i,signature:o},error:null}}const u=iI(i.alg),d=await crypto.subtle.importKey("jwk",c,u,!0,["verify"]);if(!await crypto.subtle.verify(u,d,o,HN(`${a}.${l}`)))throw new mm("Invalid JWT signature");return{data:{claims:s,header:i,signature:o},error:null}}catch(r){if(Xe(r))return{data:null,error:r};throw r}}}ql.nextInstanceID=0;const _I=ql;class wI extends _I{constructor(e){super(e)}}var SI=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function l(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):i(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})};class EI{constructor(e,n,r){var i,s,o;if(this.supabaseUrl=e,this.supabaseKey=n,!e)throw new Error("supabaseUrl is required.");if(!n)throw new Error("supabaseKey is required.");const a=CN(e),l=new URL(a);this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,u={db:yN,realtime:wN,auth:Object.assign(Object.assign({},_N),{storageKey:c}),global:xN},d=AN(r??{},u);this.storageKey=(i=d.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(s=d.global.headers)!==null&&s!==void 0?s:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(h,m)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(m)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=d.auth)!==null&&o!==void 0?o:{},this.headers,d.global.fetch),this.fetch=TN(n,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.rest=new zP(new URL("rest/v1",l).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),d.accessToken||this._listenForAuthEvents()}get functions(){return new vP(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new mN(this.storageUrl.href,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,n={},r={}){return this.rest.rpc(e,n,r)}channel(e,n={config:{}}){return this.realtime.channel(e,n)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,n;return SI(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(n=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&n!==void 0?n:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:i,storageKey:s,flowType:o,lock:a,debug:l},c,u){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new wI({url:this.authUrl.href,headers:Object.assign(Object.assign({},d),c),storageKey:s,autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:i,flowType:o,lock:a,debug:l,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new nN(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,r)=>{this._handleTokenChanged(n,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,n,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const bI=(t,e,n)=>new EI(t,e,n);function TI(){if(typeof window<"u"||typeof process>"u"||process.version===void 0||process.version===null)return!1;const t=process.version.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}TI()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const MI="https://oodqharaqstrbfoqjgfh.supabase.co",CI="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9vZHFoYXJhcXN0cmJmb3FqZ2ZoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTM1NTQ4MzgsImV4cCI6MjA2OTEzMDgzOH0.LioBvZCb4FxXPQDm--tXZcsF4dDAWiq7IpbtGabJYVI",jt=bI(MI,CI,{auth:{storage:localStorage,persistSession:!0,autoRefreshToken:!0}});Array(12).fill(0);mt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},mt.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"}));mt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},mt.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"}));mt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},mt.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"}));mt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},mt.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"}));var gm=1,AI=class{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{let e=this.subscribers.indexOf(t);this.subscribers.splice(e,1)}),this.publish=t=>{this.subscribers.forEach(e=>e(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var e;let{message:n,...r}=t,i=typeof(t==null?void 0:t.id)=="number"||((e=t.id)==null?void 0:e.length)>0?t.id:gm++,s=this.toasts.find(a=>a.id===i),o=t.dismissible===void 0?!0:t.dismissible;return s?this.toasts=this.toasts.map(a=>a.id===i?(this.publish({...a,...t,id:i,title:n}),{...a,...t,id:i,dismissible:o,title:n}):a):this.addToast({title:n,...r,dismissible:o,id:i}),i},this.dismiss=t=>(t||this.toasts.forEach(e=>{this.subscribers.forEach(n=>n({id:e.id,dismiss:!0}))}),this.subscribers.forEach(e=>e({id:t,dismiss:!0})),t),this.message=(t,e)=>this.create({...e,message:t}),this.error=(t,e)=>this.create({...e,message:t,type:"error"}),this.success=(t,e)=>this.create({...e,type:"success",message:t}),this.info=(t,e)=>this.create({...e,type:"info",message:t}),this.warning=(t,e)=>this.create({...e,type:"warning",message:t}),this.loading=(t,e)=>this.create({...e,type:"loading",message:t}),this.promise=(t,e)=>{if(!e)return;let n;e.loading!==void 0&&(n=this.create({...e,promise:t,type:"loading",message:e.loading,description:typeof e.description!="function"?e.description:void 0}));let r=t instanceof Promise?t:t(),i=n!==void 0;return r.then(async s=>{if(PI(s)&&!s.ok){i=!1;let o=typeof e.error=="function"?await e.error(`HTTP error! status: ${s.status}`):e.error,a=typeof e.description=="function"?await e.description(`HTTP error! status: ${s.status}`):e.description;this.create({id:n,type:"error",message:o,description:a})}else if(e.success!==void 0){i=!1;let o=typeof e.success=="function"?await e.success(s):e.success,a=typeof e.description=="function"?await e.description(s):e.description;this.create({id:n,type:"success",message:o,description:a})}}).catch(async s=>{if(e.error!==void 0){i=!1;let o=typeof e.error=="function"?await e.error(s):e.error,a=typeof e.description=="function"?await e.description(s):e.description;this.create({id:n,type:"error",message:o,description:a})}}).finally(()=>{var s;i&&(this.dismiss(n),n=void 0),(s=e.finally)==null||s.call(e)}),n},this.custom=(t,e)=>{let n=(e==null?void 0:e.id)||gm++;return this.create({jsx:t(n),id:n,...e}),n},this.subscribers=[],this.toasts=[]}},hr=new AI,RI=(t,e)=>{let n=(e==null?void 0:e.id)||gm++;return hr.addToast({title:t,...e,id:n}),n},PI=t=>t&&typeof t=="object"&&"ok"in t&&typeof t.ok=="boolean"&&"status"in t&&typeof t.status=="number",NI=RI,II=()=>hr.toasts,Ft=Object.assign(NI,{success:hr.success,info:hr.info,warning:hr.warning,error:hr.error,custom:hr.custom,message:hr.message,promise:hr.promise,dismiss:hr.dismiss,loading:hr.loading},{getHistory:II});function LI(t,{insertAt:e}={}){if(typeof document>"u")return;let n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",e==="top"&&n.firstChild?n.insertBefore(r,n.firstChild):n.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}LI(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999}:where([data-sonner-toaster][data-x-position="right"]){right:max(var(--offset),env(safe-area-inset-right))}:where([data-sonner-toaster][data-x-position="left"]){left:max(var(--offset),env(safe-area-inset-left))}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:max(var(--offset),env(safe-area-inset-top))}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:max(var(--offset),env(safe-area-inset-bottom))}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;background:var(--gray1);color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:0;right:0;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount, 0px));transition:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation:swipe-out .2s ease-out forwards}@keyframes swipe-out{0%{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount)));opacity:1}to{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount) + var(--lift) * -100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;--mobile-offset: 16px;right:var(--mobile-offset);left:var(--mobile-offset);width:100%}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset)}[data-sonner-toaster][data-y-position=bottom]{bottom:20px}[data-sonner-toaster][data-y-position=top]{top:20px}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset);right:var(--mobile-offset);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);const DI=1,UI=1e6;let fh=0;function kI(){return fh=(fh+1)%Number.MAX_SAFE_INTEGER,fh.toString()}const hh=new Map,yy=t=>{if(hh.has(t))return;const e=setTimeout(()=>{hh.delete(t),Cl({type:"REMOVE_TOAST",toastId:t})},UI);hh.set(t,e)},OI=(t,e)=>{switch(e.type){case"ADD_TOAST":return{...t,toasts:[e.toast,...t.toasts].slice(0,DI)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(n=>n.id===e.toast.id?{...n,...e.toast}:n)};case"DISMISS_TOAST":{const{toastId:n}=e;return n?yy(n):t.toasts.forEach(r=>{yy(r.id)}),{...t,toasts:t.toasts.map(r=>r.id===n||n===void 0?{...r,open:!1}:r)}}case"REMOVE_TOAST":return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(n=>n.id!==e.toastId)}}},Ru=[];let Pu={toasts:[]};function Cl(t){Pu=OI(Pu,t),Ru.forEach(e=>{e(Pu)})}function FI({...t}){const e=kI(),n=i=>Cl({type:"UPDATE_TOAST",toast:{...i,id:e}}),r=()=>Cl({type:"DISMISS_TOAST",toastId:e});return Cl({type:"ADD_TOAST",toast:{...t,id:e,open:!0,onOpenChange:i=>{i||r()}}}),{id:e,dismiss:r,update:n}}function Rv(){const[t,e]=S.useState(Pu);return S.useEffect(()=>(Ru.push(e),()=>{const n=Ru.indexOf(e);n>-1&&Ru.splice(n,1)}),[t]),{...t,toast:FI,dismiss:n=>Cl({type:"DISMISS_TOAST",toastId:n})}}const gd=({uploadId:t,initialUpvotes:e=0,compact:n=!1})=>{const{toast:r}=Rv(),[i,s]=S.useState(e),[o,a]=S.useState(null),[l,c]=S.useState(!1),u=async()=>{try{const{getOrCreateSecureUserId:x}=await lo(async()=>{const{getOrCreateSecureUserId:v}=await import("./secureIpUtils-D_zoJ5B5.js");return{getOrCreateSecureUserId:v}},[]);return x()}catch{let x=localStorage.getItem("pixperiment_user_id");return x||(x=`user_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,localStorage.setItem("pixperiment_user_id",x)),x}},d=async()=>{try{const{data:x,error:v}=await jt.functions.invoke("get-uploads",{body:{limit:1e3}});if(v){s(0);return}const p=(x.uploads||[]).find(y=>y.id===t);s((p==null?void 0:p.upvotes)||0)}catch(x){console.error("Error fetching upvotes:",x),s(0)}},h=async()=>{a(null)};S.useEffect(()=>{d(),h()},[t]);const m=async()=>{if(!l){c(!0);try{const x=await u(),{data:v,error:g}=await jt.functions.invoke("create-like",{body:{uploadId:t,userIP:x}});if(g){console.error("Vote function error:",g),r({title:"Vote Error",description:g.message||"Failed to process vote. Please try again.",variant:"destructive",duration:4e3});return}(v==null?void 0:v.action)==="created"?a(!0):(v==null?void 0:v.action)==="removed"&&a(!1),await d(),r({title:"Success",description:`Vote ${(v==null?void 0:v.action)||"recorded"} successfully!`,duration:2e3})}catch(x){console.error("Error voting:",x),r({title:"Vote Error",description:x instanceof Error?x.message:"Failed to process vote. Please try again.",variant:"destructive",duration:4e3})}finally{c(!1)}}};return n?f.jsx("div",{className:"flex flex-col gap-1",children:f.jsxs(Ze,{variant:o?"default":"outline",size:"sm",onClick:m,disabled:l,className:"flex items-center gap-1 text-xs h-7 px-2 bg-green-500/10 hover:bg-green-500/20 border-green-500/20 text-green-700 dark:text-green-400",children:[f.jsx(im,{className:"w-3 h-3"}),f.jsx("span",{children:i})]})}):f.jsx("div",{className:"space-y-3 w-full",children:f.jsx("div",{className:"flex gap-2 w-full",children:f.jsxs(Ze,{variant:o?"default":"outline",size:"sm",onClick:m,disabled:l,className:"flex items-center gap-2 flex-1 justify-center bg-green-500/10 hover:bg-green-500/20 border-green-500/20 text-green-700 dark:text-green-400",children:[f.jsx(im,{className:"w-4 h-4"}),f.jsxs("span",{className:"text-sm",children:["Upvote (",i,")"]})]})})})},li=({end:t,duration:e=2e3,start:n=0,decimals:r=2,prefix:i="",suffix:s="",className:o="",onComplete:a,onUpdate:l})=>{const[c,u]=S.useState(0),[d,h]=S.useState(!1),m=S.useRef(),x=S.useRef(),v=S.useRef(0);S.useEffect(()=>{if(t===v.current)return;h(!0),v.current=0,x.current=performance.now();const p=y=>{if(!x.current)return;const _=y-x.current,w=Math.min(_/e,1),E=1-Math.pow(1-w,3),M=0+(t-0)*E;u(M),l==null||l(M),w<1?m.current=requestAnimationFrame(p):(u(t),h(!1),a==null||a())};return m.current=requestAnimationFrame(p),()=>{m.current&&cancelAnimationFrame(m.current)}},[t,e,a,l]);const g=p=>p.toFixed(r);return f.jsxs("span",{className:o,children:[i,g(c),s]})},BI=({refreshTrigger:t})=>{const e=hs(),[n,r]=S.useState(null);S.useEffect(()=>{i()},[t]);const i=async()=>{try{const{data:c,error:u}=await jt.functions.invoke("get-uploads",{body:{limit:1,sortBy:"date",sortOrder:"desc"}});if(u){console.error("Error fetching current upload:",u);return}const d=c.uploads||[];d.length>0?r(d[0]):r(null)}catch(c){console.error("Error:",c)}},s=c=>new Date(c).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0}),o=c=>{if(!c||c.length<3)return"Anonymous";const[u,d]=c.split("@");return!u||!d?"Anonymous":u.length<=2?`${u}***`:`${u.substring(0,2)}${"*".repeat(Math.max(u.length-2,3))}`},a=()=>{n&&e(`/post/${n.id}`)},l=()=>{if(!n)return;const c=`${window.location.origin}/post/${n.id}`;navigator.clipboard.writeText(c),Ft.success("Link copied to clipboard!")};return n?f.jsx(_t,{className:"glass-card experiment-glow border-primary/20 mb-4 sm:mb-8",children:f.jsxs(Lt,{className:"p-2 sm:p-3 md:p-6",children:[f.jsxs("div",{className:"mb-2 sm:mb-3 md:mb-4 flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[f.jsx(Hx,{className:"w-4 h-4 sm:w-5 sm:h-5 text-yellow-500"}),f.jsx("h2",{className:"text-base sm:text-lg md:text-xl font-bold gradient-text",children:"Featured Upload"})]}),f.jsx(ns,{variant:"outline",className:"bg-primary/10 text-primary border-primary/20 text-xs",children:"Latest Upload"})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-3 sm:gap-6",children:[f.jsxs("div",{className:"md:col-span-3 space-y-2 sm:space-y-3",children:[f.jsxs("div",{className:"flex gap-3 items-start",children:[f.jsxs("div",{className:"relative inline-block flex-1 max-w-sm sm:max-w-md mx-auto md:mx-0",children:[f.jsx("div",{className:"w-full h-64 sm:h-80 md:h-96 rounded-xl overflow-hidden",children:f.jsx("img",{src:n.image_url,alt:n.caption,className:"w-full h-full object-cover",onError:c=>{c.currentTarget.src="data:image/svg+xml;base64,"+btoa(`
                        <svg width="400" height="300" xmlns="http://www.w3.org/2000/svg">
                          <rect width="400" height="300" fill="#f3f4f6"/>
                          <text x="200" y="150" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" fill="#6b7280">
                            Featured Upload
                          </text>
                        </svg>
                      `)}})}),f.jsx("div",{className:"absolute top-0 left-0 z-20",children:f.jsxs(ns,{variant:"secondary",className:"font-semibold bg-yellow-500/95 text-yellow-900 border-yellow-500/60 shadow-xl backdrop-blur-sm rounded-tl-2xl rounded-br-lg",children:["#",n.upload_order]})})]}),f.jsxs("div",{className:"md:hidden flex-shrink-0 flex flex-col gap-3 mt-4",children:[f.jsx(gd,{uploadId:n.id,compact:!0}),f.jsxs("div",{className:"flex flex-col gap-2",children:[f.jsxs(Ze,{onClick:a,variant:"outline",size:"sm",className:"text-xs",children:[f.jsx(Gx,{className:"w-3 h-3 mr-1"}),"View Post"]}),f.jsxs(Ze,{onClick:l,variant:"outline",size:"sm",className:"text-xs",children:[f.jsx(ra,{className:"w-3 h-3 mr-1"}),"Share"]})]})]})]}),f.jsxs("div",{className:"md:hidden flex gap-1 justify-between text-xs",children:[f.jsxs("div",{className:"flex-1 bg-primary/5 border border-primary/10 rounded-lg px-2 py-1.5 text-center",children:[f.jsx("div",{className:"font-medium text-primary",children:f.jsx(li,{end:n.price_paid/100,duration:1500,prefix:"$",decimals:2,className:"font-bold"})}),f.jsx("div",{className:"text-xs text-muted-foreground",children:"Paid"})]}),f.jsxs("div",{className:"flex-1 bg-primary/5 border border-primary/10 rounded-lg px-2 py-1.5 text-center",children:[f.jsx("div",{className:"font-medium text-primary",children:new Date(n.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric"})}),f.jsx("div",{className:"text-xs text-muted-foreground",children:"Date"})]}),f.jsxs("div",{className:"flex-1 bg-primary/5 border border-primary/10 rounded-lg px-2 py-1.5 text-center",children:[f.jsx("div",{className:"font-medium text-primary truncate",children:n.user_email.split("@")[0]}),f.jsx("div",{className:"text-xs text-muted-foreground",children:"User"})]})]}),f.jsxs("div",{className:"hidden md:flex gap-2",children:[f.jsxs(Ze,{onClick:a,variant:"outline",size:"sm",className:"flex-1",children:[f.jsx(Gx,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1 sm:mr-2"}),f.jsx("span",{className:"text-xs sm:text-sm",children:"View Post"})]}),f.jsxs(Ze,{onClick:l,variant:"outline",size:"sm",className:"flex-1",children:[f.jsx(ra,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1 sm:mr-2"}),f.jsx("span",{className:"text-xs sm:text-sm",children:"Share"})]})]}),f.jsx("div",{className:"space-y-2",children:f.jsx("div",{children:f.jsxs("p",{className:"text-sm sm:text-base font-medium break-words leading-relaxed",children:['"',n.caption,'"']})})})]}),f.jsx("div",{className:"hidden md:block md:col-span-2 space-y-3 sm:space-y-4",children:f.jsxs("div",{className:"glass-card p-3 sm:p-4",children:[f.jsx("h3",{className:"text-sm font-medium mb-3 text-center",children:"Community Rating"}),f.jsx(gd,{uploadId:n.id}),f.jsx("div",{className:"mt-4 pt-4 border-t border-border space-y-3",children:f.jsxs("div",{className:"grid grid-cols-1 gap-3 text-sm",children:[f.jsxs("div",{className:"glass-card p-3",children:[f.jsx("p",{className:"text-muted-foreground text-xs",children:"Price Paid"}),f.jsx("p",{className:"text-lg font-bold text-primary price-ticker",children:f.jsx(li,{end:n.price_paid/100,duration:1500,prefix:"$",decimals:2,className:"text-2xl font-bold text-green-500"})})]}),f.jsxs("div",{className:"glass-card p-3",children:[f.jsx("p",{className:"text-muted-foreground text-xs",children:"Uploaded"}),f.jsx("p",{className:"font-medium text-sm",children:s(n.created_at)})]}),f.jsxs("div",{className:"glass-card p-3",children:[f.jsx("p",{className:"text-muted-foreground text-xs",children:"Owner"}),f.jsx("p",{className:"font-medium text-sm",children:o(n.user_email)})]})]})})]})})]}),f.jsxs("div",{className:"mt-4 p-3 bg-gradient-to-r from-purple-900/20 to-purple-800/20 border border-purple-600/30 rounded-lg shadow-lg relative overflow-hidden cursor-pointer group",onClick:()=>{const c=document.getElementById("upload-section");c==null||c.scrollIntoView({behavior:"smooth"})},children:[f.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-purple-500/10 to-purple-600/10 animate-[pulse_4s_ease-in-out_infinite]"}),f.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-purple-400/5 to-purple-600/5 animate-[pulse_3s_ease-in-out_infinite_reverse] opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),f.jsxs("p",{className:"text-sm text-purple-200 text-center font-medium relative z-10",children:["🌟 ",f.jsx("strong",{children:"Want your post here?"})," This photo claimed the featured space by paying ",f.jsx(li,{end:n.price_paid/100,duration:1500,prefix:"$",decimals:2,className:"text-green-500 font-bold"}),".",f.jsx("span",{className:"block mt-1 text-purple-300 text-xs relative",children:f.jsx("span",{className:"inline-block animate-[pulse_4s_ease-in-out_infinite] brightness-110 hover:brightness-125 transition-all duration-300",children:"Upload yours to take over! 👑"})})]})]})]})}):f.jsx(_t,{className:"glass-card mb-8",children:f.jsx(Lt,{className:"p-8 text-center",children:f.jsxs("div",{className:"mb-4",children:[f.jsx(Hx,{className:"w-16 h-16 mx-auto text-muted-foreground mb-4"}),f.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Become the First!"}),f.jsx("p",{className:"text-muted-foreground",children:"No one has claimed this space yet. Upload the first photo and own the website!"})]})})})};function jI(t,e=[]){let n=[];function r(s,o){const a=S.createContext(o),l=n.length;n=[...n,o];function c(d){const{scope:h,children:m,...x}=d,v=(h==null?void 0:h[t][l])||a,g=S.useMemo(()=>x,Object.values(x));return f.jsx(v.Provider,{value:g,children:m})}function u(d,h){const m=(h==null?void 0:h[t][l])||a,x=S.useContext(m);if(x)return x;if(o!==void 0)return o;throw new Error(`\`${d}\` must be used within \`${s}\``)}return c.displayName=s+"Provider",[c,u]}const i=()=>{const s=n.map(o=>S.createContext(o));return function(a){const l=(a==null?void 0:a[t])||s;return S.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return i.scopeName=t,[r,zI(i,...e)]}function zI(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(s){const o=r.reduce((a,{useScope:l,scopeName:c})=>{const d=l(s)[`__scope${c}`];return{...a,...d}},{});return S.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}var VI=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],lt=VI.reduce((t,e)=>{const n=S.forwardRef((r,i)=>{const{asChild:s,...o}=r,a=s?va:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(a,{...o,ref:i})});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{});function HI(t,e){t&&Da.flushSync(()=>t.dispatchEvent(e))}var Pv="Progress",Nv=100,[GI,TV]=jI(Pv),[WI,$I]=GI(Pv),lE=S.forwardRef((t,e)=>{const{__scopeProgress:n,value:r=null,max:i,getValueLabel:s=XI,...o}=t;(i||i===0)&&!_y(i)&&console.error(qI(`${i}`,"Progress"));const a=_y(i)?i:Nv;r!==null&&!wy(r,a)&&console.error(YI(`${r}`,"Progress"));const l=wy(r,a)?r:null,c=vd(l)?s(l,a):void 0;return f.jsx(WI,{scope:n,value:l,max:a,children:f.jsx(lt.div,{"aria-valuemax":a,"aria-valuemin":0,"aria-valuenow":vd(l)?l:void 0,"aria-valuetext":c,role:"progressbar","data-state":dE(l,a),"data-value":l??void 0,"data-max":a,...o,ref:e})})});lE.displayName=Pv;var cE="ProgressIndicator",uE=S.forwardRef((t,e)=>{const{__scopeProgress:n,...r}=t,i=$I(cE,n);return f.jsx(lt.div,{"data-state":dE(i.value,i.max),"data-value":i.value??void 0,"data-max":i.max,...r,ref:e})});uE.displayName=cE;function XI(t,e){return`${Math.round(t/e*100)}%`}function dE(t,e){return t==null?"indeterminate":t===e?"complete":"loading"}function vd(t){return typeof t=="number"}function _y(t){return vd(t)&&!isNaN(t)&&t>0}function wy(t,e){return vd(t)&&!isNaN(t)&&t<=e&&t>=0}function qI(t,e){return`Invalid prop \`max\` of value \`${t}\` supplied to \`${e}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${Nv}\`.`}function YI(t,e){return`Invalid prop \`value\` of value \`${t}\` supplied to \`${e}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${Nv} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var fE=lE,KI=uE;const hE=S.forwardRef(({className:t,value:e,...n},r)=>f.jsx(fE,{ref:r,className:wt("relative h-4 w-full overflow-hidden rounded-full bg-secondary",t),...n,children:f.jsx(KI,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(e||0)}%)`}})}));hE.displayName=fE.displayName;const rf=()=>{const[t,e]=S.useState({uploadCount:0,nextPrice:100}),n=S.useCallback(async()=>{try{console.log("=== PRICING HOOK: Fetching pricing from endpoint ===");const{data:i,error:s}=await jt.functions.invoke("get-pricing");if(s){console.error("Error fetching pricing:",s),e({uploadCount:0,nextPrice:100});return}console.log("=== PRICING FROM ENDPOINT ===",{uploadCount:i.uploadCount,nextPrice:i.nextPrice,nextPriceDollars:i.nextPriceDollars}),console.log("🔍 PRICING DEBUG:",{uploadCount:i.uploadCount,nextPrice:i.nextPrice,nextPriceDollars:i.nextPriceDollars}),e({uploadCount:i.uploadCount,nextPrice:i.nextPrice})}catch(i){console.error("Error in pricing hook:",i),e({uploadCount:0,nextPrice:100})}},[]);return S.useEffect(()=>{n();const i=setInterval(n,6e4);return()=>clearInterval(i)},[n]),{...t,formatPrice:i=>`$${(i/100).toFixed(2)}`,refreshPricing:n}},JI=({onPriceUpdate:t,refreshTrigger:e})=>{const{uploadCount:n,nextPrice:r,formatPrice:i}=rf(),[s,o]=S.useState(0),[a,l]=S.useState(null),c=[100,200,500,1e3,2e3,5e3],u=v=>c.find(g=>g>v)||c[c.length-1],d=v=>{const g=c.filter(p=>p<=v);return g.length>0?g[g.length-1]:0},h=v=>{const g=u(v),p=d(v),y=(v-p)/(g-p)*100;return Math.min(y,100)},m=async()=>{var v;try{const{data:g,error:p}=await jt.functions.invoke("get-uploads",{body:{}});if(p){console.error("Error fetching uploads:",p);return}const y=g.uploads||[],_=y.reduce((E,M)=>E+(M.price_paid||0),0),w=((v=y[0])==null?void 0:v.created_at)||null;o(_),l(w)}catch(g){console.error("Error fetching additional data:",g)}};S.useEffect(()=>{t(r)},[r,t]),S.useEffect(()=>{m();const v=setInterval(m,3e4);return()=>clearInterval(v)},[e]);const x=v=>{if(!v)return"Never";const g=new Date,p=new Date(v),y=Math.floor((g.getTime()-p.getTime())/(1e3*60));if(y<1)return"Just now";if(y<60)return`${y}m ago`;const _=Math.floor(y/60);return _<24?`${_}h ago`:`${Math.floor(_/24)}d ago`};return f.jsxs(_t,{className:"glass-card experiment-glow text-center",children:[f.jsxs(_r,{className:"pb-2 px-3 pt-3",children:[f.jsxs(wr,{className:"text-sm sm:text-base gradient-text flex items-center justify-center gap-1",children:[f.jsx(A1,{className:"w-3 h-3 sm:w-4 sm:h-4"}),"Experiment Status"]}),f.jsx(ns,{variant:"outline",className:"mx-auto w-fit animate-pulse border-primary/50 text-xs",children:"🧪 LIVE"})]}),f.jsxs(Lt,{className:"space-y-3 px-3 pb-3",children:[f.jsxs("div",{className:"space-y-1",children:[f.jsx("p",{className:"text-xs text-muted-foreground",children:"Next Price"}),f.jsx("p",{className:"text-xl sm:text-2xl font-bold gradient-text price-ticker",children:f.jsx(li,{end:(r||100)/100,duration:1500,prefix:"$",decimals:2,className:"text-lg sm:text-xl font-bold text-green-500"})}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"What you'll pay"})]}),f.jsxs("div",{className:"grid grid-cols-3 gap-1.5",children:[f.jsxs("div",{className:"glass-card p-1.5 space-y-0.5",children:[f.jsx("div",{className:"flex items-center justify-center gap-1 text-primary",children:f.jsx(T1,{className:"w-3 h-3"})}),f.jsx("p",{className:"text-xs font-semibold",children:f.jsx(li,{end:s/100,duration:1500,prefix:"$",decimals:2,className:"text-green-500 font-bold"})}),f.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Spent"})]}),f.jsxs("div",{className:"glass-card p-1.5 space-y-0.5",children:[f.jsx("div",{className:"flex items-center justify-center gap-1 text-accent",children:f.jsx(b2,{className:"w-3 h-3"})}),f.jsx("p",{className:"text-xs font-semibold",children:n}),f.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Posts"})]}),f.jsxs("div",{className:"glass-card p-1.5 space-y-0.5",children:[f.jsx("div",{className:"flex items-center justify-center gap-1 text-muted-foreground",children:f.jsx(c2,{className:"w-3 h-3"})}),f.jsx("p",{className:"text-xs font-semibold",children:x(a)}),f.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Last"})]})]}),f.jsx("div",{className:"mt-4 pt-4 border-t border-border/30",children:f.jsxs("div",{className:"space-y-2",children:[f.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[f.jsx("span",{children:"Progress to next milestone"}),f.jsxs("span",{children:["$",(r/100).toFixed(2)]})]}),f.jsx(hE,{value:h(r),className:"h-2 bg-muted"}),f.jsxs("div",{className:"flex justify-between text-xs",children:[f.jsxs("span",{className:"text-muted-foreground",children:["$",(d(r)/100).toFixed(2)]}),f.jsxs("span",{className:"text-primary font-medium",children:["$",(u(r)/100).toFixed(2)]})]})]})})]})]})},ac=S.forwardRef(({className:t,type:e,...n},r)=>f.jsx("input",{type:e,className:wt("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:r,...n}));ac.displayName="Input";const pE=S.forwardRef(({className:t,...e},n)=>f.jsx("textarea",{className:wt("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:n,...e}));pE.displayName="Textarea";const ZI=t=>{const e=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;return t.trim()?t.length>254?{isValid:!1,error:"Email is too long"}:e.test(t)?{isValid:!0}:{isValid:!1,error:"Invalid email format"}:{isValid:!1,error:"Email is required"}},mE=t=>{if(!t.trim())return{isValid:!1,error:"Caption is required"};if(t.length>500)return{isValid:!1,error:"Caption must be less than 500 characters"};if(t.includes("\0")||t.split("").some(n=>{const r=n.charCodeAt(0);return r>=0&&r<=8||r===11||r===12||r>=14&&r<=31||r===127}))return{isValid:!1,error:"Caption contains invalid characters"};const e=[/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,/<iframe\b[^<]*(?:(?!<\/iframe>)<[^<]*)*<\/iframe>/gi,/<object\b[^<]*(?:(?!<\/object>)<[^<]*)*<\/object>/gi,/<embed\b[^>]*>/gi,/<link\b[^>]*>/gi,/<meta\b[^>]*>/gi,/javascript:/gi,/vbscript:/gi,/data:text\/html/gi,/on\w+\s*=/gi,/<style\b[^<]*(?:(?!<\/style>)<[^<]*)*<\/style>/gi,/expression\s*\(/gi,/url\s*\(/gi,/@import/gi,/eval\s*\(/gi,/Function\s*\(/gi,/setTimeout\s*\(/gi,/setInterval\s*\(/gi];for(const n of e)if(n.test(t))return{isValid:!1,error:"Caption contains prohibited content"};return{isValid:!0}},Sy=t=>t.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),Ey=t=>["image/jpeg","image/png","image/gif","image/webp"].includes(t.type)?t.size>5242880?{isValid:!1,error:"File size must be less than 5MB"}:{isValid:!0}:{isValid:!1,error:"Invalid file type. Only JPEG, PNG, GIF, and WebP are allowed."},QI=({currentPrice:t,onUploadSuccess:e})=>{const[n,r]=S.useState(""),[i,s]=S.useState(""),[o,a]=S.useState(null),[l,c]=S.useState(""),[u,d]=S.useState(!1),[h,m]=S.useState(!1),[x,v]=S.useState({x:0,y:0,width:200,height:200}),[g,p]=S.useState(!1),[y,_]=S.useState(!1),[w,E]=S.useState({x:0,y:0}),[M,T]=S.useState({x:0,y:0,width:0,height:0}),[P,C]=S.useState(""),[b,N]=S.useState(!1),U=S.useRef(null),{toast:O}=Rv(),V=S.useCallback(J=>{console.log("Processing file:",J.name,J.type,J.size);const q=Ey(J);if(!q.isValid){console.log("File validation failed:",q.error),O({title:"Invalid file",description:q.error,variant:"destructive"});return}console.log("File validation passed, reading file...");const re=new FileReader;re.onload=ie=>{var be;const I=(be=ie.target)==null?void 0:be.result;console.log("File read successfully, data length:",I.length),C(I),m(!0),v({x:100,y:100,width:200,height:200}),console.log("Image loaded, showing cropper")},re.readAsDataURL(J)},[O]);S.useEffect(()=>{h&&P&&setTimeout(()=>{const J=document.querySelector(".cropper-image");if(J){const q=J.getBoundingClientRect(),re=Math.min(200,q.width*.4,q.height*.4);v({x:(q.width-re)/2,y:(q.height-re)/2,width:re,height:re})}},100)},[h,P]);const Y=S.useCallback(()=>{const J=document.createElement("canvas"),q=J.getContext("2d"),re=new Image;re.onload=()=>{const ie=document.querySelector(".cropper-image");if(!ie)return;const I=ie.getBoundingClientRect(),be=re.naturalWidth/I.width,Ee=re.naturalHeight/I.height,He=x.x*be,Me=x.y*Ee,it=x.width*be,ge=x.height*Ee;J.width=it,J.height=ge,q==null||q.drawImage(re,He,Me,it,ge,0,0,it,ge),J.toBlob(_e=>{if(_e){const Ve=new File([_e],"cropped-image.jpg",{type:"image/jpeg"}),et=J.toDataURL("image/jpeg",.9);a({name:"cropped-image.jpg",type:"image/jpeg",data:et,file:Ve}),c(et),m(!1),C(""),console.log("Crop applied:",{original:{width:re.naturalWidth,height:re.naturalHeight},displayed:{width:I.width,height:I.height},cropArea:x,scaledCrop:{x:He,y:Me,width:it,height:ge}})}},"image/jpeg",.9)},re.src=P},[P,x]),z=J=>{J.preventDefault(),J.stopPropagation(),p(!0);const q=J.currentTarget.parentElement.getBoundingClientRect();E({x:J.clientX-q.left-x.x,y:J.clientY-q.top-x.y})},W=J=>{J.preventDefault(),J.stopPropagation(),_(!0),T({x:J.clientX,y:J.clientY,width:x.width,height:x.height})},L=J=>{if(!g&&!y)return;const q=J.currentTarget.getBoundingClientRect();if(g){const re=Math.max(0,Math.min(J.clientX-q.left-w.x,q.width-x.width)),ie=Math.max(0,Math.min(J.clientY-q.top-w.y,q.height-x.height));v(I=>({...I,x:re,y:ie}))}else if(y){const re=J.clientX-M.x,ie=J.clientY-M.y,I=Math.abs(re)>Math.abs(ie)?re:ie,be=Math.max(50,Math.min(M.width+I,Math.min(q.width-x.x,q.height-x.y)));v(Ee=>({...Ee,width:be,height:be}))}},H=J=>{J.preventDefault();const q=J.touches[0];p(!0);const re=J.currentTarget.parentElement.getBoundingClientRect();E({x:q.clientX-re.left-x.x,y:q.clientY-re.top-x.y})},j=J=>{J.preventDefault(),J.stopPropagation();const q=J.touches[0];_(!0),T({x:q.clientX,y:q.clientY,width:x.width,height:x.height})},ee=J=>{if(!g&&!y)return;J.preventDefault();const q=J.touches[0],re=J.currentTarget.getBoundingClientRect();if(g){const ie=Math.max(0,Math.min(q.clientX-re.left-w.x,re.width-x.width)),I=Math.max(0,Math.min(q.clientY-re.top-w.y,re.height-x.height));v(be=>({...be,x:ie,y:I}))}else if(y){const ie=q.clientX-M.x,I=q.clientY-M.y,be=Math.abs(ie)>Math.abs(I)?ie:I,Ee=Math.max(50,Math.min(M.width+be,Math.min(re.width-x.x,re.height-x.y)));v(He=>({...He,width:Ee,height:Ee}))}},ve=()=>{p(!1),_(!1)},Be=()=>{p(!1),_(!1)},Ue=J=>{var re;const q=(re=J.target.files)==null?void 0:re[0];q&&(console.log("File selected via input:",q.name,q.type,q.size),V(q))},Q=J=>{J.preventDefault(),J.stopPropagation(),J.type==="dragenter"||J.type==="dragover"?N(!0):J.type==="dragleave"&&N(!1)},oe=J=>{J.preventDefault(),J.stopPropagation(),N(!1);const q=J.dataTransfer.files;q&&q[0]&&(console.log("File dropped:",q[0].name,q[0].type,q[0].size),V(q[0]))},X=S.useCallback(J=>{var re;const q=(re=J.clipboardData)==null?void 0:re.items;if(q)for(let ie=0;ie<q.length;ie++){const I=q[ie];if(I.type.indexOf("image")!==-1){const be=I.getAsFile();be&&V(be);break}}},[V]);S.useEffect(()=>(document.addEventListener("paste",X),()=>{document.removeEventListener("paste",X)}),[X]);const he=async J=>{J.preventDefault();const q=ZI(n);if(!q.isValid){O({title:"Invalid email",description:q.error,variant:"destructive"});return}const re=mE(i);if(!re.isValid){O({title:"Invalid caption",description:re.error,variant:"destructive"});return}if(!o){O({title:"Missing image",description:"Please upload an image",variant:"destructive"});return}const ie=Ey(o.file);if(!ie.isValid){O({title:"Invalid file",description:ie.error,variant:"destructive"});return}d(!0);try{console.log("=== FRONTEND: Calling create-payment function ==="),console.log("Request data:",{email:n.trim().toLowerCase(),caption:Sy(i.trim()),imageUrl:o.data?"base64 data present":"NO DATA",fileName:o.name});const{data:I,error:be}=await jt.functions.invoke("create-payment",{body:{email:n.trim().toLowerCase(),caption:Sy(i.trim()),imageUrl:o.data,fileName:o.name}});if(console.log("=== FRONTEND: Function response ==="),console.log("Data:",I),console.log("Error:",be),be)throw console.error("=== FRONTEND: Function returned error ==="),console.error("Error details:",JSON.stringify(be,null,2)),be;if(I.url)console.log("=== FRONTEND: Redirecting to Stripe ==="),console.log("Stripe URL:",I.url),window.location.href=I.url;else throw console.error("=== FRONTEND: No URL in response ==="),console.log("Full response data:",I),new Error("No checkout URL received")}catch(I){console.error("=== FRONTEND: Payment error caught ==="),console.error("Payment error:",I),console.error("Error type:",typeof I),console.error("Error name:",I==null?void 0:I.name),console.error("Error message:",I==null?void 0:I.message),console.error("Error stack:",I==null?void 0:I.stack),O({title:"Payment failed",description:(I==null?void 0:I.message)||"Failed to create payment session",variant:"destructive"})}finally{d(!1)}};return f.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[f.jsx("div",{className:"text-center",children:f.jsx("div",{className:"flex items-center justify-center gap-2 mb-2",children:f.jsxs(ns,{variant:"secondary",className:"text-xs sm:text-sm font-semibold",children:["Current Price: ",f.jsx(li,{end:t/100,duration:1500,prefix:"$",decimals:2,className:"text-green-500 font-bold"})]})})}),f.jsx("div",{children:f.jsxs("form",{onSubmit:he,className:"space-y-3 sm:space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"email",className:"block text-sm font-medium mb-1.5",children:"Email Address"}),f.jsx(ac,{id:"email",type:"email",value:n,onChange:J=>r(J.target.value),placeholder:"your.email@example.com",required:!0,className:"h-8 sm:h-9 text-sm"})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"caption",className:"block text-sm font-medium mb-1.5",children:"Caption"}),f.jsx(pE,{id:"caption",value:i,onChange:J=>s(J.target.value),placeholder:"Write a caption for your picture...",rows:2,required:!0,className:"resize-none text-sm"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium mb-1.5",children:"Picture"}),f.jsxs("div",{className:"space-y-3",children:[f.jsx("div",{onClick:()=>{var J;console.log("Upload area clicked, triggering file input..."),(J=U.current)==null||J.click()},onDragEnter:Q,onDragLeave:Q,onDragOver:Q,onDrop:oe,className:`border-2 border-dashed rounded-lg p-4 sm:p-6 text-center cursor-pointer transition-colors ${b?"border-primary bg-primary/5":"border-border hover:border-primary"}`,children:l?f.jsxs("div",{className:"space-y-3",children:[f.jsx("img",{src:l,alt:"Preview",className:"max-w-full max-h-36 mx-auto rounded-lg"}),f.jsx("p",{className:"text-sm text-muted-foreground text-center",children:"Click to change image"})]}):f.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[f.jsx(m2,{className:"mx-auto h-8 w-8 sm:h-10 sm:w-10 text-muted-foreground"}),f.jsxs("div",{children:[f.jsx("p",{className:"text-sm sm:text-base font-medium",children:"Click, drag & drop, or paste image"}),f.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"PNG, JPG, GIF supported"})]})]})}),f.jsx("input",{ref:U,type:"file",accept:"image/*",onChange:Ue,className:"hidden"})]})]}),f.jsx(Ze,{type:"submit",size:"lg",className:"w-full glow-shadow text-sm sm:text-base",disabled:u||!n||!i||!o,children:u?f.jsxs(f.Fragment,{children:[f.jsx(M1,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-2 animate-spin"}),f.jsx("span",{className:"text-sm sm:text-base",children:"Creating Payment..."})]}):f.jsxs(f.Fragment,{children:[f.jsx(hd,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-2"}),"Pay ",f.jsx(li,{end:t/100,duration:1500,prefix:"$",decimals:2,className:"text-green-500 font-bold"})," & Upload"]})})]})}),h&&P&&f.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-2 sm:p-4",children:f.jsxs("div",{className:"bg-background rounded-lg p-3 sm:p-6 max-w-4xl w-full max-h-[95vh] sm:max-h-[90vh] overflow-auto",children:[f.jsxs("div",{className:"flex justify-between items-center mb-3 sm:mb-4",children:[f.jsx("h3",{className:"text-base sm:text-lg font-semibold",children:"Crop Your Image"}),f.jsx(Ze,{variant:"ghost",size:"sm",onClick:()=>m(!1),children:f.jsx(Yx,{className:"w-4 h-4"})})]}),f.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[f.jsxs("div",{className:"relative inline-block max-w-full mx-auto bg-gray-100 rounded-lg overflow-hidden",style:{maxHeight:"50vh",minHeight:"200px"},onMouseMove:L,onMouseUp:Be,onMouseLeave:Be,onTouchMove:ee,onTouchEnd:ve,children:[f.jsx("img",{src:P,alt:"Crop preview",className:"max-w-full max-h-full block cropper-image",style:{maxHeight:"60vh"}}),f.jsxs("div",{className:"absolute border-2 border-primary bg-primary/20 cursor-move select-none touch-none",style:{left:x.x,top:x.y,width:x.width,height:x.height},onMouseDown:z,onTouchStart:H,children:[f.jsx("div",{className:"absolute inset-0 border border-white/50"}),f.jsxs("div",{className:"absolute inset-0",children:[f.jsx("div",{className:"absolute border-l border-white/30",style:{left:"33.33%",height:"100%"}}),f.jsx("div",{className:"absolute border-l border-white/30",style:{left:"66.66%",height:"100%"}}),f.jsx("div",{className:"absolute border-t border-white/30",style:{top:"33.33%",width:"100%"}}),f.jsx("div",{className:"absolute border-t border-white/30",style:{top:"66.66%",width:"100%"}})]}),f.jsx("div",{className:"absolute -top-1 -left-1 w-3 h-3 bg-primary border border-white rounded-full cursor-move"}),f.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-primary border border-white rounded-full cursor-move"}),f.jsx("div",{className:"absolute -bottom-1 -left-1 w-3 h-3 bg-primary border border-white rounded-full cursor-move"}),f.jsx("div",{className:"absolute -bottom-2 -right-2 w-8 h-8 sm:w-6 sm:h-6 cursor-se-resize flex items-center justify-center touch-none",onMouseDown:W,onTouchStart:j,title:"Drag to resize (maintains square ratio)",children:f.jsx("div",{className:"w-4 h-4 sm:w-3 sm:h-3 bg-green-500 border border-white rounded-full hover:bg-green-400 transition-colors shadow-lg"})})]})]}),f.jsxs("div",{className:"flex gap-2 sm:gap-3 justify-center",children:[f.jsxs(Ze,{variant:"outline",size:"sm",onClick:()=>m(!1),className:"flex-1 sm:flex-none",children:[f.jsx(Yx,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1 sm:mr-2"}),f.jsx("span",{className:"text-xs sm:text-sm",children:"Cancel"})]}),f.jsxs(Ze,{onClick:Y,size:"sm",className:"bg-primary hover:bg-primary/90 flex-1 sm:flex-none",children:[f.jsx(wv,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1 sm:mr-2"}),f.jsx("span",{className:"text-xs sm:text-sm",children:"Apply Crop"})]})]})]})]})})]})};function by(t,[e,n]){return Math.min(n,Math.max(e,t))}function nt(t,e,{checkForDefaultPrevented:n=!0}={}){return function(i){if(t==null||t(i),n===!1||!i.defaultPrevented)return e==null?void 0:e(i)}}function eL(t,e=[]){let n=[];function r(s,o){const a=S.createContext(o),l=n.length;n=[...n,o];function c(d){const{scope:h,children:m,...x}=d,v=(h==null?void 0:h[t][l])||a,g=S.useMemo(()=>x,Object.values(x));return f.jsx(v.Provider,{value:g,children:m})}function u(d,h){const m=(h==null?void 0:h[t][l])||a,x=S.useContext(m);if(x)return x;if(o!==void 0)return o;throw new Error(`\`${d}\` must be used within \`${s}\``)}return c.displayName=s+"Provider",[c,u]}const i=()=>{const s=n.map(o=>S.createContext(o));return function(a){const l=(a==null?void 0:a[t])||s;return S.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return i.scopeName=t,[r,tL(i,...e)]}function tL(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(s){const o=r.reduce((a,{useScope:l,scopeName:c})=>{const d=l(s)[`__scope${c}`];return{...a,...d}},{});return S.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}function Iv(t){const e=t+"CollectionProvider",[n,r]=eL(e),[i,s]=n(e,{collectionRef:{current:null},itemMap:new Map}),o=m=>{const{scope:x,children:v}=m,g=mt.useRef(null),p=mt.useRef(new Map).current;return f.jsx(i,{scope:x,itemMap:p,collectionRef:g,children:v})};o.displayName=e;const a=t+"CollectionSlot",l=mt.forwardRef((m,x)=>{const{scope:v,children:g}=m,p=s(a,v),y=kt(x,p.collectionRef);return f.jsx(va,{ref:y,children:g})});l.displayName=a;const c=t+"CollectionItemSlot",u="data-radix-collection-item",d=mt.forwardRef((m,x)=>{const{scope:v,children:g,...p}=m,y=mt.useRef(null),_=kt(x,y),w=s(c,v);return mt.useEffect(()=>(w.itemMap.set(y,{ref:y,...p}),()=>void w.itemMap.delete(y))),f.jsx(va,{[u]:"",ref:_,children:g})});d.displayName=c;function h(m){const x=s(t+"CollectionConsumer",m);return mt.useCallback(()=>{const g=x.collectionRef.current;if(!g)return[];const p=Array.from(g.querySelectorAll(`[${u}]`));return Array.from(x.itemMap.values()).sort((w,E)=>p.indexOf(w.ref.current)-p.indexOf(E.ref.current))},[x.collectionRef,x.itemMap])}return[{Provider:o,Slot:l,ItemSlot:d},h,r]}function lc(t,e=[]){let n=[];function r(s,o){const a=S.createContext(o),l=n.length;n=[...n,o];const c=d=>{var p;const{scope:h,children:m,...x}=d,v=((p=h==null?void 0:h[t])==null?void 0:p[l])||a,g=S.useMemo(()=>x,Object.values(x));return f.jsx(v.Provider,{value:g,children:m})};c.displayName=s+"Provider";function u(d,h){var v;const m=((v=h==null?void 0:h[t])==null?void 0:v[l])||a,x=S.useContext(m);if(x)return x;if(o!==void 0)return o;throw new Error(`\`${d}\` must be used within \`${s}\``)}return[c,u]}const i=()=>{const s=n.map(o=>S.createContext(o));return function(a){const l=(a==null?void 0:a[t])||s;return S.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return i.scopeName=t,[r,nL(i,...e)]}function nL(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(s){const o=r.reduce((a,{useScope:l,scopeName:c})=>{const d=l(s)[`__scope${c}`];return{...a,...d}},{});return S.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}var rL=S.createContext(void 0);function sf(t){const e=S.useContext(rL);return t||e||"ltr"}function Vr(t){const e=S.useRef(t);return S.useEffect(()=>{e.current=t}),S.useMemo(()=>(...n)=>{var r;return(r=e.current)==null?void 0:r.call(e,...n)},[])}function iL(t,e=globalThis==null?void 0:globalThis.document){const n=Vr(t);S.useEffect(()=>{const r=i=>{i.key==="Escape"&&n(i)};return e.addEventListener("keydown",r,{capture:!0}),()=>e.removeEventListener("keydown",r,{capture:!0})},[n,e])}var sL="DismissableLayer",vm="dismissableLayer.update",oL="dismissableLayer.pointerDownOutside",aL="dismissableLayer.focusOutside",Ty,gE=S.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Lv=S.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:i,onFocusOutside:s,onInteractOutside:o,onDismiss:a,...l}=t,c=S.useContext(gE),[u,d]=S.useState(null),h=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,m]=S.useState({}),x=kt(e,T=>d(T)),v=Array.from(c.layers),[g]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),p=v.indexOf(g),y=u?v.indexOf(u):-1,_=c.layersWithOutsidePointerEventsDisabled.size>0,w=y>=p,E=uL(T=>{const P=T.target,C=[...c.branches].some(b=>b.contains(P));!w||C||(i==null||i(T),o==null||o(T),T.defaultPrevented||a==null||a())},h),M=dL(T=>{const P=T.target;[...c.branches].some(b=>b.contains(P))||(s==null||s(T),o==null||o(T),T.defaultPrevented||a==null||a())},h);return iL(T=>{y===c.layers.size-1&&(r==null||r(T),!T.defaultPrevented&&a&&(T.preventDefault(),a()))},h),S.useEffect(()=>{if(u)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(Ty=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),My(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=Ty)}},[u,h,n,c]),S.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),My())},[u,c]),S.useEffect(()=>{const T=()=>m({});return document.addEventListener(vm,T),()=>document.removeEventListener(vm,T)},[]),f.jsx(lt.div,{...l,ref:x,style:{pointerEvents:_?w?"auto":"none":void 0,...t.style},onFocusCapture:nt(t.onFocusCapture,M.onFocusCapture),onBlurCapture:nt(t.onBlurCapture,M.onBlurCapture),onPointerDownCapture:nt(t.onPointerDownCapture,E.onPointerDownCapture)})});Lv.displayName=sL;var lL="DismissableLayerBranch",cL=S.forwardRef((t,e)=>{const n=S.useContext(gE),r=S.useRef(null),i=kt(e,r);return S.useEffect(()=>{const s=r.current;if(s)return n.branches.add(s),()=>{n.branches.delete(s)}},[n.branches]),f.jsx(lt.div,{...t,ref:i})});cL.displayName=lL;function uL(t,e=globalThis==null?void 0:globalThis.document){const n=Vr(t),r=S.useRef(!1),i=S.useRef(()=>{});return S.useEffect(()=>{const s=a=>{if(a.target&&!r.current){let l=function(){vE(oL,n,c,{discrete:!0})};const c={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",i.current),i.current=l,e.addEventListener("click",i.current,{once:!0})):l()}else e.removeEventListener("click",i.current);r.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",s)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",s),e.removeEventListener("click",i.current)}},[e,n]),{onPointerDownCapture:()=>r.current=!0}}function dL(t,e=globalThis==null?void 0:globalThis.document){const n=Vr(t),r=S.useRef(!1);return S.useEffect(()=>{const i=s=>{s.target&&!r.current&&vE(aL,n,{originalEvent:s},{discrete:!1})};return e.addEventListener("focusin",i),()=>e.removeEventListener("focusin",i)},[e,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function My(){const t=new CustomEvent(vm);document.dispatchEvent(t)}function vE(t,e,n,{discrete:r}){const i=n.originalEvent.target,s=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&i.addEventListener(t,e,{once:!0}),r?HI(i,s):i.dispatchEvent(s)}var ph=0;function fL(){S.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??Cy()),document.body.insertAdjacentElement("beforeend",t[1]??Cy()),ph++,()=>{ph===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),ph--}},[])}function Cy(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var mh="focusScope.autoFocusOnMount",gh="focusScope.autoFocusOnUnmount",Ay={bubbles:!1,cancelable:!0},hL="FocusScope",xE=S.forwardRef((t,e)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:i,onUnmountAutoFocus:s,...o}=t,[a,l]=S.useState(null),c=Vr(i),u=Vr(s),d=S.useRef(null),h=kt(e,v=>l(v)),m=S.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;S.useEffect(()=>{if(r){let v=function(_){if(m.paused||!a)return;const w=_.target;a.contains(w)?d.current=w:Ni(d.current,{select:!0})},g=function(_){if(m.paused||!a)return;const w=_.relatedTarget;w!==null&&(a.contains(w)||Ni(d.current,{select:!0}))},p=function(_){if(document.activeElement===document.body)for(const E of _)E.removedNodes.length>0&&Ni(a)};document.addEventListener("focusin",v),document.addEventListener("focusout",g);const y=new MutationObserver(p);return a&&y.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",v),document.removeEventListener("focusout",g),y.disconnect()}}},[r,a,m.paused]),S.useEffect(()=>{if(a){Py.add(m);const v=document.activeElement;if(!a.contains(v)){const p=new CustomEvent(mh,Ay);a.addEventListener(mh,c),a.dispatchEvent(p),p.defaultPrevented||(pL(yL(yE(a)),{select:!0}),document.activeElement===v&&Ni(a))}return()=>{a.removeEventListener(mh,c),setTimeout(()=>{const p=new CustomEvent(gh,Ay);a.addEventListener(gh,u),a.dispatchEvent(p),p.defaultPrevented||Ni(v??document.body,{select:!0}),a.removeEventListener(gh,u),Py.remove(m)},0)}}},[a,c,u,m]);const x=S.useCallback(v=>{if(!n&&!r||m.paused)return;const g=v.key==="Tab"&&!v.altKey&&!v.ctrlKey&&!v.metaKey,p=document.activeElement;if(g&&p){const y=v.currentTarget,[_,w]=mL(y);_&&w?!v.shiftKey&&p===w?(v.preventDefault(),n&&Ni(_,{select:!0})):v.shiftKey&&p===_&&(v.preventDefault(),n&&Ni(w,{select:!0})):p===y&&v.preventDefault()}},[n,r,m.paused]);return f.jsx(lt.div,{tabIndex:-1,...o,ref:h,onKeyDown:x})});xE.displayName=hL;function pL(t,{select:e=!1}={}){const n=document.activeElement;for(const r of t)if(Ni(r,{select:e}),document.activeElement!==n)return}function mL(t){const e=yE(t),n=Ry(e,t),r=Ry(e.reverse(),t);return[n,r]}function yE(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const i=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||i?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function Ry(t,e){for(const n of t)if(!gL(n,{upTo:e}))return n}function gL(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function vL(t){return t instanceof HTMLInputElement&&"select"in t}function Ni(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&vL(t)&&e&&t.select()}}var Py=xL();function xL(){let t=[];return{add(e){const n=t[0];e!==n&&(n==null||n.pause()),t=Ny(t,e),t.unshift(e)},remove(e){var n;t=Ny(t,e),(n=t[0])==null||n.resume()}}}function Ny(t,e){const n=[...t],r=n.indexOf(e);return r!==-1&&n.splice(r,1),n}function yL(t){return t.filter(e=>e.tagName!=="A")}var vn=globalThis!=null&&globalThis.document?S.useLayoutEffect:()=>{},_L=cw.useId||(()=>{}),wL=0;function ms(t){const[e,n]=S.useState(_L());return vn(()=>{n(r=>r??String(wL++))},[t]),e?`radix-${e}`:""}const SL=["top","right","bottom","left"],rs=Math.min,Fn=Math.max,xd=Math.round,zc=Math.floor,is=t=>({x:t,y:t}),EL={left:"right",right:"left",bottom:"top",top:"bottom"},bL={start:"end",end:"start"};function xm(t,e,n){return Fn(t,rs(e,n))}function pi(t,e){return typeof t=="function"?t(e):t}function mi(t){return t.split("-")[0]}function Ba(t){return t.split("-")[1]}function Dv(t){return t==="x"?"y":"x"}function Uv(t){return t==="y"?"height":"width"}function ss(t){return["top","bottom"].includes(mi(t))?"y":"x"}function kv(t){return Dv(ss(t))}function TL(t,e,n){n===void 0&&(n=!1);const r=Ba(t),i=kv(t),s=Uv(i);let o=i==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[s]>e.floating[s]&&(o=yd(o)),[o,yd(o)]}function ML(t){const e=yd(t);return[ym(t),e,ym(e)]}function ym(t){return t.replace(/start|end/g,e=>bL[e])}function CL(t,e,n){const r=["left","right"],i=["right","left"],s=["top","bottom"],o=["bottom","top"];switch(t){case"top":case"bottom":return n?e?i:r:e?r:i;case"left":case"right":return e?s:o;default:return[]}}function AL(t,e,n,r){const i=Ba(t);let s=CL(mi(t),n==="start",r);return i&&(s=s.map(o=>o+"-"+i),e&&(s=s.concat(s.map(ym)))),s}function yd(t){return t.replace(/left|right|bottom|top/g,e=>EL[e])}function RL(t){return{top:0,right:0,bottom:0,left:0,...t}}function _E(t){return typeof t!="number"?RL(t):{top:t,right:t,bottom:t,left:t}}function _d(t){const{x:e,y:n,width:r,height:i}=t;return{width:r,height:i,top:n,left:e,right:e+r,bottom:n+i,x:e,y:n}}function Iy(t,e,n){let{reference:r,floating:i}=t;const s=ss(e),o=kv(e),a=Uv(o),l=mi(e),c=s==="y",u=r.x+r.width/2-i.width/2,d=r.y+r.height/2-i.height/2,h=r[a]/2-i[a]/2;let m;switch(l){case"top":m={x:u,y:r.y-i.height};break;case"bottom":m={x:u,y:r.y+r.height};break;case"right":m={x:r.x+r.width,y:d};break;case"left":m={x:r.x-i.width,y:d};break;default:m={x:r.x,y:r.y}}switch(Ba(e)){case"start":m[o]-=h*(n&&c?-1:1);break;case"end":m[o]+=h*(n&&c?-1:1);break}return m}const PL=async(t,e,n)=>{const{placement:r="bottom",strategy:i="absolute",middleware:s=[],platform:o}=n,a=s.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(e));let c=await o.getElementRects({reference:t,floating:e,strategy:i}),{x:u,y:d}=Iy(c,r,l),h=r,m={},x=0;for(let v=0;v<a.length;v++){const{name:g,fn:p}=a[v],{x:y,y:_,data:w,reset:E}=await p({x:u,y:d,initialPlacement:r,placement:h,strategy:i,middlewareData:m,rects:c,platform:o,elements:{reference:t,floating:e}});u=y??u,d=_??d,m={...m,[g]:{...m[g],...w}},E&&x<=50&&(x++,typeof E=="object"&&(E.placement&&(h=E.placement),E.rects&&(c=E.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:i}):E.rects),{x:u,y:d}=Iy(c,h,l)),v=-1)}return{x:u,y:d,placement:h,strategy:i,middlewareData:m}};async function Yl(t,e){var n;e===void 0&&(e={});const{x:r,y:i,platform:s,rects:o,elements:a,strategy:l}=t,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:h=!1,padding:m=0}=pi(e,t),x=_E(m),g=a[h?d==="floating"?"reference":"floating":d],p=_d(await s.getClippingRect({element:(n=await(s.isElement==null?void 0:s.isElement(g)))==null||n?g:g.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),y=d==="floating"?{x:r,y:i,width:o.floating.width,height:o.floating.height}:o.reference,_=await(s.getOffsetParent==null?void 0:s.getOffsetParent(a.floating)),w=await(s.isElement==null?void 0:s.isElement(_))?await(s.getScale==null?void 0:s.getScale(_))||{x:1,y:1}:{x:1,y:1},E=_d(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:y,offsetParent:_,strategy:l}):y);return{top:(p.top-E.top+x.top)/w.y,bottom:(E.bottom-p.bottom+x.bottom)/w.y,left:(p.left-E.left+x.left)/w.x,right:(E.right-p.right+x.right)/w.x}}const NL=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:r,placement:i,rects:s,platform:o,elements:a,middlewareData:l}=e,{element:c,padding:u=0}=pi(t,e)||{};if(c==null)return{};const d=_E(u),h={x:n,y:r},m=kv(i),x=Uv(m),v=await o.getDimensions(c),g=m==="y",p=g?"top":"left",y=g?"bottom":"right",_=g?"clientHeight":"clientWidth",w=s.reference[x]+s.reference[m]-h[m]-s.floating[x],E=h[m]-s.reference[m],M=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c));let T=M?M[_]:0;(!T||!await(o.isElement==null?void 0:o.isElement(M)))&&(T=a.floating[_]||s.floating[x]);const P=w/2-E/2,C=T/2-v[x]/2-1,b=rs(d[p],C),N=rs(d[y],C),U=b,O=T-v[x]-N,V=T/2-v[x]/2+P,Y=xm(U,V,O),z=!l.arrow&&Ba(i)!=null&&V!==Y&&s.reference[x]/2-(V<U?b:N)-v[x]/2<0,W=z?V<U?V-U:V-O:0;return{[m]:h[m]+W,data:{[m]:Y,centerOffset:V-Y-W,...z&&{alignmentOffset:W}},reset:z}}}),IL=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,r;const{placement:i,middlewareData:s,rects:o,initialPlacement:a,platform:l,elements:c}=e,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:h,fallbackStrategy:m="bestFit",fallbackAxisSideDirection:x="none",flipAlignment:v=!0,...g}=pi(t,e);if((n=s.arrow)!=null&&n.alignmentOffset)return{};const p=mi(i),y=ss(a),_=mi(a)===a,w=await(l.isRTL==null?void 0:l.isRTL(c.floating)),E=h||(_||!v?[yd(a)]:ML(a)),M=x!=="none";!h&&M&&E.push(...AL(a,v,x,w));const T=[a,...E],P=await Yl(e,g),C=[];let b=((r=s.flip)==null?void 0:r.overflows)||[];if(u&&C.push(P[p]),d){const V=TL(i,o,w);C.push(P[V[0]],P[V[1]])}if(b=[...b,{placement:i,overflows:C}],!C.every(V=>V<=0)){var N,U;const V=(((N=s.flip)==null?void 0:N.index)||0)+1,Y=T[V];if(Y)return{data:{index:V,overflows:b},reset:{placement:Y}};let z=(U=b.filter(W=>W.overflows[0]<=0).sort((W,L)=>W.overflows[1]-L.overflows[1])[0])==null?void 0:U.placement;if(!z)switch(m){case"bestFit":{var O;const W=(O=b.filter(L=>{if(M){const H=ss(L.placement);return H===y||H==="y"}return!0}).map(L=>[L.placement,L.overflows.filter(H=>H>0).reduce((H,j)=>H+j,0)]).sort((L,H)=>L[1]-H[1])[0])==null?void 0:O[0];W&&(z=W);break}case"initialPlacement":z=a;break}if(i!==z)return{reset:{placement:z}}}return{}}}};function Ly(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function Dy(t){return SL.some(e=>t[e]>=0)}const LL=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:r="referenceHidden",...i}=pi(t,e);switch(r){case"referenceHidden":{const s=await Yl(e,{...i,elementContext:"reference"}),o=Ly(s,n.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:Dy(o)}}}case"escaped":{const s=await Yl(e,{...i,altBoundary:!0}),o=Ly(s,n.floating);return{data:{escapedOffsets:o,escaped:Dy(o)}}}default:return{}}}}};async function DL(t,e){const{placement:n,platform:r,elements:i}=t,s=await(r.isRTL==null?void 0:r.isRTL(i.floating)),o=mi(n),a=Ba(n),l=ss(n)==="y",c=["left","top"].includes(o)?-1:1,u=s&&l?-1:1,d=pi(e,t);let{mainAxis:h,crossAxis:m,alignmentAxis:x}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return a&&typeof x=="number"&&(m=a==="end"?x*-1:x),l?{x:m*u,y:h*c}:{x:h*c,y:m*u}}const UL=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,r;const{x:i,y:s,placement:o,middlewareData:a}=e,l=await DL(e,t);return o===((n=a.offset)==null?void 0:n.placement)&&(r=a.arrow)!=null&&r.alignmentOffset?{}:{x:i+l.x,y:s+l.y,data:{...l,placement:o}}}}},kL=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:i}=e,{mainAxis:s=!0,crossAxis:o=!1,limiter:a={fn:g=>{let{x:p,y}=g;return{x:p,y}}},...l}=pi(t,e),c={x:n,y:r},u=await Yl(e,l),d=ss(mi(i)),h=Dv(d);let m=c[h],x=c[d];if(s){const g=h==="y"?"top":"left",p=h==="y"?"bottom":"right",y=m+u[g],_=m-u[p];m=xm(y,m,_)}if(o){const g=d==="y"?"top":"left",p=d==="y"?"bottom":"right",y=x+u[g],_=x-u[p];x=xm(y,x,_)}const v=a.fn({...e,[h]:m,[d]:x});return{...v,data:{x:v.x-n,y:v.y-r,enabled:{[h]:s,[d]:o}}}}}},OL=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:r,placement:i,rects:s,middlewareData:o}=e,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=pi(t,e),u={x:n,y:r},d=ss(i),h=Dv(d);let m=u[h],x=u[d];const v=pi(a,e),g=typeof v=="number"?{mainAxis:v,crossAxis:0}:{mainAxis:0,crossAxis:0,...v};if(l){const _=h==="y"?"height":"width",w=s.reference[h]-s.floating[_]+g.mainAxis,E=s.reference[h]+s.reference[_]-g.mainAxis;m<w?m=w:m>E&&(m=E)}if(c){var p,y;const _=h==="y"?"width":"height",w=["top","left"].includes(mi(i)),E=s.reference[d]-s.floating[_]+(w&&((p=o.offset)==null?void 0:p[d])||0)+(w?0:g.crossAxis),M=s.reference[d]+s.reference[_]+(w?0:((y=o.offset)==null?void 0:y[d])||0)-(w?g.crossAxis:0);x<E?x=E:x>M&&(x=M)}return{[h]:m,[d]:x}}}},FL=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var n,r;const{placement:i,rects:s,platform:o,elements:a}=e,{apply:l=()=>{},...c}=pi(t,e),u=await Yl(e,c),d=mi(i),h=Ba(i),m=ss(i)==="y",{width:x,height:v}=s.floating;let g,p;d==="top"||d==="bottom"?(g=d,p=h===(await(o.isRTL==null?void 0:o.isRTL(a.floating))?"start":"end")?"left":"right"):(p=d,g=h==="end"?"top":"bottom");const y=v-u.top-u.bottom,_=x-u.left-u.right,w=rs(v-u[g],y),E=rs(x-u[p],_),M=!e.middlewareData.shift;let T=w,P=E;if((n=e.middlewareData.shift)!=null&&n.enabled.x&&(P=_),(r=e.middlewareData.shift)!=null&&r.enabled.y&&(T=y),M&&!h){const b=Fn(u.left,0),N=Fn(u.right,0),U=Fn(u.top,0),O=Fn(u.bottom,0);m?P=x-2*(b!==0||N!==0?b+N:Fn(u.left,u.right)):T=v-2*(U!==0||O!==0?U+O:Fn(u.top,u.bottom))}await l({...e,availableWidth:P,availableHeight:T});const C=await o.getDimensions(a.floating);return x!==C.width||v!==C.height?{reset:{rects:!0}}:{}}}};function of(){return typeof window<"u"}function ja(t){return wE(t)?(t.nodeName||"").toLowerCase():"#document"}function Vn(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function Gr(t){var e;return(e=(wE(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function wE(t){return of()?t instanceof Node||t instanceof Vn(t).Node:!1}function Ar(t){return of()?t instanceof Element||t instanceof Vn(t).Element:!1}function Hr(t){return of()?t instanceof HTMLElement||t instanceof Vn(t).HTMLElement:!1}function Uy(t){return!of()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Vn(t).ShadowRoot}function cc(t){const{overflow:e,overflowX:n,overflowY:r,display:i}=Rr(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!["inline","contents"].includes(i)}function BL(t){return["table","td","th"].includes(ja(t))}function af(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function Ov(t){const e=Fv(),n=Ar(t)?Rr(t):t;return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function jL(t){let e=os(t);for(;Hr(e)&&!ya(e);){if(Ov(e))return e;if(af(e))return null;e=os(e)}return null}function Fv(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function ya(t){return["html","body","#document"].includes(ja(t))}function Rr(t){return Vn(t).getComputedStyle(t)}function lf(t){return Ar(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function os(t){if(ja(t)==="html")return t;const e=t.assignedSlot||t.parentNode||Uy(t)&&t.host||Gr(t);return Uy(e)?e.host:e}function SE(t){const e=os(t);return ya(e)?t.ownerDocument?t.ownerDocument.body:t.body:Hr(e)&&cc(e)?e:SE(e)}function Kl(t,e,n){var r;e===void 0&&(e=[]),n===void 0&&(n=!0);const i=SE(t),s=i===((r=t.ownerDocument)==null?void 0:r.body),o=Vn(i);if(s){const a=_m(o);return e.concat(o,o.visualViewport||[],cc(i)?i:[],a&&n?Kl(a):[])}return e.concat(i,Kl(i,[],n))}function _m(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function EE(t){const e=Rr(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const i=Hr(t),s=i?t.offsetWidth:n,o=i?t.offsetHeight:r,a=xd(n)!==s||xd(r)!==o;return a&&(n=s,r=o),{width:n,height:r,$:a}}function Bv(t){return Ar(t)?t:t.contextElement}function sa(t){const e=Bv(t);if(!Hr(e))return is(1);const n=e.getBoundingClientRect(),{width:r,height:i,$:s}=EE(e);let o=(s?xd(n.width):n.width)/r,a=(s?xd(n.height):n.height)/i;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const zL=is(0);function bE(t){const e=Vn(t);return!Fv()||!e.visualViewport?zL:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function VL(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==Vn(t)?!1:e}function ro(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=!1);const i=t.getBoundingClientRect(),s=Bv(t);let o=is(1);e&&(r?Ar(r)&&(o=sa(r)):o=sa(t));const a=VL(s,n,r)?bE(s):is(0);let l=(i.left+a.x)/o.x,c=(i.top+a.y)/o.y,u=i.width/o.x,d=i.height/o.y;if(s){const h=Vn(s),m=r&&Ar(r)?Vn(r):r;let x=h,v=_m(x);for(;v&&r&&m!==x;){const g=sa(v),p=v.getBoundingClientRect(),y=Rr(v),_=p.left+(v.clientLeft+parseFloat(y.paddingLeft))*g.x,w=p.top+(v.clientTop+parseFloat(y.paddingTop))*g.y;l*=g.x,c*=g.y,u*=g.x,d*=g.y,l+=_,c+=w,x=Vn(v),v=_m(x)}}return _d({width:u,height:d,x:l,y:c})}function HL(t){let{elements:e,rect:n,offsetParent:r,strategy:i}=t;const s=i==="fixed",o=Gr(r),a=e?af(e.floating):!1;if(r===o||a&&s)return n;let l={scrollLeft:0,scrollTop:0},c=is(1);const u=is(0),d=Hr(r);if((d||!d&&!s)&&((ja(r)!=="body"||cc(o))&&(l=lf(r)),Hr(r))){const h=ro(r);c=sa(r),u.x=h.x+r.clientLeft,u.y=h.y+r.clientTop}return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+u.x,y:n.y*c.y-l.scrollTop*c.y+u.y}}function GL(t){return Array.from(t.getClientRects())}function wm(t,e){const n=lf(t).scrollLeft;return e?e.left+n:ro(Gr(t)).left+n}function WL(t){const e=Gr(t),n=lf(t),r=t.ownerDocument.body,i=Fn(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),s=Fn(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let o=-n.scrollLeft+wm(t);const a=-n.scrollTop;return Rr(r).direction==="rtl"&&(o+=Fn(e.clientWidth,r.clientWidth)-i),{width:i,height:s,x:o,y:a}}function $L(t,e){const n=Vn(t),r=Gr(t),i=n.visualViewport;let s=r.clientWidth,o=r.clientHeight,a=0,l=0;if(i){s=i.width,o=i.height;const c=Fv();(!c||c&&e==="fixed")&&(a=i.offsetLeft,l=i.offsetTop)}return{width:s,height:o,x:a,y:l}}function XL(t,e){const n=ro(t,!0,e==="fixed"),r=n.top+t.clientTop,i=n.left+t.clientLeft,s=Hr(t)?sa(t):is(1),o=t.clientWidth*s.x,a=t.clientHeight*s.y,l=i*s.x,c=r*s.y;return{width:o,height:a,x:l,y:c}}function ky(t,e,n){let r;if(e==="viewport")r=$L(t,n);else if(e==="document")r=WL(Gr(t));else if(Ar(e))r=XL(e,n);else{const i=bE(t);r={...e,x:e.x-i.x,y:e.y-i.y}}return _d(r)}function TE(t,e){const n=os(t);return n===e||!Ar(n)||ya(n)?!1:Rr(n).position==="fixed"||TE(n,e)}function qL(t,e){const n=e.get(t);if(n)return n;let r=Kl(t,[],!1).filter(a=>Ar(a)&&ja(a)!=="body"),i=null;const s=Rr(t).position==="fixed";let o=s?os(t):t;for(;Ar(o)&&!ya(o);){const a=Rr(o),l=Ov(o);!l&&a.position==="fixed"&&(i=null),(s?!l&&!i:!l&&a.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||cc(o)&&!l&&TE(t,o))?r=r.filter(u=>u!==o):i=a,o=os(o)}return e.set(t,r),r}function YL(t){let{element:e,boundary:n,rootBoundary:r,strategy:i}=t;const o=[...n==="clippingAncestors"?af(e)?[]:qL(e,this._c):[].concat(n),r],a=o[0],l=o.reduce((c,u)=>{const d=ky(e,u,i);return c.top=Fn(d.top,c.top),c.right=rs(d.right,c.right),c.bottom=rs(d.bottom,c.bottom),c.left=Fn(d.left,c.left),c},ky(e,a,i));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function KL(t){const{width:e,height:n}=EE(t);return{width:e,height:n}}function JL(t,e,n){const r=Hr(e),i=Gr(e),s=n==="fixed",o=ro(t,!0,s,e);let a={scrollLeft:0,scrollTop:0};const l=is(0);if(r||!r&&!s)if((ja(e)!=="body"||cc(i))&&(a=lf(e)),r){const m=ro(e,!0,s,e);l.x=m.x+e.clientLeft,l.y=m.y+e.clientTop}else i&&(l.x=wm(i));let c=0,u=0;if(i&&!r&&!s){const m=i.getBoundingClientRect();u=m.top+a.scrollTop,c=m.left+a.scrollLeft-wm(i,m)}const d=o.left+a.scrollLeft-l.x-c,h=o.top+a.scrollTop-l.y-u;return{x:d,y:h,width:o.width,height:o.height}}function vh(t){return Rr(t).position==="static"}function Oy(t,e){if(!Hr(t)||Rr(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return Gr(t)===n&&(n=n.ownerDocument.body),n}function ME(t,e){const n=Vn(t);if(af(t))return n;if(!Hr(t)){let i=os(t);for(;i&&!ya(i);){if(Ar(i)&&!vh(i))return i;i=os(i)}return n}let r=Oy(t,e);for(;r&&BL(r)&&vh(r);)r=Oy(r,e);return r&&ya(r)&&vh(r)&&!Ov(r)?n:r||jL(t)||n}const ZL=async function(t){const e=this.getOffsetParent||ME,n=this.getDimensions,r=await n(t.floating);return{reference:JL(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function QL(t){return Rr(t).direction==="rtl"}const eD={convertOffsetParentRelativeRectToViewportRelativeRect:HL,getDocumentElement:Gr,getClippingRect:YL,getOffsetParent:ME,getElementRects:ZL,getClientRects:GL,getDimensions:KL,getScale:sa,isElement:Ar,isRTL:QL};function tD(t,e){let n=null,r;const i=Gr(t);function s(){var a;clearTimeout(r),(a=n)==null||a.disconnect(),n=null}function o(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),s();const{left:c,top:u,width:d,height:h}=t.getBoundingClientRect();if(a||e(),!d||!h)return;const m=zc(u),x=zc(i.clientWidth-(c+d)),v=zc(i.clientHeight-(u+h)),g=zc(c),y={rootMargin:-m+"px "+-x+"px "+-v+"px "+-g+"px",threshold:Fn(0,rs(1,l))||1};let _=!0;function w(E){const M=E[0].intersectionRatio;if(M!==l){if(!_)return o();M?o(!1,M):r=setTimeout(()=>{o(!1,1e-7)},1e3)}_=!1}try{n=new IntersectionObserver(w,{...y,root:i.ownerDocument})}catch{n=new IntersectionObserver(w,y)}n.observe(t)}return o(!0),s}function nD(t,e,n,r){r===void 0&&(r={});const{ancestorScroll:i=!0,ancestorResize:s=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,c=Bv(t),u=i||s?[...c?Kl(c):[],...Kl(e)]:[];u.forEach(p=>{i&&p.addEventListener("scroll",n,{passive:!0}),s&&p.addEventListener("resize",n)});const d=c&&a?tD(c,n):null;let h=-1,m=null;o&&(m=new ResizeObserver(p=>{let[y]=p;y&&y.target===c&&m&&(m.unobserve(e),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{var _;(_=m)==null||_.observe(e)})),n()}),c&&!l&&m.observe(c),m.observe(e));let x,v=l?ro(t):null;l&&g();function g(){const p=ro(t);v&&(p.x!==v.x||p.y!==v.y||p.width!==v.width||p.height!==v.height)&&n(),v=p,x=requestAnimationFrame(g)}return n(),()=>{var p;u.forEach(y=>{i&&y.removeEventListener("scroll",n),s&&y.removeEventListener("resize",n)}),d==null||d(),(p=m)==null||p.disconnect(),m=null,l&&cancelAnimationFrame(x)}}const rD=UL,iD=kL,sD=IL,oD=FL,aD=LL,Fy=NL,lD=OL,cD=(t,e,n)=>{const r=new Map,i={platform:eD,...n},s={...i.platform,_c:r};return PL(t,e,{...i,platform:s})};var Nu=typeof document<"u"?S.useLayoutEffect:S.useEffect;function wd(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,r,i;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(r=n;r--!==0;)if(!wd(t[r],e[r]))return!1;return!0}if(i=Object.keys(t),n=i.length,n!==Object.keys(e).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(e,i[r]))return!1;for(r=n;r--!==0;){const s=i[r];if(!(s==="_owner"&&t.$$typeof)&&!wd(t[s],e[s]))return!1}return!0}return t!==t&&e!==e}function CE(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function By(t,e){const n=CE(t);return Math.round(e*n)/n}function xh(t){const e=S.useRef(t);return Nu(()=>{e.current=t}),e}function uD(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:r=[],platform:i,elements:{reference:s,floating:o}={},transform:a=!0,whileElementsMounted:l,open:c}=t,[u,d]=S.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[h,m]=S.useState(r);wd(h,r)||m(r);const[x,v]=S.useState(null),[g,p]=S.useState(null),y=S.useCallback(L=>{L!==M.current&&(M.current=L,v(L))},[]),_=S.useCallback(L=>{L!==T.current&&(T.current=L,p(L))},[]),w=s||x,E=o||g,M=S.useRef(null),T=S.useRef(null),P=S.useRef(u),C=l!=null,b=xh(l),N=xh(i),U=xh(c),O=S.useCallback(()=>{if(!M.current||!T.current)return;const L={placement:e,strategy:n,middleware:h};N.current&&(L.platform=N.current),cD(M.current,T.current,L).then(H=>{const j={...H,isPositioned:U.current!==!1};V.current&&!wd(P.current,j)&&(P.current=j,Da.flushSync(()=>{d(j)}))})},[h,e,n,N,U]);Nu(()=>{c===!1&&P.current.isPositioned&&(P.current.isPositioned=!1,d(L=>({...L,isPositioned:!1})))},[c]);const V=S.useRef(!1);Nu(()=>(V.current=!0,()=>{V.current=!1}),[]),Nu(()=>{if(w&&(M.current=w),E&&(T.current=E),w&&E){if(b.current)return b.current(w,E,O);O()}},[w,E,O,b,C]);const Y=S.useMemo(()=>({reference:M,floating:T,setReference:y,setFloating:_}),[y,_]),z=S.useMemo(()=>({reference:w,floating:E}),[w,E]),W=S.useMemo(()=>{const L={position:n,left:0,top:0};if(!z.floating)return L;const H=By(z.floating,u.x),j=By(z.floating,u.y);return a?{...L,transform:"translate("+H+"px, "+j+"px)",...CE(z.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:H,top:j}},[n,a,z.floating,u.x,u.y]);return S.useMemo(()=>({...u,update:O,refs:Y,elements:z,floatingStyles:W}),[u,O,Y,z,W])}const dD=t=>{function e(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:r,padding:i}=typeof t=="function"?t(n):t;return r&&e(r)?r.current!=null?Fy({element:r.current,padding:i}).fn(n):{}:r?Fy({element:r,padding:i}).fn(n):{}}}},fD=(t,e)=>({...rD(t),options:[t,e]}),hD=(t,e)=>({...iD(t),options:[t,e]}),pD=(t,e)=>({...lD(t),options:[t,e]}),mD=(t,e)=>({...sD(t),options:[t,e]}),gD=(t,e)=>({...oD(t),options:[t,e]}),vD=(t,e)=>({...aD(t),options:[t,e]}),xD=(t,e)=>({...dD(t),options:[t,e]});var yD="Arrow",AE=S.forwardRef((t,e)=>{const{children:n,width:r=10,height:i=5,...s}=t;return f.jsx(lt.svg,{...s,ref:e,width:r,height:i,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?n:f.jsx("polygon",{points:"0,0 30,0 15,10"})})});AE.displayName=yD;var _D=AE;function wD(t,e=[]){let n=[];function r(s,o){const a=S.createContext(o),l=n.length;n=[...n,o];function c(d){const{scope:h,children:m,...x}=d,v=(h==null?void 0:h[t][l])||a,g=S.useMemo(()=>x,Object.values(x));return f.jsx(v.Provider,{value:g,children:m})}function u(d,h){const m=(h==null?void 0:h[t][l])||a,x=S.useContext(m);if(x)return x;if(o!==void 0)return o;throw new Error(`\`${d}\` must be used within \`${s}\``)}return c.displayName=s+"Provider",[c,u]}const i=()=>{const s=n.map(o=>S.createContext(o));return function(a){const l=(a==null?void 0:a[t])||s;return S.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return i.scopeName=t,[r,SD(i,...e)]}function SD(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(s){const o=r.reduce((a,{useScope:l,scopeName:c})=>{const d=l(s)[`__scope${c}`];return{...a,...d}},{});return S.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}function ED(t){const[e,n]=S.useState(void 0);return vn(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const r=new ResizeObserver(i=>{if(!Array.isArray(i)||!i.length)return;const s=i[0];let o,a;if("borderBoxSize"in s){const l=s.borderBoxSize,c=Array.isArray(l)?l[0]:l;o=c.inlineSize,a=c.blockSize}else o=t.offsetWidth,a=t.offsetHeight;n({width:o,height:a})});return r.observe(t,{box:"border-box"}),()=>r.unobserve(t)}else n(void 0)},[t]),e}var jv="Popper",[RE,cf]=wD(jv),[bD,PE]=RE(jv),NE=t=>{const{__scopePopper:e,children:n}=t,[r,i]=S.useState(null);return f.jsx(bD,{scope:e,anchor:r,onAnchorChange:i,children:n})};NE.displayName=jv;var IE="PopperAnchor",LE=S.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:r,...i}=t,s=PE(IE,n),o=S.useRef(null),a=kt(e,o);return S.useEffect(()=>{s.onAnchorChange((r==null?void 0:r.current)||o.current)}),r?null:f.jsx(lt.div,{...i,ref:a})});LE.displayName=IE;var zv="PopperContent",[TD,MD]=RE(zv),DE=S.forwardRef((t,e)=>{var X,he,J,q,re,ie;const{__scopePopper:n,side:r="bottom",sideOffset:i=0,align:s="center",alignOffset:o=0,arrowPadding:a=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:h=!1,updatePositionStrategy:m="optimized",onPlaced:x,...v}=t,g=PE(zv,n),[p,y]=S.useState(null),_=kt(e,I=>y(I)),[w,E]=S.useState(null),M=ED(w),T=(M==null?void 0:M.width)??0,P=(M==null?void 0:M.height)??0,C=r+(s!=="center"?"-"+s:""),b=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},N=Array.isArray(c)?c:[c],U=N.length>0,O={padding:b,boundary:N.filter(AD),altBoundary:U},{refs:V,floatingStyles:Y,placement:z,isPositioned:W,middlewareData:L}=uD({strategy:"fixed",placement:C,whileElementsMounted:(...I)=>nD(...I,{animationFrame:m==="always"}),elements:{reference:g.anchor},middleware:[fD({mainAxis:i+P,alignmentAxis:o}),l&&hD({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?pD():void 0,...O}),l&&mD({...O}),gD({...O,apply:({elements:I,rects:be,availableWidth:Ee,availableHeight:He})=>{const{width:Me,height:it}=be.reference,ge=I.floating.style;ge.setProperty("--radix-popper-available-width",`${Ee}px`),ge.setProperty("--radix-popper-available-height",`${He}px`),ge.setProperty("--radix-popper-anchor-width",`${Me}px`),ge.setProperty("--radix-popper-anchor-height",`${it}px`)}}),w&&xD({element:w,padding:a}),RD({arrowWidth:T,arrowHeight:P}),h&&vD({strategy:"referenceHidden",...O})]}),[H,j]=OE(z),ee=Vr(x);vn(()=>{W&&(ee==null||ee())},[W,ee]);const ve=(X=L.arrow)==null?void 0:X.x,Be=(he=L.arrow)==null?void 0:he.y,Ue=((J=L.arrow)==null?void 0:J.centerOffset)!==0,[Q,oe]=S.useState();return vn(()=>{p&&oe(window.getComputedStyle(p).zIndex)},[p]),f.jsx("div",{ref:V.setFloating,"data-radix-popper-content-wrapper":"",style:{...Y,transform:W?Y.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Q,"--radix-popper-transform-origin":[(q=L.transformOrigin)==null?void 0:q.x,(re=L.transformOrigin)==null?void 0:re.y].join(" "),...((ie=L.hide)==null?void 0:ie.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:f.jsx(TD,{scope:n,placedSide:H,onArrowChange:E,arrowX:ve,arrowY:Be,shouldHideArrow:Ue,children:f.jsx(lt.div,{"data-side":H,"data-align":j,...v,ref:_,style:{...v.style,animation:W?void 0:"none"}})})})});DE.displayName=zv;var UE="PopperArrow",CD={top:"bottom",right:"left",bottom:"top",left:"right"},kE=S.forwardRef(function(e,n){const{__scopePopper:r,...i}=e,s=MD(UE,r),o=CD[s.placedSide];return f.jsx("span",{ref:s.onArrowChange,style:{position:"absolute",left:s.arrowX,top:s.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[s.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[s.placedSide],visibility:s.shouldHideArrow?"hidden":void 0},children:f.jsx(_D,{...i,ref:n,style:{...i.style,display:"block"}})})});kE.displayName=UE;function AD(t){return t!==null}var RD=t=>({name:"transformOrigin",options:t,fn(e){var g,p,y;const{placement:n,rects:r,middlewareData:i}=e,o=((g=i.arrow)==null?void 0:g.centerOffset)!==0,a=o?0:t.arrowWidth,l=o?0:t.arrowHeight,[c,u]=OE(n),d={start:"0%",center:"50%",end:"100%"}[u],h=(((p=i.arrow)==null?void 0:p.x)??0)+a/2,m=(((y=i.arrow)==null?void 0:y.y)??0)+l/2;let x="",v="";return c==="bottom"?(x=o?d:`${h}px`,v=`${-l}px`):c==="top"?(x=o?d:`${h}px`,v=`${r.floating.height+l}px`):c==="right"?(x=`${-l}px`,v=o?d:`${m}px`):c==="left"&&(x=`${r.floating.width+l}px`,v=o?d:`${m}px`),{data:{x,y:v}}}});function OE(t){const[e,n="center"]=t.split("-");return[e,n]}var FE=NE,BE=LE,jE=DE,zE=kE,PD="Portal",VE=S.forwardRef((t,e)=>{var a;const{container:n,...r}=t,[i,s]=S.useState(!1);vn(()=>s(!0),[]);const o=n||i&&((a=globalThis==null?void 0:globalThis.document)==null?void 0:a.body);return o?iR.createPortal(f.jsx(lt.div,{...r,ref:e}),o):null});VE.displayName=PD;function as({prop:t,defaultProp:e,onChange:n=()=>{}}){const[r,i]=ND({defaultProp:e,onChange:n}),s=t!==void 0,o=s?t:r,a=Vr(n),l=S.useCallback(c=>{if(s){const d=typeof c=="function"?c(t):c;d!==t&&a(d)}else i(c)},[s,t,i,a]);return[o,l]}function ND({defaultProp:t,onChange:e}){const n=S.useState(t),[r]=n,i=S.useRef(r),s=Vr(e);return S.useEffect(()=>{i.current!==r&&(s(r),i.current=r)},[r,i,s]),n}function ID(t){const e=S.useRef({value:t,previous:t});return S.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}var LD="VisuallyHidden",Vv=S.forwardRef((t,e)=>f.jsx(lt.span,{...t,ref:e,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...t.style}}));Vv.displayName=LD;var DD=Vv,UD=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},xo=new WeakMap,Vc=new WeakMap,Hc={},yh=0,HE=function(t){return t&&(t.host||HE(t.parentNode))},kD=function(t,e){return e.map(function(n){if(t.contains(n))return n;var r=HE(n);return r&&t.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},OD=function(t,e,n,r){var i=kD(e,Array.isArray(t)?t:[t]);Hc[n]||(Hc[n]=new WeakMap);var s=Hc[n],o=[],a=new Set,l=new Set(i),c=function(d){!d||a.has(d)||(a.add(d),c(d.parentNode))};i.forEach(c);var u=function(d){!d||l.has(d)||Array.prototype.forEach.call(d.children,function(h){if(a.has(h))u(h);else try{var m=h.getAttribute(r),x=m!==null&&m!=="false",v=(xo.get(h)||0)+1,g=(s.get(h)||0)+1;xo.set(h,v),s.set(h,g),o.push(h),v===1&&x&&Vc.set(h,!0),g===1&&h.setAttribute(n,"true"),x||h.setAttribute(r,"true")}catch(p){console.error("aria-hidden: cannot operate on ",h,p)}})};return u(e),a.clear(),yh++,function(){o.forEach(function(d){var h=xo.get(d)-1,m=s.get(d)-1;xo.set(d,h),s.set(d,m),h||(Vc.has(d)||d.removeAttribute(r),Vc.delete(d)),m||d.removeAttribute(n)}),yh--,yh||(xo=new WeakMap,xo=new WeakMap,Vc=new WeakMap,Hc={})}},FD=function(t,e,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(t)?t:[t]),i=UD(t);return i?(r.push.apply(r,Array.from(i.querySelectorAll("[aria-live]"))),OD(r,i,n,"aria-hidden")):function(){return null}},kr=function(){return kr=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},kr.apply(this,arguments)};function GE(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function BD(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return t.concat(s||Array.prototype.slice.call(e))}var Iu="right-scroll-bar-position",Lu="width-before-scroll-bar",jD="with-scroll-bars-hidden",zD="--removed-body-scroll-bar-size";function _h(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function VD(t,e){var n=S.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(r){var i=n.value;i!==r&&(n.value=r,n.callback(r,i))}}}})[0];return n.callback=e,n.facade}var HD=typeof window<"u"?S.useLayoutEffect:S.useEffect,jy=new WeakMap;function GD(t,e){var n=VD(null,function(r){return t.forEach(function(i){return _h(i,r)})});return HD(function(){var r=jy.get(n);if(r){var i=new Set(r),s=new Set(t),o=n.current;i.forEach(function(a){s.has(a)||_h(a,null)}),s.forEach(function(a){i.has(a)||_h(a,o)})}jy.set(n,t)},[t]),n}function WD(t){return t}function $D(t,e){e===void 0&&(e=WD);var n=[],r=!1,i={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(s){var o=e(s,r);return n.push(o),function(){n=n.filter(function(a){return a!==o})}},assignSyncMedium:function(s){for(r=!0;n.length;){var o=n;n=[],o.forEach(s)}n={push:function(a){return s(a)},filter:function(){return n}}},assignMedium:function(s){r=!0;var o=[];if(n.length){var a=n;n=[],a.forEach(s),o=n}var l=function(){var u=o;o=[],u.forEach(s)},c=function(){return Promise.resolve().then(l)};c(),n={push:function(u){o.push(u),c()},filter:function(u){return o=o.filter(u),n}}}};return i}function XD(t){t===void 0&&(t={});var e=$D(null);return e.options=kr({async:!0,ssr:!1},t),e}var WE=function(t){var e=t.sideCar,n=GE(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=e.read();if(!r)throw new Error("Sidecar medium not found");return S.createElement(r,kr({},n))};WE.isSideCarExport=!0;function qD(t,e){return t.useMedium(e),WE}var $E=XD(),wh=function(){},uf=S.forwardRef(function(t,e){var n=S.useRef(null),r=S.useState({onScrollCapture:wh,onWheelCapture:wh,onTouchMoveCapture:wh}),i=r[0],s=r[1],o=t.forwardProps,a=t.children,l=t.className,c=t.removeScrollBar,u=t.enabled,d=t.shards,h=t.sideCar,m=t.noIsolation,x=t.inert,v=t.allowPinchZoom,g=t.as,p=g===void 0?"div":g,y=t.gapMode,_=GE(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),w=h,E=GD([n,e]),M=kr(kr({},_),i);return S.createElement(S.Fragment,null,u&&S.createElement(w,{sideCar:$E,removeScrollBar:c,shards:d,noIsolation:m,inert:x,setCallbacks:s,allowPinchZoom:!!v,lockRef:n,gapMode:y}),o?S.cloneElement(S.Children.only(a),kr(kr({},M),{ref:E})):S.createElement(p,kr({},M,{className:l,ref:E}),a))});uf.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};uf.classNames={fullWidth:Lu,zeroRight:Iu};var YD=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function KD(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=YD();return e&&t.setAttribute("nonce",e),t}function JD(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function ZD(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var QD=function(){var t=0,e=null;return{add:function(n){t==0&&(e=KD())&&(JD(e,n),ZD(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},e3=function(){var t=QD();return function(e,n){S.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])}},XE=function(){var t=e3(),e=function(n){var r=n.styles,i=n.dynamic;return t(r,i),null};return e},t3={left:0,top:0,right:0,gap:0},Sh=function(t){return parseInt(t||"",10)||0},n3=function(t){var e=window.getComputedStyle(document.body),n=e[t==="padding"?"paddingLeft":"marginLeft"],r=e[t==="padding"?"paddingTop":"marginTop"],i=e[t==="padding"?"paddingRight":"marginRight"];return[Sh(n),Sh(r),Sh(i)]},r3=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return t3;var e=n3(t),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,r-n+e[2]-e[0])}},i3=XE(),oa="data-scroll-locked",s3=function(t,e,n,r){var i=t.left,s=t.top,o=t.right,a=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(jD,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(a,"px ").concat(r,`;
  }
  body[`).concat(oa,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(i,`px;
    padding-top: `).concat(s,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(a,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Iu,` {
    right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(Lu,` {
    margin-right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(Iu," .").concat(Iu,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(Lu," .").concat(Lu,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(oa,`] {
    `).concat(zD,": ").concat(a,`px;
  }
`)},zy=function(){var t=parseInt(document.body.getAttribute(oa)||"0",10);return isFinite(t)?t:0},o3=function(){S.useEffect(function(){return document.body.setAttribute(oa,(zy()+1).toString()),function(){var t=zy()-1;t<=0?document.body.removeAttribute(oa):document.body.setAttribute(oa,t.toString())}},[])},a3=function(t){var e=t.noRelative,n=t.noImportant,r=t.gapMode,i=r===void 0?"margin":r;o3();var s=S.useMemo(function(){return r3(i)},[i]);return S.createElement(i3,{styles:s3(s,!e,i,n?"":"!important")})},Sm=!1;if(typeof window<"u")try{var Gc=Object.defineProperty({},"passive",{get:function(){return Sm=!0,!0}});window.addEventListener("test",Gc,Gc),window.removeEventListener("test",Gc,Gc)}catch{Sm=!1}var yo=Sm?{passive:!1}:!1,l3=function(t){return t.tagName==="TEXTAREA"},qE=function(t,e){if(!(t instanceof Element))return!1;var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!l3(t)&&n[e]==="visible")},c3=function(t){return qE(t,"overflowY")},u3=function(t){return qE(t,"overflowX")},Vy=function(t,e){var n=e.ownerDocument,r=e;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var i=YE(t,r);if(i){var s=KE(t,r),o=s[1],a=s[2];if(o>a)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},d3=function(t){var e=t.scrollTop,n=t.scrollHeight,r=t.clientHeight;return[e,n,r]},f3=function(t){var e=t.scrollLeft,n=t.scrollWidth,r=t.clientWidth;return[e,n,r]},YE=function(t,e){return t==="v"?c3(e):u3(e)},KE=function(t,e){return t==="v"?d3(e):f3(e)},h3=function(t,e){return t==="h"&&e==="rtl"?-1:1},p3=function(t,e,n,r,i){var s=h3(t,window.getComputedStyle(e).direction),o=s*r,a=n.target,l=e.contains(a),c=!1,u=o>0,d=0,h=0;do{var m=KE(t,a),x=m[0],v=m[1],g=m[2],p=v-g-s*x;(x||p)&&YE(t,a)&&(d+=p,h+=x),a instanceof ShadowRoot?a=a.host:a=a.parentNode}while(!l&&a!==document.body||l&&(e.contains(a)||e===a));return(u&&(Math.abs(d)<1||!i)||!u&&(Math.abs(h)<1||!i))&&(c=!0),c},Wc=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},Hy=function(t){return[t.deltaX,t.deltaY]},Gy=function(t){return t&&"current"in t?t.current:t},m3=function(t,e){return t[0]===e[0]&&t[1]===e[1]},g3=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},v3=0,_o=[];function x3(t){var e=S.useRef([]),n=S.useRef([0,0]),r=S.useRef(),i=S.useState(v3++)[0],s=S.useState(XE)[0],o=S.useRef(t);S.useEffect(function(){o.current=t},[t]),S.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(i));var v=BD([t.lockRef.current],(t.shards||[]).map(Gy),!0).filter(Boolean);return v.forEach(function(g){return g.classList.add("allow-interactivity-".concat(i))}),function(){document.body.classList.remove("block-interactivity-".concat(i)),v.forEach(function(g){return g.classList.remove("allow-interactivity-".concat(i))})}}},[t.inert,t.lockRef.current,t.shards]);var a=S.useCallback(function(v,g){if("touches"in v&&v.touches.length===2||v.type==="wheel"&&v.ctrlKey)return!o.current.allowPinchZoom;var p=Wc(v),y=n.current,_="deltaX"in v?v.deltaX:y[0]-p[0],w="deltaY"in v?v.deltaY:y[1]-p[1],E,M=v.target,T=Math.abs(_)>Math.abs(w)?"h":"v";if("touches"in v&&T==="h"&&M.type==="range")return!1;var P=Vy(T,M);if(!P)return!0;if(P?E=T:(E=T==="v"?"h":"v",P=Vy(T,M)),!P)return!1;if(!r.current&&"changedTouches"in v&&(_||w)&&(r.current=E),!E)return!0;var C=r.current||E;return p3(C,g,v,C==="h"?_:w,!0)},[]),l=S.useCallback(function(v){var g=v;if(!(!_o.length||_o[_o.length-1]!==s)){var p="deltaY"in g?Hy(g):Wc(g),y=e.current.filter(function(E){return E.name===g.type&&(E.target===g.target||g.target===E.shadowParent)&&m3(E.delta,p)})[0];if(y&&y.should){g.cancelable&&g.preventDefault();return}if(!y){var _=(o.current.shards||[]).map(Gy).filter(Boolean).filter(function(E){return E.contains(g.target)}),w=_.length>0?a(g,_[0]):!o.current.noIsolation;w&&g.cancelable&&g.preventDefault()}}},[]),c=S.useCallback(function(v,g,p,y){var _={name:v,delta:g,target:p,should:y,shadowParent:y3(p)};e.current.push(_),setTimeout(function(){e.current=e.current.filter(function(w){return w!==_})},1)},[]),u=S.useCallback(function(v){n.current=Wc(v),r.current=void 0},[]),d=S.useCallback(function(v){c(v.type,Hy(v),v.target,a(v,t.lockRef.current))},[]),h=S.useCallback(function(v){c(v.type,Wc(v),v.target,a(v,t.lockRef.current))},[]);S.useEffect(function(){return _o.push(s),t.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:h}),document.addEventListener("wheel",l,yo),document.addEventListener("touchmove",l,yo),document.addEventListener("touchstart",u,yo),function(){_o=_o.filter(function(v){return v!==s}),document.removeEventListener("wheel",l,yo),document.removeEventListener("touchmove",l,yo),document.removeEventListener("touchstart",u,yo)}},[]);var m=t.removeScrollBar,x=t.inert;return S.createElement(S.Fragment,null,x?S.createElement(s,{styles:g3(i)}):null,m?S.createElement(a3,{gapMode:t.gapMode}):null)}function y3(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const _3=qD($E,x3);var JE=S.forwardRef(function(t,e){return S.createElement(uf,kr({},t,{ref:e,sideCar:_3}))});JE.classNames=uf.classNames;var w3=[" ","Enter","ArrowUp","ArrowDown"],S3=[" ","Enter"],uc="Select",[df,ff,E3]=Iv(uc),[za,MV]=lc(uc,[E3,cf]),hf=cf(),[b3,gs]=za(uc),[T3,M3]=za(uc),ZE=t=>{const{__scopeSelect:e,children:n,open:r,defaultOpen:i,onOpenChange:s,value:o,defaultValue:a,onValueChange:l,dir:c,name:u,autoComplete:d,disabled:h,required:m,form:x}=t,v=hf(e),[g,p]=S.useState(null),[y,_]=S.useState(null),[w,E]=S.useState(!1),M=sf(c),[T=!1,P]=as({prop:r,defaultProp:i,onChange:s}),[C,b]=as({prop:o,defaultProp:a,onChange:l}),N=S.useRef(null),U=g?x||!!g.closest("form"):!0,[O,V]=S.useState(new Set),Y=Array.from(O).map(z=>z.props.value).join(";");return f.jsx(FE,{...v,children:f.jsxs(b3,{required:m,scope:e,trigger:g,onTriggerChange:p,valueNode:y,onValueNodeChange:_,valueNodeHasChildren:w,onValueNodeHasChildrenChange:E,contentId:ms(),value:C,onValueChange:b,open:T,onOpenChange:P,dir:M,triggerPointerDownPosRef:N,disabled:h,children:[f.jsx(df.Provider,{scope:e,children:f.jsx(T3,{scope:t.__scopeSelect,onNativeOptionAdd:S.useCallback(z=>{V(W=>new Set(W).add(z))},[]),onNativeOptionRemove:S.useCallback(z=>{V(W=>{const L=new Set(W);return L.delete(z),L})},[]),children:n})}),U?f.jsxs(Eb,{"aria-hidden":!0,required:m,tabIndex:-1,name:u,autoComplete:d,value:C,onChange:z=>b(z.target.value),disabled:h,form:x,children:[C===void 0?f.jsx("option",{value:""}):null,Array.from(O)]},Y):null]})})};ZE.displayName=uc;var QE="SelectTrigger",eb=S.forwardRef((t,e)=>{const{__scopeSelect:n,disabled:r=!1,...i}=t,s=hf(n),o=gs(QE,n),a=o.disabled||r,l=kt(e,o.onTriggerChange),c=ff(n),u=S.useRef("touch"),[d,h,m]=bb(v=>{const g=c().filter(_=>!_.disabled),p=g.find(_=>_.value===o.value),y=Tb(g,v,p);y!==void 0&&o.onValueChange(y.value)}),x=v=>{a||(o.onOpenChange(!0),m()),v&&(o.triggerPointerDownPosRef.current={x:Math.round(v.pageX),y:Math.round(v.pageY)})};return f.jsx(BE,{asChild:!0,...s,children:f.jsx(lt.button,{type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:a,"data-disabled":a?"":void 0,"data-placeholder":Sb(o.value)?"":void 0,...i,ref:l,onClick:nt(i.onClick,v=>{v.currentTarget.focus(),u.current!=="mouse"&&x(v)}),onPointerDown:nt(i.onPointerDown,v=>{u.current=v.pointerType;const g=v.target;g.hasPointerCapture(v.pointerId)&&g.releasePointerCapture(v.pointerId),v.button===0&&v.ctrlKey===!1&&v.pointerType==="mouse"&&(x(v),v.preventDefault())}),onKeyDown:nt(i.onKeyDown,v=>{const g=d.current!=="";!(v.ctrlKey||v.altKey||v.metaKey)&&v.key.length===1&&h(v.key),!(g&&v.key===" ")&&w3.includes(v.key)&&(x(),v.preventDefault())})})})});eb.displayName=QE;var tb="SelectValue",nb=S.forwardRef((t,e)=>{const{__scopeSelect:n,className:r,style:i,children:s,placeholder:o="",...a}=t,l=gs(tb,n),{onValueNodeHasChildrenChange:c}=l,u=s!==void 0,d=kt(e,l.onValueNodeChange);return vn(()=>{c(u)},[c,u]),f.jsx(lt.span,{...a,ref:d,style:{pointerEvents:"none"},children:Sb(l.value)?f.jsx(f.Fragment,{children:o}):s})});nb.displayName=tb;var C3="SelectIcon",rb=S.forwardRef((t,e)=>{const{__scopeSelect:n,children:r,...i}=t;return f.jsx(lt.span,{"aria-hidden":!0,...i,ref:e,children:r||"▼"})});rb.displayName=C3;var A3="SelectPortal",ib=t=>f.jsx(VE,{asChild:!0,...t});ib.displayName=A3;var io="SelectContent",sb=S.forwardRef((t,e)=>{const n=gs(io,t.__scopeSelect),[r,i]=S.useState();if(vn(()=>{i(new DocumentFragment)},[]),!n.open){const s=r;return s?Da.createPortal(f.jsx(ob,{scope:t.__scopeSelect,children:f.jsx(df.Slot,{scope:t.__scopeSelect,children:f.jsx("div",{children:t.children})})}),s):null}return f.jsx(ab,{...t,ref:e})});sb.displayName=io;var pr=10,[ob,vs]=za(io),R3="SelectContentImpl",ab=S.forwardRef((t,e)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:i,onEscapeKeyDown:s,onPointerDownOutside:o,side:a,sideOffset:l,align:c,alignOffset:u,arrowPadding:d,collisionBoundary:h,collisionPadding:m,sticky:x,hideWhenDetached:v,avoidCollisions:g,...p}=t,y=gs(io,n),[_,w]=S.useState(null),[E,M]=S.useState(null),T=kt(e,X=>w(X)),[P,C]=S.useState(null),[b,N]=S.useState(null),U=ff(n),[O,V]=S.useState(!1),Y=S.useRef(!1);S.useEffect(()=>{if(_)return FD(_)},[_]),fL();const z=S.useCallback(X=>{const[he,...J]=U().map(ie=>ie.ref.current),[q]=J.slice(-1),re=document.activeElement;for(const ie of X)if(ie===re||(ie==null||ie.scrollIntoView({block:"nearest"}),ie===he&&E&&(E.scrollTop=0),ie===q&&E&&(E.scrollTop=E.scrollHeight),ie==null||ie.focus(),document.activeElement!==re))return},[U,E]),W=S.useCallback(()=>z([P,_]),[z,P,_]);S.useEffect(()=>{O&&W()},[O,W]);const{onOpenChange:L,triggerPointerDownPosRef:H}=y;S.useEffect(()=>{if(_){let X={x:0,y:0};const he=q=>{var re,ie;X={x:Math.abs(Math.round(q.pageX)-(((re=H.current)==null?void 0:re.x)??0)),y:Math.abs(Math.round(q.pageY)-(((ie=H.current)==null?void 0:ie.y)??0))}},J=q=>{X.x<=10&&X.y<=10?q.preventDefault():_.contains(q.target)||L(!1),document.removeEventListener("pointermove",he),H.current=null};return H.current!==null&&(document.addEventListener("pointermove",he),document.addEventListener("pointerup",J,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",he),document.removeEventListener("pointerup",J,{capture:!0})}}},[_,L,H]),S.useEffect(()=>{const X=()=>L(!1);return window.addEventListener("blur",X),window.addEventListener("resize",X),()=>{window.removeEventListener("blur",X),window.removeEventListener("resize",X)}},[L]);const[j,ee]=bb(X=>{const he=U().filter(re=>!re.disabled),J=he.find(re=>re.ref.current===document.activeElement),q=Tb(he,X,J);q&&setTimeout(()=>q.ref.current.focus())}),ve=S.useCallback((X,he,J)=>{const q=!Y.current&&!J;(y.value!==void 0&&y.value===he||q)&&(C(X),q&&(Y.current=!0))},[y.value]),Be=S.useCallback(()=>_==null?void 0:_.focus(),[_]),Ue=S.useCallback((X,he,J)=>{const q=!Y.current&&!J;(y.value!==void 0&&y.value===he||q)&&N(X)},[y.value]),Q=r==="popper"?Em:lb,oe=Q===Em?{side:a,sideOffset:l,align:c,alignOffset:u,arrowPadding:d,collisionBoundary:h,collisionPadding:m,sticky:x,hideWhenDetached:v,avoidCollisions:g}:{};return f.jsx(ob,{scope:n,content:_,viewport:E,onViewportChange:M,itemRefCallback:ve,selectedItem:P,onItemLeave:Be,itemTextRefCallback:Ue,focusSelectedItem:W,selectedItemText:b,position:r,isPositioned:O,searchRef:j,children:f.jsx(JE,{as:va,allowPinchZoom:!0,children:f.jsx(xE,{asChild:!0,trapped:y.open,onMountAutoFocus:X=>{X.preventDefault()},onUnmountAutoFocus:nt(i,X=>{var he;(he=y.trigger)==null||he.focus({preventScroll:!0}),X.preventDefault()}),children:f.jsx(Lv,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:s,onPointerDownOutside:o,onFocusOutside:X=>X.preventDefault(),onDismiss:()=>y.onOpenChange(!1),children:f.jsx(Q,{role:"listbox",id:y.contentId,"data-state":y.open?"open":"closed",dir:y.dir,onContextMenu:X=>X.preventDefault(),...p,...oe,onPlaced:()=>V(!0),ref:T,style:{display:"flex",flexDirection:"column",outline:"none",...p.style},onKeyDown:nt(p.onKeyDown,X=>{const he=X.ctrlKey||X.altKey||X.metaKey;if(X.key==="Tab"&&X.preventDefault(),!he&&X.key.length===1&&ee(X.key),["ArrowUp","ArrowDown","Home","End"].includes(X.key)){let q=U().filter(re=>!re.disabled).map(re=>re.ref.current);if(["ArrowUp","End"].includes(X.key)&&(q=q.slice().reverse()),["ArrowUp","ArrowDown"].includes(X.key)){const re=X.target,ie=q.indexOf(re);q=q.slice(ie+1)}setTimeout(()=>z(q)),X.preventDefault()}})})})})})})});ab.displayName=R3;var P3="SelectItemAlignedPosition",lb=S.forwardRef((t,e)=>{const{__scopeSelect:n,onPlaced:r,...i}=t,s=gs(io,n),o=vs(io,n),[a,l]=S.useState(null),[c,u]=S.useState(null),d=kt(e,T=>u(T)),h=ff(n),m=S.useRef(!1),x=S.useRef(!0),{viewport:v,selectedItem:g,selectedItemText:p,focusSelectedItem:y}=o,_=S.useCallback(()=>{if(s.trigger&&s.valueNode&&a&&c&&v&&g&&p){const T=s.trigger.getBoundingClientRect(),P=c.getBoundingClientRect(),C=s.valueNode.getBoundingClientRect(),b=p.getBoundingClientRect();if(s.dir!=="rtl"){const re=b.left-P.left,ie=C.left-re,I=T.left-ie,be=T.width+I,Ee=Math.max(be,P.width),He=window.innerWidth-pr,Me=by(ie,[pr,Math.max(pr,He-Ee)]);a.style.minWidth=be+"px",a.style.left=Me+"px"}else{const re=P.right-b.right,ie=window.innerWidth-C.right-re,I=window.innerWidth-T.right-ie,be=T.width+I,Ee=Math.max(be,P.width),He=window.innerWidth-pr,Me=by(ie,[pr,Math.max(pr,He-Ee)]);a.style.minWidth=be+"px",a.style.right=Me+"px"}const N=h(),U=window.innerHeight-pr*2,O=v.scrollHeight,V=window.getComputedStyle(c),Y=parseInt(V.borderTopWidth,10),z=parseInt(V.paddingTop,10),W=parseInt(V.borderBottomWidth,10),L=parseInt(V.paddingBottom,10),H=Y+z+O+L+W,j=Math.min(g.offsetHeight*5,H),ee=window.getComputedStyle(v),ve=parseInt(ee.paddingTop,10),Be=parseInt(ee.paddingBottom,10),Ue=T.top+T.height/2-pr,Q=U-Ue,oe=g.offsetHeight/2,X=g.offsetTop+oe,he=Y+z+X,J=H-he;if(he<=Ue){const re=N.length>0&&g===N[N.length-1].ref.current;a.style.bottom="0px";const ie=c.clientHeight-v.offsetTop-v.offsetHeight,I=Math.max(Q,oe+(re?Be:0)+ie+W),be=he+I;a.style.height=be+"px"}else{const re=N.length>0&&g===N[0].ref.current;a.style.top="0px";const I=Math.max(Ue,Y+v.offsetTop+(re?ve:0)+oe)+J;a.style.height=I+"px",v.scrollTop=he-Ue+v.offsetTop}a.style.margin=`${pr}px 0`,a.style.minHeight=j+"px",a.style.maxHeight=U+"px",r==null||r(),requestAnimationFrame(()=>m.current=!0)}},[h,s.trigger,s.valueNode,a,c,v,g,p,s.dir,r]);vn(()=>_(),[_]);const[w,E]=S.useState();vn(()=>{c&&E(window.getComputedStyle(c).zIndex)},[c]);const M=S.useCallback(T=>{T&&x.current===!0&&(_(),y==null||y(),x.current=!1)},[_,y]);return f.jsx(I3,{scope:n,contentWrapper:a,shouldExpandOnScrollRef:m,onScrollButtonChange:M,children:f.jsx("div",{ref:l,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:w},children:f.jsx(lt.div,{...i,ref:d,style:{boxSizing:"border-box",maxHeight:"100%",...i.style}})})})});lb.displayName=P3;var N3="SelectPopperPosition",Em=S.forwardRef((t,e)=>{const{__scopeSelect:n,align:r="start",collisionPadding:i=pr,...s}=t,o=hf(n);return f.jsx(jE,{...o,...s,ref:e,align:r,collisionPadding:i,style:{boxSizing:"border-box",...s.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});Em.displayName=N3;var[I3,Hv]=za(io,{}),bm="SelectViewport",cb=S.forwardRef((t,e)=>{const{__scopeSelect:n,nonce:r,...i}=t,s=vs(bm,n),o=Hv(bm,n),a=kt(e,s.onViewportChange),l=S.useRef(0);return f.jsxs(f.Fragment,{children:[f.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),f.jsx(df.Slot,{scope:n,children:f.jsx(lt.div,{"data-radix-select-viewport":"",role:"presentation",...i,ref:a,style:{position:"relative",flex:1,overflow:"hidden auto",...i.style},onScroll:nt(i.onScroll,c=>{const u=c.currentTarget,{contentWrapper:d,shouldExpandOnScrollRef:h}=o;if(h!=null&&h.current&&d){const m=Math.abs(l.current-u.scrollTop);if(m>0){const x=window.innerHeight-pr*2,v=parseFloat(d.style.minHeight),g=parseFloat(d.style.height),p=Math.max(v,g);if(p<x){const y=p+m,_=Math.min(x,y),w=y-_;d.style.height=_+"px",d.style.bottom==="0px"&&(u.scrollTop=w>0?w:0,d.style.justifyContent="flex-end")}}}l.current=u.scrollTop})})})]})});cb.displayName=bm;var ub="SelectGroup",[L3,D3]=za(ub),U3=S.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t,i=ms();return f.jsx(L3,{scope:n,id:i,children:f.jsx(lt.div,{role:"group","aria-labelledby":i,...r,ref:e})})});U3.displayName=ub;var db="SelectLabel",fb=S.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t,i=D3(db,n);return f.jsx(lt.div,{id:i.id,...r,ref:e})});fb.displayName=db;var Sd="SelectItem",[k3,hb]=za(Sd),pb=S.forwardRef((t,e)=>{const{__scopeSelect:n,value:r,disabled:i=!1,textValue:s,...o}=t,a=gs(Sd,n),l=vs(Sd,n),c=a.value===r,[u,d]=S.useState(s??""),[h,m]=S.useState(!1),x=kt(e,y=>{var _;return(_=l.itemRefCallback)==null?void 0:_.call(l,y,r,i)}),v=ms(),g=S.useRef("touch"),p=()=>{i||(a.onValueChange(r),a.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return f.jsx(k3,{scope:n,value:r,disabled:i,textId:v,isSelected:c,onItemTextChange:S.useCallback(y=>{d(_=>_||((y==null?void 0:y.textContent)??"").trim())},[]),children:f.jsx(df.ItemSlot,{scope:n,value:r,disabled:i,textValue:u,children:f.jsx(lt.div,{role:"option","aria-labelledby":v,"data-highlighted":h?"":void 0,"aria-selected":c&&h,"data-state":c?"checked":"unchecked","aria-disabled":i||void 0,"data-disabled":i?"":void 0,tabIndex:i?void 0:-1,...o,ref:x,onFocus:nt(o.onFocus,()=>m(!0)),onBlur:nt(o.onBlur,()=>m(!1)),onClick:nt(o.onClick,()=>{g.current!=="mouse"&&p()}),onPointerUp:nt(o.onPointerUp,()=>{g.current==="mouse"&&p()}),onPointerDown:nt(o.onPointerDown,y=>{g.current=y.pointerType}),onPointerMove:nt(o.onPointerMove,y=>{var _;g.current=y.pointerType,i?(_=l.onItemLeave)==null||_.call(l):g.current==="mouse"&&y.currentTarget.focus({preventScroll:!0})}),onPointerLeave:nt(o.onPointerLeave,y=>{var _;y.currentTarget===document.activeElement&&((_=l.onItemLeave)==null||_.call(l))}),onKeyDown:nt(o.onKeyDown,y=>{var w;((w=l.searchRef)==null?void 0:w.current)!==""&&y.key===" "||(S3.includes(y.key)&&p(),y.key===" "&&y.preventDefault())})})})})});pb.displayName=Sd;var fl="SelectItemText",mb=S.forwardRef((t,e)=>{const{__scopeSelect:n,className:r,style:i,...s}=t,o=gs(fl,n),a=vs(fl,n),l=hb(fl,n),c=M3(fl,n),[u,d]=S.useState(null),h=kt(e,p=>d(p),l.onItemTextChange,p=>{var y;return(y=a.itemTextRefCallback)==null?void 0:y.call(a,p,l.value,l.disabled)}),m=u==null?void 0:u.textContent,x=S.useMemo(()=>f.jsx("option",{value:l.value,disabled:l.disabled,children:m},l.value),[l.disabled,l.value,m]),{onNativeOptionAdd:v,onNativeOptionRemove:g}=c;return vn(()=>(v(x),()=>g(x)),[v,g,x]),f.jsxs(f.Fragment,{children:[f.jsx(lt.span,{id:l.textId,...s,ref:h}),l.isSelected&&o.valueNode&&!o.valueNodeHasChildren?Da.createPortal(s.children,o.valueNode):null]})});mb.displayName=fl;var gb="SelectItemIndicator",vb=S.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t;return hb(gb,n).isSelected?f.jsx(lt.span,{"aria-hidden":!0,...r,ref:e}):null});vb.displayName=gb;var Tm="SelectScrollUpButton",xb=S.forwardRef((t,e)=>{const n=vs(Tm,t.__scopeSelect),r=Hv(Tm,t.__scopeSelect),[i,s]=S.useState(!1),o=kt(e,r.onScrollButtonChange);return vn(()=>{if(n.viewport&&n.isPositioned){let a=function(){const c=l.scrollTop>0;s(c)};const l=n.viewport;return a(),l.addEventListener("scroll",a),()=>l.removeEventListener("scroll",a)}},[n.viewport,n.isPositioned]),i?f.jsx(_b,{...t,ref:o,onAutoScroll:()=>{const{viewport:a,selectedItem:l}=n;a&&l&&(a.scrollTop=a.scrollTop-l.offsetHeight)}}):null});xb.displayName=Tm;var Mm="SelectScrollDownButton",yb=S.forwardRef((t,e)=>{const n=vs(Mm,t.__scopeSelect),r=Hv(Mm,t.__scopeSelect),[i,s]=S.useState(!1),o=kt(e,r.onScrollButtonChange);return vn(()=>{if(n.viewport&&n.isPositioned){let a=function(){const c=l.scrollHeight-l.clientHeight,u=Math.ceil(l.scrollTop)<c;s(u)};const l=n.viewport;return a(),l.addEventListener("scroll",a),()=>l.removeEventListener("scroll",a)}},[n.viewport,n.isPositioned]),i?f.jsx(_b,{...t,ref:o,onAutoScroll:()=>{const{viewport:a,selectedItem:l}=n;a&&l&&(a.scrollTop=a.scrollTop+l.offsetHeight)}}):null});yb.displayName=Mm;var _b=S.forwardRef((t,e)=>{const{__scopeSelect:n,onAutoScroll:r,...i}=t,s=vs("SelectScrollButton",n),o=S.useRef(null),a=ff(n),l=S.useCallback(()=>{o.current!==null&&(window.clearInterval(o.current),o.current=null)},[]);return S.useEffect(()=>()=>l(),[l]),vn(()=>{var u;const c=a().find(d=>d.ref.current===document.activeElement);(u=c==null?void 0:c.ref.current)==null||u.scrollIntoView({block:"nearest"})},[a]),f.jsx(lt.div,{"aria-hidden":!0,...i,ref:e,style:{flexShrink:0,...i.style},onPointerDown:nt(i.onPointerDown,()=>{o.current===null&&(o.current=window.setInterval(r,50))}),onPointerMove:nt(i.onPointerMove,()=>{var c;(c=s.onItemLeave)==null||c.call(s),o.current===null&&(o.current=window.setInterval(r,50))}),onPointerLeave:nt(i.onPointerLeave,()=>{l()})})}),O3="SelectSeparator",wb=S.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t;return f.jsx(lt.div,{"aria-hidden":!0,...r,ref:e})});wb.displayName=O3;var Cm="SelectArrow",F3=S.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t,i=hf(n),s=gs(Cm,n),o=vs(Cm,n);return s.open&&o.position==="popper"?f.jsx(zE,{...i,...r,ref:e}):null});F3.displayName=Cm;function Sb(t){return t===""||t===void 0}var Eb=S.forwardRef((t,e)=>{const{value:n,...r}=t,i=S.useRef(null),s=kt(e,i),o=ID(n);return S.useEffect(()=>{const a=i.current,l=window.HTMLSelectElement.prototype,u=Object.getOwnPropertyDescriptor(l,"value").set;if(o!==n&&u){const d=new Event("change",{bubbles:!0});u.call(a,n),a.dispatchEvent(d)}},[o,n]),f.jsx(Vv,{asChild:!0,children:f.jsx("select",{...r,ref:s,defaultValue:n})})});Eb.displayName="BubbleSelect";function bb(t){const e=Vr(t),n=S.useRef(""),r=S.useRef(0),i=S.useCallback(o=>{const a=n.current+o;e(a),function l(c){n.current=c,window.clearTimeout(r.current),c!==""&&(r.current=window.setTimeout(()=>l(""),1e3))}(a)},[e]),s=S.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return S.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,i,s]}function Tb(t,e,n){const i=e.length>1&&Array.from(e).every(c=>c===e[0])?e[0]:e,s=n?t.indexOf(n):-1;let o=B3(t,Math.max(s,0));i.length===1&&(o=o.filter(c=>c!==n));const l=o.find(c=>c.textValue.toLowerCase().startsWith(i.toLowerCase()));return l!==n?l:void 0}function B3(t,e){return t.map((n,r)=>t[(e+r)%t.length])}var j3=ZE,Mb=eb,z3=nb,V3=rb,H3=ib,Cb=sb,G3=cb,Ab=fb,Rb=pb,W3=mb,$3=vb,Pb=xb,Nb=yb,Ib=wb;const X3=j3,q3=z3,Lb=S.forwardRef(({className:t,children:e,...n},r)=>f.jsxs(Mb,{ref:r,className:wt("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...n,children:[e,f.jsx(V3,{asChild:!0,children:f.jsx(Yd,{className:"h-4 w-4 opacity-50"})})]}));Lb.displayName=Mb.displayName;const Db=S.forwardRef(({className:t,...e},n)=>f.jsx(Pb,{ref:n,className:wt("flex cursor-default items-center justify-center py-1",t),...e,children:f.jsx(im,{className:"h-4 w-4"})}));Db.displayName=Pb.displayName;const Ub=S.forwardRef(({className:t,...e},n)=>f.jsx(Nb,{ref:n,className:wt("flex cursor-default items-center justify-center py-1",t),...e,children:f.jsx(Yd,{className:"h-4 w-4"})}));Ub.displayName=Nb.displayName;const kb=S.forwardRef(({className:t,children:e,position:n="popper",...r},i)=>f.jsx(H3,{children:f.jsxs(Cb,{ref:i,className:wt("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:n,...r,children:[f.jsx(Db,{}),f.jsx(G3,{className:wt("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:e}),f.jsx(Ub,{})]})}));kb.displayName=Cb.displayName;const Y3=S.forwardRef(({className:t,...e},n)=>f.jsx(Ab,{ref:n,className:wt("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...e}));Y3.displayName=Ab.displayName;const Du=S.forwardRef(({className:t,children:e,...n},r)=>f.jsxs(Rb,{ref:r,className:wt("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[f.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:f.jsx($3,{children:f.jsx(wv,{className:"h-4 w-4"})})}),f.jsx(W3,{children:e})]}));Du.displayName=Rb.displayName;const K3=S.forwardRef(({className:t,...e},n)=>f.jsx(Ib,{ref:n,className:wt("-mx-1 my-1 h-px bg-muted",t),...e}));K3.displayName=Ib.displayName;const Wy=({onSearch:t,placeholder:e="Search by keyword, price, or index..."})=>{const[n,r]=S.useState(""),[i,s]=S.useState(!0),o=l=>{l.preventDefault(),i&&t(n)},a=l=>{const c=l.target.value,u=mE(c||" ");s(u.isValid||c===""),r(c),(u.isValid||c==="")&&t(c)};return f.jsx("form",{onSubmit:o,className:"relative",children:f.jsxs("div",{className:"relative",children:[f.jsx(y2,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),f.jsx(ac,{type:"text",placeholder:e,value:n,onChange:a,className:`pl-10 glass-card border-border/50 focus:border-primary/50 ${i?"":"border-destructive focus:border-destructive"}`}),!i&&f.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-destructive text-xs",children:"Invalid input"})]})})},Ob=({refreshTrigger:t,showSearch:e=!1,limitResults:n})=>{const r=hs(),[i,s]=S.useState([]),[o,a]=S.useState([]),[l,c]=S.useState(""),[u,d]=S.useState("date"),[h,m]=S.useState("desc"),[x,v]=S.useState(!1);S.useEffect(()=>{const b=()=>{v(window.innerWidth<768)};return b(),window.addEventListener("resize",b),()=>window.removeEventListener("resize",b)},[]);const g=async()=>{try{const{data:b,error:N}=await jt.functions.invoke("get-uploads",{body:{limit:n||void 0,search:l||void 0,sortBy:u,sortOrder:h}});if(N){console.error("Error fetching uploads:",N);return}const U=b.uploads||[];s(U),a(U)}catch(b){console.error("Error:",b)}};S.useEffect(()=>{g()},[t,n,l,u,h]);const p=async b=>{c(b),await g()},y=b=>`$${(b/100).toFixed(2)}`,_=b=>new Date(b).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"}),w=b=>{if(!b||b.length<3)return"Anonymous User";const[N,U]=b.split("@");return!N||!U?"Anonymous User":N.length<=2?`${N}***`:`${N.substring(0,2)}${"*".repeat(Math.max(N.length-2,3))}`},E=(b,N=120)=>b.length>N?`${b.substring(0,N)}...`:b,M=b=>{r(`/post/${b}`)};if(i.length===0)return f.jsxs("div",{children:[e&&f.jsx("div",{className:"mb-6",children:f.jsx(Wy,{onSearch:p})}),f.jsx(_t,{className:"glass-card",children:f.jsxs(Lt,{className:"p-8 text-center",children:[f.jsx(C1,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),f.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No uploads yet"}),f.jsx("p",{className:"text-muted-foreground",children:"Be the first to join the experiment! 👀"})]})})]});const T=o.length>0?o:i,P=n===6?x?6:5:n,C=P?T.slice(0,P):T;return f.jsxs("div",{children:[e&&f.jsxs("div",{className:"mb-6",children:[f.jsx(Wy,{onSearch:p}),l&&f.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:["Showing ",C.length,' results for "',l,'"']})]}),f.jsx("div",{className:"mb-4 sm:mb-6 flex flex-col sm:flex-row gap-3 sm:gap-4 items-start sm:items-center justify-between",children:f.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3 w-full sm:w-auto",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("label",{className:"text-xs sm:text-sm font-medium text-muted-foreground",children:"Sort by:"}),f.jsxs(X3,{value:u,onValueChange:b=>d(b),children:[f.jsx(Lb,{className:"w-24 sm:w-32 h-8 text-xs sm:text-sm",children:f.jsx(q3,{})}),f.jsxs(kb,{children:[f.jsx(Du,{value:"date",children:"Date"}),f.jsx(Du,{value:"index",children:"Index"}),f.jsx(Du,{value:"votes",children:"Votes"})]})]})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("label",{className:"text-xs sm:text-sm font-medium text-muted-foreground",children:"Order:"}),f.jsxs(Ze,{variant:"outline",size:"sm",onClick:()=>m(h==="asc"?"desc":"asc"),className:"flex items-center gap-1 sm:gap-2 h-8 px-2 sm:px-3 text-xs sm:text-sm",children:[h==="asc"?f.jsx(s2,{className:"w-3 h-3 sm:w-4 sm:h-4"}):f.jsx(r2,{className:"w-3 h-3 sm:w-4 sm:h-4"}),f.jsx("span",{className:"hidden sm:inline",children:h==="asc"?"Ascending":"Descending"}),f.jsx("span",{className:"sm:hidden",children:h==="asc"?"Asc":"Desc"})]})]})]})}),f.jsx("div",{className:`grid gap-2 sm:gap-3 md:gap-4 ${n===6?"grid-cols-3 sm:grid-cols-3 md:grid-cols-5":P===5||n?"grid-cols-3 sm:grid-cols-4 md:grid-cols-5":"grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6"}`,children:C.map((b,N)=>f.jsx(_t,{className:"glass-card experiment-glow cursor-pointer hover:scale-105 transition-all duration-300 group h-56 sm:h-64 md:h-72 hover:shadow-2xl hover:shadow-primary/20 overflow-hidden",onClick:()=>M(b.id),children:f.jsxs(Lt,{className:"p-2 sm:p-3 md:p-4 h-full flex flex-col",children:[f.jsxs("div",{className:"relative mb-2 sm:mb-3 md:mb-4 flex-shrink-0 flex gap-1 sm:gap-2",children:[f.jsx("div",{className:"flex-1 overflow-hidden rounded-lg",children:f.jsx("img",{src:b.image_url,alt:b.caption,className:"w-full h-24 sm:h-32 md:h-36 object-cover group-hover:scale-105 transition-transform duration-300",loading:"lazy",onError:U=>{U.currentTarget.src="data:image/svg+xml;base64,"+btoa(`
                        <svg width="400" height="300" xmlns="http://www.w3.org/2000/svg">
                          <rect width="400" height="300" fill="#f3f4f6"/>
                          <text x="200" y="150" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" fill="#6b7280">
                            Image not available
                          </text>
                        </svg>
                      `)}})}),f.jsxs("div",{className:"flex-shrink-0 w-16 flex flex-col justify-start gap-2",onClick:U=>U.stopPropagation(),children:[f.jsx(ns,{variant:"outline",className:"bg-white text-black font-semibold text-xs price-ticker shadow-sm border w-full justify-center",children:y(b.price_paid)}),f.jsx(gd,{uploadId:b.id,compact:!0})]})]}),f.jsxs("div",{className:"flex-1 flex flex-col justify-between min-h-0",children:[f.jsx("div",{className:"flex-1 mb-3",children:f.jsx("p",{className:"text-xs sm:text-sm font-medium leading-relaxed break-words overflow-hidden display-text",children:E(b.caption,60)})}),f.jsxs("div",{className:"space-y-2 flex-shrink-0",children:[f.jsxs("div",{className:"sm:hidden space-y-1",children:[f.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[f.jsx(Vx,{className:"w-3 h-3 flex-shrink-0"}),f.jsx("span",{className:"truncate",children:_(b.created_at)})]}),f.jsx("div",{className:"text-xs font-medium text-primary/80 truncate",children:w(b.user_email)})]}),f.jsxs("div",{className:"hidden sm:flex items-center justify-between text-xs text-muted-foreground",children:[f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx(Vx,{className:"w-3 h-3 flex-shrink-0"}),f.jsx("span",{className:"truncate",children:_(b.created_at)})]}),f.jsx("span",{className:"text-xs font-medium text-primary/80 truncate max-w-[60px]",children:w(b.user_email)})]})]})]})]})},b.id))})]})},J3=({refreshTrigger:t})=>{const[e,n]=S.useState([]),{nextPrice:r,formatPrice:i}=rf(),s=c=>{const[u]=c.split("@");return u.length<=3?"an***":`${u.substring(0,2)}***`},o=c=>{const u=new Date,d=new Date(c),h=Math.floor((u.getTime()-d.getTime())/(1e3*60));if(h<1)return"just now";if(h<60)return`${h}m ago`;const m=Math.floor(h/60);return m<24?`${m}h ago`:`${Math.floor(m/24)}d ago`},a=async()=>{try{const{data:c,error:u}=await jt.functions.invoke("get-uploads",{body:{limit:5}});if(u)throw u;const d=c.uploads||[];n(d)}catch(c){console.error("Error fetching live feed data:",c)}};S.useEffect(()=>{a();const c=jt.channel("uploads-changes").on("postgres_changes",{event:"INSERT",schema:"public",table:"uploads"},()=>{console.log("New upload detected, refreshing feed..."),a()}).subscribe(),u=setInterval(a,2e4);return()=>{jt.removeChannel(c),clearInterval(u)}},[t]);const l=c=>{const u=o(c.created_at),d=s(c.user_email),h=[`${d} just uploaded for $${(c.price_paid/100).toFixed(2)} ${u}`,`New upload by ${d} • $${(c.price_paid/100).toFixed(2)} paid ${u}`,`${d} joined the experiment • $${(c.price_paid/100).toFixed(2)} ${u}`];return h[Math.floor(Math.random()*h.length)]};return f.jsxs(_t,{className:"glass-card",children:[f.jsx(_r,{className:"pb-2",children:f.jsxs(wr,{className:"text-base flex items-center gap-2",children:["📡 Live Feed",f.jsx(ns,{variant:"outline",className:"text-xs animate-pulse",children:"LIVE"})]})}),f.jsx(Lt,{className:"pt-0",children:f.jsxs("div",{className:"space-y-2",children:[f.jsx("div",{className:"text-center p-2 bg-primary/10 rounded-lg border border-primary/20",children:f.jsxs("p",{className:"text-xs font-medium",children:["Current: ",f.jsx("span",{className:"text-primary font-bold",children:f.jsx(li,{end:r/100,duration:1500,prefix:"$",decimals:2,className:"text-green-500 font-bold"})})]})}),e.length>0?f.jsx("div",{className:"space-y-1 max-h-24 overflow-y-auto",children:e.map((c,u)=>f.jsx("div",{className:"text-xs p-1.5 bg-muted/30 rounded text-muted-foreground hover:bg-muted/50 transition-colors",children:l(c)},u))}):f.jsx("div",{className:"text-center text-xs text-muted-foreground py-2",children:f.jsx("p",{children:"👀 Waiting for uploads..."})})]})})]})},Z3=()=>{const{toast:t}=Rv(),{nextPrice:e,formatPrice:n}=rf(),[r,i]=S.useState(null),[s,o]=S.useState(!1),[a,l]=S.useState({}),[c,u]=S.useState(!1),[d,h]=S.useState([]),m=()=>{const w=new Date,E=7-w.getDay(),M=new Date(w);return M.setDate(w.getDate()+(E===7?0:E)),M.toISOString().split("T")[0]},x=async()=>{try{const{getOrCreateSecureUserId:w}=await lo(async()=>{const{getOrCreateSecureUserId:E}=await import("./secureIpUtils-D_zoJ5B5.js");return{getOrCreateSecureUserId:E}},[]);return w()}catch{let w=localStorage.getItem("pixperiment_user_id");return w||(w=`user_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,localStorage.setItem("pixperiment_user_id",w)),w}},v=S.useCallback(()=>{const w=e,E=[{value:w+25,label:`${n(w+1)} - ${n(w+50)}`},{value:w+75,label:`${n(w+51)} - ${n(w+100)}`},{value:w+150,label:`${n(w+101)} - ${n(w+200)}`},{value:w+300,label:`${n(w+201)} - ${n(w+400)}`}];h(E)},[e,n]),g=S.useCallback(async w=>{try{const E=m(),{data:M,error:T}=await jt.from("predictions").select("predicted_price").eq("week_ending",E);if(T)throw T;const P={};w.forEach(C=>P[C.value]=0),M==null||M.forEach(C=>{P[C.predicted_price]!==void 0&&P[C.predicted_price]++}),l(P)}catch(E){console.error("Error fetching predictions:",E)}},[]),p=S.useCallback(async w=>{try{const E=await x(),M=m(),{data:T,error:P}=await jt.from("predictions").select("predicted_price").eq("ip_address",E).eq("week_ending",M).single();if(P&&P.code!=="PGRST116")throw P;if(T){const C=w.find(b=>b.value===T.predicted_price);i(C||null),o(!0)}}catch(E){console.error("Error checking user vote:",E)}},[]);S.useEffect(()=>{v()},[e]),S.useEffect(()=>{d.length>0&&(g(d),p(d))},[d,g,p]);const y=async w=>{if(!c){u(!0);try{const{data:E,error:M}=await jt.functions.invoke("create-prediction",{body:{predictedPrice:w.value}});if(M)throw M;i(w),o(!0),await Promise.all([g(),p()]),t({title:"Success!",description:`Your prediction has been ${(E==null?void 0:E.action)||"recorded"}!`,duration:3e3})}catch(E){console.error("Error submitting prediction:",E),t({title:"Error",description:"Failed to submit prediction. Please try again.",variant:"destructive"})}finally{u(!1)}}},_=Object.values(a).reduce((w,E)=>w+E,0);return f.jsxs(_t,{className:"glass-card",children:[f.jsxs(_r,{className:"pb-2",children:[f.jsx(wr,{className:"text-base flex items-center gap-2",children:"🔮 Weekly Poll"}),f.jsxs("p",{className:"text-xs text-muted-foreground",children:["Where by Sunday? (Now: ",f.jsx(li,{end:e/100,duration:1500,prefix:"$",decimals:2,className:"text-green-500 font-bold"}),")"]})]}),f.jsx(Lt,{className:"pt-0",children:f.jsxs("div",{className:"space-y-2",children:[d.map(w=>{const E=a[w.value]||0,M=_>0?E/_*100:0,T=(r==null?void 0:r.value)===w.value;return f.jsxs("div",{className:"space-y-1",children:[f.jsxs(Ze,{variant:T?"default":"outline",onClick:()=>y(w),disabled:c,size:"sm",className:`w-full justify-between text-xs h-8 transition-all duration-200 ${T?"bg-purple-600 hover:bg-purple-700 border-purple-600":""}`,children:[f.jsx("span",{className:"font-medium truncate",children:w.label}),f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx(ns,{variant:"secondary",className:"text-xs px-1 py-0",children:E}),f.jsxs("span",{className:"text-xs text-muted-foreground",children:[M.toFixed(0),"%"]})]})]}),s&&f.jsx("div",{className:"w-full bg-muted rounded-full h-1.5",children:f.jsx("div",{className:`h-1.5 rounded-full transition-all duration-500 ${T?"bg-purple-600":"bg-primary"}`,style:{width:`${Math.max(M,2)}%`}})})]},w.value)}),s&&f.jsxs("div",{className:"text-center pt-2 border-t border-border",children:[f.jsxs("p",{className:"text-xs text-muted-foreground",children:["Total: ",_," votes"]}),f.jsxs("p",{className:"text-xs text-purple-600 font-medium mt-1 truncate",children:["Your pick: ",(r==null?void 0:r.label)||"Unknown",r&&a[r.value]?` (${Math.round(a[r.value]/_*100)}%)`:""]})]})]})})]})},$y=["As prices increase, perceived value often increases too - known as the Veblen effect","People often value things more when they're harder to obtain - scarcity psychology","Social proof drives behavior - we follow what others do in uncertain situations","Loss aversion makes us value avoiding losses more than acquiring gains","The anchoring effect influences our perception of what's a 'fair' price","FOMO (fear of missing out) creates urgency and drives quick decisions","Digital scarcity creates artificial value in unlimited digital spaces","Escalation of commitment makes us continue investing after initial costs","Social comparison theory explains why we compete for status symbols","The endowment effect makes us value things more once we 'own' them"],Q3=({className:t=""})=>{const[e,n]=S.useState(0);return S.useEffect(()=>{const r=setInterval(()=>{n(i=>(i+1)%$y.length)},8e3);return()=>clearInterval(r)},[]),f.jsxs("div",{className:`text-xs text-muted-foreground space-y-1 transition-all duration-500 ${t}`,children:[f.jsx("p",{className:"font-medium text-primary",children:"🧠 Psychology Fact:"}),f.jsxs("p",{className:"min-h-[2.5rem] leading-relaxed",children:['"',$y[e],'"']})]})},Xy=()=>f.jsx(_t,{className:"glass-card border border-primary/20 bg-gradient-to-r from-purple-50/5 to-purple-100/5",children:f.jsx(Lt,{className:"p-2",children:f.jsx(Q3,{})})}),eU=()=>{const[t,e]=S.useState(!0);return S.useEffect(()=>{const n=()=>{const r=document.getElementById("upload-form");r&&(r.getBoundingClientRect().top<=window.innerHeight?e(!1):e(!0))};return window.addEventListener("scroll",n),n(),()=>window.removeEventListener("scroll",n)},[]),t?f.jsx("div",{className:"fixed bottom-8 left-8 z-10 animate-bounce",children:f.jsx("div",{className:"bg-primary/10 backdrop-blur-sm rounded-full p-3 border border-primary/20",children:f.jsx(Yd,{className:"w-5 h-5 text-primary animate-pulse"})})}):null};function tU(t,e){return S.useReducer((n,r)=>e[n][r]??n,t)}var pf=t=>{const{present:e,children:n}=t,r=nU(e),i=typeof n=="function"?n({present:r.isPresent}):S.Children.only(n),s=kt(r.ref,rU(i));return typeof n=="function"||r.isPresent?S.cloneElement(i,{ref:s}):null};pf.displayName="Presence";function nU(t){const[e,n]=S.useState(),r=S.useRef({}),i=S.useRef(t),s=S.useRef("none"),o=t?"mounted":"unmounted",[a,l]=tU(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return S.useEffect(()=>{const c=$c(r.current);s.current=a==="mounted"?c:"none"},[a]),vn(()=>{const c=r.current,u=i.current;if(u!==t){const h=s.current,m=$c(c);t?l("MOUNT"):m==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(u&&h!==m?"ANIMATION_OUT":"UNMOUNT"),i.current=t}},[t,l]),vn(()=>{if(e){let c;const u=e.ownerDocument.defaultView??window,d=m=>{const v=$c(r.current).includes(m.animationName);if(m.target===e&&v&&(l("ANIMATION_END"),!i.current)){const g=e.style.animationFillMode;e.style.animationFillMode="forwards",c=u.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=g)})}},h=m=>{m.target===e&&(s.current=$c(r.current))};return e.addEventListener("animationstart",h),e.addEventListener("animationcancel",d),e.addEventListener("animationend",d),()=>{u.clearTimeout(c),e.removeEventListener("animationstart",h),e.removeEventListener("animationcancel",d),e.removeEventListener("animationend",d)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:S.useCallback(c=>{c&&(r.current=getComputedStyle(c)),n(c)},[])}}function $c(t){return(t==null?void 0:t.animationName)||"none"}function rU(t){var r,i;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(i=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:i.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var Gv="Collapsible",[iU,Fb]=lc(Gv),[sU,Wv]=iU(Gv),Bb=S.forwardRef((t,e)=>{const{__scopeCollapsible:n,open:r,defaultOpen:i,disabled:s,onOpenChange:o,...a}=t,[l=!1,c]=as({prop:r,defaultProp:i,onChange:o});return f.jsx(sU,{scope:n,disabled:s,contentId:ms(),open:l,onOpenToggle:S.useCallback(()=>c(u=>!u),[c]),children:f.jsx(lt.div,{"data-state":Xv(l),"data-disabled":s?"":void 0,...a,ref:e})})});Bb.displayName=Gv;var jb="CollapsibleTrigger",zb=S.forwardRef((t,e)=>{const{__scopeCollapsible:n,...r}=t,i=Wv(jb,n);return f.jsx(lt.button,{type:"button","aria-controls":i.contentId,"aria-expanded":i.open||!1,"data-state":Xv(i.open),"data-disabled":i.disabled?"":void 0,disabled:i.disabled,...r,ref:e,onClick:nt(t.onClick,i.onOpenToggle)})});zb.displayName=jb;var $v="CollapsibleContent",Vb=S.forwardRef((t,e)=>{const{forceMount:n,...r}=t,i=Wv($v,t.__scopeCollapsible);return f.jsx(pf,{present:n||i.open,children:({present:s})=>f.jsx(oU,{...r,ref:e,present:s})})});Vb.displayName=$v;var oU=S.forwardRef((t,e)=>{const{__scopeCollapsible:n,present:r,children:i,...s}=t,o=Wv($v,n),[a,l]=S.useState(r),c=S.useRef(null),u=kt(e,c),d=S.useRef(0),h=d.current,m=S.useRef(0),x=m.current,v=o.open||a,g=S.useRef(v),p=S.useRef();return S.useEffect(()=>{const y=requestAnimationFrame(()=>g.current=!1);return()=>cancelAnimationFrame(y)},[]),vn(()=>{const y=c.current;if(y){p.current=p.current||{transitionDuration:y.style.transitionDuration,animationName:y.style.animationName},y.style.transitionDuration="0s",y.style.animationName="none";const _=y.getBoundingClientRect();d.current=_.height,m.current=_.width,g.current||(y.style.transitionDuration=p.current.transitionDuration,y.style.animationName=p.current.animationName),l(r)}},[o.open,r]),f.jsx(lt.div,{"data-state":Xv(o.open),"data-disabled":o.disabled?"":void 0,id:o.contentId,hidden:!v,...s,ref:u,style:{"--radix-collapsible-content-height":h?`${h}px`:void 0,"--radix-collapsible-content-width":x?`${x}px`:void 0,...t.style},children:v&&i})});function Xv(t){return t?"open":"closed"}var aU=Bb,lU=zb,cU=Vb,yi="Accordion",uU=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[qv,dU,fU]=Iv(yi),[mf,CV]=lc(yi,[fU,Fb]),Yv=Fb(),Hb=mt.forwardRef((t,e)=>{const{type:n,...r}=t,i=r,s=r;return f.jsx(qv.Provider,{scope:t.__scopeAccordion,children:n==="multiple"?f.jsx(gU,{...s,ref:e}):f.jsx(mU,{...i,ref:e})})});Hb.displayName=yi;var[Gb,hU]=mf(yi),[Wb,pU]=mf(yi,{collapsible:!1}),mU=mt.forwardRef((t,e)=>{const{value:n,defaultValue:r,onValueChange:i=()=>{},collapsible:s=!1,...o}=t,[a,l]=as({prop:n,defaultProp:r,onChange:i});return f.jsx(Gb,{scope:t.__scopeAccordion,value:a?[a]:[],onItemOpen:l,onItemClose:mt.useCallback(()=>s&&l(""),[s,l]),children:f.jsx(Wb,{scope:t.__scopeAccordion,collapsible:s,children:f.jsx($b,{...o,ref:e})})})}),gU=mt.forwardRef((t,e)=>{const{value:n,defaultValue:r,onValueChange:i=()=>{},...s}=t,[o=[],a]=as({prop:n,defaultProp:r,onChange:i}),l=mt.useCallback(u=>a((d=[])=>[...d,u]),[a]),c=mt.useCallback(u=>a((d=[])=>d.filter(h=>h!==u)),[a]);return f.jsx(Gb,{scope:t.__scopeAccordion,value:o,onItemOpen:l,onItemClose:c,children:f.jsx(Wb,{scope:t.__scopeAccordion,collapsible:!0,children:f.jsx($b,{...s,ref:e})})})}),[vU,gf]=mf(yi),$b=mt.forwardRef((t,e)=>{const{__scopeAccordion:n,disabled:r,dir:i,orientation:s="vertical",...o}=t,a=mt.useRef(null),l=kt(a,e),c=dU(n),d=sf(i)==="ltr",h=nt(t.onKeyDown,m=>{var P;if(!uU.includes(m.key))return;const x=m.target,v=c().filter(C=>{var b;return!((b=C.ref.current)!=null&&b.disabled)}),g=v.findIndex(C=>C.ref.current===x),p=v.length;if(g===-1)return;m.preventDefault();let y=g;const _=0,w=p-1,E=()=>{y=g+1,y>w&&(y=_)},M=()=>{y=g-1,y<_&&(y=w)};switch(m.key){case"Home":y=_;break;case"End":y=w;break;case"ArrowRight":s==="horizontal"&&(d?E():M());break;case"ArrowDown":s==="vertical"&&E();break;case"ArrowLeft":s==="horizontal"&&(d?M():E());break;case"ArrowUp":s==="vertical"&&M();break}const T=y%p;(P=v[T].ref.current)==null||P.focus()});return f.jsx(vU,{scope:n,disabled:r,direction:i,orientation:s,children:f.jsx(qv.Slot,{scope:n,children:f.jsx(lt.div,{...o,"data-orientation":s,ref:l,onKeyDown:r?void 0:h})})})}),Ed="AccordionItem",[xU,Kv]=mf(Ed),Xb=mt.forwardRef((t,e)=>{const{__scopeAccordion:n,value:r,...i}=t,s=gf(Ed,n),o=hU(Ed,n),a=Yv(n),l=ms(),c=r&&o.value.includes(r)||!1,u=s.disabled||t.disabled;return f.jsx(xU,{scope:n,open:c,disabled:u,triggerId:l,children:f.jsx(aU,{"data-orientation":s.orientation,"data-state":Qb(c),...a,...i,ref:e,disabled:u,open:c,onOpenChange:d=>{d?o.onItemOpen(r):o.onItemClose(r)}})})});Xb.displayName=Ed;var qb="AccordionHeader",Yb=mt.forwardRef((t,e)=>{const{__scopeAccordion:n,...r}=t,i=gf(yi,n),s=Kv(qb,n);return f.jsx(lt.h3,{"data-orientation":i.orientation,"data-state":Qb(s.open),"data-disabled":s.disabled?"":void 0,...r,ref:e})});Yb.displayName=qb;var Am="AccordionTrigger",Kb=mt.forwardRef((t,e)=>{const{__scopeAccordion:n,...r}=t,i=gf(yi,n),s=Kv(Am,n),o=pU(Am,n),a=Yv(n);return f.jsx(qv.ItemSlot,{scope:n,children:f.jsx(lU,{"aria-disabled":s.open&&!o.collapsible||void 0,"data-orientation":i.orientation,id:s.triggerId,...a,...r,ref:e})})});Kb.displayName=Am;var Jb="AccordionContent",Zb=mt.forwardRef((t,e)=>{const{__scopeAccordion:n,...r}=t,i=gf(yi,n),s=Kv(Jb,n),o=Yv(n);return f.jsx(cU,{role:"region","aria-labelledby":s.triggerId,"data-orientation":i.orientation,...o,...r,ref:e,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...t.style}})});Zb.displayName=Jb;function Qb(t){return t?"open":"closed"}var yU=Hb,_U=Xb,wU=Yb,eT=Kb,tT=Zb;const SU=yU,Ii=S.forwardRef(({className:t,...e},n)=>f.jsx(_U,{ref:n,className:wt("border-b",t),...e}));Ii.displayName="AccordionItem";const Li=S.forwardRef(({className:t,children:e,...n},r)=>f.jsx(wU,{className:"flex",children:f.jsxs(eT,{ref:r,className:wt("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",t),...n,children:[e,f.jsx(Yd,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));Li.displayName=eT.displayName;const Di=S.forwardRef(({className:t,children:e,...n},r)=>f.jsx(tT,{ref:r,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...n,children:f.jsx("div",{className:wt("pb-4 pt-0",t),children:e})}));Di.displayName=tT.displayName;const $e=({text:t,delay:e=0,className:n="",speed:r=50,characters:i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*()_+-=[]{}|;:,.<>?"})=>{const[s,o]=S.useState(""),[a,l]=S.useState(!1);return S.useEffect(()=>{const c=setTimeout(()=>{l(!0);let u=0;const d=Array.from({length:t.length},()=>i[Math.floor(Math.random()*i.length)]).join("");o(d);const h=setInterval(()=>{u<t.length?(o(m=>t.slice(0,u+1)+m.slice(u+1)),u++):(o(t),clearInterval(h))},r);return()=>clearInterval(h)},e);return()=>clearTimeout(c)},[t,e,r,i]),f.jsx("span",{className:`font-mono ${n}`,children:s})},EU=()=>{const[t,e]=S.useState(null),n=r=>{e(r)};return f.jsxs(SU,{type:"single",collapsible:!0,className:"w-full",onValueChange:n,children:[f.jsxs(Ii,{value:"item-1",children:[f.jsx(Li,{className:"text-left",children:"How does the pricing experiment work? 🤔"}),f.jsx(Di,{children:f.jsxs("div",{className:"space-y-3",children:[f.jsx($e,{text:"Each upload costs 1¢ more than the previous one, creating scarcity and urgency.",delay:0,speed:15}),f.jsx("div",{className:"bg-primary/10 p-3 rounded-lg",children:f.jsx($e,{text:"📈 Formula: $1.00 + (Previous Uploads × $0.01)",delay:t==="item-1"?400:0,speed:12,className:"text-sm font-medium"})}),f.jsx($e,{text:"First upload: $1.00, second: $1.01, third: $1.02, and so on!",delay:t==="item-1"?700:0,speed:15,className:"text-sm text-muted-foreground"})]})})]}),f.jsxs(Ii,{value:"item-2",children:[f.jsx(Li,{className:"text-left",children:"What happens after I upload a photo? 📤"}),f.jsx(Di,{children:f.jsxs("div",{className:"space-y-3",children:[f.jsx($e,{text:"Your photos are stored securely and displayed publicly:",delay:0,speed:15}),f.jsxs("ul",{className:"space-y-2 text-sm",children:[f.jsx("li",{children:f.jsx($e,{text:"✅ Secure cloud storage",delay:t==="item-2"?200:0,speed:12})}),f.jsx("li",{children:f.jsx($e,{text:"🎨 Public gallery display",delay:t==="item-2"?300:0,speed:12})}),f.jsx("li",{children:f.jsx($e,{text:"📊 Permanent pricing history",delay:t==="item-2"?400:0,speed:12})}),f.jsx("li",{children:f.jsx($e,{text:"🔗 Unique shareable link",delay:t==="item-2"?500:0,speed:12})}),f.jsx("li",{children:f.jsx($e,{text:"📱 QR code generation",delay:t==="item-2"?600:0,speed:12})})]})]})})]}),f.jsxs(Ii,{value:"item-3",children:[f.jsx(Li,{className:"text-left",children:"Is my email address kept private? 🔒"}),f.jsx(Di,{children:f.jsxs("div",{className:"space-y-3",children:[f.jsx($e,{text:"Yes! Your email is completely private and secure:",delay:0,speed:15}),f.jsxs("ul",{className:"space-y-2 text-sm",children:[f.jsx("li",{children:f.jsx($e,{text:"🔐 Never displayed publicly",delay:t==="item-3"?200:0,speed:12})}),f.jsx("li",{children:f.jsx($e,{text:"🛡️ Encrypted storage",delay:t==="item-3"?300:0,speed:12})}),f.jsx("li",{children:f.jsx($e,{text:"📧 No spam or sharing",delay:t==="item-3"?400:0,speed:12})}),f.jsx("li",{children:f.jsx($e,{text:"🎯 Only for payments & identification",delay:t==="item-3"?500:0,speed:12})})]}),f.jsx($e,{text:"Privacy first - we only collect what's necessary!",delay:t==="item-3"?700:0,speed:15,className:"text-sm text-muted-foreground"})]})})]}),f.jsxs(Ii,{value:"item-4",children:[f.jsx(Li,{className:"text-left",children:"Can I upload multiple photos? 📸📸"}),f.jsx(Di,{children:f.jsxs("div",{className:"space-y-3",children:[f.jsx($e,{text:"Yes! Upload as many as you want, but each costs more:",delay:0,speed:15}),f.jsxs("ul",{className:"space-y-2 text-sm",children:[f.jsx("li",{children:f.jsx($e,{text:"💰 Each upload increases price by 1¢",delay:t==="item-4"?200:0,speed:12})}),f.jsx("li",{children:f.jsx($e,{text:"🔄 Same email can upload multiple times",delay:t==="item-4"?300:0,speed:12})}),f.jsx("li",{children:f.jsx($e,{text:"📈 Later uploads cost more",delay:t==="item-4"?400:0,speed:12})}),f.jsx("li",{children:f.jsx($e,{text:"⚡ Real-time price updates",delay:t==="item-4"?500:0,speed:12})})]}),f.jsx("div",{className:"bg-blue-500/10 p-3 rounded-lg",children:f.jsx($e,{text:"💡 Upload quickly for better prices!",delay:t==="item-4"?700:0,speed:12,className:"text-sm font-medium"})})]})})]}),f.jsxs(Ii,{value:"item-5",children:[f.jsx(Li,{className:"text-left",children:"What's the psychology behind this experiment? 🧠"}),f.jsx(Di,{children:f.jsxs("div",{className:"space-y-3",children:[f.jsx($e,{text:"Studies human behavior and decision-making:",delay:0,speed:15}),f.jsxs("ul",{className:"space-y-2 text-sm",children:[f.jsx("li",{children:f.jsx($e,{text:"💰 Scarcity psychology",delay:t==="item-5"?200:0,speed:12})}),f.jsx("li",{children:f.jsx($e,{text:"⏰ FOMO and urgency effects",delay:t==="item-5"?300:0,speed:12})}),f.jsx("li",{children:f.jsx($e,{text:"📈 Loss aversion behavior",delay:t==="item-5"?400:0,speed:12})}),f.jsx("li",{children:f.jsx($e,{text:"👥 Social proof influence",delay:t==="item-5"?500:0,speed:12})}),f.jsx("li",{children:f.jsx($e,{text:"🧠 Cognitive biases",delay:t==="item-5"?600:0,speed:12})})]}),f.jsx("div",{className:"bg-purple-500/10 p-3 rounded-lg",children:f.jsx($e,{text:"🔬 Real psychological research data!",delay:t==="item-5"?800:0,speed:12,className:"text-sm font-medium"})})]})})]}),f.jsxs(Ii,{value:"item-6",children:[f.jsx(Li,{className:"text-left",children:"Can I upload anything I want? 🎨"}),f.jsx(Di,{children:f.jsxs("div",{className:"space-y-3",children:[f.jsx($e,{text:"Almost! Most content is welcome with guidelines:",delay:0,speed:15}),f.jsxs("ul",{className:"space-y-2 text-sm",children:[f.jsx("li",{children:f.jsx($e,{text:"✅ Photos, artwork, memes, screenshots",delay:t==="item-6"?200:0,speed:12})}),f.jsx("li",{children:f.jsx($e,{text:"✅ Digital art and creative content",delay:t==="item-6"?300:0,speed:12})}),f.jsx("li",{children:f.jsx($e,{text:"✅ Fun and interesting images",delay:t==="item-6"?400:0,speed:12})}),f.jsx("li",{children:f.jsx($e,{text:"🔄 PNG, JPG, GIF - cropped to square",delay:t==="item-6"?500:0,speed:12})}),f.jsx("li",{children:f.jsx($e,{text:"⚖️ Must own rights to the image",delay:t==="item-6"?600:0,speed:12})})]}),f.jsx("div",{className:"bg-orange-500/10 p-3 rounded-lg",children:f.jsx($e,{text:"🎨 Be creative - add to internet history!",delay:t==="item-6"?800:0,speed:12,className:"text-sm font-medium"})})]})})]}),f.jsxs(Ii,{value:"item-7",children:[f.jsx(Li,{className:"text-left",children:"Is NSFW content allowed? 🚫"}),f.jsx(Di,{children:f.jsxs("div",{className:"space-y-3",children:[f.jsx($e,{text:"No, NSFW content is prohibited - keep it family-friendly:",delay:0,speed:15}),f.jsxs("ul",{className:"space-y-2 text-sm",children:[f.jsx("li",{children:f.jsx($e,{text:"🚫 No adult or explicit content",delay:t==="item-7"?200:0,speed:12})}),f.jsx("li",{children:f.jsx($e,{text:"👨‍👩‍👧‍👦 Family-friendly only",delay:t==="item-7"?300:0,speed:12})}),f.jsx("li",{children:f.jsx($e,{text:"🏢 Workplace appropriate",delay:t==="item-7"?400:0,speed:12})}),f.jsx("li",{children:f.jsx($e,{text:"⚡ Auto-moderation active",delay:t==="item-7"?500:0,speed:12})}),f.jsx("li",{children:f.jsx($e,{text:"📝 Clean and respectful content",delay:t==="item-7"?600:0,speed:12})})]}),f.jsx("div",{className:"bg-red-500/10 p-3 rounded-lg",children:f.jsx($e,{text:"⚠️ Violations = removal without refund",delay:t==="item-7"?800:0,speed:12,className:"text-sm font-medium"})})]})})]})]})},bU=({children:t,fontSize:e="clamp(2rem, 10vw, 10rem)",fontWeight:n=900,fontFamily:r="inherit",color:i="#fff",enableHover:s=!0,baseIntensity:o=.08,hoverIntensity:a=.25})=>{const l=S.useRef(null);return S.useEffect(()=>{let c,u=!1;const d=l.current;return d?((async()=>{var J;if((J=document.fonts)!=null&&J.ready&&await document.fonts.ready,u)return;const m=d.getContext("2d");if(!m)return;const x=r==="inherit"?window.getComputedStyle(d).fontFamily||"sans-serif":r,v=typeof e=="number"?`${e}px`:e;let g;if(typeof e=="number")g=e;else{const q=document.createElement("span");q.style.fontSize=e,document.body.appendChild(q);const re=window.getComputedStyle(q).fontSize;g=parseFloat(re),document.body.removeChild(q)}const p=mt.Children.toArray(t).join(""),y=document.createElement("canvas"),_=y.getContext("2d");if(!_)return;_.font=`${n} ${v} ${x}`,_.textBaseline="alphabetic";const w=_.measureText(p),E=w.actualBoundingBoxLeft??0,M=w.actualBoundingBoxRight??w.width,T=w.actualBoundingBoxAscent??g,P=w.actualBoundingBoxDescent??g*.2,C=Math.ceil(E+M),b=Math.ceil(T+P),N=10,U=C+N;y.width=U,y.height=b;const O=N/2;_.font=`${n} ${v} ${x}`,_.textBaseline="alphabetic",_.strokeStyle="white",_.lineWidth=4,_.lineJoin="round",_.strokeText(p,O-E,T),_.fillStyle=i,_.fillText(p,O-E,T);const V=50,Y=0;d.width=U+V*2,d.height=b+Y*2,m.translate(V,Y);const z=V+O,W=Y,L=z+C,H=W+b;let j=!1;const ee=15,ve=()=>{if(u)return;m.clearRect(-ee,-ee,U+2*ee,b+2*ee);const q=j?a:o;for(let re=0;re<b;re++){const ie=Math.floor(q*(Math.random()-.5)*ee);m.drawImage(y,0,re,U,1,ie,re,U,1)}c=window.requestAnimationFrame(ve)};ve();const Be=(q,re)=>q>=z&&q<=L&&re>=W&&re<=H,Ue=q=>{if(!s)return;const re=d.getBoundingClientRect(),ie=q.clientX-re.left,I=q.clientY-re.top;j=Be(ie,I)},Q=()=>{j=!1},oe=q=>{if(!s)return;q.preventDefault();const re=d.getBoundingClientRect(),ie=q.touches[0],I=ie.clientX-re.left,be=ie.clientY-re.top;j=Be(I,be)},X=()=>{j=!1};s&&(d.addEventListener("mousemove",Ue),d.addEventListener("mouseleave",Q),d.addEventListener("touchmove",oe,{passive:!1}),d.addEventListener("touchend",X));const he=()=>{window.cancelAnimationFrame(c),s&&(d.removeEventListener("mousemove",Ue),d.removeEventListener("mouseleave",Q),d.removeEventListener("touchmove",oe),d.removeEventListener("touchend",X))};d.cleanupFuzzyText=he})(),()=>{u=!0,window.cancelAnimationFrame(c),d&&d.cleanupFuzzyText&&d.cleanupFuzzyText()}):void 0},[t,e,n,r,i,s,o,a]),f.jsx("canvas",{ref:l})},TU=()=>{const t=hs(),{nextPrice:e}=rf(),[n,r]=S.useState(0);console.log("Index component rendering, nextPrice:",e);const i=()=>{r(o=>o+1)},s=()=>{const o=document.getElementById("upload-section");o&&o.scrollIntoView({behavior:"smooth",block:"center"})};return f.jsxs("div",{className:"min-h-screen",children:[f.jsx("header",{className:"border-b border-border/50 backdrop-blur-sm bg-background/80 sticky top-0 z-50",children:f.jsx("div",{className:"container mx-auto px-2 sm:px-4 py-2 sm:py-3",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("img",{src:"https://i.imgur.com/8KY5V0m.png",alt:"PixPeriment Logo",className:"w-6 h-6 sm:w-8 sm:h-8 object-contain"}),f.jsxs("div",{children:[f.jsx("h1",{className:"text-sm sm:text-lg font-bold gradient-text",children:"The PixPeriment"}),f.jsx("p",{className:"text-xs text-muted-foreground hidden sm:block",children:"Social Experiment"})]})]}),f.jsx("div",{className:"hidden lg:flex items-center justify-center absolute left-1/2 transform -translate-x-1/2",children:f.jsxs("div",{className:"flex items-center gap-4 text-xs text-purple-200 glass-card glow-outline p-2 bg-gradient-to-r from-purple-900/20 to-purple-800/20 border border-purple-600/30",children:[f.jsx("span",{className:"flex items-center gap-1",children:"💰 Price increases"}),f.jsx("span",{className:"text-purple-400",children:"•"}),f.jsx("span",{className:"flex items-center gap-1",children:"🧠 Psychology test"}),f.jsx("span",{className:"text-purple-400",children:"•"}),f.jsx("span",{className:"flex items-center gap-1",children:"🎯 Scarcity experiment"})]})}),f.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[f.jsxs("div",{className:"hidden md:flex items-center gap-2",children:[f.jsxs(Ze,{variant:"ghost",size:"sm",onClick:()=>t("/history"),className:"text-muted-foreground hover:text-foreground",children:[f.jsx(a2,{className:"w-4 h-4 mr-1"}),"History"]}),f.jsxs(Ze,{variant:"ghost",size:"sm",onClick:()=>t("/control"),className:"text-muted-foreground hover:text-foreground",children:[f.jsx(qx,{className:"w-4 h-4 mr-1"}),"Control"]})]}),f.jsxs(Ze,{onClick:s,size:"sm",className:"bg-gradient-to-r from-primary to-primary/80 hover:from-primary/90 hover:to-primary/70 text-primary-foreground px-2 sm:px-4 py-1.5 sm:py-2 rounded-lg transition-all duration-300 hover:shadow-lg hover:shadow-primary/25",children:[f.jsx(hd,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1 sm:mr-2"}),f.jsx("span",{className:"text-xs sm:text-sm",children:"Upload Now"})]})]})]})})}),f.jsxs("div",{className:"container mx-auto px-2 sm:px-4 py-2",children:[f.jsxs("div",{className:"text-center mb-4 sm:mb-6",children:[f.jsx("div",{className:"mb-2 flex justify-center px-2",children:f.jsx("div",{className:"w-full max-w-4xl",children:f.jsx(bU,{baseIntensity:.2,hoverIntensity:.5,enableHover:!0,fontSize:"4rem",fontWeight:700,color:"#8b5cf6",children:"The Social Experiment: How High Can It Go? 🚀"})})}),f.jsx("p",{className:"text-xs sm:text-sm md:text-base text-muted-foreground mb-3 max-w-2xl mx-auto px-2 md:whitespace-nowrap",children:"A psychological pricing experiment where each photo upload costs more than the last 📈"}),f.jsx("div",{className:"lg:hidden glass-card glow-outline max-w-2xl mx-auto p-2 sm:p-3 bg-gradient-to-r from-purple-900/20 to-purple-800/20 border border-purple-600/30",children:f.jsxs("div",{className:"flex flex-wrap justify-center gap-2 sm:gap-4 text-xs text-purple-200",children:[f.jsx("span",{className:"flex items-center gap-1",children:"💰 Price increases"}),f.jsx("span",{className:"hidden sm:inline text-purple-400",children:"•"}),f.jsx("span",{className:"flex items-center gap-1",children:"🧠 Psychology test"}),f.jsx("span",{className:"hidden sm:inline text-purple-400",children:"•"}),f.jsx("span",{className:"flex items-center gap-1",children:"🎯 Scarcity experiment"})]})})]}),f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-2 sm:gap-3 lg:gap-4 mb-3 sm:mb-4 lg:mb-6",children:[f.jsx("div",{className:"lg:col-span-2 lg:order-1",children:f.jsx("div",{className:"glow-outline",children:f.jsx(BI,{refreshTrigger:n})})}),f.jsxs("div",{className:"lg:order-2 space-y-2 sm:space-y-3 lg:space-y-4",children:[f.jsx("div",{className:"glow-outline",children:f.jsx(JI,{onPriceUpdate:()=>{},refreshTrigger:n})}),f.jsx("div",{className:"hidden lg:block glow-outline",children:f.jsx(Xy,{})})]})]}),f.jsx("div",{className:"mb-2 sm:mb-3 lg:hidden glow-outline",children:f.jsx(Xy,{})}),f.jsx("div",{className:"mb-4 sm:mb-6 lg:mb-8",children:f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-3 sm:gap-4 lg:gap-6",children:[f.jsx("div",{id:"upload-section",className:"lg:col-span-3",children:f.jsxs(_t,{className:"glass-card border-primary/20 glow-outline",children:[f.jsxs(_r,{className:"text-center pb-2 sm:pb-3 lg:pb-4 px-2 sm:px-3 lg:px-6",children:[f.jsxs(wr,{className:"text-sm sm:text-base lg:text-lg gradient-text flex items-center justify-center gap-2",children:[f.jsx(hd,{className:"w-3 h-3 sm:w-4 sm:h-4 lg:w-5 lg:h-5"}),"Join the Experiment"]}),f.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"Upload your photo and become part of the pricing history"})]}),f.jsx(Lt,{className:"pt-0 px-2 sm:px-3 lg:px-6",children:f.jsx(QI,{currentPrice:e,onUploadSuccess:i})})]})}),f.jsx("div",{className:"lg:col-span-1",children:f.jsxs("div",{className:"grid grid-cols-2 gap-2 lg:grid-cols-1 lg:gap-0 lg:space-y-3",children:[f.jsxs("div",{children:[f.jsxs("h2",{className:"text-sm sm:text-base lg:text-xl font-bold gradient-text flex items-center gap-1 sm:gap-2 mb-2 sm:mb-3 lg:mb-4",children:[f.jsx(T2,{className:"w-3 h-3 sm:w-4 sm:h-4 lg:w-5 lg:h-5"}),f.jsx("span",{className:"hidden sm:inline",children:"Live Activity"}),f.jsx("span",{className:"sm:hidden",children:"Live"})]}),f.jsx("div",{className:"glow-outline",children:f.jsx(J3,{})})]}),f.jsxs("div",{children:[f.jsxs("h2",{className:"text-sm sm:text-base lg:text-xl font-bold gradient-text flex items-center gap-1 sm:gap-2 mb-2 sm:mb-3 lg:mb-4",children:[f.jsx(qx,{className:"w-3 h-3 sm:w-4 sm:h-4 lg:w-5 lg:h-5"}),f.jsx("span",{className:"hidden sm:inline",children:"Weekly Poll"}),f.jsx("span",{className:"sm:hidden",children:"Poll"})]}),f.jsx("div",{className:"glow-outline",children:f.jsx(Z3,{})})]})]})})]})}),f.jsxs("div",{className:"mb-8",children:[f.jsxs("div",{className:"flex items-center justify-between mb-6",children:[f.jsxs("h2",{className:"text-2xl font-bold gradient-text flex items-center gap-2",children:[f.jsx(h2,{className:"w-6 h-6"}),"Recent Uploads"]}),f.jsxs(Ze,{variant:"outline",onClick:()=>t("/history"),className:"border-primary/30 text-primary hover:bg-primary/10",children:["View All",f.jsx(i2,{className:"w-4 h-4 ml-2"})]})]}),f.jsx(Ob,{refreshTrigger:n,limitResults:6})]}),f.jsxs("div",{className:"mb-8",children:[f.jsxs("h2",{className:"text-2xl font-bold gradient-text flex items-center gap-2 mb-6",children:[f.jsx(C1,{className:"w-6 h-6"}),"Frequently Asked Questions"]}),f.jsx(_t,{className:"glass-card glow-outline",children:f.jsx(Lt,{className:"p-6",children:f.jsx(EU,{})})})]}),f.jsx(eU,{})]})]})},MU=()=>{const t=hs();return f.jsx("div",{className:"min-h-screen bg-background",children:f.jsxs("div",{className:"container mx-auto px-4 py-8",children:[f.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-8",children:[f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsx(Ze,{variant:"outline",size:"icon",onClick:()=>t("/"),className:"shrink-0",children:f.jsx(fd,{className:"w-4 h-4"})}),f.jsxs("div",{children:[f.jsx("h1",{className:"text-2xl sm:text-3xl font-bold gradient-text",children:"The PixPeriment Gallery"}),f.jsx("p",{className:"text-sm sm:text-base text-muted-foreground",children:"The experiment archive - watch prices climb with each upload"})]})]}),f.jsxs("div",{className:"flex items-center gap-2 self-start sm:self-auto glass-card px-3 py-2",children:[f.jsx(o2,{className:"w-5 h-5 text-primary experiment-glow"}),f.jsx("span",{className:"text-sm font-medium",children:"Live Experiment"})]})]}),f.jsx(Ob,{showSearch:!0,limitResults:50})]})})};var CU="Label",nT=S.forwardRef((t,e)=>f.jsx(lt.label,{...t,ref:e,onMouseDown:n=>{var i;n.target.closest("button, input, select, textarea")||((i=t.onMouseDown)==null||i.call(t,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));nT.displayName=CU;var rT=nT;const AU=Sv("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Jv=S.forwardRef(({className:t,...e},n)=>f.jsx(rT,{ref:n,className:wt(AU(),t),...e}));Jv.displayName=rT.displayName;function RU(t,e=[]){let n=[];function r(s,o){const a=S.createContext(o),l=n.length;n=[...n,o];function c(d){const{scope:h,children:m,...x}=d,v=(h==null?void 0:h[t][l])||a,g=S.useMemo(()=>x,Object.values(x));return f.jsx(v.Provider,{value:g,children:m})}function u(d,h){const m=(h==null?void 0:h[t][l])||a,x=S.useContext(m);if(x)return x;if(o!==void 0)return o;throw new Error(`\`${d}\` must be used within \`${s}\``)}return c.displayName=s+"Provider",[c,u]}const i=()=>{const s=n.map(o=>S.createContext(o));return function(a){const l=(a==null?void 0:a[t])||s;return S.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return i.scopeName=t,[r,PU(i,...e)]}function PU(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(s){const o=r.reduce((a,{useScope:l,scopeName:c})=>{const d=l(s)[`__scope${c}`];return{...a,...d}},{});return S.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}var Eh="rovingFocusGroup.onEntryFocus",NU={bubbles:!1,cancelable:!0},vf="RovingFocusGroup",[Rm,iT,IU]=Iv(vf),[LU,sT]=RU(vf,[IU]),[DU,UU]=LU(vf),oT=S.forwardRef((t,e)=>f.jsx(Rm.Provider,{scope:t.__scopeRovingFocusGroup,children:f.jsx(Rm.Slot,{scope:t.__scopeRovingFocusGroup,children:f.jsx(kU,{...t,ref:e})})}));oT.displayName=vf;var kU=S.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:i=!1,dir:s,currentTabStopId:o,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:l,onEntryFocus:c,preventScrollOnEntryFocus:u=!1,...d}=t,h=S.useRef(null),m=kt(e,h),x=sf(s),[v=null,g]=as({prop:o,defaultProp:a,onChange:l}),[p,y]=S.useState(!1),_=Vr(c),w=iT(n),E=S.useRef(!1),[M,T]=S.useState(0);return S.useEffect(()=>{const P=h.current;if(P)return P.addEventListener(Eh,_),()=>P.removeEventListener(Eh,_)},[_]),f.jsx(DU,{scope:n,orientation:r,dir:x,loop:i,currentTabStopId:v,onItemFocus:S.useCallback(P=>g(P),[g]),onItemShiftTab:S.useCallback(()=>y(!0),[]),onFocusableItemAdd:S.useCallback(()=>T(P=>P+1),[]),onFocusableItemRemove:S.useCallback(()=>T(P=>P-1),[]),children:f.jsx(lt.div,{tabIndex:p||M===0?-1:0,"data-orientation":r,...d,ref:m,style:{outline:"none",...t.style},onMouseDown:nt(t.onMouseDown,()=>{E.current=!0}),onFocus:nt(t.onFocus,P=>{const C=!E.current;if(P.target===P.currentTarget&&C&&!p){const b=new CustomEvent(Eh,NU);if(P.currentTarget.dispatchEvent(b),!b.defaultPrevented){const N=w().filter(z=>z.focusable),U=N.find(z=>z.active),O=N.find(z=>z.id===v),Y=[U,O,...N].filter(Boolean).map(z=>z.ref.current);cT(Y,u)}}E.current=!1}),onBlur:nt(t.onBlur,()=>y(!1))})})}),aT="RovingFocusGroupItem",lT=S.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:i=!1,tabStopId:s,...o}=t,a=ms(),l=s||a,c=UU(aT,n),u=c.currentTabStopId===l,d=iT(n),{onFocusableItemAdd:h,onFocusableItemRemove:m}=c;return S.useEffect(()=>{if(r)return h(),()=>m()},[r,h,m]),f.jsx(Rm.ItemSlot,{scope:n,id:l,focusable:r,active:i,children:f.jsx(lt.span,{tabIndex:u?0:-1,"data-orientation":c.orientation,...o,ref:e,onMouseDown:nt(t.onMouseDown,x=>{r?c.onItemFocus(l):x.preventDefault()}),onFocus:nt(t.onFocus,()=>c.onItemFocus(l)),onKeyDown:nt(t.onKeyDown,x=>{if(x.key==="Tab"&&x.shiftKey){c.onItemShiftTab();return}if(x.target!==x.currentTarget)return;const v=BU(x,c.orientation,c.dir);if(v!==void 0){if(x.metaKey||x.ctrlKey||x.altKey||x.shiftKey)return;x.preventDefault();let p=d().filter(y=>y.focusable).map(y=>y.ref.current);if(v==="last")p.reverse();else if(v==="prev"||v==="next"){v==="prev"&&p.reverse();const y=p.indexOf(x.currentTarget);p=c.loop?jU(p,y+1):p.slice(y+1)}setTimeout(()=>cT(p))}})})})});lT.displayName=aT;var OU={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function FU(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function BU(t,e,n){const r=FU(t.key,n);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return OU[r]}function cT(t,e=!1){const n=document.activeElement;for(const r of t)if(r===n||(r.focus({preventScroll:e}),document.activeElement!==n))return}function jU(t,e){return t.map((n,r)=>t[(e+r)%t.length])}var zU=oT,VU=lT,Zv="Tabs",[HU,AV]=lc(Zv,[sT]),uT=sT(),[GU,Qv]=HU(Zv),dT=S.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,onValueChange:i,defaultValue:s,orientation:o="horizontal",dir:a,activationMode:l="automatic",...c}=t,u=sf(a),[d,h]=as({prop:r,onChange:i,defaultProp:s});return f.jsx(GU,{scope:n,baseId:ms(),value:d,onValueChange:h,orientation:o,dir:u,activationMode:l,children:f.jsx(lt.div,{dir:u,"data-orientation":o,...c,ref:e})})});dT.displayName=Zv;var fT="TabsList",hT=S.forwardRef((t,e)=>{const{__scopeTabs:n,loop:r=!0,...i}=t,s=Qv(fT,n),o=uT(n);return f.jsx(zU,{asChild:!0,...o,orientation:s.orientation,dir:s.dir,loop:r,children:f.jsx(lt.div,{role:"tablist","aria-orientation":s.orientation,...i,ref:e})})});hT.displayName=fT;var pT="TabsTrigger",mT=S.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,disabled:i=!1,...s}=t,o=Qv(pT,n),a=uT(n),l=xT(o.baseId,r),c=yT(o.baseId,r),u=r===o.value;return f.jsx(VU,{asChild:!0,...a,focusable:!i,active:u,children:f.jsx(lt.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":c,"data-state":u?"active":"inactive","data-disabled":i?"":void 0,disabled:i,id:l,...s,ref:e,onMouseDown:nt(t.onMouseDown,d=>{!i&&d.button===0&&d.ctrlKey===!1?o.onValueChange(r):d.preventDefault()}),onKeyDown:nt(t.onKeyDown,d=>{[" ","Enter"].includes(d.key)&&o.onValueChange(r)}),onFocus:nt(t.onFocus,()=>{const d=o.activationMode!=="manual";!u&&!i&&d&&o.onValueChange(r)})})})});mT.displayName=pT;var gT="TabsContent",vT=S.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,forceMount:i,children:s,...o}=t,a=Qv(gT,n),l=xT(a.baseId,r),c=yT(a.baseId,r),u=r===a.value,d=S.useRef(u);return S.useEffect(()=>{const h=requestAnimationFrame(()=>d.current=!1);return()=>cancelAnimationFrame(h)},[]),f.jsx(pf,{present:i||u,children:({present:h})=>f.jsx(lt.div,{"data-state":u?"active":"inactive","data-orientation":a.orientation,role:"tabpanel","aria-labelledby":l,hidden:!h,id:c,tabIndex:0,...o,ref:e,style:{...t.style,animationDuration:d.current?"0s":void 0},children:h&&s})})});vT.displayName=gT;function xT(t,e){return`${t}-trigger-${e}`}function yT(t,e){return`${t}-content-${e}`}var WU=dT,_T=hT,wT=mT,ST=vT;const $U=WU,ET=S.forwardRef(({className:t,...e},n)=>f.jsx(_T,{ref:n,className:wt("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...e}));ET.displayName=_T.displayName;const hl=S.forwardRef(({className:t,...e},n)=>f.jsx(wT,{ref:n,className:wt("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...e}));hl.displayName=wT.displayName;const pl=S.forwardRef(({className:t,...e},n)=>f.jsx(ST,{ref:n,className:wt("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...e}));pl.displayName=ST.displayName;const wo="secure_admin_session",XU=()=>{const[t,e]=S.useState(!1),[n,r]=S.useState(!0),[i,s]=S.useState(null);S.useEffect(()=>{o()},[]);const o=async()=>{try{const d=sessionStorage.getItem(wo);if(d){const h=JSON.parse(d);if(new Date(h.expiresAt)<=new Date){sessionStorage.removeItem(wo),e(!1),s(null),r(!1);return}const{data:m,error:x}=await jt.functions.invoke("admin-verify",{body:{sessionToken:h.sessionToken}});x||!(m!=null&&m.valid)?(sessionStorage.removeItem(wo),e(!1),s(null)):(e(!0),s(h.sessionToken))}}catch(d){console.error("Error checking auth session:",d),sessionStorage.removeItem(wo),e(!1),s(null)}r(!1)};return{isAuthenticated:t,isLoading:n,login:async d=>{try{const{data:h,error:m}=await jt.functions.invoke("admin-login",{body:{password:d}});if(m||!(h!=null&&h.sessionToken))return Ft.error("Invalid password 🚫"),!1;const x={sessionToken:h.sessionToken,expiresAt:h.expiresAt};return sessionStorage.setItem(wo,JSON.stringify(x)),e(!0),s(h.sessionToken),Ft.success("Access granted! 🔓"),!0}catch(h){return console.error("Login error:",h),Ft.error("Authentication failed"),!1}},logout:()=>{sessionStorage.removeItem(wo),e(!1),s(null),Ft.success("Logged out successfully 👋")},deleteUpload:async d=>{if(!i)return Ft.error("Not authenticated"),!1;try{const{data:h,error:m}=await jt.functions.invoke("admin-delete-upload",{body:{uploadId:d,sessionToken:i}});return m||!(h!=null&&h.success)?(Ft.error("Failed to delete upload"),!1):(Ft.success("Upload deleted successfully"),!0)}catch(h){return console.error("Delete upload error:",h),Ft.error("Failed to delete upload"),!1}},updatePricing:async d=>{if(!i)return Ft.error("Not authenticated"),!1;try{const{data:h,error:m}=await jt.functions.invoke("admin-update-pricing",{body:{newPrice:d,sessionToken:i}});return m||!(h!=null&&h.success)?(Ft.error("Failed to update pricing"),!1):(Ft.success("Pricing updated successfully"),!0)}catch(h){return console.error("Update pricing error:",h),Ft.error("Failed to update pricing"),!1}}}},qU=({onLogin:t})=>{const[e,n]=S.useState(""),[r,i]=S.useState(!1),s=async o=>{if(o.preventDefault(),!e.trim())return;i(!0);const a=await t(e);i(!1),a||n("")};return f.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:f.jsxs(_t,{className:"glass-card w-full max-w-md",children:[f.jsxs(_r,{className:"text-center",children:[f.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-gradient-to-br from-primary to-primary/70 flex items-center justify-center experiment-glow",children:f.jsx(w2,{className:"w-8 h-8 text-white"})}),f.jsx(wr,{className:"text-2xl gradient-text",children:"Control Panel Access 🔐"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Enter the admin password to access control features"})]}),f.jsx(Lt,{children:f.jsxs("form",{onSubmit:s,className:"space-y-4",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx(Jv,{htmlFor:"password",children:"Password"}),f.jsxs("div",{className:"relative",children:[f.jsx(g2,{className:"absolute left-3 top-3 w-4 h-4 text-muted-foreground"}),f.jsx(ac,{id:"password",type:"password",placeholder:"Enter admin password",value:e,onChange:o=>n(o.target.value),className:"pl-10",disabled:r})]})]}),f.jsx(Ze,{type:"submit",className:"w-full",disabled:!e.trim()||r,children:r?"Authenticating...":"Access Control Panel 🚀"})]})})]})})},YU=({email:t,showFull:e=!1})=>e?f.jsx("span",{children:t}):f.jsx("span",{children:t}),KU=()=>{const t=hs(),{isAuthenticated:e,isLoading:n,login:r,logout:i,deleteUpload:s,updatePricing:o}=XU(),[a,l]=S.useState([]),[c,u]=S.useState(null),[d,h]=S.useState(!0),[m,x]=S.useState("");S.useEffect(()=>{e&&v()},[e]);const v=async()=>{h(!0);try{const{data:T,error:P}=await jt.functions.invoke("get-uploads",{body:{limit:1e3}});if(P)console.error("Error fetching uploads:",P),Ft.error("Failed to fetch uploads");else{const C=(T==null?void 0:T.uploads)||[];l(C);const b=C.length,N=100+b,U={id:"system",current_price:N,upload_count:b,updated_at:new Date().toISOString()};u(U),x((N/100).toString())}}catch(T){console.error("Error:",T),Ft.error("Failed to fetch data")}finally{h(!1)}},g=async()=>{if(!m||isNaN(Number(m))){Ft.error("Please enter a valid price");return}const T=Math.round(Number(m)*100);await o(T)&&(u(C=>C?{...C,current_price:T}:null),await v())},p=async T=>{if(!confirm("Are you sure you want to delete this upload?"))return;await s(T)&&l(a.filter(C=>C.id!==T))},y=async()=>{if(!confirm("⚠️ Reset pricing to $1.00 and upload count to 0? This cannot be undone!"))return;await o(100)&&(u(P=>P?{...P,current_price:100,upload_count:0}:null),x("1.00"),await v())},_=()=>{const T={uploads:a,pricing:c,exportDate:new Date().toISOString(),totalRevenue:M},P=new Blob([JSON.stringify(T,null,2)],{type:"application/json"}),C=URL.createObjectURL(P),b=document.createElement("a");b.href=C,b.download=`pixperiment-data-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(b),b.click(),document.body.removeChild(b),URL.revokeObjectURL(C),Ft.success("Data exported successfully! 📊")},w=T=>`$${(T/100).toFixed(2)}`,E=T=>new Date(T).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}),M=a.reduce((T,P)=>T+P.price_paid,0);return n?f.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:f.jsxs("div",{className:"animate-pulse text-center",children:[f.jsx("div",{className:"w-16 h-16 bg-muted rounded-full mx-auto mb-4"}),f.jsx("div",{className:"h-4 bg-muted rounded w-32 mx-auto"})]})}):e?d?f.jsx("div",{className:"container mx-auto px-4 py-8",children:f.jsxs("div",{className:"animate-pulse space-y-6",children:[f.jsx("div",{className:"h-8 bg-muted rounded w-64"}),f.jsx("div",{className:"grid md:grid-cols-4 gap-6",children:[...Array(4)].map((T,P)=>f.jsx("div",{className:"h-32 bg-muted rounded"},P))})]})}):f.jsx("div",{className:"min-h-screen bg-background",children:f.jsxs("div",{className:"container mx-auto px-4 py-8",children:[f.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[f.jsx(Ze,{variant:"outline",size:"icon",onClick:()=>t("/"),className:"shrink-0",children:f.jsx(fd,{className:"w-4 h-4"})}),f.jsxs("div",{className:"flex-1",children:[f.jsx("h1",{className:"text-2xl sm:text-3xl font-bold gradient-text",children:"Control Panel 🎛️"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage your PixPeriment application"})]}),f.jsxs(Ze,{variant:"outline",onClick:i,className:"gap-2",children:[f.jsx(v2,{className:"w-4 h-4"}),"Logout"]})]}),f.jsxs("div",{className:"grid md:grid-cols-4 gap-6 mb-8",children:[f.jsx(_t,{className:"glass-card",children:f.jsx(Lt,{className:"p-6",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Revenue"}),f.jsx("p",{className:"text-2xl font-bold text-primary",children:w(M)})]}),f.jsx(T1,{className:"w-8 h-8 text-primary"})]})})}),f.jsx(_t,{className:"glass-card",children:f.jsx(Lt,{className:"p-6",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Uploads"}),f.jsx("p",{className:"text-2xl font-bold text-primary",children:a.length})]}),f.jsx(hd,{className:"w-8 h-8 text-primary"})]})})}),f.jsx(_t,{className:"glass-card",children:f.jsx(Lt,{className:"p-6",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-sm text-muted-foreground",children:"Current Price"}),f.jsx("p",{className:"text-2xl font-bold text-primary",children:c?w(c.current_price):"Loading..."})]}),f.jsx(A1,{className:"w-8 h-8 text-primary"})]})})}),f.jsx(_t,{className:"glass-card",children:f.jsx(Lt,{className:"p-6",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-sm text-muted-foreground",children:"Avg. Price"}),f.jsx("p",{className:"text-2xl font-bold text-primary",children:a.length>0?w(M/a.length):"$0.00"})]}),f.jsx(zx,{className:"w-8 h-8 text-primary"})]})})})]}),f.jsxs($U,{defaultValue:"uploads",className:"space-y-6",children:[f.jsxs(ET,{className:"grid w-full grid-cols-4",children:[f.jsx(hl,{value:"uploads",children:"Uploads Management"}),f.jsx(hl,{value:"pricing",children:"Pricing Control"}),f.jsx(hl,{value:"analytics",children:"Analytics & Export"}),f.jsx(hl,{value:"settings",children:"System Settings"})]}),f.jsx(pl,{value:"uploads",children:f.jsxs(_t,{className:"glass-card",children:[f.jsx(_r,{children:f.jsxs(wr,{className:"flex items-center gap-2",children:[f.jsx(d2,{className:"w-5 h-5"}),"Uploads Management"]})}),f.jsx(Lt,{children:f.jsx("div",{className:"space-y-4",children:a.length===0?f.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No uploads found"}):a.map(T=>f.jsxs("div",{className:"flex items-center gap-4 p-4 border border-border rounded-lg",children:[f.jsx("img",{src:T.image_url,alt:T.caption,className:"w-16 h-16 object-cover rounded"}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsx("p",{className:"font-medium truncate",children:T.caption}),f.jsx("p",{className:"text-sm text-muted-foreground",children:f.jsx(YU,{email:T.user_email})}),f.jsxs("div",{className:"flex items-center gap-4 mt-1",children:[f.jsxs(ns,{variant:"outline",children:["#",T.upload_order]}),f.jsx("span",{className:"text-sm text-primary font-medium",children:w(T.price_paid)}),f.jsx("span",{className:"text-xs text-muted-foreground",children:E(T.created_at)})]})]}),f.jsx(Ze,{variant:"destructive",size:"sm",onClick:()=>p(T.id),children:f.jsx(S2,{className:"w-4 h-4"})})]},T.id))})})]})}),f.jsx(pl,{value:"pricing",children:f.jsxs(_t,{className:"glass-card",children:[f.jsx(_r,{children:f.jsxs(wr,{className:"flex items-center gap-2",children:[f.jsx(Xx,{className:"w-5 h-5"}),"Pricing Control"]})}),f.jsx(Lt,{className:"space-y-6",children:f.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx(Jv,{htmlFor:"price",children:"Current Price ($)"}),f.jsx(ac,{id:"price",type:"number",step:"0.01",min:"0",value:m,onChange:T=>x(T.target.value),placeholder:"Enter new price"})]}),f.jsxs(Ze,{onClick:g,className:"w-full",children:[f.jsx(Xx,{className:"w-4 h-4 mr-2"}),"Update Price"]}),f.jsxs(Ze,{onClick:y,variant:"destructive",className:"w-full",children:[f.jsx($x,{className:"w-4 h-4 mr-2"}),"Reset Pricing"]})]}),f.jsx("div",{className:"space-y-4",children:f.jsxs("div",{className:"p-4 border border-border rounded-lg",children:[f.jsx("h3",{className:"font-medium mb-2",children:"Current Settings 📊"}),f.jsxs("div",{className:"space-y-2 text-sm",children:[f.jsxs("div",{className:"flex justify-between",children:[f.jsx("span",{children:"Price:"}),f.jsx("span",{className:"font-medium",children:c?w(c.current_price):"Loading..."})]}),f.jsxs("div",{className:"flex justify-between",children:[f.jsx("span",{children:"Upload Count:"}),f.jsx("span",{className:"font-medium",children:(c==null?void 0:c.upload_count)||0})]}),f.jsxs("div",{className:"flex justify-between",children:[f.jsx("span",{children:"Last Updated:"}),f.jsx("span",{className:"font-medium",children:c?E(c.updated_at):"Loading..."})]})]})]})})]})})]})}),f.jsx(pl,{value:"analytics",children:f.jsxs(_t,{className:"glass-card",children:[f.jsx(_r,{children:f.jsxs(wr,{className:"flex items-center gap-2",children:[f.jsx(zx,{className:"w-5 h-5"}),"Analytics & Data Export 📊"]})}),f.jsx(Lt,{className:"space-y-6",children:f.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[f.jsxs("div",{className:"space-y-4",children:[f.jsx("h3",{className:"font-medium",children:"Revenue Analytics 💰"}),f.jsxs("div",{className:"space-y-3",children:[f.jsx("div",{className:"p-4 border border-border rounded-lg",children:f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{className:"text-sm text-muted-foreground",children:"Total Revenue"}),f.jsx("span",{className:"text-xl font-bold text-primary",children:w(M)})]})}),f.jsx("div",{className:"p-4 border border-border rounded-lg",children:f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{className:"text-sm text-muted-foreground",children:"Average Upload Price"}),f.jsx("span",{className:"text-lg font-semibold",children:a.length>0?w(M/a.length):"$0.00"})]})}),f.jsx("div",{className:"p-4 border border-border rounded-lg",children:f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{className:"text-sm text-muted-foreground",children:"Price Growth"}),f.jsx("span",{className:"text-lg font-semibold text-green-500",children:a.length>1?`+${a.length-1}¢`:"0¢"})]})})]})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsx("h3",{className:"font-medium",children:"Data Export 📁"}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs(Ze,{onClick:_,className:"w-full gap-2",children:[f.jsx(f2,{className:"w-4 h-4"}),"Export All Data (JSON)"]}),f.jsxs("div",{className:"p-4 border border-green-500/20 bg-green-500/10 rounded-lg",children:[f.jsx("h4",{className:"font-medium text-green-200 mb-2",children:"Export Includes:"}),f.jsxs("ul",{className:"text-sm text-green-200 space-y-1",children:[f.jsx("li",{children:"• All upload data and metadata"}),f.jsx("li",{children:"• Current pricing information"}),f.jsx("li",{children:"• Revenue analytics"}),f.jsx("li",{children:"• Export timestamp"})]})]})]})]})]})})]})}),f.jsx(pl,{value:"settings",children:f.jsxs(_t,{className:"glass-card",children:[f.jsx(_r,{children:f.jsxs(wr,{className:"flex items-center gap-2",children:[f.jsx(_2,{className:"w-5 h-5"}),"System Settings ⚙️"]})}),f.jsx(Lt,{className:"space-y-6",children:f.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[f.jsxs("div",{className:"space-y-4",children:[f.jsx("h3",{className:"font-medium",children:"Data Management 🔄"}),f.jsxs("div",{className:"space-y-2",children:[f.jsxs(Ze,{variant:"outline",onClick:v,className:"w-full gap-2",children:[f.jsx(x2,{className:"w-4 h-4"}),"Refresh Data"]}),f.jsxs(Ze,{variant:"destructive",onClick:y,className:"w-full gap-2",children:[f.jsx($x,{className:"w-4 h-4"}),"Reset Pricing System"]})]})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsx("h3",{className:"font-medium",children:"Security Notice 🔐"}),f.jsx("div",{className:"p-4 border border-yellow-500/20 bg-yellow-500/10 rounded-lg",children:f.jsxs("div",{className:"flex items-start gap-2",children:[f.jsx(E2,{className:"w-4 h-4 text-yellow-500 mt-0.5 flex-shrink-0"}),f.jsxs("div",{className:"text-sm text-yellow-200",children:[f.jsx("p",{className:"font-medium mb-1",children:"⚠️ Admin Access Active"}),f.jsx("p",{children:"Most admin functions require elevated privileges. Current implementation shows interface but requires proper authentication for database modifications."})]})]})}),f.jsx("div",{className:"p-4 border border-blue-500/20 bg-blue-500/10 rounded-lg",children:f.jsxs("div",{className:"text-sm text-blue-200",children:[f.jsx("p",{className:"font-medium mb-1",children:"🔒 Session Info"}),f.jsx("p",{children:"Your session will expire after 30 minutes of inactivity for security."})]})})]})]})})]})})]})]})}):f.jsx(qU,{onLogin:r})};var[xf,RV]=lc("Tooltip",[cf]),yf=cf(),bT="TooltipProvider",JU=700,Pm="tooltip.open",[ZU,e0]=xf(bT),TT=t=>{const{__scopeTooltip:e,delayDuration:n=JU,skipDelayDuration:r=300,disableHoverableContent:i=!1,children:s}=t,[o,a]=S.useState(!0),l=S.useRef(!1),c=S.useRef(0);return S.useEffect(()=>{const u=c.current;return()=>window.clearTimeout(u)},[]),f.jsx(ZU,{scope:e,isOpenDelayed:o,delayDuration:n,onOpen:S.useCallback(()=>{window.clearTimeout(c.current),a(!1)},[]),onClose:S.useCallback(()=>{window.clearTimeout(c.current),c.current=window.setTimeout(()=>a(!0),r)},[r]),isPointerInTransitRef:l,onPointerInTransitChange:S.useCallback(u=>{l.current=u},[]),disableHoverableContent:i,children:s})};TT.displayName=bT;var _f="Tooltip",[QU,wf]=xf(_f),MT=t=>{const{__scopeTooltip:e,children:n,open:r,defaultOpen:i=!1,onOpenChange:s,disableHoverableContent:o,delayDuration:a}=t,l=e0(_f,t.__scopeTooltip),c=yf(e),[u,d]=S.useState(null),h=ms(),m=S.useRef(0),x=o??l.disableHoverableContent,v=a??l.delayDuration,g=S.useRef(!1),[p=!1,y]=as({prop:r,defaultProp:i,onChange:T=>{T?(l.onOpen(),document.dispatchEvent(new CustomEvent(Pm))):l.onClose(),s==null||s(T)}}),_=S.useMemo(()=>p?g.current?"delayed-open":"instant-open":"closed",[p]),w=S.useCallback(()=>{window.clearTimeout(m.current),m.current=0,g.current=!1,y(!0)},[y]),E=S.useCallback(()=>{window.clearTimeout(m.current),m.current=0,y(!1)},[y]),M=S.useCallback(()=>{window.clearTimeout(m.current),m.current=window.setTimeout(()=>{g.current=!0,y(!0),m.current=0},v)},[v,y]);return S.useEffect(()=>()=>{m.current&&(window.clearTimeout(m.current),m.current=0)},[]),f.jsx(FE,{...c,children:f.jsx(QU,{scope:e,contentId:h,open:p,stateAttribute:_,trigger:u,onTriggerChange:d,onTriggerEnter:S.useCallback(()=>{l.isOpenDelayed?M():w()},[l.isOpenDelayed,M,w]),onTriggerLeave:S.useCallback(()=>{x?E():(window.clearTimeout(m.current),m.current=0)},[E,x]),onOpen:w,onClose:E,disableHoverableContent:x,children:n})})};MT.displayName=_f;var Nm="TooltipTrigger",CT=S.forwardRef((t,e)=>{const{__scopeTooltip:n,...r}=t,i=wf(Nm,n),s=e0(Nm,n),o=yf(n),a=S.useRef(null),l=kt(e,a,i.onTriggerChange),c=S.useRef(!1),u=S.useRef(!1),d=S.useCallback(()=>c.current=!1,[]);return S.useEffect(()=>()=>document.removeEventListener("pointerup",d),[d]),f.jsx(BE,{asChild:!0,...o,children:f.jsx(lt.button,{"aria-describedby":i.open?i.contentId:void 0,"data-state":i.stateAttribute,...r,ref:l,onPointerMove:nt(t.onPointerMove,h=>{h.pointerType!=="touch"&&!u.current&&!s.isPointerInTransitRef.current&&(i.onTriggerEnter(),u.current=!0)}),onPointerLeave:nt(t.onPointerLeave,()=>{i.onTriggerLeave(),u.current=!1}),onPointerDown:nt(t.onPointerDown,()=>{c.current=!0,document.addEventListener("pointerup",d,{once:!0})}),onFocus:nt(t.onFocus,()=>{c.current||i.onOpen()}),onBlur:nt(t.onBlur,i.onClose),onClick:nt(t.onClick,i.onClose)})})});CT.displayName=Nm;var ek="TooltipPortal",[PV,tk]=xf(ek,{forceMount:void 0}),_a="TooltipContent",AT=S.forwardRef((t,e)=>{const n=tk(_a,t.__scopeTooltip),{forceMount:r=n.forceMount,side:i="top",...s}=t,o=wf(_a,t.__scopeTooltip);return f.jsx(pf,{present:r||o.open,children:o.disableHoverableContent?f.jsx(RT,{side:i,...s,ref:e}):f.jsx(nk,{side:i,...s,ref:e})})}),nk=S.forwardRef((t,e)=>{const n=wf(_a,t.__scopeTooltip),r=e0(_a,t.__scopeTooltip),i=S.useRef(null),s=kt(e,i),[o,a]=S.useState(null),{trigger:l,onClose:c}=n,u=i.current,{onPointerInTransitChange:d}=r,h=S.useCallback(()=>{a(null),d(!1)},[d]),m=S.useCallback((x,v)=>{const g=x.currentTarget,p={x:x.clientX,y:x.clientY},y=ok(p,g.getBoundingClientRect()),_=ak(p,y),w=lk(v.getBoundingClientRect()),E=uk([..._,...w]);a(E),d(!0)},[d]);return S.useEffect(()=>()=>h(),[h]),S.useEffect(()=>{if(l&&u){const x=g=>m(g,u),v=g=>m(g,l);return l.addEventListener("pointerleave",x),u.addEventListener("pointerleave",v),()=>{l.removeEventListener("pointerleave",x),u.removeEventListener("pointerleave",v)}}},[l,u,m,h]),S.useEffect(()=>{if(o){const x=v=>{const g=v.target,p={x:v.clientX,y:v.clientY},y=(l==null?void 0:l.contains(g))||(u==null?void 0:u.contains(g)),_=!ck(p,o);y?h():_&&(h(),c())};return document.addEventListener("pointermove",x),()=>document.removeEventListener("pointermove",x)}},[l,u,o,c,h]),f.jsx(RT,{...t,ref:s})}),[rk,ik]=xf(_f,{isInside:!1}),RT=S.forwardRef((t,e)=>{const{__scopeTooltip:n,children:r,"aria-label":i,onEscapeKeyDown:s,onPointerDownOutside:o,...a}=t,l=wf(_a,n),c=yf(n),{onClose:u}=l;return S.useEffect(()=>(document.addEventListener(Pm,u),()=>document.removeEventListener(Pm,u)),[u]),S.useEffect(()=>{if(l.trigger){const d=h=>{const m=h.target;m!=null&&m.contains(l.trigger)&&u()};return window.addEventListener("scroll",d,{capture:!0}),()=>window.removeEventListener("scroll",d,{capture:!0})}},[l.trigger,u]),f.jsx(Lv,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:s,onPointerDownOutside:o,onFocusOutside:d=>d.preventDefault(),onDismiss:u,children:f.jsxs(jE,{"data-state":l.stateAttribute,...c,...a,ref:e,style:{...a.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[f.jsx(P1,{children:r}),f.jsx(rk,{scope:n,isInside:!0,children:f.jsx(DD,{id:l.contentId,role:"tooltip",children:i||r})})]})})});AT.displayName=_a;var PT="TooltipArrow",sk=S.forwardRef((t,e)=>{const{__scopeTooltip:n,...r}=t,i=yf(n);return ik(PT,n).isInside?null:f.jsx(zE,{...i,...r,ref:e})});sk.displayName=PT;function ok(t,e){const n=Math.abs(e.top-t.y),r=Math.abs(e.bottom-t.y),i=Math.abs(e.right-t.x),s=Math.abs(e.left-t.x);switch(Math.min(n,r,i,s)){case s:return"left";case i:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function ak(t,e,n=5){const r=[];switch(e){case"top":r.push({x:t.x-n,y:t.y+n},{x:t.x+n,y:t.y+n});break;case"bottom":r.push({x:t.x-n,y:t.y-n},{x:t.x+n,y:t.y-n});break;case"left":r.push({x:t.x+n,y:t.y-n},{x:t.x+n,y:t.y+n});break;case"right":r.push({x:t.x-n,y:t.y-n},{x:t.x-n,y:t.y+n});break}return r}function lk(t){const{top:e,right:n,bottom:r,left:i}=t;return[{x:i,y:e},{x:n,y:e},{x:n,y:r},{x:i,y:r}]}function ck(t,e){const{x:n,y:r}=t;let i=!1;for(let s=0,o=e.length-1;s<e.length;o=s++){const a=e[s].x,l=e[s].y,c=e[o].x,u=e[o].y;l>r!=u>r&&n<(c-a)*(r-l)/(u-l)+a&&(i=!i)}return i}function uk(t){const e=t.slice();return e.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),dk(e)}function dk(t){if(t.length<=1)return t.slice();const e=[];for(let r=0;r<t.length;r++){const i=t[r];for(;e.length>=2;){const s=e[e.length-1],o=e[e.length-2];if((s.x-o.x)*(i.y-o.y)>=(s.y-o.y)*(i.x-o.x))e.pop();else break}e.push(i)}e.pop();const n=[];for(let r=t.length-1;r>=0;r--){const i=t[r];for(;n.length>=2;){const s=n[n.length-1],o=n[n.length-2];if((s.x-o.x)*(i.y-o.y)>=(s.y-o.y)*(i.x-o.x))n.pop();else break}n.push(i)}return n.pop(),e.length===1&&n.length===1&&e[0].x===n[0].x&&e[0].y===n[0].y?e:e.concat(n)}var fk=TT,hk=MT,pk=CT,NT=AT;const mk=fk,gk=hk,vk=pk,IT=S.forwardRef(({className:t,sideOffset:e=4,...n},r)=>f.jsx(NT,{ref:r,sideOffset:e,className:wt("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n}));IT.displayName=NT.displayName;const xk=({children:t})=>f.jsx(mk,{children:f.jsxs(gk,{children:[f.jsx(vk,{asChild:!0,children:t}),f.jsx(IT,{children:f.jsx("p",{children:"Scan to share or revisit this post instantly"})})]})}),yk=()=>{const{id:t}=DR(),e=hs(),[n,r]=S.useState(null),[i,s]=S.useState(!0),[o,a]=S.useState(""),[l,c]=S.useState(!1);S.useEffect(()=>{t&&(u(),d())},[t]);const u=S.useCallback(async()=>{try{const{data:_,error:w}=await jt.functions.invoke("get-uploads",{body:{}});if(w)throw w;const M=(_.uploads||[]).find(T=>T.id===t);if(!M){Ft.error("Post not found"),e("/");return}r(M)}catch(_){console.error("Error fetching upload:",_),Ft.error("Post not found"),e("/")}finally{s(!1)}},[t,e]),d=()=>{const _=window.location.href;a(`https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(_)}`)},h=_=>`$${(_/100).toFixed(2)}`,m=_=>new Date(_).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0}),x=_=>{const[w,E]=_.split("@");return`${w.substring(0,2)}***@${E}`},v=()=>{navigator.clipboard.writeText(window.location.href),c(!0),Ft.success("Link copied to clipboard!"),setTimeout(()=>c(!1),2e3)},g=()=>{const _=`Check out this post on PixPeriment - The Social Experiment! Price paid: ${n?h(n.price_paid):""} 🚀`;window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(_)}&url=${encodeURIComponent(window.location.href)}`)},p=()=>{window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(window.location.href)}`)},y=()=>{window.open(`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(window.location.href)}`)};return i?f.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:f.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary"})}):n?f.jsx("div",{className:"min-h-screen bg-background",children:f.jsxs("div",{className:"container mx-auto px-4 py-4",children:[f.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[f.jsx(Ze,{variant:"outline",size:"sm",onClick:()=>e("/"),className:"shrink-0",children:f.jsx(fd,{className:"w-4 h-4"})}),f.jsxs("div",{children:[f.jsx("h1",{className:"text-lg sm:text-xl font-bold gradient-text",children:"PixPeriment Post"}),f.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"Part of the social experiment"})]})]}),f.jsxs("div",{className:"grid lg:grid-cols-2 gap-4",children:[f.jsx("div",{className:"space-y-4",children:f.jsxs(_t,{className:"glass-card p-4 experiment-glow",children:[f.jsx("div",{className:"aspect-square max-w-md mx-auto rounded-lg overflow-hidden mb-3",children:f.jsx("img",{src:n.image_url,alt:n.caption,className:"w-full h-full object-cover hover:scale-105 transition-transform duration-300",onError:_=>{console.error("Image failed to load:",n.image_url),console.log("Attempting to load fallback image..."),_.currentTarget.src="data:image/svg+xml;base64,"+btoa(`
                      <svg width="400" height="400" xmlns="http://www.w3.org/2000/svg">
                        <rect width="400" height="400" fill="#f3f4f6"/>
                        <text x="200" y="200" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" fill="#6b7280">
                          ${n.caption||"Image not available"}
                        </text>
                      </svg>
                    `)}})}),f.jsxs("div",{className:"space-y-3",children:[f.jsx("h2",{className:"text-lg font-semibold break-words",children:n.caption}),f.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[f.jsxs("div",{className:"glass-card p-2",children:[f.jsx("p",{className:"text-muted-foreground text-xs",children:"Price Paid"}),f.jsx("p",{className:"text-base font-bold text-primary price-ticker",children:h(n.price_paid)})]}),f.jsxs("div",{className:"glass-card p-2",children:[f.jsx("p",{className:"text-muted-foreground text-xs",children:"Upload Date & Time"}),f.jsx("p",{className:"font-medium text-xs",children:m(n.created_at)})]})]}),f.jsxs("div",{className:"glass-card p-2",children:[f.jsx("p",{className:"text-muted-foreground text-xs",children:"Uploaded by"}),f.jsx("p",{className:"font-medium text-sm",children:n.user_email?x(n.user_email):"Anonymous"})]}),f.jsxs("div",{className:"glass-card p-3",children:[f.jsx("p",{className:"text-muted-foreground text-xs mb-2",children:"Community Rating"}),f.jsx(gd,{uploadId:n.id})]})]})]})}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs(_t,{className:"glass-card p-4",children:[f.jsx("h3",{className:"text-lg font-bold mb-3 gradient-text",children:"Share This Post"}),f.jsxs("div",{className:"text-center mb-4",children:[f.jsx(xk,{children:f.jsx("div",{className:"inline-block p-2 bg-white rounded-lg cursor-pointer",children:f.jsx("img",{src:o,alt:"QR Code",className:"w-32 h-32 mx-auto"})})}),f.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Scan to view this post"})]}),f.jsx("div",{className:"mb-4",children:f.jsxs(Ze,{onClick:v,variant:"outline",className:"w-full",size:"sm",children:[l?f.jsx(b1,{className:"w-4 h-4 mr-2"}):f.jsx(u2,{className:"w-4 h-4 mr-2"}),l?"Copied!":"Copy Link"]})}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("h4",{className:"font-medium text-sm",children:"Share on Social Media"}),f.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[f.jsxs(Ze,{onClick:g,variant:"outline",className:"w-full",size:"sm",children:[f.jsx(ra,{className:"w-4 h-4 mr-2"}),"Share on Twitter"]}),f.jsxs(Ze,{onClick:p,variant:"outline",className:"w-full",size:"sm",children:[f.jsx(ra,{className:"w-4 h-4 mr-2"}),"Share on Facebook"]}),f.jsxs(Ze,{onClick:y,variant:"outline",className:"w-full",size:"sm",children:[f.jsx(ra,{className:"w-4 h-4 mr-2"}),"Share on LinkedIn"]})]})]})]}),f.jsxs(_t,{className:"glass-card p-4",children:[f.jsx("h3",{className:"text-base font-bold mb-2 gradient-text",children:"About the Experiment"}),f.jsxs("div",{className:"space-y-1 text-xs text-muted-foreground",children:[f.jsx("p",{children:"🔬 Part of PixPeriment's social pricing experiment"}),f.jsx("p",{children:"📈 Each upload costs more than the previous one"}),f.jsx("p",{children:"🎯 Testing how high the community will push the price"}),f.jsx("p",{children:"⚡ Real-time price increases with every new upload"})]}),f.jsx(Ze,{onClick:()=>e("/"),className:"w-full mt-3",variant:"default",size:"sm",children:"Join the Experiment"})]})]})]})]})}):f.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:f.jsxs(_t,{className:"glass-card p-8 text-center",children:[f.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Post Not Found"}),f.jsxs(Ze,{onClick:()=>e("/"),variant:"outline",children:[f.jsx(fd,{className:"w-4 h-4 mr-2"}),"Back to Home"]})]})})};var Ys={},_k=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then},LT={},qn={};let t0;const wk=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];qn.getSymbolSize=function(e){if(!e)throw new Error('"version" cannot be null or undefined');if(e<1||e>40)throw new Error('"version" should be in range from 1 to 40');return e*4+17};qn.getSymbolTotalCodewords=function(e){return wk[e]};qn.getBCHDigit=function(t){let e=0;for(;t!==0;)e++,t>>>=1;return e};qn.setToSJISFunction=function(e){if(typeof e!="function")throw new Error('"toSJISFunc" is not a valid function.');t0=e};qn.isKanjiModeEnabled=function(){return typeof t0<"u"};qn.toSJIS=function(e){return t0(e)};var Sf={};(function(t){t.L={bit:1},t.M={bit:0},t.Q={bit:3},t.H={bit:2};function e(n){if(typeof n!="string")throw new Error("Param is not a string");switch(n.toLowerCase()){case"l":case"low":return t.L;case"m":case"medium":return t.M;case"q":case"quartile":return t.Q;case"h":case"high":return t.H;default:throw new Error("Unknown EC Level: "+n)}}t.isValid=function(r){return r&&typeof r.bit<"u"&&r.bit>=0&&r.bit<4},t.from=function(r,i){if(t.isValid(r))return r;try{return e(r)}catch{return i}}})(Sf);function DT(){this.buffer=[],this.length=0}DT.prototype={get:function(t){const e=Math.floor(t/8);return(this.buffer[e]>>>7-t%8&1)===1},put:function(t,e){for(let n=0;n<e;n++)this.putBit((t>>>e-n-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(t){const e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}};var Sk=DT;function dc(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=new Uint8Array(t*t),this.reservedBit=new Uint8Array(t*t)}dc.prototype.set=function(t,e,n,r){const i=t*this.size+e;this.data[i]=n,r&&(this.reservedBit[i]=!0)};dc.prototype.get=function(t,e){return this.data[t*this.size+e]};dc.prototype.xor=function(t,e,n){this.data[t*this.size+e]^=n};dc.prototype.isReserved=function(t,e){return this.reservedBit[t*this.size+e]};var Ek=dc,UT={};(function(t){const e=qn.getSymbolSize;t.getRowColCoords=function(r){if(r===1)return[];const i=Math.floor(r/7)+2,s=e(r),o=s===145?26:Math.ceil((s-13)/(2*i-2))*2,a=[s-7];for(let l=1;l<i-1;l++)a[l]=a[l-1]-o;return a.push(6),a.reverse()},t.getPositions=function(r){const i=[],s=t.getRowColCoords(r),o=s.length;for(let a=0;a<o;a++)for(let l=0;l<o;l++)a===0&&l===0||a===0&&l===o-1||a===o-1&&l===0||i.push([s[a],s[l]]);return i}})(UT);var kT={};const bk=qn.getSymbolSize,qy=7;kT.getPositions=function(e){const n=bk(e);return[[0,0],[n-qy,0],[0,n-qy]]};var OT={};(function(t){t.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const e={N1:3,N2:3,N3:40,N4:10};t.isValid=function(i){return i!=null&&i!==""&&!isNaN(i)&&i>=0&&i<=7},t.from=function(i){return t.isValid(i)?parseInt(i,10):void 0},t.getPenaltyN1=function(i){const s=i.size;let o=0,a=0,l=0,c=null,u=null;for(let d=0;d<s;d++){a=l=0,c=u=null;for(let h=0;h<s;h++){let m=i.get(d,h);m===c?a++:(a>=5&&(o+=e.N1+(a-5)),c=m,a=1),m=i.get(h,d),m===u?l++:(l>=5&&(o+=e.N1+(l-5)),u=m,l=1)}a>=5&&(o+=e.N1+(a-5)),l>=5&&(o+=e.N1+(l-5))}return o},t.getPenaltyN2=function(i){const s=i.size;let o=0;for(let a=0;a<s-1;a++)for(let l=0;l<s-1;l++){const c=i.get(a,l)+i.get(a,l+1)+i.get(a+1,l)+i.get(a+1,l+1);(c===4||c===0)&&o++}return o*e.N2},t.getPenaltyN3=function(i){const s=i.size;let o=0,a=0,l=0;for(let c=0;c<s;c++){a=l=0;for(let u=0;u<s;u++)a=a<<1&2047|i.get(c,u),u>=10&&(a===1488||a===93)&&o++,l=l<<1&2047|i.get(u,c),u>=10&&(l===1488||l===93)&&o++}return o*e.N3},t.getPenaltyN4=function(i){let s=0;const o=i.data.length;for(let l=0;l<o;l++)s+=i.data[l];return Math.abs(Math.ceil(s*100/o/5)-10)*e.N4};function n(r,i,s){switch(r){case t.Patterns.PATTERN000:return(i+s)%2===0;case t.Patterns.PATTERN001:return i%2===0;case t.Patterns.PATTERN010:return s%3===0;case t.Patterns.PATTERN011:return(i+s)%3===0;case t.Patterns.PATTERN100:return(Math.floor(i/2)+Math.floor(s/3))%2===0;case t.Patterns.PATTERN101:return i*s%2+i*s%3===0;case t.Patterns.PATTERN110:return(i*s%2+i*s%3)%2===0;case t.Patterns.PATTERN111:return(i*s%3+(i+s)%2)%2===0;default:throw new Error("bad maskPattern:"+r)}}t.applyMask=function(i,s){const o=s.size;for(let a=0;a<o;a++)for(let l=0;l<o;l++)s.isReserved(l,a)||s.xor(l,a,n(i,l,a))},t.getBestMask=function(i,s){const o=Object.keys(t.Patterns).length;let a=0,l=1/0;for(let c=0;c<o;c++){s(c),t.applyMask(c,i);const u=t.getPenaltyN1(i)+t.getPenaltyN2(i)+t.getPenaltyN3(i)+t.getPenaltyN4(i);t.applyMask(c,i),u<l&&(l=u,a=c)}return a}})(OT);var Ef={};const Gi=Sf,Xc=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],qc=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];Ef.getBlocksCount=function(e,n){switch(n){case Gi.L:return Xc[(e-1)*4+0];case Gi.M:return Xc[(e-1)*4+1];case Gi.Q:return Xc[(e-1)*4+2];case Gi.H:return Xc[(e-1)*4+3];default:return}};Ef.getTotalCodewordsCount=function(e,n){switch(n){case Gi.L:return qc[(e-1)*4+0];case Gi.M:return qc[(e-1)*4+1];case Gi.Q:return qc[(e-1)*4+2];case Gi.H:return qc[(e-1)*4+3];default:return}};var FT={},bf={};const Al=new Uint8Array(512),bd=new Uint8Array(256);(function(){let e=1;for(let n=0;n<255;n++)Al[n]=e,bd[e]=n,e<<=1,e&256&&(e^=285);for(let n=255;n<512;n++)Al[n]=Al[n-255]})();bf.log=function(e){if(e<1)throw new Error("log("+e+")");return bd[e]};bf.exp=function(e){return Al[e]};bf.mul=function(e,n){return e===0||n===0?0:Al[bd[e]+bd[n]]};(function(t){const e=bf;t.mul=function(r,i){const s=new Uint8Array(r.length+i.length-1);for(let o=0;o<r.length;o++)for(let a=0;a<i.length;a++)s[o+a]^=e.mul(r[o],i[a]);return s},t.mod=function(r,i){let s=new Uint8Array(r);for(;s.length-i.length>=0;){const o=s[0];for(let l=0;l<i.length;l++)s[l]^=e.mul(i[l],o);let a=0;for(;a<s.length&&s[a]===0;)a++;s=s.slice(a)}return s},t.generateECPolynomial=function(r){let i=new Uint8Array([1]);for(let s=0;s<r;s++)i=t.mul(i,new Uint8Array([1,e.exp(s)]));return i}})(FT);const BT=FT;function n0(t){this.genPoly=void 0,this.degree=t,this.degree&&this.initialize(this.degree)}n0.prototype.initialize=function(e){this.degree=e,this.genPoly=BT.generateECPolynomial(this.degree)};n0.prototype.encode=function(e){if(!this.genPoly)throw new Error("Encoder not initialized");const n=new Uint8Array(e.length+this.degree);n.set(e);const r=BT.mod(n,this.genPoly),i=this.degree-r.length;if(i>0){const s=new Uint8Array(this.degree);return s.set(r,i),s}return r};var Tk=n0,jT={},xs={},r0={};r0.isValid=function(e){return!isNaN(e)&&e>=1&&e<=40};var Wr={};const zT="[0-9]+",Mk="[A-Z $%*+\\-./:]+";let Jl="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";Jl=Jl.replace(/u/g,"\\u");const Ck="(?:(?![A-Z0-9 $%*+\\-./:]|"+Jl+`)(?:.|[\r
]))+`;Wr.KANJI=new RegExp(Jl,"g");Wr.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");Wr.BYTE=new RegExp(Ck,"g");Wr.NUMERIC=new RegExp(zT,"g");Wr.ALPHANUMERIC=new RegExp(Mk,"g");const Ak=new RegExp("^"+Jl+"$"),Rk=new RegExp("^"+zT+"$"),Pk=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");Wr.testKanji=function(e){return Ak.test(e)};Wr.testNumeric=function(e){return Rk.test(e)};Wr.testAlphanumeric=function(e){return Pk.test(e)};(function(t){const e=r0,n=Wr;t.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},t.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},t.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},t.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},t.MIXED={bit:-1},t.getCharCountIndicator=function(s,o){if(!s.ccBits)throw new Error("Invalid mode: "+s);if(!e.isValid(o))throw new Error("Invalid version: "+o);return o>=1&&o<10?s.ccBits[0]:o<27?s.ccBits[1]:s.ccBits[2]},t.getBestModeForData=function(s){return n.testNumeric(s)?t.NUMERIC:n.testAlphanumeric(s)?t.ALPHANUMERIC:n.testKanji(s)?t.KANJI:t.BYTE},t.toString=function(s){if(s&&s.id)return s.id;throw new Error("Invalid mode")},t.isValid=function(s){return s&&s.bit&&s.ccBits};function r(i){if(typeof i!="string")throw new Error("Param is not a string");switch(i.toLowerCase()){case"numeric":return t.NUMERIC;case"alphanumeric":return t.ALPHANUMERIC;case"kanji":return t.KANJI;case"byte":return t.BYTE;default:throw new Error("Unknown mode: "+i)}}t.from=function(s,o){if(t.isValid(s))return s;try{return r(s)}catch{return o}}})(xs);(function(t){const e=qn,n=Ef,r=Sf,i=xs,s=r0,o=7973,a=e.getBCHDigit(o);function l(h,m,x){for(let v=1;v<=40;v++)if(m<=t.getCapacity(v,x,h))return v}function c(h,m){return i.getCharCountIndicator(h,m)+4}function u(h,m){let x=0;return h.forEach(function(v){const g=c(v.mode,m);x+=g+v.getBitsLength()}),x}function d(h,m){for(let x=1;x<=40;x++)if(u(h,x)<=t.getCapacity(x,m,i.MIXED))return x}t.from=function(m,x){return s.isValid(m)?parseInt(m,10):x},t.getCapacity=function(m,x,v){if(!s.isValid(m))throw new Error("Invalid QR Code version");typeof v>"u"&&(v=i.BYTE);const g=e.getSymbolTotalCodewords(m),p=n.getTotalCodewordsCount(m,x),y=(g-p)*8;if(v===i.MIXED)return y;const _=y-c(v,m);switch(v){case i.NUMERIC:return Math.floor(_/10*3);case i.ALPHANUMERIC:return Math.floor(_/11*2);case i.KANJI:return Math.floor(_/13);case i.BYTE:default:return Math.floor(_/8)}},t.getBestVersionForData=function(m,x){let v;const g=r.from(x,r.M);if(Array.isArray(m)){if(m.length>1)return d(m,g);if(m.length===0)return 1;v=m[0]}else v=m;return l(v.mode,v.getLength(),g)},t.getEncodedBits=function(m){if(!s.isValid(m)||m<7)throw new Error("Invalid QR Code version");let x=m<<12;for(;e.getBCHDigit(x)-a>=0;)x^=o<<e.getBCHDigit(x)-a;return m<<12|x}})(jT);var VT={};const Im=qn,HT=1335,Nk=21522,Yy=Im.getBCHDigit(HT);VT.getEncodedBits=function(e,n){const r=e.bit<<3|n;let i=r<<10;for(;Im.getBCHDigit(i)-Yy>=0;)i^=HT<<Im.getBCHDigit(i)-Yy;return(r<<10|i)^Nk};var GT={};const Ik=xs;function wa(t){this.mode=Ik.NUMERIC,this.data=t.toString()}wa.getBitsLength=function(e){return 10*Math.floor(e/3)+(e%3?e%3*3+1:0)};wa.prototype.getLength=function(){return this.data.length};wa.prototype.getBitsLength=function(){return wa.getBitsLength(this.data.length)};wa.prototype.write=function(e){let n,r,i;for(n=0;n+3<=this.data.length;n+=3)r=this.data.substr(n,3),i=parseInt(r,10),e.put(i,10);const s=this.data.length-n;s>0&&(r=this.data.substr(n),i=parseInt(r,10),e.put(i,s*3+1))};var Lk=wa;const Dk=xs,bh=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function Sa(t){this.mode=Dk.ALPHANUMERIC,this.data=t}Sa.getBitsLength=function(e){return 11*Math.floor(e/2)+6*(e%2)};Sa.prototype.getLength=function(){return this.data.length};Sa.prototype.getBitsLength=function(){return Sa.getBitsLength(this.data.length)};Sa.prototype.write=function(e){let n;for(n=0;n+2<=this.data.length;n+=2){let r=bh.indexOf(this.data[n])*45;r+=bh.indexOf(this.data[n+1]),e.put(r,11)}this.data.length%2&&e.put(bh.indexOf(this.data[n]),6)};var Uk=Sa;const kk=xs;function Ea(t){this.mode=kk.BYTE,typeof t=="string"?this.data=new TextEncoder().encode(t):this.data=new Uint8Array(t)}Ea.getBitsLength=function(e){return e*8};Ea.prototype.getLength=function(){return this.data.length};Ea.prototype.getBitsLength=function(){return Ea.getBitsLength(this.data.length)};Ea.prototype.write=function(t){for(let e=0,n=this.data.length;e<n;e++)t.put(this.data[e],8)};var Ok=Ea;const Fk=xs,Bk=qn;function ba(t){this.mode=Fk.KANJI,this.data=t}ba.getBitsLength=function(e){return e*13};ba.prototype.getLength=function(){return this.data.length};ba.prototype.getBitsLength=function(){return ba.getBitsLength(this.data.length)};ba.prototype.write=function(t){let e;for(e=0;e<this.data.length;e++){let n=Bk.toSJIS(this.data[e]);if(n>=33088&&n<=40956)n-=33088;else if(n>=57408&&n<=60351)n-=49472;else throw new Error("Invalid SJIS character: "+this.data[e]+`
Make sure your charset is UTF-8`);n=(n>>>8&255)*192+(n&255),t.put(n,13)}};var jk=ba,WT={exports:{}};(function(t){var e={single_source_shortest_paths:function(n,r,i){var s={},o={};o[r]=0;var a=e.PriorityQueue.make();a.push(r,0);for(var l,c,u,d,h,m,x,v,g;!a.empty();){l=a.pop(),c=l.value,d=l.cost,h=n[c]||{};for(u in h)h.hasOwnProperty(u)&&(m=h[u],x=d+m,v=o[u],g=typeof o[u]>"u",(g||v>x)&&(o[u]=x,a.push(u,x),s[u]=c))}if(typeof i<"u"&&typeof o[i]>"u"){var p=["Could not find a path from ",r," to ",i,"."].join("");throw new Error(p)}return s},extract_shortest_path_from_predecessor_list:function(n,r){for(var i=[],s=r;s;)i.push(s),n[s],s=n[s];return i.reverse(),i},find_path:function(n,r,i){var s=e.single_source_shortest_paths(n,r,i);return e.extract_shortest_path_from_predecessor_list(s,i)},PriorityQueue:{make:function(n){var r=e.PriorityQueue,i={},s;n=n||{};for(s in r)r.hasOwnProperty(s)&&(i[s]=r[s]);return i.queue=[],i.sorter=n.sorter||r.default_sorter,i},default_sorter:function(n,r){return n.cost-r.cost},push:function(n,r){var i={value:n,cost:r};this.queue.push(i),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};t.exports=e})(WT);var zk=WT.exports;(function(t){const e=xs,n=Lk,r=Uk,i=Ok,s=jk,o=Wr,a=qn,l=zk;function c(p){return unescape(encodeURIComponent(p)).length}function u(p,y,_){const w=[];let E;for(;(E=p.exec(_))!==null;)w.push({data:E[0],index:E.index,mode:y,length:E[0].length});return w}function d(p){const y=u(o.NUMERIC,e.NUMERIC,p),_=u(o.ALPHANUMERIC,e.ALPHANUMERIC,p);let w,E;return a.isKanjiModeEnabled()?(w=u(o.BYTE,e.BYTE,p),E=u(o.KANJI,e.KANJI,p)):(w=u(o.BYTE_KANJI,e.BYTE,p),E=[]),y.concat(_,w,E).sort(function(T,P){return T.index-P.index}).map(function(T){return{data:T.data,mode:T.mode,length:T.length}})}function h(p,y){switch(y){case e.NUMERIC:return n.getBitsLength(p);case e.ALPHANUMERIC:return r.getBitsLength(p);case e.KANJI:return s.getBitsLength(p);case e.BYTE:return i.getBitsLength(p)}}function m(p){return p.reduce(function(y,_){const w=y.length-1>=0?y[y.length-1]:null;return w&&w.mode===_.mode?(y[y.length-1].data+=_.data,y):(y.push(_),y)},[])}function x(p){const y=[];for(let _=0;_<p.length;_++){const w=p[_];switch(w.mode){case e.NUMERIC:y.push([w,{data:w.data,mode:e.ALPHANUMERIC,length:w.length},{data:w.data,mode:e.BYTE,length:w.length}]);break;case e.ALPHANUMERIC:y.push([w,{data:w.data,mode:e.BYTE,length:w.length}]);break;case e.KANJI:y.push([w,{data:w.data,mode:e.BYTE,length:c(w.data)}]);break;case e.BYTE:y.push([{data:w.data,mode:e.BYTE,length:c(w.data)}])}}return y}function v(p,y){const _={},w={start:{}};let E=["start"];for(let M=0;M<p.length;M++){const T=p[M],P=[];for(let C=0;C<T.length;C++){const b=T[C],N=""+M+C;P.push(N),_[N]={node:b,lastCount:0},w[N]={};for(let U=0;U<E.length;U++){const O=E[U];_[O]&&_[O].node.mode===b.mode?(w[O][N]=h(_[O].lastCount+b.length,b.mode)-h(_[O].lastCount,b.mode),_[O].lastCount+=b.length):(_[O]&&(_[O].lastCount=b.length),w[O][N]=h(b.length,b.mode)+4+e.getCharCountIndicator(b.mode,y))}}E=P}for(let M=0;M<E.length;M++)w[E[M]].end=0;return{map:w,table:_}}function g(p,y){let _;const w=e.getBestModeForData(p);if(_=e.from(y,w),_!==e.BYTE&&_.bit<w.bit)throw new Error('"'+p+'" cannot be encoded with mode '+e.toString(_)+`.
 Suggested mode is: `+e.toString(w));switch(_===e.KANJI&&!a.isKanjiModeEnabled()&&(_=e.BYTE),_){case e.NUMERIC:return new n(p);case e.ALPHANUMERIC:return new r(p);case e.KANJI:return new s(p);case e.BYTE:return new i(p)}}t.fromArray=function(y){return y.reduce(function(_,w){return typeof w=="string"?_.push(g(w,null)):w.data&&_.push(g(w.data,w.mode)),_},[])},t.fromString=function(y,_){const w=d(y,a.isKanjiModeEnabled()),E=x(w),M=v(E,_),T=l.find_path(M.map,"start","end"),P=[];for(let C=1;C<T.length-1;C++)P.push(M.table[T[C]].node);return t.fromArray(m(P))},t.rawSplit=function(y){return t.fromArray(d(y,a.isKanjiModeEnabled()))}})(GT);const Tf=qn,Th=Sf,Vk=Sk,Hk=Ek,Gk=UT,Wk=kT,Lm=OT,Dm=Ef,$k=Tk,Td=jT,Xk=VT,qk=xs,Mh=GT;function Yk(t,e){const n=t.size,r=Wk.getPositions(e);for(let i=0;i<r.length;i++){const s=r[i][0],o=r[i][1];for(let a=-1;a<=7;a++)if(!(s+a<=-1||n<=s+a))for(let l=-1;l<=7;l++)o+l<=-1||n<=o+l||(a>=0&&a<=6&&(l===0||l===6)||l>=0&&l<=6&&(a===0||a===6)||a>=2&&a<=4&&l>=2&&l<=4?t.set(s+a,o+l,!0,!0):t.set(s+a,o+l,!1,!0))}}function Kk(t){const e=t.size;for(let n=8;n<e-8;n++){const r=n%2===0;t.set(n,6,r,!0),t.set(6,n,r,!0)}}function Jk(t,e){const n=Gk.getPositions(e);for(let r=0;r<n.length;r++){const i=n[r][0],s=n[r][1];for(let o=-2;o<=2;o++)for(let a=-2;a<=2;a++)o===-2||o===2||a===-2||a===2||o===0&&a===0?t.set(i+o,s+a,!0,!0):t.set(i+o,s+a,!1,!0)}}function Zk(t,e){const n=t.size,r=Td.getEncodedBits(e);let i,s,o;for(let a=0;a<18;a++)i=Math.floor(a/3),s=a%3+n-8-3,o=(r>>a&1)===1,t.set(i,s,o,!0),t.set(s,i,o,!0)}function Ch(t,e,n){const r=t.size,i=Xk.getEncodedBits(e,n);let s,o;for(s=0;s<15;s++)o=(i>>s&1)===1,s<6?t.set(s,8,o,!0):s<8?t.set(s+1,8,o,!0):t.set(r-15+s,8,o,!0),s<8?t.set(8,r-s-1,o,!0):s<9?t.set(8,15-s-1+1,o,!0):t.set(8,15-s-1,o,!0);t.set(r-8,8,1,!0)}function Qk(t,e){const n=t.size;let r=-1,i=n-1,s=7,o=0;for(let a=n-1;a>0;a-=2)for(a===6&&a--;;){for(let l=0;l<2;l++)if(!t.isReserved(i,a-l)){let c=!1;o<e.length&&(c=(e[o]>>>s&1)===1),t.set(i,a-l,c),s--,s===-1&&(o++,s=7)}if(i+=r,i<0||n<=i){i-=r,r=-r;break}}}function eO(t,e,n){const r=new Vk;n.forEach(function(l){r.put(l.mode.bit,4),r.put(l.getLength(),qk.getCharCountIndicator(l.mode,t)),l.write(r)});const i=Tf.getSymbolTotalCodewords(t),s=Dm.getTotalCodewordsCount(t,e),o=(i-s)*8;for(r.getLengthInBits()+4<=o&&r.put(0,4);r.getLengthInBits()%8!==0;)r.putBit(0);const a=(o-r.getLengthInBits())/8;for(let l=0;l<a;l++)r.put(l%2?17:236,8);return tO(r,t,e)}function tO(t,e,n){const r=Tf.getSymbolTotalCodewords(e),i=Dm.getTotalCodewordsCount(e,n),s=r-i,o=Dm.getBlocksCount(e,n),a=r%o,l=o-a,c=Math.floor(r/o),u=Math.floor(s/o),d=u+1,h=c-u,m=new $k(h);let x=0;const v=new Array(o),g=new Array(o);let p=0;const y=new Uint8Array(t.buffer);for(let T=0;T<o;T++){const P=T<l?u:d;v[T]=y.slice(x,x+P),g[T]=m.encode(v[T]),x+=P,p=Math.max(p,P)}const _=new Uint8Array(r);let w=0,E,M;for(E=0;E<p;E++)for(M=0;M<o;M++)E<v[M].length&&(_[w++]=v[M][E]);for(E=0;E<h;E++)for(M=0;M<o;M++)_[w++]=g[M][E];return _}function nO(t,e,n,r){let i;if(Array.isArray(t))i=Mh.fromArray(t);else if(typeof t=="string"){let c=e;if(!c){const u=Mh.rawSplit(t);c=Td.getBestVersionForData(u,n)}i=Mh.fromString(t,c||40)}else throw new Error("Invalid data");const s=Td.getBestVersionForData(i,n);if(!s)throw new Error("The amount of data is too big to be stored in a QR Code");if(!e)e=s;else if(e<s)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+s+`.
`);const o=eO(e,n,i),a=Tf.getSymbolSize(e),l=new Hk(a);return Yk(l,e),Kk(l),Jk(l,e),Ch(l,n,0),e>=7&&Zk(l,e),Qk(l,o),isNaN(r)&&(r=Lm.getBestMask(l,Ch.bind(null,l,n))),Lm.applyMask(r,l),Ch(l,n,r),{modules:l,version:e,errorCorrectionLevel:n,maskPattern:r,segments:i}}LT.create=function(e,n){if(typeof e>"u"||e==="")throw new Error("No input text");let r=Th.M,i,s;return typeof n<"u"&&(r=Th.from(n.errorCorrectionLevel,Th.M),i=Td.from(n.version),s=Lm.from(n.maskPattern),n.toSJISFunc&&Tf.setToSJISFunction(n.toSJISFunc)),nO(e,i,r,s)};var $T={},i0={};(function(t){function e(n){if(typeof n=="number"&&(n=n.toString()),typeof n!="string")throw new Error("Color should be defined as hex string");let r=n.slice().replace("#","").split("");if(r.length<3||r.length===5||r.length>8)throw new Error("Invalid hex color: "+n);(r.length===3||r.length===4)&&(r=Array.prototype.concat.apply([],r.map(function(s){return[s,s]}))),r.length===6&&r.push("F","F");const i=parseInt(r.join(""),16);return{r:i>>24&255,g:i>>16&255,b:i>>8&255,a:i&255,hex:"#"+r.slice(0,6).join("")}}t.getOptions=function(r){r||(r={}),r.color||(r.color={});const i=typeof r.margin>"u"||r.margin===null||r.margin<0?4:r.margin,s=r.width&&r.width>=21?r.width:void 0,o=r.scale||4;return{width:s,scale:s?4:o,margin:i,color:{dark:e(r.color.dark||"#000000ff"),light:e(r.color.light||"#ffffffff")},type:r.type,rendererOpts:r.rendererOpts||{}}},t.getScale=function(r,i){return i.width&&i.width>=r+i.margin*2?i.width/(r+i.margin*2):i.scale},t.getImageWidth=function(r,i){const s=t.getScale(r,i);return Math.floor((r+i.margin*2)*s)},t.qrToImageData=function(r,i,s){const o=i.modules.size,a=i.modules.data,l=t.getScale(o,s),c=Math.floor((o+s.margin*2)*l),u=s.margin*l,d=[s.color.light,s.color.dark];for(let h=0;h<c;h++)for(let m=0;m<c;m++){let x=(h*c+m)*4,v=s.color.light;if(h>=u&&m>=u&&h<c-u&&m<c-u){const g=Math.floor((h-u)/l),p=Math.floor((m-u)/l);v=d[a[g*o+p]?1:0]}r[x++]=v.r,r[x++]=v.g,r[x++]=v.b,r[x]=v.a}}})(i0);(function(t){const e=i0;function n(i,s,o){i.clearRect(0,0,s.width,s.height),s.style||(s.style={}),s.height=o,s.width=o,s.style.height=o+"px",s.style.width=o+"px"}function r(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}t.render=function(s,o,a){let l=a,c=o;typeof l>"u"&&(!o||!o.getContext)&&(l=o,o=void 0),o||(c=r()),l=e.getOptions(l);const u=e.getImageWidth(s.modules.size,l),d=c.getContext("2d"),h=d.createImageData(u,u);return e.qrToImageData(h.data,s,l),n(d,c,u),d.putImageData(h,0,0),c},t.renderToDataURL=function(s,o,a){let l=a;typeof l>"u"&&(!o||!o.getContext)&&(l=o,o=void 0),l||(l={});const c=t.render(s,o,l),u=l.type||"image/png",d=l.rendererOpts||{};return c.toDataURL(u,d.quality)}})($T);var XT={};const rO=i0;function Ky(t,e){const n=t.a/255,r=e+'="'+t.hex+'"';return n<1?r+" "+e+'-opacity="'+n.toFixed(2).slice(1)+'"':r}function Ah(t,e,n){let r=t+e;return typeof n<"u"&&(r+=" "+n),r}function iO(t,e,n){let r="",i=0,s=!1,o=0;for(let a=0;a<t.length;a++){const l=Math.floor(a%e),c=Math.floor(a/e);!l&&!s&&(s=!0),t[a]?(o++,a>0&&l>0&&t[a-1]||(r+=s?Ah("M",l+n,.5+c+n):Ah("m",i,0),i=0,s=!1),l+1<e&&t[a+1]||(r+=Ah("h",o),o=0)):i++}return r}XT.render=function(e,n,r){const i=rO.getOptions(n),s=e.modules.size,o=e.modules.data,a=s+i.margin*2,l=i.color.light.a?"<path "+Ky(i.color.light,"fill")+' d="M0 0h'+a+"v"+a+'H0z"/>':"",c="<path "+Ky(i.color.dark,"stroke")+' d="'+iO(o,s,i.margin)+'"/>',u='viewBox="0 0 '+a+" "+a+'"',h='<svg xmlns="http://www.w3.org/2000/svg" '+(i.width?'width="'+i.width+'" height="'+i.width+'" ':"")+u+' shape-rendering="crispEdges">'+l+c+`</svg>
`;return typeof r=="function"&&r(null,h),h};const sO=_k,Um=LT,qT=$T,oO=XT;function s0(t,e,n,r,i){const s=[].slice.call(arguments,1),o=s.length,a=typeof s[o-1]=="function";if(!a&&!sO())throw new Error("Callback required as last argument");if(a){if(o<2)throw new Error("Too few arguments provided");o===2?(i=n,n=e,e=r=void 0):o===3&&(e.getContext&&typeof i>"u"?(i=r,r=void 0):(i=r,r=n,n=e,e=void 0))}else{if(o<1)throw new Error("Too few arguments provided");return o===1?(n=e,e=r=void 0):o===2&&!e.getContext&&(r=n,n=e,e=void 0),new Promise(function(l,c){try{const u=Um.create(n,r);l(t(u,e,r))}catch(u){c(u)}})}try{const l=Um.create(n,r);i(null,t(l,e,r))}catch(l){i(l)}}Ys.create=Um.create;Ys.toCanvas=s0.bind(null,qT.render);Ys.toDataURL=s0.bind(null,qT.renderToDataURL);Ys.toString=s0.bind(null,function(t,e,n){return oO.render(t,n)});const aO=()=>{const[t]=QR(),e=hs(),[n,r]=S.useState(!0),[i,s]=S.useState(!1),[o,a]=S.useState(""),[l,c]=S.useState(null),[u,d]=S.useState(""),[h,m]=S.useState(!1),x=t.get("session_id");return S.useEffect(()=>{if(!x){a("No session ID found"),r(!1);return}const v=async()=>{try{console.log("Processing payment for session:",x);const{data:g,error:p}=await jt.functions.invoke("get-uploads",{body:{}});if(p)console.error("Error fetching uploads:",p);else{const E=(g.uploads||[]).find(M=>M.stripe_session_id===x);if(E){console.log("Upload already exists:",E),c(E);const M=`${window.location.origin}/post/${E.id}`,T=await Ys.toDataURL(M);d(T),localStorage.setItem("refreshGallery","true");return}}console.log("No existing upload found, processing payment...");const{data:y,error:_}=await jt.functions.invoke("process-payment",{body:{session_id:x}});if(_){console.error("Error processing payment:",_),console.error("Process error details:",JSON.stringify(_,null,2)),a(`Failed to process payment: ${_.message||"Unknown error"}`);return}if(console.log("Payment processed successfully:",y),y.upload){console.log("Upload data received:",y.upload),c(y.upload);const w=`${window.location.origin}/post/${y.upload.id}`,E=await Ys.toDataURL(w);d(E),localStorage.setItem("refreshGallery","true")}else if(y.upload_id){console.log("Upload already processed, fetching data for ID:",y.upload_id);const{data:w,error:E}=await jt.functions.invoke("get-uploads",{body:{}});if(E){console.error("Error fetching existing upload:",E),a("Failed to fetch upload data. Please contact support if this persists.");return}const T=(w.uploads||[]).find(P=>P.id===y.upload_id);if(T){console.log("Found existing upload:",T),c(T);const P=`${window.location.origin}/post/${T.id}`,C=await Ys.toDataURL(P);d(C),localStorage.setItem("refreshGallery","true")}else console.error("Could not find existing upload with ID:",y.upload_id),a("Upload not found. Please contact support if this persists.")}else console.error("No upload data returned from process-payment:",y),a("Upload not found. Please contact support if this persists.")}catch(g){console.error("Error processing payment or fetching upload data:",g),console.error("Error details:",JSON.stringify(g,null,2)),a(`Failed to process payment: ${g instanceof Error?g.message:"Unknown error"}`)}};setTimeout(async()=>{await v(),r(!1),s(!0),Ft.success("You're part of the experiment! Payment successful.")},2e3)},[x]),n?f.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:f.jsx(_t,{className:"glass-card max-w-md w-full experiment-glow",children:f.jsxs(Lt,{className:"p-8 text-center",children:[f.jsx(M1,{className:"w-12 h-12 mx-auto mb-4 animate-spin text-primary"}),f.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Processing your contribution..."}),f.jsx("p",{className:"text-muted-foreground",children:"Adding your upload to the experiment. The price is climbing!"})]})})}):o?f.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:f.jsx(_t,{className:"glass-card max-w-md w-full",children:f.jsxs(Lt,{className:"p-8 text-center",children:[f.jsx(l2,{className:"w-12 h-12 mx-auto mb-4 text-destructive"}),f.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Something went wrong"}),f.jsx("p",{className:"text-muted-foreground mb-6",children:o}),f.jsxs(Ze,{onClick:()=>e("/"),className:"w-full",children:[f.jsx(Wx,{className:"w-4 h-4 mr-2"}),"Back to Experiment"]})]})})}):f.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:f.jsxs(_t,{className:"glass-card max-w-lg w-full experiment-glow",children:[f.jsxs(_r,{className:"text-center",children:[f.jsx(b1,{className:"w-16 h-16 text-green-500 mx-auto mb-4 experiment-glow"}),f.jsx(wr,{className:"text-xl sm:text-2xl font-bold gradient-text",children:"You're Part of the Experiment!"})]}),f.jsxs(Lt,{className:"space-y-6",children:[f.jsxs("div",{className:"text-center space-y-4",children:[l&&f.jsxs("div",{className:"glass-card p-4 space-y-3",children:[f.jsx("img",{src:l.image_url,alt:l.caption,className:"w-full max-w-sm mx-auto rounded-lg"}),f.jsxs("div",{children:[f.jsxs("h3",{className:"font-semibold",children:['"',l.caption,'"']}),f.jsxs("p",{className:"text-sm text-muted-foreground",children:["Price paid: $",(l.price_paid/100).toFixed(2)]})]})]}),l&&u&&f.jsxs("div",{className:"glass-card p-4 space-y-3",children:[f.jsx("h3",{className:"font-semibold",children:"Share Your Post"}),f.jsx("img",{src:u,alt:"QR Code",className:"w-32 h-32 mx-auto"}),f.jsx(Ze,{variant:"outline",onClick:()=>{const g=`Check out my post on PixPeriment! ${`${window.location.origin}/post/${l.id}`}`;navigator.clipboard.writeText(g),m(!0),Ft.success("Link copied to clipboard!"),setTimeout(()=>m(!1),2e3)},className:"w-full",children:h?f.jsxs(f.Fragment,{children:[f.jsx(wv,{className:"w-4 h-4 mr-2"}),"Copied!"]}):f.jsxs(f.Fragment,{children:[f.jsx(ra,{className:"w-4 h-4 mr-2"}),"Copy Share Link"]})})]}),f.jsx("div",{className:"bg-blue-50 dark:bg-blue-950/20 p-3 rounded-lg",children:f.jsxs("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:["🧠 ",f.jsx("strong",{children:"Experiment continues!"})," The next person will pay 1¢ more."]})})]}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs(Ze,{onClick:()=>e("/"),className:"w-full experiment-glow",children:[f.jsx(Wx,{className:"w-4 h-4 mr-2"}),"Watch the Experiment Continue"]}),f.jsxs(Ze,{variant:"outline",onClick:()=>e("/history"),className:"w-full",children:[f.jsx(p2,{className:"w-4 h-4 mr-2"}),"View Gallery"]})]})]})]})})},lO=()=>{const t=qd();return S.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",t.pathname)},[t.pathname]),f.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:f.jsxs("div",{className:"text-center",children:[f.jsx("h1",{className:"text-4xl font-bold mb-4",children:"404"}),f.jsx("p",{className:"text-xl text-gray-600 mb-4",children:"Oops! Page not found"}),f.jsx("a",{href:"/",className:"text-blue-500 hover:text-blue-700 underline",children:"Return to Home"})]})})};/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const Mf="179",cO=0,Jy=1,uO=2,YT=1,dO=2,ei=3,gi=0,nn=1,Bn=2,zr=0,aa=1,Zy=2,Qy=3,e_=4,fO=5,Bs=100,hO=101,pO=102,mO=103,gO=104,vO=200,xO=201,yO=202,_O=203,km=204,Om=205,wO=206,SO=207,EO=208,bO=209,TO=210,MO=211,CO=212,AO=213,RO=214,Fm=0,Bm=1,jm=2,Ta=3,zm=4,Vm=5,Hm=6,Gm=7,KT=0,PO=1,NO=2,Qi=0,IO=1,LO=2,DO=3,UO=4,kO=5,OO=6,FO=7,JT=300,Ma=301,Ca=302,Wm=303,$m=304,Cf=306,Xm=1e3,Gs=1001,qm=1002,Mr=1003,BO=1004,Yc=1005,mn=1006,Rh=1007,Ws=1008,Wn=1009,ZT=1010,QT=1011,Zl=1012,o0=1013,ls=1014,oi=1015,fc=1016,a0=1017,l0=1018,Aa=1020,eM=35902,tM=1021,nM=1022,Sr=1023,Ql=1026,Ra=1027,rM=1028,c0=1029,iM=1030,u0=1031,d0=1033,Uu=33776,ku=33777,Ou=33778,Fu=33779,Ym=35840,Km=35841,Jm=35842,Zm=35843,Qm=36196,eg=37492,tg=37496,ng=37808,rg=37809,ig=37810,sg=37811,og=37812,ag=37813,lg=37814,cg=37815,ug=37816,dg=37817,fg=37818,hg=37819,pg=37820,mg=37821,Bu=36492,gg=36494,vg=36495,sM=36283,xg=36284,yg=36285,_g=36286,hc=3200,jO=3201,zO=0,VO=1,Or="",zt="srgb",cs="srgb-linear",Md="linear",xt="srgb",So=7680,t_=519,HO=512,GO=513,WO=514,oM=515,$O=516,XO=517,qO=518,YO=519,n_=35044,wg="300 es",Fr=2e3,Cd=2001;class ys{addEventListener(e,n){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(n)===-1&&r[e].push(n)}hasEventListener(e,n){const r=this._listeners;return r===void 0?!1:r[e]!==void 0&&r[e].indexOf(n)!==-1}removeEventListener(e,n){const r=this._listeners;if(r===void 0)return;const i=r[e];if(i!==void 0){const s=i.indexOf(n);s!==-1&&i.splice(s,1)}}dispatchEvent(e){const n=this._listeners;if(n===void 0)return;const r=n[e.type];if(r!==void 0){e.target=this;const i=r.slice(0);for(let s=0,o=i.length;s<o;s++)i[s].call(this,e);e.target=null}}}const dn=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],Ph=Math.PI/180,Sg=180/Math.PI;function pc(){const t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(dn[t&255]+dn[t>>8&255]+dn[t>>16&255]+dn[t>>24&255]+"-"+dn[e&255]+dn[e>>8&255]+"-"+dn[e>>16&15|64]+dn[e>>24&255]+"-"+dn[n&63|128]+dn[n>>8&255]+"-"+dn[n>>16&255]+dn[n>>24&255]+dn[r&255]+dn[r>>8&255]+dn[r>>16&255]+dn[r>>24&255]).toLowerCase()}function at(t,e,n){return Math.max(e,Math.min(n,t))}function KO(t,e){return(t%e+e)%e}function Nh(t,e,n){return(1-n)*t+n*e}function nl(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return t/4294967295;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int32Array:return Math.max(t/2147483647,-1);case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function Mn(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return Math.round(t*4294967295);case Uint16Array:return Math.round(t*65535);case Uint8Array:return Math.round(t*255);case Int32Array:return Math.round(t*2147483647);case Int16Array:return Math.round(t*32767);case Int8Array:return Math.round(t*127);default:throw new Error("Invalid component type.")}}class Qe{constructor(e=0,n=0){Qe.prototype.isVector2=!0,this.x=e,this.y=n}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,n){return this.x=e,this.y=n,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const n=this.x,r=this.y,i=e.elements;return this.x=i[0]*n+i[3]*r+i[6],this.y=i[1]*n+i[4]*r+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,n){return this.x=at(this.x,e.x,n.x),this.y=at(this.y,e.y,n.y),this}clampScalar(e,n){return this.x=at(this.x,e,n),this.y=at(this.y,e,n),this}clampLength(e,n){const r=this.length();return this.divideScalar(r||1).multiplyScalar(at(r,e,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const r=this.dot(e)/n;return Math.acos(at(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,r=this.y-e.y;return n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this}lerpVectors(e,n,r){return this.x=e.x+(n.x-e.x)*r,this.y=e.y+(n.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this}rotateAround(e,n){const r=Math.cos(n),i=Math.sin(n),s=this.x-e.x,o=this.y-e.y;return this.x=s*r-o*i+e.x,this.y=s*i+o*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class mc{constructor(e=0,n=0,r=0,i=1){this.isQuaternion=!0,this._x=e,this._y=n,this._z=r,this._w=i}static slerpFlat(e,n,r,i,s,o,a){let l=r[i+0],c=r[i+1],u=r[i+2],d=r[i+3];const h=s[o+0],m=s[o+1],x=s[o+2],v=s[o+3];if(a===0){e[n+0]=l,e[n+1]=c,e[n+2]=u,e[n+3]=d;return}if(a===1){e[n+0]=h,e[n+1]=m,e[n+2]=x,e[n+3]=v;return}if(d!==v||l!==h||c!==m||u!==x){let g=1-a;const p=l*h+c*m+u*x+d*v,y=p>=0?1:-1,_=1-p*p;if(_>Number.EPSILON){const E=Math.sqrt(_),M=Math.atan2(E,p*y);g=Math.sin(g*M)/E,a=Math.sin(a*M)/E}const w=a*y;if(l=l*g+h*w,c=c*g+m*w,u=u*g+x*w,d=d*g+v*w,g===1-a){const E=1/Math.sqrt(l*l+c*c+u*u+d*d);l*=E,c*=E,u*=E,d*=E}}e[n]=l,e[n+1]=c,e[n+2]=u,e[n+3]=d}static multiplyQuaternionsFlat(e,n,r,i,s,o){const a=r[i],l=r[i+1],c=r[i+2],u=r[i+3],d=s[o],h=s[o+1],m=s[o+2],x=s[o+3];return e[n]=a*x+u*d+l*m-c*h,e[n+1]=l*x+u*h+c*d-a*m,e[n+2]=c*x+u*m+a*h-l*d,e[n+3]=u*x-a*d-l*h-c*m,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,n,r,i){return this._x=e,this._y=n,this._z=r,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,n=!0){const r=e._x,i=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,c=a(r/2),u=a(i/2),d=a(s/2),h=l(r/2),m=l(i/2),x=l(s/2);switch(o){case"XYZ":this._x=h*u*d+c*m*x,this._y=c*m*d-h*u*x,this._z=c*u*x+h*m*d,this._w=c*u*d-h*m*x;break;case"YXZ":this._x=h*u*d+c*m*x,this._y=c*m*d-h*u*x,this._z=c*u*x-h*m*d,this._w=c*u*d+h*m*x;break;case"ZXY":this._x=h*u*d-c*m*x,this._y=c*m*d+h*u*x,this._z=c*u*x+h*m*d,this._w=c*u*d-h*m*x;break;case"ZYX":this._x=h*u*d-c*m*x,this._y=c*m*d+h*u*x,this._z=c*u*x-h*m*d,this._w=c*u*d+h*m*x;break;case"YZX":this._x=h*u*d+c*m*x,this._y=c*m*d+h*u*x,this._z=c*u*x-h*m*d,this._w=c*u*d-h*m*x;break;case"XZY":this._x=h*u*d-c*m*x,this._y=c*m*d-h*u*x,this._z=c*u*x+h*m*d,this._w=c*u*d+h*m*x;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return n===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,n){const r=n/2,i=Math.sin(r);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){const n=e.elements,r=n[0],i=n[4],s=n[8],o=n[1],a=n[5],l=n[9],c=n[2],u=n[6],d=n[10],h=r+a+d;if(h>0){const m=.5/Math.sqrt(h+1);this._w=.25/m,this._x=(u-l)*m,this._y=(s-c)*m,this._z=(o-i)*m}else if(r>a&&r>d){const m=2*Math.sqrt(1+r-a-d);this._w=(u-l)/m,this._x=.25*m,this._y=(i+o)/m,this._z=(s+c)/m}else if(a>d){const m=2*Math.sqrt(1+a-r-d);this._w=(s-c)/m,this._x=(i+o)/m,this._y=.25*m,this._z=(l+u)/m}else{const m=2*Math.sqrt(1+d-r-a);this._w=(o-i)/m,this._x=(s+c)/m,this._y=(l+u)/m,this._z=.25*m}return this._onChangeCallback(),this}setFromUnitVectors(e,n){let r=e.dot(n)+1;return r<1e-8?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*n.z-e.z*n.y,this._y=e.z*n.x-e.x*n.z,this._z=e.x*n.y-e.y*n.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(at(this.dot(e),-1,1)))}rotateTowards(e,n){const r=this.angleTo(e);if(r===0)return this;const i=Math.min(1,n/r);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,n){const r=e._x,i=e._y,s=e._z,o=e._w,a=n._x,l=n._y,c=n._z,u=n._w;return this._x=r*u+o*a+i*c-s*l,this._y=i*u+o*l+s*a-r*c,this._z=s*u+o*c+r*l-i*a,this._w=o*u-r*a-i*l-s*c,this._onChangeCallback(),this}slerp(e,n){if(n===0)return this;if(n===1)return this.copy(e);const r=this._x,i=this._y,s=this._z,o=this._w;let a=o*e._w+r*e._x+i*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=r,this._y=i,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const m=1-n;return this._w=m*o+n*this._w,this._x=m*r+n*this._x,this._y=m*i+n*this._y,this._z=m*s+n*this._z,this.normalize(),this}const c=Math.sqrt(l),u=Math.atan2(c,a),d=Math.sin((1-n)*u)/c,h=Math.sin(n*u)/c;return this._w=o*d+this._w*h,this._x=r*d+this._x*h,this._y=i*d+this._y*h,this._z=s*d+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,n,r){return this.copy(e).slerp(n,r)}random(){const e=2*Math.PI*Math.random(),n=2*Math.PI*Math.random(),r=Math.random(),i=Math.sqrt(1-r),s=Math.sqrt(r);return this.set(i*Math.sin(e),i*Math.cos(e),s*Math.sin(n),s*Math.cos(n))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,n=0){return this._x=e[n],this._y=e[n+1],this._z=e[n+2],this._w=e[n+3],this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._w,e}fromBufferAttribute(e,n){return this._x=e.getX(n),this._y=e.getY(n),this._z=e.getZ(n),this._w=e.getW(n),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Z{constructor(e=0,n=0,r=0){Z.prototype.isVector3=!0,this.x=e,this.y=n,this.z=r}set(e,n,r){return r===void 0&&(r=this.z),this.x=e,this.y=n,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,n){return this.x=e.x*n.x,this.y=e.y*n.y,this.z=e.z*n.z,this}applyEuler(e){return this.applyQuaternion(r_.setFromEuler(e))}applyAxisAngle(e,n){return this.applyQuaternion(r_.setFromAxisAngle(e,n))}applyMatrix3(e){const n=this.x,r=this.y,i=this.z,s=e.elements;return this.x=s[0]*n+s[3]*r+s[6]*i,this.y=s[1]*n+s[4]*r+s[7]*i,this.z=s[2]*n+s[5]*r+s[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const n=this.x,r=this.y,i=this.z,s=e.elements,o=1/(s[3]*n+s[7]*r+s[11]*i+s[15]);return this.x=(s[0]*n+s[4]*r+s[8]*i+s[12])*o,this.y=(s[1]*n+s[5]*r+s[9]*i+s[13])*o,this.z=(s[2]*n+s[6]*r+s[10]*i+s[14])*o,this}applyQuaternion(e){const n=this.x,r=this.y,i=this.z,s=e.x,o=e.y,a=e.z,l=e.w,c=2*(o*i-a*r),u=2*(a*n-s*i),d=2*(s*r-o*n);return this.x=n+l*c+o*d-a*u,this.y=r+l*u+a*c-s*d,this.z=i+l*d+s*u-o*c,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const n=this.x,r=this.y,i=this.z,s=e.elements;return this.x=s[0]*n+s[4]*r+s[8]*i,this.y=s[1]*n+s[5]*r+s[9]*i,this.z=s[2]*n+s[6]*r+s[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,n){return this.x=at(this.x,e.x,n.x),this.y=at(this.y,e.y,n.y),this.z=at(this.z,e.z,n.z),this}clampScalar(e,n){return this.x=at(this.x,e,n),this.y=at(this.y,e,n),this.z=at(this.z,e,n),this}clampLength(e,n){const r=this.length();return this.divideScalar(r||1).multiplyScalar(at(r,e,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this}lerpVectors(e,n,r){return this.x=e.x+(n.x-e.x)*r,this.y=e.y+(n.y-e.y)*r,this.z=e.z+(n.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,n){const r=e.x,i=e.y,s=e.z,o=n.x,a=n.y,l=n.z;return this.x=i*l-s*a,this.y=s*o-r*l,this.z=r*a-i*o,this}projectOnVector(e){const n=e.lengthSq();if(n===0)return this.set(0,0,0);const r=e.dot(this)/n;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return Ih.copy(this).projectOnVector(e),this.sub(Ih)}reflect(e){return this.sub(Ih.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const r=this.dot(e)/n;return Math.acos(at(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,r=this.y-e.y,i=this.z-e.z;return n*n+r*r+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,n,r){const i=Math.sin(n)*e;return this.x=i*Math.sin(r),this.y=Math.cos(n)*e,this.z=i*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,n,r){return this.x=e*Math.sin(n),this.y=r,this.z=e*Math.cos(n),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this}setFromMatrixScale(e){const n=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=n,this.y=r,this.z=i,this}setFromMatrixColumn(e,n){return this.fromArray(e.elements,n*4)}setFromMatrix3Column(e,n){return this.fromArray(e.elements,n*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,n=Math.random()*2-1,r=Math.sqrt(1-n*n);return this.x=r*Math.cos(e),this.y=n,this.z=r*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Ih=new Z,r_=new mc;class Ke{constructor(e,n,r,i,s,o,a,l,c){Ke.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,n,r,i,s,o,a,l,c)}set(e,n,r,i,s,o,a,l,c){const u=this.elements;return u[0]=e,u[1]=i,u[2]=a,u[3]=n,u[4]=s,u[5]=l,u[6]=r,u[7]=o,u[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const n=this.elements,r=e.elements;return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],this}extractBasis(e,n,r){return e.setFromMatrix3Column(this,0),n.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const n=e.elements;return this.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const r=e.elements,i=n.elements,s=this.elements,o=r[0],a=r[3],l=r[6],c=r[1],u=r[4],d=r[7],h=r[2],m=r[5],x=r[8],v=i[0],g=i[3],p=i[6],y=i[1],_=i[4],w=i[7],E=i[2],M=i[5],T=i[8];return s[0]=o*v+a*y+l*E,s[3]=o*g+a*_+l*M,s[6]=o*p+a*w+l*T,s[1]=c*v+u*y+d*E,s[4]=c*g+u*_+d*M,s[7]=c*p+u*w+d*T,s[2]=h*v+m*y+x*E,s[5]=h*g+m*_+x*M,s[8]=h*p+m*w+x*T,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=e,n[4]*=e,n[7]*=e,n[2]*=e,n[5]*=e,n[8]*=e,this}determinant(){const e=this.elements,n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8];return n*o*u-n*a*c-r*s*u+r*a*l+i*s*c-i*o*l}invert(){const e=this.elements,n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],d=u*o-a*c,h=a*l-u*s,m=c*s-o*l,x=n*d+r*h+i*m;if(x===0)return this.set(0,0,0,0,0,0,0,0,0);const v=1/x;return e[0]=d*v,e[1]=(i*c-u*r)*v,e[2]=(a*r-i*o)*v,e[3]=h*v,e[4]=(u*n-i*l)*v,e[5]=(i*s-a*n)*v,e[6]=m*v,e[7]=(r*l-c*n)*v,e[8]=(o*n-r*s)*v,this}transpose(){let e;const n=this.elements;return e=n[1],n[1]=n[3],n[3]=e,e=n[2],n[2]=n[6],n[6]=e,e=n[5],n[5]=n[7],n[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const n=this.elements;return e[0]=n[0],e[1]=n[3],e[2]=n[6],e[3]=n[1],e[4]=n[4],e[5]=n[7],e[6]=n[2],e[7]=n[5],e[8]=n[8],this}setUvTransform(e,n,r,i,s,o,a){const l=Math.cos(s),c=Math.sin(s);return this.set(r*l,r*c,-r*(l*o+c*a)+o+e,-i*c,i*l,-i*(-c*o+l*a)+a+n,0,0,1),this}scale(e,n){return this.premultiply(Lh.makeScale(e,n)),this}rotate(e){return this.premultiply(Lh.makeRotation(-e)),this}translate(e,n){return this.premultiply(Lh.makeTranslation(e,n)),this}makeTranslation(e,n){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,n,0,0,1),this}makeRotation(e){const n=Math.cos(e),r=Math.sin(e);return this.set(n,-r,0,r,n,0,0,0,1),this}makeScale(e,n){return this.set(e,0,0,0,n,0,0,0,1),this}equals(e){const n=this.elements,r=e.elements;for(let i=0;i<9;i++)if(n[i]!==r[i])return!1;return!0}fromArray(e,n=0){for(let r=0;r<9;r++)this.elements[r]=e[r+n];return this}toArray(e=[],n=0){const r=this.elements;return e[n]=r[0],e[n+1]=r[1],e[n+2]=r[2],e[n+3]=r[3],e[n+4]=r[4],e[n+5]=r[5],e[n+6]=r[6],e[n+7]=r[7],e[n+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const Lh=new Ke;function aM(t){for(let e=t.length-1;e>=0;--e)if(t[e]>=65535)return!0;return!1}function Ad(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}function JO(){const t=Ad("canvas");return t.style.display="block",t}const i_={};function la(t){t in i_||(i_[t]=!0,console.warn(t))}function ZO(t,e,n){return new Promise(function(r,i){function s(){switch(t.clientWaitSync(e,t.SYNC_FLUSH_COMMANDS_BIT,0)){case t.WAIT_FAILED:i();break;case t.TIMEOUT_EXPIRED:setTimeout(s,n);break;default:r()}}setTimeout(s,n)})}const s_=new Ke().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),o_=new Ke().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function QO(){const t={enabled:!0,workingColorSpace:cs,spaces:{},convert:function(i,s,o){return this.enabled===!1||s===o||!s||!o||(this.spaces[s].transfer===xt&&(i.r=ci(i.r),i.g=ci(i.g),i.b=ci(i.b)),this.spaces[s].primaries!==this.spaces[o].primaries&&(i.applyMatrix3(this.spaces[s].toXYZ),i.applyMatrix3(this.spaces[o].fromXYZ)),this.spaces[o].transfer===xt&&(i.r=ca(i.r),i.g=ca(i.g),i.b=ca(i.b))),i},workingToColorSpace:function(i,s){return this.convert(i,this.workingColorSpace,s)},colorSpaceToWorking:function(i,s){return this.convert(i,s,this.workingColorSpace)},getPrimaries:function(i){return this.spaces[i].primaries},getTransfer:function(i){return i===Or?Md:this.spaces[i].transfer},getLuminanceCoefficients:function(i,s=this.workingColorSpace){return i.fromArray(this.spaces[s].luminanceCoefficients)},define:function(i){Object.assign(this.spaces,i)},_getMatrix:function(i,s,o){return i.copy(this.spaces[s].toXYZ).multiply(this.spaces[o].fromXYZ)},_getDrawingBufferColorSpace:function(i){return this.spaces[i].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(i=this.workingColorSpace){return this.spaces[i].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(i,s){return la("THREE.ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),t.workingToColorSpace(i,s)},toWorkingColorSpace:function(i,s){return la("THREE.ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),t.colorSpaceToWorking(i,s)}},e=[.64,.33,.3,.6,.15,.06],n=[.2126,.7152,.0722],r=[.3127,.329];return t.define({[cs]:{primaries:e,whitePoint:r,transfer:Md,toXYZ:s_,fromXYZ:o_,luminanceCoefficients:n,workingColorSpaceConfig:{unpackColorSpace:zt},outputColorSpaceConfig:{drawingBufferColorSpace:zt}},[zt]:{primaries:e,whitePoint:r,transfer:xt,toXYZ:s_,fromXYZ:o_,luminanceCoefficients:n,outputColorSpaceConfig:{drawingBufferColorSpace:zt}}}),t}const dt=QO();function ci(t){return t<.04045?t*.0773993808:Math.pow(t*.9478672986+.0521327014,2.4)}function ca(t){return t<.0031308?t*12.92:1.055*Math.pow(t,.41666)-.055}let Eo;class eF{static getDataURL(e,n="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let r;if(e instanceof HTMLCanvasElement)r=e;else{Eo===void 0&&(Eo=Ad("canvas")),Eo.width=e.width,Eo.height=e.height;const i=Eo.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),r=Eo}return r.toDataURL(n)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const n=Ad("canvas");n.width=e.width,n.height=e.height;const r=n.getContext("2d");r.drawImage(e,0,0,e.width,e.height);const i=r.getImageData(0,0,e.width,e.height),s=i.data;for(let o=0;o<s.length;o++)s[o]=ci(s[o]/255)*255;return r.putImageData(i,0,0),n}else if(e.data){const n=e.data.slice(0);for(let r=0;r<n.length;r++)n instanceof Uint8Array||n instanceof Uint8ClampedArray?n[r]=Math.floor(ci(n[r]/255)*255):n[r]=ci(n[r]);return{data:n,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let tF=0;class f0{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:tF++}),this.uuid=pc(),this.data=e,this.dataReady=!0,this.version=0}getSize(e){const n=this.data;return n instanceof HTMLVideoElement?e.set(n.videoWidth,n.videoHeight,0):n instanceof VideoFrame?e.set(n.displayHeight,n.displayWidth,0):n!==null?e.set(n.width,n.height,n.depth||0):e.set(0,0,0),e}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const r={uuid:this.uuid,url:""},i=this.data;if(i!==null){let s;if(Array.isArray(i)){s=[];for(let o=0,a=i.length;o<a;o++)i[o].isDataTexture?s.push(Dh(i[o].image)):s.push(Dh(i[o]))}else s=Dh(i);r.url=s}return n||(e.images[this.uuid]=r),r}}function Dh(t){return typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap?eF.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let nF=0;const Uh=new Z;class an extends ys{constructor(e=an.DEFAULT_IMAGE,n=an.DEFAULT_MAPPING,r=Gs,i=Gs,s=mn,o=Ws,a=Sr,l=Wn,c=an.DEFAULT_ANISOTROPY,u=Or){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:nF++}),this.uuid=pc(),this.name="",this.source=new f0(e),this.mipmaps=[],this.mapping=n,this.channel=0,this.wrapS=r,this.wrapT=i,this.magFilter=s,this.minFilter=o,this.anisotropy=c,this.format=a,this.internalFormat=null,this.type=l,this.offset=new Qe(0,0),this.repeat=new Qe(1,1),this.center=new Qe(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ke,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=u,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(e&&e.depth&&e.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(Uh).x}get height(){return this.source.getSize(Uh).y}get depth(){return this.source.getSize(Uh).z}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isArrayTexture=e.isArrayTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}setValues(e){for(const n in e){const r=e[n];if(r===void 0){console.warn(`THREE.Texture.setValues(): parameter '${n}' has value of undefined.`);continue}const i=this[n];if(i===void 0){console.warn(`THREE.Texture.setValues(): property '${n}' does not exist.`);continue}i&&r&&i.isVector2&&r.isVector2||i&&r&&i.isVector3&&r.isVector3||i&&r&&i.isMatrix3&&r.isMatrix3?i.copy(r):this[n]=r}}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const r={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),n||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==JT)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Xm:e.x=e.x-Math.floor(e.x);break;case Gs:e.x=e.x<0?0:1;break;case qm:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Xm:e.y=e.y-Math.floor(e.y);break;case Gs:e.y=e.y<0?0:1;break;case qm:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}an.DEFAULT_IMAGE=null;an.DEFAULT_MAPPING=JT;an.DEFAULT_ANISOTROPY=1;class Ht{constructor(e=0,n=0,r=0,i=1){Ht.prototype.isVector4=!0,this.x=e,this.y=n,this.z=r,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,n,r,i){return this.x=e,this.y=n,this.z=r,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this.w=e.w+n.w,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this.w+=e.w*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this.w=e.w-n.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const n=this.x,r=this.y,i=this.z,s=this.w,o=e.elements;return this.x=o[0]*n+o[4]*r+o[8]*i+o[12]*s,this.y=o[1]*n+o[5]*r+o[9]*i+o[13]*s,this.z=o[2]*n+o[6]*r+o[10]*i+o[14]*s,this.w=o[3]*n+o[7]*r+o[11]*i+o[15]*s,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const n=Math.sqrt(1-e.w*e.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/n,this.y=e.y/n,this.z=e.z/n),this}setAxisAngleFromRotationMatrix(e){let n,r,i,s;const l=e.elements,c=l[0],u=l[4],d=l[8],h=l[1],m=l[5],x=l[9],v=l[2],g=l[6],p=l[10];if(Math.abs(u-h)<.01&&Math.abs(d-v)<.01&&Math.abs(x-g)<.01){if(Math.abs(u+h)<.1&&Math.abs(d+v)<.1&&Math.abs(x+g)<.1&&Math.abs(c+m+p-3)<.1)return this.set(1,0,0,0),this;n=Math.PI;const _=(c+1)/2,w=(m+1)/2,E=(p+1)/2,M=(u+h)/4,T=(d+v)/4,P=(x+g)/4;return _>w&&_>E?_<.01?(r=0,i=.707106781,s=.707106781):(r=Math.sqrt(_),i=M/r,s=T/r):w>E?w<.01?(r=.707106781,i=0,s=.707106781):(i=Math.sqrt(w),r=M/i,s=P/i):E<.01?(r=.707106781,i=.707106781,s=0):(s=Math.sqrt(E),r=T/s,i=P/s),this.set(r,i,s,n),this}let y=Math.sqrt((g-x)*(g-x)+(d-v)*(d-v)+(h-u)*(h-u));return Math.abs(y)<.001&&(y=1),this.x=(g-x)/y,this.y=(d-v)/y,this.z=(h-u)/y,this.w=Math.acos((c+m+p-1)/2),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this.w=n[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,n){return this.x=at(this.x,e.x,n.x),this.y=at(this.y,e.y,n.y),this.z=at(this.z,e.z,n.z),this.w=at(this.w,e.w,n.w),this}clampScalar(e,n){return this.x=at(this.x,e,n),this.y=at(this.y,e,n),this.z=at(this.z,e,n),this.w=at(this.w,e,n),this}clampLength(e,n){const r=this.length();return this.divideScalar(r||1).multiplyScalar(at(r,e,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this.w+=(e.w-this.w)*n,this}lerpVectors(e,n,r){return this.x=e.x+(n.x-e.x)*r,this.y=e.y+(n.y-e.y)*r,this.z=e.z+(n.z-e.z)*r,this.w=e.w+(n.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this.w=e[n+3],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e[n+3]=this.w,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this.w=e.getW(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class rF extends ys{constructor(e=1,n=1,r={}){super(),r=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:mn,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},r),this.isRenderTarget=!0,this.width=e,this.height=n,this.depth=r.depth,this.scissor=new Ht(0,0,e,n),this.scissorTest=!1,this.viewport=new Ht(0,0,e,n);const i={width:e,height:n,depth:r.depth},s=new an(i);this.textures=[];const o=r.count;for(let a=0;a<o;a++)this.textures[a]=s.clone(),this.textures[a].isRenderTargetTexture=!0,this.textures[a].renderTarget=this;this._setTextureOptions(r),this.depthBuffer=r.depthBuffer,this.stencilBuffer=r.stencilBuffer,this.resolveDepthBuffer=r.resolveDepthBuffer,this.resolveStencilBuffer=r.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=r.depthTexture,this.samples=r.samples,this.multiview=r.multiview}_setTextureOptions(e={}){const n={minFilter:mn,generateMipmaps:!1,flipY:!1,internalFormat:null};e.mapping!==void 0&&(n.mapping=e.mapping),e.wrapS!==void 0&&(n.wrapS=e.wrapS),e.wrapT!==void 0&&(n.wrapT=e.wrapT),e.wrapR!==void 0&&(n.wrapR=e.wrapR),e.magFilter!==void 0&&(n.magFilter=e.magFilter),e.minFilter!==void 0&&(n.minFilter=e.minFilter),e.format!==void 0&&(n.format=e.format),e.type!==void 0&&(n.type=e.type),e.anisotropy!==void 0&&(n.anisotropy=e.anisotropy),e.colorSpace!==void 0&&(n.colorSpace=e.colorSpace),e.flipY!==void 0&&(n.flipY=e.flipY),e.generateMipmaps!==void 0&&(n.generateMipmaps=e.generateMipmaps),e.internalFormat!==void 0&&(n.internalFormat=e.internalFormat);for(let r=0;r<this.textures.length;r++)this.textures[r].setValues(n)}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,n,r=1){if(this.width!==e||this.height!==n||this.depth!==r){this.width=e,this.height=n,this.depth=r;for(let i=0,s=this.textures.length;i<s;i++)this.textures[i].image.width=e,this.textures[i].image.height=n,this.textures[i].image.depth=r,this.textures[i].isArrayTexture=this.textures[i].image.depth>1;this.dispose()}this.viewport.set(0,0,e,n),this.scissor.set(0,0,e,n)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let n=0,r=e.textures.length;n<r;n++){this.textures[n]=e.textures[n].clone(),this.textures[n].isRenderTargetTexture=!0,this.textures[n].renderTarget=this;const i=Object.assign({},e.textures[n].image);this.textures[n].source=new f0(i)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Pr extends rF{constructor(e=1,n=1,r={}){super(e,n,r),this.isWebGLRenderTarget=!0}}class lM extends an{constructor(e=null,n=1,r=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:n,height:r,depth:i},this.magFilter=Mr,this.minFilter=Mr,this.wrapR=Gs,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class iF extends an{constructor(e=null,n=1,r=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:n,height:r,depth:i},this.magFilter=Mr,this.minFilter=Mr,this.wrapR=Gs,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class gc{constructor(e=new Z(1/0,1/0,1/0),n=new Z(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromArray(e){this.makeEmpty();for(let n=0,r=e.length;n<r;n+=3)this.expandByPoint(cr.fromArray(e,n));return this}setFromBufferAttribute(e){this.makeEmpty();for(let n=0,r=e.count;n<r;n++)this.expandByPoint(cr.fromBufferAttribute(e,n));return this}setFromPoints(e){this.makeEmpty();for(let n=0,r=e.length;n<r;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const r=cr.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,n=!1){return this.makeEmpty(),this.expandByObject(e,n)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,n=!1){e.updateWorldMatrix(!1,!1);const r=e.geometry;if(r!==void 0){const s=r.getAttribute("position");if(n===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let o=0,a=s.count;o<a;o++)e.isMesh===!0?e.getVertexPosition(o,cr):cr.fromBufferAttribute(s,o),cr.applyMatrix4(e.matrixWorld),this.expandByPoint(cr);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),Kc.copy(e.boundingBox)):(r.boundingBox===null&&r.computeBoundingBox(),Kc.copy(r.boundingBox)),Kc.applyMatrix4(e.matrixWorld),this.union(Kc)}const i=e.children;for(let s=0,o=i.length;s<o;s++)this.expandByObject(i[s],n);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,cr),cr.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let n,r;return e.normal.x>0?(n=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(n=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(n+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(n+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(n+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(n+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),n<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(rl),Jc.subVectors(this.max,rl),bo.subVectors(e.a,rl),To.subVectors(e.b,rl),Mo.subVectors(e.c,rl),bi.subVectors(To,bo),Ti.subVectors(Mo,To),Ms.subVectors(bo,Mo);let n=[0,-bi.z,bi.y,0,-Ti.z,Ti.y,0,-Ms.z,Ms.y,bi.z,0,-bi.x,Ti.z,0,-Ti.x,Ms.z,0,-Ms.x,-bi.y,bi.x,0,-Ti.y,Ti.x,0,-Ms.y,Ms.x,0];return!kh(n,bo,To,Mo,Jc)||(n=[1,0,0,0,1,0,0,0,1],!kh(n,bo,To,Mo,Jc))?!1:(Zc.crossVectors(bi,Ti),n=[Zc.x,Zc.y,Zc.z],kh(n,bo,To,Mo,Jc))}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,cr).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(cr).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(qr[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),qr[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),qr[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),qr[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),qr[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),qr[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),qr[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),qr[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(qr),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}}const qr=[new Z,new Z,new Z,new Z,new Z,new Z,new Z,new Z],cr=new Z,Kc=new gc,bo=new Z,To=new Z,Mo=new Z,bi=new Z,Ti=new Z,Ms=new Z,rl=new Z,Jc=new Z,Zc=new Z,Cs=new Z;function kh(t,e,n,r,i){for(let s=0,o=t.length-3;s<=o;s+=3){Cs.fromArray(t,s);const a=i.x*Math.abs(Cs.x)+i.y*Math.abs(Cs.y)+i.z*Math.abs(Cs.z),l=e.dot(Cs),c=n.dot(Cs),u=r.dot(Cs);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>a)return!1}return!0}const sF=new gc,il=new Z,Oh=new Z;class h0{constructor(e=new Z,n=-1){this.isSphere=!0,this.center=e,this.radius=n}set(e,n){return this.center.copy(e),this.radius=n,this}setFromPoints(e,n){const r=this.center;n!==void 0?r.copy(n):sF.setFromPoints(e).getCenter(r);let i=0;for(let s=0,o=e.length;s<o;s++)i=Math.max(i,r.distanceToSquared(e[s]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const n=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=n*n}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,n){const r=this.center.distanceToSquared(e);return n.copy(e),r>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;il.subVectors(e,this.center);const n=il.lengthSq();if(n>this.radius*this.radius){const r=Math.sqrt(n),i=(r-this.radius)*.5;this.center.addScaledVector(il,i/r),this.radius+=i}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(Oh.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(il.copy(e.center).add(Oh)),this.expandByPoint(il.copy(e.center).sub(Oh))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(e){return this.radius=e.radius,this.center.fromArray(e.center),this}}const Yr=new Z,Fh=new Z,Qc=new Z,Mi=new Z,Bh=new Z,eu=new Z,jh=new Z;class oF{constructor(e=new Z,n=new Z(0,0,-1)){this.origin=e,this.direction=n}set(e,n){return this.origin.copy(e),this.direction.copy(n),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,n){return n.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Yr)),this}closestPointToPoint(e,n){n.subVectors(e,this.origin);const r=n.dot(this.direction);return r<0?n.copy(this.origin):n.copy(this.origin).addScaledVector(this.direction,r)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const n=Yr.subVectors(e,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(e):(Yr.copy(this.origin).addScaledVector(this.direction,n),Yr.distanceToSquared(e))}distanceSqToSegment(e,n,r,i){Fh.copy(e).add(n).multiplyScalar(.5),Qc.copy(n).sub(e).normalize(),Mi.copy(this.origin).sub(Fh);const s=e.distanceTo(n)*.5,o=-this.direction.dot(Qc),a=Mi.dot(this.direction),l=-Mi.dot(Qc),c=Mi.lengthSq(),u=Math.abs(1-o*o);let d,h,m,x;if(u>0)if(d=o*l-a,h=o*a-l,x=s*u,d>=0)if(h>=-x)if(h<=x){const v=1/u;d*=v,h*=v,m=d*(d+o*h+2*a)+h*(o*d+h+2*l)+c}else h=s,d=Math.max(0,-(o*h+a)),m=-d*d+h*(h+2*l)+c;else h=-s,d=Math.max(0,-(o*h+a)),m=-d*d+h*(h+2*l)+c;else h<=-x?(d=Math.max(0,-(-o*s+a)),h=d>0?-s:Math.min(Math.max(-s,-l),s),m=-d*d+h*(h+2*l)+c):h<=x?(d=0,h=Math.min(Math.max(-s,-l),s),m=h*(h+2*l)+c):(d=Math.max(0,-(o*s+a)),h=d>0?s:Math.min(Math.max(-s,-l),s),m=-d*d+h*(h+2*l)+c);else h=o>0?-s:s,d=Math.max(0,-(o*h+a)),m=-d*d+h*(h+2*l)+c;return r&&r.copy(this.origin).addScaledVector(this.direction,d),i&&i.copy(Fh).addScaledVector(Qc,h),m}intersectSphere(e,n){Yr.subVectors(e.center,this.origin);const r=Yr.dot(this.direction),i=Yr.dot(Yr)-r*r,s=e.radius*e.radius;if(i>s)return null;const o=Math.sqrt(s-i),a=r-o,l=r+o;return l<0?null:a<0?this.at(l,n):this.at(a,n)}intersectsSphere(e){return e.radius<0?!1:this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const n=e.normal.dot(this.direction);if(n===0)return e.distanceToPoint(this.origin)===0?0:null;const r=-(this.origin.dot(e.normal)+e.constant)/n;return r>=0?r:null}intersectPlane(e,n){const r=this.distanceToPlane(e);return r===null?null:this.at(r,n)}intersectsPlane(e){const n=e.distanceToPoint(this.origin);return n===0||e.normal.dot(this.direction)*n<0}intersectBox(e,n){let r,i,s,o,a,l;const c=1/this.direction.x,u=1/this.direction.y,d=1/this.direction.z,h=this.origin;return c>=0?(r=(e.min.x-h.x)*c,i=(e.max.x-h.x)*c):(r=(e.max.x-h.x)*c,i=(e.min.x-h.x)*c),u>=0?(s=(e.min.y-h.y)*u,o=(e.max.y-h.y)*u):(s=(e.max.y-h.y)*u,o=(e.min.y-h.y)*u),r>o||s>i||((s>r||isNaN(r))&&(r=s),(o<i||isNaN(i))&&(i=o),d>=0?(a=(e.min.z-h.z)*d,l=(e.max.z-h.z)*d):(a=(e.max.z-h.z)*d,l=(e.min.z-h.z)*d),r>l||a>i)||((a>r||r!==r)&&(r=a),(l<i||i!==i)&&(i=l),i<0)?null:this.at(r>=0?r:i,n)}intersectsBox(e){return this.intersectBox(e,Yr)!==null}intersectTriangle(e,n,r,i,s){Bh.subVectors(n,e),eu.subVectors(r,e),jh.crossVectors(Bh,eu);let o=this.direction.dot(jh),a;if(o>0){if(i)return null;a=1}else if(o<0)a=-1,o=-o;else return null;Mi.subVectors(this.origin,e);const l=a*this.direction.dot(eu.crossVectors(Mi,eu));if(l<0)return null;const c=a*this.direction.dot(Bh.cross(Mi));if(c<0||l+c>o)return null;const u=-a*Mi.dot(jh);return u<0?null:this.at(u/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Kt{constructor(e,n,r,i,s,o,a,l,c,u,d,h,m,x,v,g){Kt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,n,r,i,s,o,a,l,c,u,d,h,m,x,v,g)}set(e,n,r,i,s,o,a,l,c,u,d,h,m,x,v,g){const p=this.elements;return p[0]=e,p[4]=n,p[8]=r,p[12]=i,p[1]=s,p[5]=o,p[9]=a,p[13]=l,p[2]=c,p[6]=u,p[10]=d,p[14]=h,p[3]=m,p[7]=x,p[11]=v,p[15]=g,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Kt().fromArray(this.elements)}copy(e){const n=this.elements,r=e.elements;return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],n[9]=r[9],n[10]=r[10],n[11]=r[11],n[12]=r[12],n[13]=r[13],n[14]=r[14],n[15]=r[15],this}copyPosition(e){const n=this.elements,r=e.elements;return n[12]=r[12],n[13]=r[13],n[14]=r[14],this}setFromMatrix3(e){const n=e.elements;return this.set(n[0],n[3],n[6],0,n[1],n[4],n[7],0,n[2],n[5],n[8],0,0,0,0,1),this}extractBasis(e,n,r){return e.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,n,r){return this.set(e.x,n.x,r.x,0,e.y,n.y,r.y,0,e.z,n.z,r.z,0,0,0,0,1),this}extractRotation(e){const n=this.elements,r=e.elements,i=1/Co.setFromMatrixColumn(e,0).length(),s=1/Co.setFromMatrixColumn(e,1).length(),o=1/Co.setFromMatrixColumn(e,2).length();return n[0]=r[0]*i,n[1]=r[1]*i,n[2]=r[2]*i,n[3]=0,n[4]=r[4]*s,n[5]=r[5]*s,n[6]=r[6]*s,n[7]=0,n[8]=r[8]*o,n[9]=r[9]*o,n[10]=r[10]*o,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromEuler(e){const n=this.elements,r=e.x,i=e.y,s=e.z,o=Math.cos(r),a=Math.sin(r),l=Math.cos(i),c=Math.sin(i),u=Math.cos(s),d=Math.sin(s);if(e.order==="XYZ"){const h=o*u,m=o*d,x=a*u,v=a*d;n[0]=l*u,n[4]=-l*d,n[8]=c,n[1]=m+x*c,n[5]=h-v*c,n[9]=-a*l,n[2]=v-h*c,n[6]=x+m*c,n[10]=o*l}else if(e.order==="YXZ"){const h=l*u,m=l*d,x=c*u,v=c*d;n[0]=h+v*a,n[4]=x*a-m,n[8]=o*c,n[1]=o*d,n[5]=o*u,n[9]=-a,n[2]=m*a-x,n[6]=v+h*a,n[10]=o*l}else if(e.order==="ZXY"){const h=l*u,m=l*d,x=c*u,v=c*d;n[0]=h-v*a,n[4]=-o*d,n[8]=x+m*a,n[1]=m+x*a,n[5]=o*u,n[9]=v-h*a,n[2]=-o*c,n[6]=a,n[10]=o*l}else if(e.order==="ZYX"){const h=o*u,m=o*d,x=a*u,v=a*d;n[0]=l*u,n[4]=x*c-m,n[8]=h*c+v,n[1]=l*d,n[5]=v*c+h,n[9]=m*c-x,n[2]=-c,n[6]=a*l,n[10]=o*l}else if(e.order==="YZX"){const h=o*l,m=o*c,x=a*l,v=a*c;n[0]=l*u,n[4]=v-h*d,n[8]=x*d+m,n[1]=d,n[5]=o*u,n[9]=-a*u,n[2]=-c*u,n[6]=m*d+x,n[10]=h-v*d}else if(e.order==="XZY"){const h=o*l,m=o*c,x=a*l,v=a*c;n[0]=l*u,n[4]=-d,n[8]=c*u,n[1]=h*d+v,n[5]=o*u,n[9]=m*d-x,n[2]=x*d-m,n[6]=a*u,n[10]=v*d+h}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromQuaternion(e){return this.compose(aF,e,lF)}lookAt(e,n,r){const i=this.elements;return Un.subVectors(e,n),Un.lengthSq()===0&&(Un.z=1),Un.normalize(),Ci.crossVectors(r,Un),Ci.lengthSq()===0&&(Math.abs(r.z)===1?Un.x+=1e-4:Un.z+=1e-4,Un.normalize(),Ci.crossVectors(r,Un)),Ci.normalize(),tu.crossVectors(Un,Ci),i[0]=Ci.x,i[4]=tu.x,i[8]=Un.x,i[1]=Ci.y,i[5]=tu.y,i[9]=Un.y,i[2]=Ci.z,i[6]=tu.z,i[10]=Un.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const r=e.elements,i=n.elements,s=this.elements,o=r[0],a=r[4],l=r[8],c=r[12],u=r[1],d=r[5],h=r[9],m=r[13],x=r[2],v=r[6],g=r[10],p=r[14],y=r[3],_=r[7],w=r[11],E=r[15],M=i[0],T=i[4],P=i[8],C=i[12],b=i[1],N=i[5],U=i[9],O=i[13],V=i[2],Y=i[6],z=i[10],W=i[14],L=i[3],H=i[7],j=i[11],ee=i[15];return s[0]=o*M+a*b+l*V+c*L,s[4]=o*T+a*N+l*Y+c*H,s[8]=o*P+a*U+l*z+c*j,s[12]=o*C+a*O+l*W+c*ee,s[1]=u*M+d*b+h*V+m*L,s[5]=u*T+d*N+h*Y+m*H,s[9]=u*P+d*U+h*z+m*j,s[13]=u*C+d*O+h*W+m*ee,s[2]=x*M+v*b+g*V+p*L,s[6]=x*T+v*N+g*Y+p*H,s[10]=x*P+v*U+g*z+p*j,s[14]=x*C+v*O+g*W+p*ee,s[3]=y*M+_*b+w*V+E*L,s[7]=y*T+_*N+w*Y+E*H,s[11]=y*P+_*U+w*z+E*j,s[15]=y*C+_*O+w*W+E*ee,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[4]*=e,n[8]*=e,n[12]*=e,n[1]*=e,n[5]*=e,n[9]*=e,n[13]*=e,n[2]*=e,n[6]*=e,n[10]*=e,n[14]*=e,n[3]*=e,n[7]*=e,n[11]*=e,n[15]*=e,this}determinant(){const e=this.elements,n=e[0],r=e[4],i=e[8],s=e[12],o=e[1],a=e[5],l=e[9],c=e[13],u=e[2],d=e[6],h=e[10],m=e[14],x=e[3],v=e[7],g=e[11],p=e[15];return x*(+s*l*d-i*c*d-s*a*h+r*c*h+i*a*m-r*l*m)+v*(+n*l*m-n*c*h+s*o*h-i*o*m+i*c*u-s*l*u)+g*(+n*c*d-n*a*m-s*o*d+r*o*m+s*a*u-r*c*u)+p*(-i*a*u-n*l*d+n*a*h+i*o*d-r*o*h+r*l*u)}transpose(){const e=this.elements;let n;return n=e[1],e[1]=e[4],e[4]=n,n=e[2],e[2]=e[8],e[8]=n,n=e[6],e[6]=e[9],e[9]=n,n=e[3],e[3]=e[12],e[12]=n,n=e[7],e[7]=e[13],e[13]=n,n=e[11],e[11]=e[14],e[14]=n,this}setPosition(e,n,r){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=n,i[14]=r),this}invert(){const e=this.elements,n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],d=e[9],h=e[10],m=e[11],x=e[12],v=e[13],g=e[14],p=e[15],y=d*g*c-v*h*c+v*l*m-a*g*m-d*l*p+a*h*p,_=x*h*c-u*g*c-x*l*m+o*g*m+u*l*p-o*h*p,w=u*v*c-x*d*c+x*a*m-o*v*m-u*a*p+o*d*p,E=x*d*l-u*v*l-x*a*h+o*v*h+u*a*g-o*d*g,M=n*y+r*_+i*w+s*E;if(M===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const T=1/M;return e[0]=y*T,e[1]=(v*h*s-d*g*s-v*i*m+r*g*m+d*i*p-r*h*p)*T,e[2]=(a*g*s-v*l*s+v*i*c-r*g*c-a*i*p+r*l*p)*T,e[3]=(d*l*s-a*h*s-d*i*c+r*h*c+a*i*m-r*l*m)*T,e[4]=_*T,e[5]=(u*g*s-x*h*s+x*i*m-n*g*m-u*i*p+n*h*p)*T,e[6]=(x*l*s-o*g*s-x*i*c+n*g*c+o*i*p-n*l*p)*T,e[7]=(o*h*s-u*l*s+u*i*c-n*h*c-o*i*m+n*l*m)*T,e[8]=w*T,e[9]=(x*d*s-u*v*s-x*r*m+n*v*m+u*r*p-n*d*p)*T,e[10]=(o*v*s-x*a*s+x*r*c-n*v*c-o*r*p+n*a*p)*T,e[11]=(u*a*s-o*d*s-u*r*c+n*d*c+o*r*m-n*a*m)*T,e[12]=E*T,e[13]=(u*v*i-x*d*i+x*r*h-n*v*h-u*r*g+n*d*g)*T,e[14]=(x*a*i-o*v*i-x*r*l+n*v*l+o*r*g-n*a*g)*T,e[15]=(o*d*i-u*a*i+u*r*l-n*d*l-o*r*h+n*a*h)*T,this}scale(e){const n=this.elements,r=e.x,i=e.y,s=e.z;return n[0]*=r,n[4]*=i,n[8]*=s,n[1]*=r,n[5]*=i,n[9]*=s,n[2]*=r,n[6]*=i,n[10]*=s,n[3]*=r,n[7]*=i,n[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(n,r,i))}makeTranslation(e,n,r){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,n,0,0,1,r,0,0,0,1),this}makeRotationX(e){const n=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,n,-r,0,0,r,n,0,0,0,0,1),this}makeRotationY(e){const n=Math.cos(e),r=Math.sin(e);return this.set(n,0,r,0,0,1,0,0,-r,0,n,0,0,0,0,1),this}makeRotationZ(e){const n=Math.cos(e),r=Math.sin(e);return this.set(n,-r,0,0,r,n,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,n){const r=Math.cos(n),i=Math.sin(n),s=1-r,o=e.x,a=e.y,l=e.z,c=s*o,u=s*a;return this.set(c*o+r,c*a-i*l,c*l+i*a,0,c*a+i*l,u*a+r,u*l-i*o,0,c*l-i*a,u*l+i*o,s*l*l+r,0,0,0,0,1),this}makeScale(e,n,r){return this.set(e,0,0,0,0,n,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,n,r,i,s,o){return this.set(1,r,s,0,e,1,o,0,n,i,1,0,0,0,0,1),this}compose(e,n,r){const i=this.elements,s=n._x,o=n._y,a=n._z,l=n._w,c=s+s,u=o+o,d=a+a,h=s*c,m=s*u,x=s*d,v=o*u,g=o*d,p=a*d,y=l*c,_=l*u,w=l*d,E=r.x,M=r.y,T=r.z;return i[0]=(1-(v+p))*E,i[1]=(m+w)*E,i[2]=(x-_)*E,i[3]=0,i[4]=(m-w)*M,i[5]=(1-(h+p))*M,i[6]=(g+y)*M,i[7]=0,i[8]=(x+_)*T,i[9]=(g-y)*T,i[10]=(1-(h+v))*T,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,n,r){const i=this.elements;let s=Co.set(i[0],i[1],i[2]).length();const o=Co.set(i[4],i[5],i[6]).length(),a=Co.set(i[8],i[9],i[10]).length();this.determinant()<0&&(s=-s),e.x=i[12],e.y=i[13],e.z=i[14],ur.copy(this);const c=1/s,u=1/o,d=1/a;return ur.elements[0]*=c,ur.elements[1]*=c,ur.elements[2]*=c,ur.elements[4]*=u,ur.elements[5]*=u,ur.elements[6]*=u,ur.elements[8]*=d,ur.elements[9]*=d,ur.elements[10]*=d,n.setFromRotationMatrix(ur),r.x=s,r.y=o,r.z=a,this}makePerspective(e,n,r,i,s,o,a=Fr,l=!1){const c=this.elements,u=2*s/(n-e),d=2*s/(r-i),h=(n+e)/(n-e),m=(r+i)/(r-i);let x,v;if(l)x=s/(o-s),v=o*s/(o-s);else if(a===Fr)x=-(o+s)/(o-s),v=-2*o*s/(o-s);else if(a===Cd)x=-o/(o-s),v=-o*s/(o-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);return c[0]=u,c[4]=0,c[8]=h,c[12]=0,c[1]=0,c[5]=d,c[9]=m,c[13]=0,c[2]=0,c[6]=0,c[10]=x,c[14]=v,c[3]=0,c[7]=0,c[11]=-1,c[15]=0,this}makeOrthographic(e,n,r,i,s,o,a=Fr,l=!1){const c=this.elements,u=2/(n-e),d=2/(r-i),h=-(n+e)/(n-e),m=-(r+i)/(r-i);let x,v;if(l)x=1/(o-s),v=o/(o-s);else if(a===Fr)x=-2/(o-s),v=-(o+s)/(o-s);else if(a===Cd)x=-1/(o-s),v=-s/(o-s);else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);return c[0]=u,c[4]=0,c[8]=0,c[12]=h,c[1]=0,c[5]=d,c[9]=0,c[13]=m,c[2]=0,c[6]=0,c[10]=x,c[14]=v,c[3]=0,c[7]=0,c[11]=0,c[15]=1,this}equals(e){const n=this.elements,r=e.elements;for(let i=0;i<16;i++)if(n[i]!==r[i])return!1;return!0}fromArray(e,n=0){for(let r=0;r<16;r++)this.elements[r]=e[r+n];return this}toArray(e=[],n=0){const r=this.elements;return e[n]=r[0],e[n+1]=r[1],e[n+2]=r[2],e[n+3]=r[3],e[n+4]=r[4],e[n+5]=r[5],e[n+6]=r[6],e[n+7]=r[7],e[n+8]=r[8],e[n+9]=r[9],e[n+10]=r[10],e[n+11]=r[11],e[n+12]=r[12],e[n+13]=r[13],e[n+14]=r[14],e[n+15]=r[15],e}}const Co=new Z,ur=new Kt,aF=new Z(0,0,0),lF=new Z(1,1,1),Ci=new Z,tu=new Z,Un=new Z,a_=new Kt,l_=new mc;class vi{constructor(e=0,n=0,r=0,i=vi.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=n,this._z=r,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,n,r,i=this._order){return this._x=e,this._y=n,this._z=r,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,n=this._order,r=!0){const i=e.elements,s=i[0],o=i[4],a=i[8],l=i[1],c=i[5],u=i[9],d=i[2],h=i[6],m=i[10];switch(n){case"XYZ":this._y=Math.asin(at(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-u,m),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(h,c),this._z=0);break;case"YXZ":this._x=Math.asin(-at(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(a,m),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-d,s),this._z=0);break;case"ZXY":this._x=Math.asin(at(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-d,m),this._z=Math.atan2(-o,c)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-at(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(h,m),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-o,c));break;case"YZX":this._z=Math.asin(at(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-u,c),this._y=Math.atan2(-d,s)):(this._x=0,this._y=Math.atan2(a,m));break;case"XZY":this._z=Math.asin(-at(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(h,c),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-u,m),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,n,r){return a_.makeRotationFromQuaternion(e),this.setFromRotationMatrix(a_,n,r)}setFromVector3(e,n=this._order){return this.set(e.x,e.y,e.z,n)}reorder(e){return l_.setFromEuler(this),this.setFromQuaternion(l_,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}vi.DEFAULT_ORDER="XYZ";class cM{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let cF=0;const c_=new Z,Ao=new mc,Kr=new Kt,nu=new Z,sl=new Z,uF=new Z,dF=new mc,u_=new Z(1,0,0),d_=new Z(0,1,0),f_=new Z(0,0,1),h_={type:"added"},fF={type:"removed"},Ro={type:"childadded",child:null},zh={type:"childremoved",child:null};class Hn extends ys{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:cF++}),this.uuid=pc(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Hn.DEFAULT_UP.clone();const e=new Z,n=new vi,r=new mc,i=new Z(1,1,1);function s(){r.setFromEuler(n,!1)}function o(){n.setFromQuaternion(r,void 0,!1)}n._onChange(s),r._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new Kt},normalMatrix:{value:new Ke}}),this.matrix=new Kt,this.matrixWorld=new Kt,this.matrixAutoUpdate=Hn.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Hn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new cM,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,n){this.quaternion.setFromAxisAngle(e,n)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,n){return Ao.setFromAxisAngle(e,n),this.quaternion.multiply(Ao),this}rotateOnWorldAxis(e,n){return Ao.setFromAxisAngle(e,n),this.quaternion.premultiply(Ao),this}rotateX(e){return this.rotateOnAxis(u_,e)}rotateY(e){return this.rotateOnAxis(d_,e)}rotateZ(e){return this.rotateOnAxis(f_,e)}translateOnAxis(e,n){return c_.copy(e).applyQuaternion(this.quaternion),this.position.add(c_.multiplyScalar(n)),this}translateX(e){return this.translateOnAxis(u_,e)}translateY(e){return this.translateOnAxis(d_,e)}translateZ(e){return this.translateOnAxis(f_,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Kr.copy(this.matrixWorld).invert())}lookAt(e,n,r){e.isVector3?nu.copy(e):nu.set(e,n,r);const i=this.parent;this.updateWorldMatrix(!0,!1),sl.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Kr.lookAt(sl,nu,this.up):Kr.lookAt(nu,sl,this.up),this.quaternion.setFromRotationMatrix(Kr),i&&(Kr.extractRotation(i.matrixWorld),Ao.setFromRotationMatrix(Kr),this.quaternion.premultiply(Ao.invert()))}add(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(h_),Ro.child=e,this.dispatchEvent(Ro),Ro.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const n=this.children.indexOf(e);return n!==-1&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(fF),zh.child=e,this.dispatchEvent(zh),zh.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Kr.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Kr.multiply(e.parent.matrixWorld)),e.applyMatrix4(Kr),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(h_),Ro.child=e,this.dispatchEvent(Ro),Ro.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,n){if(this[e]===n)return this;for(let r=0,i=this.children.length;r<i;r++){const o=this.children[r].getObjectByProperty(e,n);if(o!==void 0)return o}}getObjectsByProperty(e,n,r=[]){this[e]===n&&r.push(this);const i=this.children;for(let s=0,o=i.length;s<o;s++)i[s].getObjectsByProperty(e,n,r);return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(sl,e,uF),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(sl,dF,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return e.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(e){e(this);const n=this.children;for(let r=0,i=n.length;r<i;r++)n[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const n=this.children;for(let r=0,i=n.length;r<i;r++)n[r].traverseVisible(e)}traverseAncestors(e){const n=this.parent;n!==null&&(e(n),n.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const n=this.children;for(let r=0,i=n.length;r<i;r++)n[r].updateMatrixWorld(e)}updateWorldMatrix(e,n){const r=this.parent;if(e===!0&&r!==null&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),n===!0){const i=this.children;for(let s=0,o=i.length;s<o;s++)i[s].updateWorldMatrix(!1,!0)}}toJSON(e){const n=e===void 0||typeof e=="string",r={};n&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),i.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(i.type="BatchedMesh",i.perObjectFrustumCulled=this.perObjectFrustumCulled,i.sortObjects=this.sortObjects,i.drawRanges=this._drawRanges,i.reservedRanges=this._reservedRanges,i.geometryInfo=this._geometryInfo.map(a=>({...a,boundingBox:a.boundingBox?a.boundingBox.toJSON():void 0,boundingSphere:a.boundingSphere?a.boundingSphere.toJSON():void 0})),i.instanceInfo=this._instanceInfo.map(a=>({...a})),i.availableInstanceIds=this._availableInstanceIds.slice(),i.availableGeometryIds=this._availableGeometryIds.slice(),i.nextIndexStart=this._nextIndexStart,i.nextVertexStart=this._nextVertexStart,i.geometryCount=this._geometryCount,i.maxInstanceCount=this._maxInstanceCount,i.maxVertexCount=this._maxVertexCount,i.maxIndexCount=this._maxIndexCount,i.geometryInitialized=this._geometryInitialized,i.matricesTexture=this._matricesTexture.toJSON(e),i.indirectTexture=this._indirectTexture.toJSON(e),this._colorsTexture!==null&&(i.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(i.boundingSphere=this.boundingSphere.toJSON()),this.boundingBox!==null&&(i.boundingBox=this.boundingBox.toJSON()));function s(a,l){return a[l.uuid]===void 0&&(a[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=s(e.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const l=a.shapes;if(Array.isArray(l))for(let c=0,u=l.length;c<u;c++){const d=l[c];s(e.shapes,d)}else s(e.shapes,l)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let l=0,c=this.material.length;l<c;l++)a.push(s(e.materials,this.material[l]));i.material=a}else i.material=s(e.materials,this.material);if(this.children.length>0){i.children=[];for(let a=0;a<this.children.length;a++)i.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let a=0;a<this.animations.length;a++){const l=this.animations[a];i.animations.push(s(e.animations,l))}}if(n){const a=o(e.geometries),l=o(e.materials),c=o(e.textures),u=o(e.images),d=o(e.shapes),h=o(e.skeletons),m=o(e.animations),x=o(e.nodes);a.length>0&&(r.geometries=a),l.length>0&&(r.materials=l),c.length>0&&(r.textures=c),u.length>0&&(r.images=u),d.length>0&&(r.shapes=d),h.length>0&&(r.skeletons=h),m.length>0&&(r.animations=m),x.length>0&&(r.nodes=x)}return r.object=i,r;function o(a){const l=[];for(const c in a){const u=a[c];delete u.metadata,l.push(u)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,n=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),n===!0)for(let r=0;r<e.children.length;r++){const i=e.children[r];this.add(i.clone())}return this}}Hn.DEFAULT_UP=new Z(0,1,0);Hn.DEFAULT_MATRIX_AUTO_UPDATE=!0;Hn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const dr=new Z,Jr=new Z,Vh=new Z,Zr=new Z,Po=new Z,No=new Z,p_=new Z,Hh=new Z,Gh=new Z,Wh=new Z,$h=new Ht,Xh=new Ht,qh=new Ht;class yr{constructor(e=new Z,n=new Z,r=new Z){this.a=e,this.b=n,this.c=r}static getNormal(e,n,r,i){i.subVectors(r,n),dr.subVectors(e,n),i.cross(dr);const s=i.lengthSq();return s>0?i.multiplyScalar(1/Math.sqrt(s)):i.set(0,0,0)}static getBarycoord(e,n,r,i,s){dr.subVectors(i,n),Jr.subVectors(r,n),Vh.subVectors(e,n);const o=dr.dot(dr),a=dr.dot(Jr),l=dr.dot(Vh),c=Jr.dot(Jr),u=Jr.dot(Vh),d=o*c-a*a;if(d===0)return s.set(0,0,0),null;const h=1/d,m=(c*l-a*u)*h,x=(o*u-a*l)*h;return s.set(1-m-x,x,m)}static containsPoint(e,n,r,i){return this.getBarycoord(e,n,r,i,Zr)===null?!1:Zr.x>=0&&Zr.y>=0&&Zr.x+Zr.y<=1}static getInterpolation(e,n,r,i,s,o,a,l){return this.getBarycoord(e,n,r,i,Zr)===null?(l.x=0,l.y=0,"z"in l&&(l.z=0),"w"in l&&(l.w=0),null):(l.setScalar(0),l.addScaledVector(s,Zr.x),l.addScaledVector(o,Zr.y),l.addScaledVector(a,Zr.z),l)}static getInterpolatedAttribute(e,n,r,i,s,o){return $h.setScalar(0),Xh.setScalar(0),qh.setScalar(0),$h.fromBufferAttribute(e,n),Xh.fromBufferAttribute(e,r),qh.fromBufferAttribute(e,i),o.setScalar(0),o.addScaledVector($h,s.x),o.addScaledVector(Xh,s.y),o.addScaledVector(qh,s.z),o}static isFrontFacing(e,n,r,i){return dr.subVectors(r,n),Jr.subVectors(e,n),dr.cross(Jr).dot(i)<0}set(e,n,r){return this.a.copy(e),this.b.copy(n),this.c.copy(r),this}setFromPointsAndIndices(e,n,r,i){return this.a.copy(e[n]),this.b.copy(e[r]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,n,r,i){return this.a.fromBufferAttribute(e,n),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return dr.subVectors(this.c,this.b),Jr.subVectors(this.a,this.b),dr.cross(Jr).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return yr.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,n){return yr.getBarycoord(e,this.a,this.b,this.c,n)}getInterpolation(e,n,r,i,s){return yr.getInterpolation(e,this.a,this.b,this.c,n,r,i,s)}containsPoint(e){return yr.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return yr.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,n){const r=this.a,i=this.b,s=this.c;let o,a;Po.subVectors(i,r),No.subVectors(s,r),Hh.subVectors(e,r);const l=Po.dot(Hh),c=No.dot(Hh);if(l<=0&&c<=0)return n.copy(r);Gh.subVectors(e,i);const u=Po.dot(Gh),d=No.dot(Gh);if(u>=0&&d<=u)return n.copy(i);const h=l*d-u*c;if(h<=0&&l>=0&&u<=0)return o=l/(l-u),n.copy(r).addScaledVector(Po,o);Wh.subVectors(e,s);const m=Po.dot(Wh),x=No.dot(Wh);if(x>=0&&m<=x)return n.copy(s);const v=m*c-l*x;if(v<=0&&c>=0&&x<=0)return a=c/(c-x),n.copy(r).addScaledVector(No,a);const g=u*x-m*d;if(g<=0&&d-u>=0&&m-x>=0)return p_.subVectors(s,i),a=(d-u)/(d-u+(m-x)),n.copy(i).addScaledVector(p_,a);const p=1/(g+v+h);return o=v*p,a=h*p,n.copy(r).addScaledVector(Po,o).addScaledVector(No,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const uM={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Ai={h:0,s:0,l:0},ru={h:0,s:0,l:0};function Yh(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*6*(2/3-n):t}class pt{constructor(e,n,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,n,r)}set(e,n,r){if(n===void 0&&r===void 0){const i=e;i&&i.isColor?this.copy(i):typeof i=="number"?this.setHex(i):typeof i=="string"&&this.setStyle(i)}else this.setRGB(e,n,r);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,n=zt){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,dt.colorSpaceToWorking(this,n),this}setRGB(e,n,r,i=dt.workingColorSpace){return this.r=e,this.g=n,this.b=r,dt.colorSpaceToWorking(this,i),this}setHSL(e,n,r,i=dt.workingColorSpace){if(e=KO(e,1),n=at(n,0,1),r=at(r,0,1),n===0)this.r=this.g=this.b=r;else{const s=r<=.5?r*(1+n):r+n-r*n,o=2*r-s;this.r=Yh(o,s,e+1/3),this.g=Yh(o,s,e),this.b=Yh(o,s,e-1/3)}return dt.colorSpaceToWorking(this,i),this}setStyle(e,n=zt){function r(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let i;if(i=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const o=i[1],a=i[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return r(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,n);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return r(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,n);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return r(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,n);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=i[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,n);if(o===6)return this.setHex(parseInt(s,16),n);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,n);return this}setColorName(e,n=zt){const r=uM[e.toLowerCase()];return r!==void 0?this.setHex(r,n):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=ci(e.r),this.g=ci(e.g),this.b=ci(e.b),this}copyLinearToSRGB(e){return this.r=ca(e.r),this.g=ca(e.g),this.b=ca(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=zt){return dt.workingToColorSpace(fn.copy(this),e),Math.round(at(fn.r*255,0,255))*65536+Math.round(at(fn.g*255,0,255))*256+Math.round(at(fn.b*255,0,255))}getHexString(e=zt){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,n=dt.workingColorSpace){dt.workingToColorSpace(fn.copy(this),n);const r=fn.r,i=fn.g,s=fn.b,o=Math.max(r,i,s),a=Math.min(r,i,s);let l,c;const u=(a+o)/2;if(a===o)l=0,c=0;else{const d=o-a;switch(c=u<=.5?d/(o+a):d/(2-o-a),o){case r:l=(i-s)/d+(i<s?6:0);break;case i:l=(s-r)/d+2;break;case s:l=(r-i)/d+4;break}l/=6}return e.h=l,e.s=c,e.l=u,e}getRGB(e,n=dt.workingColorSpace){return dt.workingToColorSpace(fn.copy(this),n),e.r=fn.r,e.g=fn.g,e.b=fn.b,e}getStyle(e=zt){dt.workingToColorSpace(fn.copy(this),e);const n=fn.r,r=fn.g,i=fn.b;return e!==zt?`color(${e} ${n.toFixed(3)} ${r.toFixed(3)} ${i.toFixed(3)})`:`rgb(${Math.round(n*255)},${Math.round(r*255)},${Math.round(i*255)})`}offsetHSL(e,n,r){return this.getHSL(Ai),this.setHSL(Ai.h+e,Ai.s+n,Ai.l+r)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,n){return this.r=e.r+n.r,this.g=e.g+n.g,this.b=e.b+n.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,n){return this.r+=(e.r-this.r)*n,this.g+=(e.g-this.g)*n,this.b+=(e.b-this.b)*n,this}lerpColors(e,n,r){return this.r=e.r+(n.r-e.r)*r,this.g=e.g+(n.g-e.g)*r,this.b=e.b+(n.b-e.b)*r,this}lerpHSL(e,n){this.getHSL(Ai),e.getHSL(ru);const r=Nh(Ai.h,ru.h,n),i=Nh(Ai.s,ru.s,n),s=Nh(Ai.l,ru.l,n);return this.setHSL(r,i,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const n=this.r,r=this.g,i=this.b,s=e.elements;return this.r=s[0]*n+s[3]*r+s[6]*i,this.g=s[1]*n+s[4]*r+s[7]*i,this.b=s[2]*n+s[5]*r+s[8]*i,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,n=0){return this.r=e[n],this.g=e[n+1],this.b=e[n+2],this}toArray(e=[],n=0){return e[n]=this.r,e[n+1]=this.g,e[n+2]=this.b,e}fromBufferAttribute(e,n){return this.r=e.getX(n),this.g=e.getY(n),this.b=e.getZ(n),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const fn=new pt;pt.NAMES=uM;let hF=0;class Va extends ys{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:hF++}),this.uuid=pc(),this.name="",this.type="Material",this.blending=aa,this.side=gi,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=km,this.blendDst=Om,this.blendEquation=Bs,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new pt(0,0,0),this.blendAlpha=0,this.depthFunc=Ta,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=t_,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=So,this.stencilZFail=So,this.stencilZPass=So,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const n in e){const r=e[n];if(r===void 0){console.warn(`THREE.Material: parameter '${n}' has value of undefined.`);continue}const i=this[n];if(i===void 0){console.warn(`THREE.Material: '${n}' is not a property of THREE.${this.type}.`);continue}i&&i.isColor?i.set(r):i&&i.isVector3&&r&&r.isVector3?i.copy(r):this[n]=r}}toJSON(e){const n=e===void 0||typeof e=="string";n&&(e={textures:{},images:{}});const r={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(r.dispersion=this.dispersion),this.iridescence!==void 0&&(r.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(r.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(r.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(r.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(r.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapRotation!==void 0&&(r.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==aa&&(r.blending=this.blending),this.side!==gi&&(r.side=this.side),this.vertexColors===!0&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=!0),this.blendSrc!==km&&(r.blendSrc=this.blendSrc),this.blendDst!==Om&&(r.blendDst=this.blendDst),this.blendEquation!==Bs&&(r.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(r.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(r.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(r.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(r.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(r.blendAlpha=this.blendAlpha),this.depthFunc!==Ta&&(r.depthFunc=this.depthFunc),this.depthTest===!1&&(r.depthTest=this.depthTest),this.depthWrite===!1&&(r.depthWrite=this.depthWrite),this.colorWrite===!1&&(r.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(r.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==t_&&(r.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(r.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(r.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==So&&(r.stencilFail=this.stencilFail),this.stencilZFail!==So&&(r.stencilZFail=this.stencilZFail),this.stencilZPass!==So&&(r.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(r.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaHash===!0&&(r.alphaHash=!0),this.alphaToCoverage===!0&&(r.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=!0),this.forceSinglePass===!0&&(r.forceSinglePass=!0),this.wireframe===!0&&(r.wireframe=!0),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=!0),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),this.fog===!1&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData);function i(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(n){const s=i(e.textures),o=i(e.images);s.length>0&&(r.textures=s),o.length>0&&(r.images=o)}return r}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const n=e.clippingPlanes;let r=null;if(n!==null){const i=n.length;r=new Array(i);for(let s=0;s!==i;++s)r[s]=n[s].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class p0 extends Va{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new pt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new vi,this.combine=KT,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Gt=new Z,iu=new Qe;let pF=0;class rr{constructor(e,n,r=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:pF++}),this.name="",this.array=e,this.itemSize=n,this.count=e!==void 0?e.length/n:0,this.normalized=r,this.usage=n_,this.updateRanges=[],this.gpuType=oi,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,n,r){e*=this.itemSize,r*=n.itemSize;for(let i=0,s=this.itemSize;i<s;i++)this.array[e+i]=n.array[r+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let n=0,r=this.count;n<r;n++)iu.fromBufferAttribute(this,n),iu.applyMatrix3(e),this.setXY(n,iu.x,iu.y);else if(this.itemSize===3)for(let n=0,r=this.count;n<r;n++)Gt.fromBufferAttribute(this,n),Gt.applyMatrix3(e),this.setXYZ(n,Gt.x,Gt.y,Gt.z);return this}applyMatrix4(e){for(let n=0,r=this.count;n<r;n++)Gt.fromBufferAttribute(this,n),Gt.applyMatrix4(e),this.setXYZ(n,Gt.x,Gt.y,Gt.z);return this}applyNormalMatrix(e){for(let n=0,r=this.count;n<r;n++)Gt.fromBufferAttribute(this,n),Gt.applyNormalMatrix(e),this.setXYZ(n,Gt.x,Gt.y,Gt.z);return this}transformDirection(e){for(let n=0,r=this.count;n<r;n++)Gt.fromBufferAttribute(this,n),Gt.transformDirection(e),this.setXYZ(n,Gt.x,Gt.y,Gt.z);return this}set(e,n=0){return this.array.set(e,n),this}getComponent(e,n){let r=this.array[e*this.itemSize+n];return this.normalized&&(r=nl(r,this.array)),r}setComponent(e,n,r){return this.normalized&&(r=Mn(r,this.array)),this.array[e*this.itemSize+n]=r,this}getX(e){let n=this.array[e*this.itemSize];return this.normalized&&(n=nl(n,this.array)),n}setX(e,n){return this.normalized&&(n=Mn(n,this.array)),this.array[e*this.itemSize]=n,this}getY(e){let n=this.array[e*this.itemSize+1];return this.normalized&&(n=nl(n,this.array)),n}setY(e,n){return this.normalized&&(n=Mn(n,this.array)),this.array[e*this.itemSize+1]=n,this}getZ(e){let n=this.array[e*this.itemSize+2];return this.normalized&&(n=nl(n,this.array)),n}setZ(e,n){return this.normalized&&(n=Mn(n,this.array)),this.array[e*this.itemSize+2]=n,this}getW(e){let n=this.array[e*this.itemSize+3];return this.normalized&&(n=nl(n,this.array)),n}setW(e,n){return this.normalized&&(n=Mn(n,this.array)),this.array[e*this.itemSize+3]=n,this}setXY(e,n,r){return e*=this.itemSize,this.normalized&&(n=Mn(n,this.array),r=Mn(r,this.array)),this.array[e+0]=n,this.array[e+1]=r,this}setXYZ(e,n,r,i){return e*=this.itemSize,this.normalized&&(n=Mn(n,this.array),r=Mn(r,this.array),i=Mn(i,this.array)),this.array[e+0]=n,this.array[e+1]=r,this.array[e+2]=i,this}setXYZW(e,n,r,i,s){return e*=this.itemSize,this.normalized&&(n=Mn(n,this.array),r=Mn(r,this.array),i=Mn(i,this.array),s=Mn(s,this.array)),this.array[e+0]=n,this.array[e+1]=r,this.array[e+2]=i,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==n_&&(e.usage=this.usage),e}}class dM extends rr{constructor(e,n,r){super(new Uint16Array(e),n,r)}}class fM extends rr{constructor(e,n,r){super(new Uint32Array(e),n,r)}}class Ks extends rr{constructor(e,n,r){super(new Float32Array(e),n,r)}}let mF=0;const Jn=new Kt,Kh=new Hn,Io=new Z,kn=new gc,ol=new gc,Qt=new Z;class _s extends ys{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:mF++}),this.uuid=pc(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(aM(e)?fM:dM)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,n){return this.attributes[e]=n,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,n,r=0){this.groups.push({start:e,count:n,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,n){this.drawRange.start=e,this.drawRange.count=n}applyMatrix4(e){const n=this.attributes.position;n!==void 0&&(n.applyMatrix4(e),n.needsUpdate=!0);const r=this.attributes.normal;if(r!==void 0){const s=new Ke().getNormalMatrix(e);r.applyNormalMatrix(s),r.needsUpdate=!0}const i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(e),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Jn.makeRotationFromQuaternion(e),this.applyMatrix4(Jn),this}rotateX(e){return Jn.makeRotationX(e),this.applyMatrix4(Jn),this}rotateY(e){return Jn.makeRotationY(e),this.applyMatrix4(Jn),this}rotateZ(e){return Jn.makeRotationZ(e),this.applyMatrix4(Jn),this}translate(e,n,r){return Jn.makeTranslation(e,n,r),this.applyMatrix4(Jn),this}scale(e,n,r){return Jn.makeScale(e,n,r),this.applyMatrix4(Jn),this}lookAt(e){return Kh.lookAt(e),Kh.updateMatrix(),this.applyMatrix4(Kh.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Io).negate(),this.translate(Io.x,Io.y,Io.z),this}setFromPoints(e){const n=this.getAttribute("position");if(n===void 0){const r=[];for(let i=0,s=e.length;i<s;i++){const o=e[i];r.push(o.x,o.y,o.z||0)}this.setAttribute("position",new Ks(r,3))}else{const r=Math.min(e.length,n.count);for(let i=0;i<r;i++){const s=e[i];n.setXYZ(i,s.x,s.y,s.z||0)}e.length>n.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),n.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new gc);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new Z(-1/0,-1/0,-1/0),new Z(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),n)for(let r=0,i=n.length;r<i;r++){const s=n[r];kn.setFromBufferAttribute(s),this.morphTargetsRelative?(Qt.addVectors(this.boundingBox.min,kn.min),this.boundingBox.expandByPoint(Qt),Qt.addVectors(this.boundingBox.max,kn.max),this.boundingBox.expandByPoint(Qt)):(this.boundingBox.expandByPoint(kn.min),this.boundingBox.expandByPoint(kn.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new h0);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new Z,1/0);return}if(e){const r=this.boundingSphere.center;if(kn.setFromBufferAttribute(e),n)for(let s=0,o=n.length;s<o;s++){const a=n[s];ol.setFromBufferAttribute(a),this.morphTargetsRelative?(Qt.addVectors(kn.min,ol.min),kn.expandByPoint(Qt),Qt.addVectors(kn.max,ol.max),kn.expandByPoint(Qt)):(kn.expandByPoint(ol.min),kn.expandByPoint(ol.max))}kn.getCenter(r);let i=0;for(let s=0,o=e.count;s<o;s++)Qt.fromBufferAttribute(e,s),i=Math.max(i,r.distanceToSquared(Qt));if(n)for(let s=0,o=n.length;s<o;s++){const a=n[s],l=this.morphTargetsRelative;for(let c=0,u=a.count;c<u;c++)Qt.fromBufferAttribute(a,c),l&&(Io.fromBufferAttribute(e,c),Qt.add(Io)),i=Math.max(i,r.distanceToSquared(Qt))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,n=this.attributes;if(e===null||n.position===void 0||n.normal===void 0||n.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const r=n.position,i=n.normal,s=n.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new rr(new Float32Array(4*r.count),4));const o=this.getAttribute("tangent"),a=[],l=[];for(let P=0;P<r.count;P++)a[P]=new Z,l[P]=new Z;const c=new Z,u=new Z,d=new Z,h=new Qe,m=new Qe,x=new Qe,v=new Z,g=new Z;function p(P,C,b){c.fromBufferAttribute(r,P),u.fromBufferAttribute(r,C),d.fromBufferAttribute(r,b),h.fromBufferAttribute(s,P),m.fromBufferAttribute(s,C),x.fromBufferAttribute(s,b),u.sub(c),d.sub(c),m.sub(h),x.sub(h);const N=1/(m.x*x.y-x.x*m.y);isFinite(N)&&(v.copy(u).multiplyScalar(x.y).addScaledVector(d,-m.y).multiplyScalar(N),g.copy(d).multiplyScalar(m.x).addScaledVector(u,-x.x).multiplyScalar(N),a[P].add(v),a[C].add(v),a[b].add(v),l[P].add(g),l[C].add(g),l[b].add(g))}let y=this.groups;y.length===0&&(y=[{start:0,count:e.count}]);for(let P=0,C=y.length;P<C;++P){const b=y[P],N=b.start,U=b.count;for(let O=N,V=N+U;O<V;O+=3)p(e.getX(O+0),e.getX(O+1),e.getX(O+2))}const _=new Z,w=new Z,E=new Z,M=new Z;function T(P){E.fromBufferAttribute(i,P),M.copy(E);const C=a[P];_.copy(C),_.sub(E.multiplyScalar(E.dot(C))).normalize(),w.crossVectors(M,C);const N=w.dot(l[P])<0?-1:1;o.setXYZW(P,_.x,_.y,_.z,N)}for(let P=0,C=y.length;P<C;++P){const b=y[P],N=b.start,U=b.count;for(let O=N,V=N+U;O<V;O+=3)T(e.getX(O+0)),T(e.getX(O+1)),T(e.getX(O+2))}}computeVertexNormals(){const e=this.index,n=this.getAttribute("position");if(n!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new rr(new Float32Array(n.count*3),3),this.setAttribute("normal",r);else for(let h=0,m=r.count;h<m;h++)r.setXYZ(h,0,0,0);const i=new Z,s=new Z,o=new Z,a=new Z,l=new Z,c=new Z,u=new Z,d=new Z;if(e)for(let h=0,m=e.count;h<m;h+=3){const x=e.getX(h+0),v=e.getX(h+1),g=e.getX(h+2);i.fromBufferAttribute(n,x),s.fromBufferAttribute(n,v),o.fromBufferAttribute(n,g),u.subVectors(o,s),d.subVectors(i,s),u.cross(d),a.fromBufferAttribute(r,x),l.fromBufferAttribute(r,v),c.fromBufferAttribute(r,g),a.add(u),l.add(u),c.add(u),r.setXYZ(x,a.x,a.y,a.z),r.setXYZ(v,l.x,l.y,l.z),r.setXYZ(g,c.x,c.y,c.z)}else for(let h=0,m=n.count;h<m;h+=3)i.fromBufferAttribute(n,h+0),s.fromBufferAttribute(n,h+1),o.fromBufferAttribute(n,h+2),u.subVectors(o,s),d.subVectors(i,s),u.cross(d),r.setXYZ(h+0,u.x,u.y,u.z),r.setXYZ(h+1,u.x,u.y,u.z),r.setXYZ(h+2,u.x,u.y,u.z);this.normalizeNormals(),r.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let n=0,r=e.count;n<r;n++)Qt.fromBufferAttribute(e,n),Qt.normalize(),e.setXYZ(n,Qt.x,Qt.y,Qt.z)}toNonIndexed(){function e(a,l){const c=a.array,u=a.itemSize,d=a.normalized,h=new c.constructor(l.length*u);let m=0,x=0;for(let v=0,g=l.length;v<g;v++){a.isInterleavedBufferAttribute?m=l[v]*a.data.stride+a.offset:m=l[v]*u;for(let p=0;p<u;p++)h[x++]=c[m++]}return new rr(h,u,d)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const n=new _s,r=this.index.array,i=this.attributes;for(const a in i){const l=i[a],c=e(l,r);n.setAttribute(a,c)}const s=this.morphAttributes;for(const a in s){const l=[],c=s[a];for(let u=0,d=c.length;u<d;u++){const h=c[u],m=e(h,r);l.push(m)}n.morphAttributes[a]=l}n.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const c=o[a];n.addGroup(c.start,c.count,c.materialIndex)}return n}toJSON(){const e={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const c in l)l[c]!==void 0&&(e[c]=l[c]);return e}e.data={attributes:{}};const n=this.index;n!==null&&(e.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});const r=this.attributes;for(const l in r){const c=r[l];e.data.attributes[l]=c.toJSON(e.data)}const i={};let s=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],u=[];for(let d=0,h=c.length;d<h;d++){const m=c[d];u.push(m.toJSON(e.data))}u.length>0&&(i[l]=u,s=!0)}s&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return a!==null&&(e.data.boundingSphere=a.toJSON()),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const n={};this.name=e.name;const r=e.index;r!==null&&this.setIndex(r.clone());const i=e.attributes;for(const c in i){const u=i[c];this.setAttribute(c,u.clone(n))}const s=e.morphAttributes;for(const c in s){const u=[],d=s[c];for(let h=0,m=d.length;h<m;h++)u.push(d[h].clone(n));this.morphAttributes[c]=u}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let c=0,u=o.length;c<u;c++){const d=o[c];this.addGroup(d.start,d.count,d.materialIndex)}const a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const m_=new Kt,As=new oF,su=new h0,g_=new Z,ou=new Z,au=new Z,lu=new Z,Jh=new Z,cu=new Z,v_=new Z,uu=new Z;class Er extends Hn{constructor(e=new _s,n=new p0){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=n,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const n=this.geometry.morphAttributes,r=Object.keys(n);if(r.length>0){const i=n[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=i.length;s<o;s++){const a=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,n){const r=this.geometry,i=r.attributes.position,s=r.morphAttributes.position,o=r.morphTargetsRelative;n.fromBufferAttribute(i,e);const a=this.morphTargetInfluences;if(s&&a){cu.set(0,0,0);for(let l=0,c=s.length;l<c;l++){const u=a[l],d=s[l];u!==0&&(Jh.fromBufferAttribute(d,e),o?cu.addScaledVector(Jh,u):cu.addScaledVector(Jh.sub(n),u))}n.add(cu)}return n}raycast(e,n){const r=this.geometry,i=this.material,s=this.matrixWorld;i!==void 0&&(r.boundingSphere===null&&r.computeBoundingSphere(),su.copy(r.boundingSphere),su.applyMatrix4(s),As.copy(e.ray).recast(e.near),!(su.containsPoint(As.origin)===!1&&(As.intersectSphere(su,g_)===null||As.origin.distanceToSquared(g_)>(e.far-e.near)**2))&&(m_.copy(s).invert(),As.copy(e.ray).applyMatrix4(m_),!(r.boundingBox!==null&&As.intersectsBox(r.boundingBox)===!1)&&this._computeIntersections(e,n,As)))}_computeIntersections(e,n,r){let i;const s=this.geometry,o=this.material,a=s.index,l=s.attributes.position,c=s.attributes.uv,u=s.attributes.uv1,d=s.attributes.normal,h=s.groups,m=s.drawRange;if(a!==null)if(Array.isArray(o))for(let x=0,v=h.length;x<v;x++){const g=h[x],p=o[g.materialIndex],y=Math.max(g.start,m.start),_=Math.min(a.count,Math.min(g.start+g.count,m.start+m.count));for(let w=y,E=_;w<E;w+=3){const M=a.getX(w),T=a.getX(w+1),P=a.getX(w+2);i=du(this,p,e,r,c,u,d,M,T,P),i&&(i.faceIndex=Math.floor(w/3),i.face.materialIndex=g.materialIndex,n.push(i))}}else{const x=Math.max(0,m.start),v=Math.min(a.count,m.start+m.count);for(let g=x,p=v;g<p;g+=3){const y=a.getX(g),_=a.getX(g+1),w=a.getX(g+2);i=du(this,o,e,r,c,u,d,y,_,w),i&&(i.faceIndex=Math.floor(g/3),n.push(i))}}else if(l!==void 0)if(Array.isArray(o))for(let x=0,v=h.length;x<v;x++){const g=h[x],p=o[g.materialIndex],y=Math.max(g.start,m.start),_=Math.min(l.count,Math.min(g.start+g.count,m.start+m.count));for(let w=y,E=_;w<E;w+=3){const M=w,T=w+1,P=w+2;i=du(this,p,e,r,c,u,d,M,T,P),i&&(i.faceIndex=Math.floor(w/3),i.face.materialIndex=g.materialIndex,n.push(i))}}else{const x=Math.max(0,m.start),v=Math.min(l.count,m.start+m.count);for(let g=x,p=v;g<p;g+=3){const y=g,_=g+1,w=g+2;i=du(this,o,e,r,c,u,d,y,_,w),i&&(i.faceIndex=Math.floor(g/3),n.push(i))}}}}function gF(t,e,n,r,i,s,o,a){let l;if(e.side===nn?l=r.intersectTriangle(o,s,i,!0,a):l=r.intersectTriangle(i,s,o,e.side===gi,a),l===null)return null;uu.copy(a),uu.applyMatrix4(t.matrixWorld);const c=n.ray.origin.distanceTo(uu);return c<n.near||c>n.far?null:{distance:c,point:uu.clone(),object:t}}function du(t,e,n,r,i,s,o,a,l,c){t.getVertexPosition(a,ou),t.getVertexPosition(l,au),t.getVertexPosition(c,lu);const u=gF(t,e,n,r,ou,au,lu,v_);if(u){const d=new Z;yr.getBarycoord(v_,ou,au,lu,d),i&&(u.uv=yr.getInterpolatedAttribute(i,a,l,c,d,new Qe)),s&&(u.uv1=yr.getInterpolatedAttribute(s,a,l,c,d,new Qe)),o&&(u.normal=yr.getInterpolatedAttribute(o,a,l,c,d,new Z),u.normal.dot(r.direction)>0&&u.normal.multiplyScalar(-1));const h={a,b:l,c,normal:new Z,materialIndex:0};yr.getNormal(ou,au,lu,h.normal),u.face=h,u.barycoord=d}return u}class vc extends _s{constructor(e=1,n=1,r=1,i=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:n,depth:r,widthSegments:i,heightSegments:s,depthSegments:o};const a=this;i=Math.floor(i),s=Math.floor(s),o=Math.floor(o);const l=[],c=[],u=[],d=[];let h=0,m=0;x("z","y","x",-1,-1,r,n,e,o,s,0),x("z","y","x",1,-1,r,n,-e,o,s,1),x("x","z","y",1,1,e,r,n,i,o,2),x("x","z","y",1,-1,e,r,-n,i,o,3),x("x","y","z",1,-1,e,n,r,i,s,4),x("x","y","z",-1,-1,e,n,-r,i,s,5),this.setIndex(l),this.setAttribute("position",new Ks(c,3)),this.setAttribute("normal",new Ks(u,3)),this.setAttribute("uv",new Ks(d,2));function x(v,g,p,y,_,w,E,M,T,P,C){const b=w/T,N=E/P,U=w/2,O=E/2,V=M/2,Y=T+1,z=P+1;let W=0,L=0;const H=new Z;for(let j=0;j<z;j++){const ee=j*N-O;for(let ve=0;ve<Y;ve++){const Be=ve*b-U;H[v]=Be*y,H[g]=ee*_,H[p]=V,c.push(H.x,H.y,H.z),H[v]=0,H[g]=0,H[p]=M>0?1:-1,u.push(H.x,H.y,H.z),d.push(ve/T),d.push(1-j/P),W+=1}}for(let j=0;j<P;j++)for(let ee=0;ee<T;ee++){const ve=h+ee+Y*j,Be=h+ee+Y*(j+1),Ue=h+(ee+1)+Y*(j+1),Q=h+(ee+1)+Y*j;l.push(ve,Be,Q),l.push(Be,Ue,Q),L+=6}a.addGroup(m,L,C),m+=L,h+=W}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new vc(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Pa(t){const e={};for(const n in t){e[n]={};for(const r in t[n]){const i=t[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[n][r]=null):e[n][r]=i.clone():Array.isArray(i)?e[n][r]=i.slice():e[n][r]=i}}return e}function yn(t){const e={};for(let n=0;n<t.length;n++){const r=Pa(t[n]);for(const i in r)e[i]=r[i]}return e}function vF(t){const e=[];for(let n=0;n<t.length;n++)e.push(t[n].clone());return e}function hM(t){const e=t.getRenderTarget();return e===null?t.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:dt.workingColorSpace}const xF={clone:Pa,merge:yn};var yF=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,_F=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class ar extends Va{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=yF,this.fragmentShader=_F,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Pa(e.uniforms),this.uniformsGroups=vF(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const n=super.toJSON(e);n.glslVersion=this.glslVersion,n.uniforms={};for(const i in this.uniforms){const o=this.uniforms[i].value;o&&o.isTexture?n.uniforms[i]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?n.uniforms[i]={type:"c",value:o.getHex()}:o&&o.isVector2?n.uniforms[i]={type:"v2",value:o.toArray()}:o&&o.isVector3?n.uniforms[i]={type:"v3",value:o.toArray()}:o&&o.isVector4?n.uniforms[i]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?n.uniforms[i]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?n.uniforms[i]={type:"m4",value:o.toArray()}:n.uniforms[i]={value:o}}Object.keys(this.defines).length>0&&(n.defines=this.defines),n.vertexShader=this.vertexShader,n.fragmentShader=this.fragmentShader,n.lights=this.lights,n.clipping=this.clipping;const r={};for(const i in this.extensions)this.extensions[i]===!0&&(r[i]=!0);return Object.keys(r).length>0&&(n.extensions=r),n}}class m0 extends Hn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Kt,this.projectionMatrix=new Kt,this.projectionMatrixInverse=new Kt,this.coordinateSystem=Fr,this._reversedDepth=!1}get reversedDepth(){return this._reversedDepth}copy(e,n){return super.copy(e,n),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,n){super.updateWorldMatrix(e,n),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const Ri=new Z,x_=new Qe,y_=new Qe;class er extends m0{constructor(e=50,n=1,r=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=i,this.focus=10,this.aspect=n,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const n=.5*this.getFilmHeight()/e;this.fov=Sg*2*Math.atan(n),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Ph*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Sg*2*Math.atan(Math.tan(Ph*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,n,r){Ri.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(Ri.x,Ri.y).multiplyScalar(-e/Ri.z),Ri.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),r.set(Ri.x,Ri.y).multiplyScalar(-e/Ri.z)}getViewSize(e,n){return this.getViewBounds(e,x_,y_),n.subVectors(y_,x_)}setViewOffset(e,n,r,i,s,o){this.aspect=e/n,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=r,this.view.offsetY=i,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let n=e*Math.tan(Ph*.5*this.fov)/this.zoom,r=2*n,i=this.aspect*r,s=-.5*i;const o=this.view;if(this.view!==null&&this.view.enabled){const l=o.fullWidth,c=o.fullHeight;s+=o.offsetX*i/l,n-=o.offsetY*r/c,i*=o.width/l,r*=o.height/c}const a=this.filmOffset;a!==0&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+i,n,n-r,e,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.fov=this.fov,n.object.zoom=this.zoom,n.object.near=this.near,n.object.far=this.far,n.object.focus=this.focus,n.object.aspect=this.aspect,this.view!==null&&(n.object.view=Object.assign({},this.view)),n.object.filmGauge=this.filmGauge,n.object.filmOffset=this.filmOffset,n}}const Lo=-90,Do=1;class wF extends Hn{constructor(e,n,r){super(),this.type="CubeCamera",this.renderTarget=r,this.coordinateSystem=null,this.activeMipmapLevel=0;const i=new er(Lo,Do,e,n);i.layers=this.layers,this.add(i);const s=new er(Lo,Do,e,n);s.layers=this.layers,this.add(s);const o=new er(Lo,Do,e,n);o.layers=this.layers,this.add(o);const a=new er(Lo,Do,e,n);a.layers=this.layers,this.add(a);const l=new er(Lo,Do,e,n);l.layers=this.layers,this.add(l);const c=new er(Lo,Do,e,n);c.layers=this.layers,this.add(c)}updateCoordinateSystem(){const e=this.coordinateSystem,n=this.children.concat(),[r,i,s,o,a,l]=n;for(const c of n)this.remove(c);if(e===Fr)r.up.set(0,1,0),r.lookAt(1,0,0),i.up.set(0,1,0),i.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===Cd)r.up.set(0,-1,0),r.lookAt(-1,0,0),i.up.set(0,-1,0),i.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const c of n)this.add(c),c.updateMatrixWorld()}update(e,n){this.parent===null&&this.updateMatrixWorld();const{renderTarget:r,activeMipmapLevel:i}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,o,a,l,c,u]=this.children,d=e.getRenderTarget(),h=e.getActiveCubeFace(),m=e.getActiveMipmapLevel(),x=e.xr.enabled;e.xr.enabled=!1;const v=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0,i),e.render(n,s),e.setRenderTarget(r,1,i),e.render(n,o),e.setRenderTarget(r,2,i),e.render(n,a),e.setRenderTarget(r,3,i),e.render(n,l),e.setRenderTarget(r,4,i),e.render(n,c),r.texture.generateMipmaps=v,e.setRenderTarget(r,5,i),e.render(n,u),e.setRenderTarget(d,h,m),e.xr.enabled=x,r.texture.needsPMREMUpdate=!0}}class pM extends an{constructor(e=[],n=Ma,r,i,s,o,a,l,c,u){super(e,n,r,i,s,o,a,l,c,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class SF extends Pr{constructor(e=1,n={}){super(e,e,n),this.isWebGLCubeRenderTarget=!0;const r={width:e,height:e,depth:1},i=[r,r,r,r,r,r];this.texture=new pM(i),this._setTextureOptions(n),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(e,n){this.texture.type=n.type,this.texture.colorSpace=n.colorSpace,this.texture.generateMipmaps=n.generateMipmaps,this.texture.minFilter=n.minFilter,this.texture.magFilter=n.magFilter;const r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new vc(5,5,5),s=new ar({name:"CubemapFromEquirect",uniforms:Pa(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:nn,blending:zr});s.uniforms.tEquirect.value=n;const o=new Er(i,s),a=n.minFilter;return n.minFilter===Ws&&(n.minFilter=mn),new wF(1,10,this).update(e,o),n.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,n=!0,r=!0,i=!0){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(n,r,i);e.setRenderTarget(s)}}class fu extends Hn{constructor(){super(),this.isGroup=!0,this.type="Group"}}const EF={type:"move"};class Zh{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new fu,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new fu,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Z,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Z),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new fu,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Z,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Z),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const n=this._hand;if(n)for(const r of e.hand.values())this._getHandJoint(n,r)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,n,r){let i=null,s=null,o=null;const a=this._targetRay,l=this._grip,c=this._hand;if(e&&n.session.visibilityState!=="visible-blurred"){if(c&&e.hand){o=!0;for(const v of e.hand.values()){const g=n.getJointPose(v,r),p=this._getHandJoint(c,v);g!==null&&(p.matrix.fromArray(g.transform.matrix),p.matrix.decompose(p.position,p.rotation,p.scale),p.matrixWorldNeedsUpdate=!0,p.jointRadius=g.radius),p.visible=g!==null}const u=c.joints["index-finger-tip"],d=c.joints["thumb-tip"],h=u.position.distanceTo(d.position),m=.02,x=.005;c.inputState.pinching&&h>m+x?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&h<=m-x&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(s=n.getPose(e.gripSpace,r),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));a!==null&&(i=n.getPose(e.targetRaySpace,r),i===null&&s!==null&&(i=s),i!==null&&(a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,i.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(i.linearVelocity)):a.hasLinearVelocity=!1,i.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(i.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(EF)))}return a!==null&&(a.visible=i!==null),l!==null&&(l.visible=s!==null),c!==null&&(c.visible=o!==null),this}_getHandJoint(e,n){if(e.joints[n.jointName]===void 0){const r=new fu;r.matrixAutoUpdate=!1,r.visible=!1,e.joints[n.jointName]=r,e.add(r)}return e.joints[n.jointName]}}class Eg extends Hn{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new vi,this.environmentIntensity=1,this.environmentRotation=new vi,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,n){return super.copy(e,n),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const n=super.toJSON(e);return this.fog!==null&&(n.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(n.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(n.object.backgroundIntensity=this.backgroundIntensity),n.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(n.object.environmentIntensity=this.environmentIntensity),n.object.environmentRotation=this.environmentRotation.toArray(),n}}const Qh=new Z,bF=new Z,TF=new Ke;class ks{constructor(e=new Z(1,0,0),n=0){this.isPlane=!0,this.normal=e,this.constant=n}set(e,n){return this.normal.copy(e),this.constant=n,this}setComponents(e,n,r,i){return this.normal.set(e,n,r),this.constant=i,this}setFromNormalAndCoplanarPoint(e,n){return this.normal.copy(e),this.constant=-n.dot(this.normal),this}setFromCoplanarPoints(e,n,r){const i=Qh.subVectors(r,n).cross(bF.subVectors(e,n)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,n){return n.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,n){const r=e.delta(Qh),i=this.normal.dot(r);if(i===0)return this.distanceToPoint(e.start)===0?n.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/i;return s<0||s>1?null:n.copy(e.start).addScaledVector(r,s)}intersectsLine(e){const n=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return n<0&&r>0||r<0&&n>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,n){const r=n||TF.getNormalMatrix(e),i=this.coplanarPoint(Qh).applyMatrix4(e),s=this.normal.applyMatrix3(r).normalize();return this.constant=-i.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Rs=new h0,MF=new Qe(.5,.5),hu=new Z;class mM{constructor(e=new ks,n=new ks,r=new ks,i=new ks,s=new ks,o=new ks){this.planes=[e,n,r,i,s,o]}set(e,n,r,i,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(n),a[2].copy(r),a[3].copy(i),a[4].copy(s),a[5].copy(o),this}copy(e){const n=this.planes;for(let r=0;r<6;r++)n[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e,n=Fr,r=!1){const i=this.planes,s=e.elements,o=s[0],a=s[1],l=s[2],c=s[3],u=s[4],d=s[5],h=s[6],m=s[7],x=s[8],v=s[9],g=s[10],p=s[11],y=s[12],_=s[13],w=s[14],E=s[15];if(i[0].setComponents(c-o,m-u,p-x,E-y).normalize(),i[1].setComponents(c+o,m+u,p+x,E+y).normalize(),i[2].setComponents(c+a,m+d,p+v,E+_).normalize(),i[3].setComponents(c-a,m-d,p-v,E-_).normalize(),r)i[4].setComponents(l,h,g,w).normalize(),i[5].setComponents(c-l,m-h,p-g,E-w).normalize();else if(i[4].setComponents(c-l,m-h,p-g,E-w).normalize(),n===Fr)i[5].setComponents(c+l,m+h,p+g,E+w).normalize();else if(n===Cd)i[5].setComponents(l,h,g,w).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+n);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Rs.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const n=e.geometry;n.boundingSphere===null&&n.computeBoundingSphere(),Rs.copy(n.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Rs)}intersectsSprite(e){Rs.center.set(0,0,0);const n=MF.distanceTo(e.center);return Rs.radius=.7071067811865476+n,Rs.applyMatrix4(e.matrixWorld),this.intersectsSphere(Rs)}intersectsSphere(e){const n=this.planes,r=e.center,i=-e.radius;for(let s=0;s<6;s++)if(n[s].distanceToPoint(r)<i)return!1;return!0}intersectsBox(e){const n=this.planes;for(let r=0;r<6;r++){const i=n[r];if(hu.x=i.normal.x>0?e.max.x:e.min.x,hu.y=i.normal.y>0?e.max.y:e.min.y,hu.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(hu)<0)return!1}return!0}containsPoint(e){const n=this.planes;for(let r=0;r<6;r++)if(n[r].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}class g0 extends an{constructor(e,n,r=ls,i,s,o,a=Mr,l=Mr,c,u=Ql,d=1){if(u!==Ql&&u!==Ra)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");const h={width:e,height:n,depth:d};super(h,i,s,o,a,l,u,r,c),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new f0(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const n=super.toJSON(e);return this.compareFunction!==null&&(n.compareFunction=this.compareFunction),n}}class xc extends _s{constructor(e=1,n=1,r=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:n,widthSegments:r,heightSegments:i};const s=e/2,o=n/2,a=Math.floor(r),l=Math.floor(i),c=a+1,u=l+1,d=e/a,h=n/l,m=[],x=[],v=[],g=[];for(let p=0;p<u;p++){const y=p*h-o;for(let _=0;_<c;_++){const w=_*d-s;x.push(w,-y,0),v.push(0,0,1),g.push(_/a),g.push(1-p/l)}}for(let p=0;p<l;p++)for(let y=0;y<a;y++){const _=y+c*p,w=y+c*(p+1),E=y+1+c*(p+1),M=y+1+c*p;m.push(_,w,M),m.push(w,E,M)}this.setIndex(m),this.setAttribute("position",new Ks(x,3)),this.setAttribute("normal",new Ks(v,3)),this.setAttribute("uv",new Ks(g,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new xc(e.width,e.height,e.widthSegments,e.heightSegments)}}class CF extends Va{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=hc,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class AF extends Va{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class gM extends m0{constructor(e=-1,n=1,r=1,i=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=n,this.top=r,this.bottom=i,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,n,r,i,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=r,this.view.offsetY=i,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),n=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let s=r-e,o=r+e,a=i+n,l=i-n;if(this.view!==null&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,o=s+c*this.view.width,a-=u*this.view.offsetY,l=a-u*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.zoom=this.zoom,n.object.left=this.left,n.object.right=this.right,n.object.top=this.top,n.object.bottom=this.bottom,n.object.near=this.near,n.object.far=this.far,this.view!==null&&(n.object.view=Object.assign({},this.view)),n}}class RF extends er{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}class PF{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=performance.now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const n=performance.now();e=(n-this.oldTime)/1e3,this.oldTime=n,this.elapsedTime+=e}return e}}class Xt{constructor(e){this.value=e}clone(){return new Xt(this.value.clone===void 0?this.value:this.value.clone())}}function __(t,e,n,r){const i=NF(r);switch(n){case tM:return t*e;case rM:return t*e/i.components*i.byteLength;case c0:return t*e/i.components*i.byteLength;case iM:return t*e*2/i.components*i.byteLength;case u0:return t*e*2/i.components*i.byteLength;case nM:return t*e*3/i.components*i.byteLength;case Sr:return t*e*4/i.components*i.byteLength;case d0:return t*e*4/i.components*i.byteLength;case Uu:case ku:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*8;case Ou:case Fu:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case Km:case Zm:return Math.max(t,16)*Math.max(e,8)/4;case Ym:case Jm:return Math.max(t,8)*Math.max(e,8)/2;case Qm:case eg:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*8;case tg:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case ng:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case rg:return Math.floor((t+4)/5)*Math.floor((e+3)/4)*16;case ig:return Math.floor((t+4)/5)*Math.floor((e+4)/5)*16;case sg:return Math.floor((t+5)/6)*Math.floor((e+4)/5)*16;case og:return Math.floor((t+5)/6)*Math.floor((e+5)/6)*16;case ag:return Math.floor((t+7)/8)*Math.floor((e+4)/5)*16;case lg:return Math.floor((t+7)/8)*Math.floor((e+5)/6)*16;case cg:return Math.floor((t+7)/8)*Math.floor((e+7)/8)*16;case ug:return Math.floor((t+9)/10)*Math.floor((e+4)/5)*16;case dg:return Math.floor((t+9)/10)*Math.floor((e+5)/6)*16;case fg:return Math.floor((t+9)/10)*Math.floor((e+7)/8)*16;case hg:return Math.floor((t+9)/10)*Math.floor((e+9)/10)*16;case pg:return Math.floor((t+11)/12)*Math.floor((e+9)/10)*16;case mg:return Math.floor((t+11)/12)*Math.floor((e+11)/12)*16;case Bu:case gg:case vg:return Math.ceil(t/4)*Math.ceil(e/4)*16;case sM:case xg:return Math.ceil(t/4)*Math.ceil(e/4)*8;case yg:case _g:return Math.ceil(t/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${n} format.`)}function NF(t){switch(t){case Wn:case ZT:return{byteLength:1,components:1};case Zl:case QT:case fc:return{byteLength:2,components:1};case a0:case l0:return{byteLength:2,components:4};case ls:case o0:case oi:return{byteLength:4,components:1};case eM:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${t}.`)}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Mf}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Mf);/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */function vM(){let t=null,e=!1,n=null,r=null;function i(s,o){n(s,o),r=t.requestAnimationFrame(i)}return{start:function(){e!==!0&&n!==null&&(r=t.requestAnimationFrame(i),e=!0)},stop:function(){t.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(s){n=s},setContext:function(s){t=s}}}function IF(t){const e=new WeakMap;function n(a,l){const c=a.array,u=a.usage,d=c.byteLength,h=t.createBuffer();t.bindBuffer(l,h),t.bufferData(l,c,u),a.onUploadCallback();let m;if(c instanceof Float32Array)m=t.FLOAT;else if(typeof Float16Array<"u"&&c instanceof Float16Array)m=t.HALF_FLOAT;else if(c instanceof Uint16Array)a.isFloat16BufferAttribute?m=t.HALF_FLOAT:m=t.UNSIGNED_SHORT;else if(c instanceof Int16Array)m=t.SHORT;else if(c instanceof Uint32Array)m=t.UNSIGNED_INT;else if(c instanceof Int32Array)m=t.INT;else if(c instanceof Int8Array)m=t.BYTE;else if(c instanceof Uint8Array)m=t.UNSIGNED_BYTE;else if(c instanceof Uint8ClampedArray)m=t.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+c);return{buffer:h,type:m,bytesPerElement:c.BYTES_PER_ELEMENT,version:a.version,size:d}}function r(a,l,c){const u=l.array,d=l.updateRanges;if(t.bindBuffer(c,a),d.length===0)t.bufferSubData(c,0,u);else{d.sort((m,x)=>m.start-x.start);let h=0;for(let m=1;m<d.length;m++){const x=d[h],v=d[m];v.start<=x.start+x.count+1?x.count=Math.max(x.count,v.start+v.count-x.start):(++h,d[h]=v)}d.length=h+1;for(let m=0,x=d.length;m<x;m++){const v=d[m];t.bufferSubData(c,v.start*u.BYTES_PER_ELEMENT,u,v.start,v.count)}l.clearUpdateRanges()}l.onUploadCallback()}function i(a){return a.isInterleavedBufferAttribute&&(a=a.data),e.get(a)}function s(a){a.isInterleavedBufferAttribute&&(a=a.data);const l=e.get(a);l&&(t.deleteBuffer(l.buffer),e.delete(a))}function o(a,l){if(a.isInterleavedBufferAttribute&&(a=a.data),a.isGLBufferAttribute){const u=e.get(a);(!u||u.version<a.version)&&e.set(a,{buffer:a.buffer,type:a.type,bytesPerElement:a.elementSize,version:a.version});return}const c=e.get(a);if(c===void 0)e.set(a,n(a,l));else if(c.version<a.version){if(c.size!==a.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");r(c.buffer,a,l),c.version=a.version}}return{get:i,remove:s,update:o}}var LF=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,DF=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,UF=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,kF=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,OF=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,FF=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,BF=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,jF=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,zF=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,VF=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,HF=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,GF=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,WF=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,$F=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,XF=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,qF=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,YF=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,KF=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,JF=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,ZF=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,QF=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,e4=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,t4=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,n4=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,r4=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,i4=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,s4=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,o4=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,a4=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,l4=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,c4="gl_FragColor = linearToOutputTexel( gl_FragColor );",u4=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,d4=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,f4=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,h4=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,p4=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,m4=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,g4=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,v4=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,x4=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,y4=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,_4=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,w4=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,S4=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,E4=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,b4=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,T4=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,M4=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,C4=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,A4=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,R4=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,P4=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,N4=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,I4=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,L4=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,D4=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,U4=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,k4=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,O4=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,F4=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,B4=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,j4=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,z4=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,V4=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,H4=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,G4=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,W4=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,$4=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,X4=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,q4=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,Y4=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,K4=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,J4=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,Z4=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Q4=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,eB=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,tB=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,nB=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,rB=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,iB=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,sB=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,oB=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,aB=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,lB=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,cB=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,uB=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,dB=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,fB=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,hB=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,pB=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		float depth = unpackRGBAToDepth( texture2D( depths, uv ) );
		#ifdef USE_REVERSEDEPTHBUF
			return step( depth, compare );
		#else
			return step( compare, depth );
		#endif
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		#ifdef USE_REVERSEDEPTHBUF
			float hard_shadow = step( distribution.x, compare );
		#else
			float hard_shadow = step( compare , distribution.x );
		#endif
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,mB=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,gB=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,vB=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,xB=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,yB=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,_B=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,wB=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,SB=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,EB=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,bB=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,TB=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,MB=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,CB=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,AB=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,RB=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,PB=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,NB=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const IB=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,LB=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,DB=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,UB=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,kB=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,OB=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,FB=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,BB=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	#ifdef USE_REVERSEDEPTHBUF
		float fragCoordZ = vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ];
	#else
		float fragCoordZ = 0.5 * vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ] + 0.5;
	#endif
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,jB=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,zB=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,VB=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,HB=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,GB=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,WB=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,$B=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,XB=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,qB=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,YB=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,KB=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,JB=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,ZB=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,QB=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,ej=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,tj=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,nj=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,rj=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,ij=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,sj=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,oj=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,aj=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,lj=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,cj=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,uj=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,dj=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Je={alphahash_fragment:LF,alphahash_pars_fragment:DF,alphamap_fragment:UF,alphamap_pars_fragment:kF,alphatest_fragment:OF,alphatest_pars_fragment:FF,aomap_fragment:BF,aomap_pars_fragment:jF,batching_pars_vertex:zF,batching_vertex:VF,begin_vertex:HF,beginnormal_vertex:GF,bsdfs:WF,iridescence_fragment:$F,bumpmap_pars_fragment:XF,clipping_planes_fragment:qF,clipping_planes_pars_fragment:YF,clipping_planes_pars_vertex:KF,clipping_planes_vertex:JF,color_fragment:ZF,color_pars_fragment:QF,color_pars_vertex:e4,color_vertex:t4,common:n4,cube_uv_reflection_fragment:r4,defaultnormal_vertex:i4,displacementmap_pars_vertex:s4,displacementmap_vertex:o4,emissivemap_fragment:a4,emissivemap_pars_fragment:l4,colorspace_fragment:c4,colorspace_pars_fragment:u4,envmap_fragment:d4,envmap_common_pars_fragment:f4,envmap_pars_fragment:h4,envmap_pars_vertex:p4,envmap_physical_pars_fragment:T4,envmap_vertex:m4,fog_vertex:g4,fog_pars_vertex:v4,fog_fragment:x4,fog_pars_fragment:y4,gradientmap_pars_fragment:_4,lightmap_pars_fragment:w4,lights_lambert_fragment:S4,lights_lambert_pars_fragment:E4,lights_pars_begin:b4,lights_toon_fragment:M4,lights_toon_pars_fragment:C4,lights_phong_fragment:A4,lights_phong_pars_fragment:R4,lights_physical_fragment:P4,lights_physical_pars_fragment:N4,lights_fragment_begin:I4,lights_fragment_maps:L4,lights_fragment_end:D4,logdepthbuf_fragment:U4,logdepthbuf_pars_fragment:k4,logdepthbuf_pars_vertex:O4,logdepthbuf_vertex:F4,map_fragment:B4,map_pars_fragment:j4,map_particle_fragment:z4,map_particle_pars_fragment:V4,metalnessmap_fragment:H4,metalnessmap_pars_fragment:G4,morphinstance_vertex:W4,morphcolor_vertex:$4,morphnormal_vertex:X4,morphtarget_pars_vertex:q4,morphtarget_vertex:Y4,normal_fragment_begin:K4,normal_fragment_maps:J4,normal_pars_fragment:Z4,normal_pars_vertex:Q4,normal_vertex:eB,normalmap_pars_fragment:tB,clearcoat_normal_fragment_begin:nB,clearcoat_normal_fragment_maps:rB,clearcoat_pars_fragment:iB,iridescence_pars_fragment:sB,opaque_fragment:oB,packing:aB,premultiplied_alpha_fragment:lB,project_vertex:cB,dithering_fragment:uB,dithering_pars_fragment:dB,roughnessmap_fragment:fB,roughnessmap_pars_fragment:hB,shadowmap_pars_fragment:pB,shadowmap_pars_vertex:mB,shadowmap_vertex:gB,shadowmask_pars_fragment:vB,skinbase_vertex:xB,skinning_pars_vertex:yB,skinning_vertex:_B,skinnormal_vertex:wB,specularmap_fragment:SB,specularmap_pars_fragment:EB,tonemapping_fragment:bB,tonemapping_pars_fragment:TB,transmission_fragment:MB,transmission_pars_fragment:CB,uv_pars_fragment:AB,uv_pars_vertex:RB,uv_vertex:PB,worldpos_vertex:NB,background_vert:IB,background_frag:LB,backgroundCube_vert:DB,backgroundCube_frag:UB,cube_vert:kB,cube_frag:OB,depth_vert:FB,depth_frag:BB,distanceRGBA_vert:jB,distanceRGBA_frag:zB,equirect_vert:VB,equirect_frag:HB,linedashed_vert:GB,linedashed_frag:WB,meshbasic_vert:$B,meshbasic_frag:XB,meshlambert_vert:qB,meshlambert_frag:YB,meshmatcap_vert:KB,meshmatcap_frag:JB,meshnormal_vert:ZB,meshnormal_frag:QB,meshphong_vert:ej,meshphong_frag:tj,meshphysical_vert:nj,meshphysical_frag:rj,meshtoon_vert:ij,meshtoon_frag:sj,points_vert:oj,points_frag:aj,shadow_vert:lj,shadow_frag:cj,sprite_vert:uj,sprite_frag:dj},xe={common:{diffuse:{value:new pt(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Ke},alphaMap:{value:null},alphaMapTransform:{value:new Ke},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Ke}},envmap:{envMap:{value:null},envMapRotation:{value:new Ke},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Ke}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Ke}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Ke},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Ke},normalScale:{value:new Qe(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Ke},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Ke}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Ke}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Ke}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new pt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new pt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Ke},alphaTest:{value:0},uvTransform:{value:new Ke}},sprite:{diffuse:{value:new pt(16777215)},opacity:{value:1},center:{value:new Qe(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Ke},alphaMap:{value:null},alphaMapTransform:{value:new Ke},alphaTest:{value:0}}},Dr={basic:{uniforms:yn([xe.common,xe.specularmap,xe.envmap,xe.aomap,xe.lightmap,xe.fog]),vertexShader:Je.meshbasic_vert,fragmentShader:Je.meshbasic_frag},lambert:{uniforms:yn([xe.common,xe.specularmap,xe.envmap,xe.aomap,xe.lightmap,xe.emissivemap,xe.bumpmap,xe.normalmap,xe.displacementmap,xe.fog,xe.lights,{emissive:{value:new pt(0)}}]),vertexShader:Je.meshlambert_vert,fragmentShader:Je.meshlambert_frag},phong:{uniforms:yn([xe.common,xe.specularmap,xe.envmap,xe.aomap,xe.lightmap,xe.emissivemap,xe.bumpmap,xe.normalmap,xe.displacementmap,xe.fog,xe.lights,{emissive:{value:new pt(0)},specular:{value:new pt(1118481)},shininess:{value:30}}]),vertexShader:Je.meshphong_vert,fragmentShader:Je.meshphong_frag},standard:{uniforms:yn([xe.common,xe.envmap,xe.aomap,xe.lightmap,xe.emissivemap,xe.bumpmap,xe.normalmap,xe.displacementmap,xe.roughnessmap,xe.metalnessmap,xe.fog,xe.lights,{emissive:{value:new pt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Je.meshphysical_vert,fragmentShader:Je.meshphysical_frag},toon:{uniforms:yn([xe.common,xe.aomap,xe.lightmap,xe.emissivemap,xe.bumpmap,xe.normalmap,xe.displacementmap,xe.gradientmap,xe.fog,xe.lights,{emissive:{value:new pt(0)}}]),vertexShader:Je.meshtoon_vert,fragmentShader:Je.meshtoon_frag},matcap:{uniforms:yn([xe.common,xe.bumpmap,xe.normalmap,xe.displacementmap,xe.fog,{matcap:{value:null}}]),vertexShader:Je.meshmatcap_vert,fragmentShader:Je.meshmatcap_frag},points:{uniforms:yn([xe.points,xe.fog]),vertexShader:Je.points_vert,fragmentShader:Je.points_frag},dashed:{uniforms:yn([xe.common,xe.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Je.linedashed_vert,fragmentShader:Je.linedashed_frag},depth:{uniforms:yn([xe.common,xe.displacementmap]),vertexShader:Je.depth_vert,fragmentShader:Je.depth_frag},normal:{uniforms:yn([xe.common,xe.bumpmap,xe.normalmap,xe.displacementmap,{opacity:{value:1}}]),vertexShader:Je.meshnormal_vert,fragmentShader:Je.meshnormal_frag},sprite:{uniforms:yn([xe.sprite,xe.fog]),vertexShader:Je.sprite_vert,fragmentShader:Je.sprite_frag},background:{uniforms:{uvTransform:{value:new Ke},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Je.background_vert,fragmentShader:Je.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Ke}},vertexShader:Je.backgroundCube_vert,fragmentShader:Je.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Je.cube_vert,fragmentShader:Je.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Je.equirect_vert,fragmentShader:Je.equirect_frag},distanceRGBA:{uniforms:yn([xe.common,xe.displacementmap,{referencePosition:{value:new Z},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Je.distanceRGBA_vert,fragmentShader:Je.distanceRGBA_frag},shadow:{uniforms:yn([xe.lights,xe.fog,{color:{value:new pt(0)},opacity:{value:1}}]),vertexShader:Je.shadow_vert,fragmentShader:Je.shadow_frag}};Dr.physical={uniforms:yn([Dr.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Ke},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Ke},clearcoatNormalScale:{value:new Qe(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Ke},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Ke},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Ke},sheen:{value:0},sheenColor:{value:new pt(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Ke},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Ke},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Ke},transmissionSamplerSize:{value:new Qe},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Ke},attenuationDistance:{value:0},attenuationColor:{value:new pt(0)},specularColor:{value:new pt(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Ke},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Ke},anisotropyVector:{value:new Qe},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Ke}}]),vertexShader:Je.meshphysical_vert,fragmentShader:Je.meshphysical_frag};const pu={r:0,b:0,g:0},Ps=new vi,fj=new Kt;function hj(t,e,n,r,i,s,o){const a=new pt(0);let l=s===!0?0:1,c,u,d=null,h=0,m=null;function x(_){let w=_.isScene===!0?_.background:null;return w&&w.isTexture&&(w=(_.backgroundBlurriness>0?n:e).get(w)),w}function v(_){let w=!1;const E=x(_);E===null?p(a,l):E&&E.isColor&&(p(E,1),w=!0);const M=t.xr.getEnvironmentBlendMode();M==="additive"?r.buffers.color.setClear(0,0,0,1,o):M==="alpha-blend"&&r.buffers.color.setClear(0,0,0,0,o),(t.autoClear||w)&&(r.buffers.depth.setTest(!0),r.buffers.depth.setMask(!0),r.buffers.color.setMask(!0),t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil))}function g(_,w){const E=x(w);E&&(E.isCubeTexture||E.mapping===Cf)?(u===void 0&&(u=new Er(new vc(1,1,1),new ar({name:"BackgroundCubeMaterial",uniforms:Pa(Dr.backgroundCube.uniforms),vertexShader:Dr.backgroundCube.vertexShader,fragmentShader:Dr.backgroundCube.fragmentShader,side:nn,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(M,T,P){this.matrixWorld.copyPosition(P.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(u)),Ps.copy(w.backgroundRotation),Ps.x*=-1,Ps.y*=-1,Ps.z*=-1,E.isCubeTexture&&E.isRenderTargetTexture===!1&&(Ps.y*=-1,Ps.z*=-1),u.material.uniforms.envMap.value=E,u.material.uniforms.flipEnvMap.value=E.isCubeTexture&&E.isRenderTargetTexture===!1?-1:1,u.material.uniforms.backgroundBlurriness.value=w.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=w.backgroundIntensity,u.material.uniforms.backgroundRotation.value.setFromMatrix4(fj.makeRotationFromEuler(Ps)),u.material.toneMapped=dt.getTransfer(E.colorSpace)!==xt,(d!==E||h!==E.version||m!==t.toneMapping)&&(u.material.needsUpdate=!0,d=E,h=E.version,m=t.toneMapping),u.layers.enableAll(),_.unshift(u,u.geometry,u.material,0,0,null)):E&&E.isTexture&&(c===void 0&&(c=new Er(new xc(2,2),new ar({name:"BackgroundMaterial",uniforms:Pa(Dr.background.uniforms),vertexShader:Dr.background.vertexShader,fragmentShader:Dr.background.fragmentShader,side:gi,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(c)),c.material.uniforms.t2D.value=E,c.material.uniforms.backgroundIntensity.value=w.backgroundIntensity,c.material.toneMapped=dt.getTransfer(E.colorSpace)!==xt,E.matrixAutoUpdate===!0&&E.updateMatrix(),c.material.uniforms.uvTransform.value.copy(E.matrix),(d!==E||h!==E.version||m!==t.toneMapping)&&(c.material.needsUpdate=!0,d=E,h=E.version,m=t.toneMapping),c.layers.enableAll(),_.unshift(c,c.geometry,c.material,0,0,null))}function p(_,w){_.getRGB(pu,hM(t)),r.buffers.color.setClear(pu.r,pu.g,pu.b,w,o)}function y(){u!==void 0&&(u.geometry.dispose(),u.material.dispose(),u=void 0),c!==void 0&&(c.geometry.dispose(),c.material.dispose(),c=void 0)}return{getClearColor:function(){return a},setClearColor:function(_,w=1){a.set(_),l=w,p(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(_){l=_,p(a,l)},render:v,addToRenderList:g,dispose:y}}function pj(t,e){const n=t.getParameter(t.MAX_VERTEX_ATTRIBS),r={},i=h(null);let s=i,o=!1;function a(b,N,U,O,V){let Y=!1;const z=d(O,U,N);s!==z&&(s=z,c(s.object)),Y=m(b,O,U,V),Y&&x(b,O,U,V),V!==null&&e.update(V,t.ELEMENT_ARRAY_BUFFER),(Y||o)&&(o=!1,w(b,N,U,O),V!==null&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e.get(V).buffer))}function l(){return t.createVertexArray()}function c(b){return t.bindVertexArray(b)}function u(b){return t.deleteVertexArray(b)}function d(b,N,U){const O=U.wireframe===!0;let V=r[b.id];V===void 0&&(V={},r[b.id]=V);let Y=V[N.id];Y===void 0&&(Y={},V[N.id]=Y);let z=Y[O];return z===void 0&&(z=h(l()),Y[O]=z),z}function h(b){const N=[],U=[],O=[];for(let V=0;V<n;V++)N[V]=0,U[V]=0,O[V]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:N,enabledAttributes:U,attributeDivisors:O,object:b,attributes:{},index:null}}function m(b,N,U,O){const V=s.attributes,Y=N.attributes;let z=0;const W=U.getAttributes();for(const L in W)if(W[L].location>=0){const j=V[L];let ee=Y[L];if(ee===void 0&&(L==="instanceMatrix"&&b.instanceMatrix&&(ee=b.instanceMatrix),L==="instanceColor"&&b.instanceColor&&(ee=b.instanceColor)),j===void 0||j.attribute!==ee||ee&&j.data!==ee.data)return!0;z++}return s.attributesNum!==z||s.index!==O}function x(b,N,U,O){const V={},Y=N.attributes;let z=0;const W=U.getAttributes();for(const L in W)if(W[L].location>=0){let j=Y[L];j===void 0&&(L==="instanceMatrix"&&b.instanceMatrix&&(j=b.instanceMatrix),L==="instanceColor"&&b.instanceColor&&(j=b.instanceColor));const ee={};ee.attribute=j,j&&j.data&&(ee.data=j.data),V[L]=ee,z++}s.attributes=V,s.attributesNum=z,s.index=O}function v(){const b=s.newAttributes;for(let N=0,U=b.length;N<U;N++)b[N]=0}function g(b){p(b,0)}function p(b,N){const U=s.newAttributes,O=s.enabledAttributes,V=s.attributeDivisors;U[b]=1,O[b]===0&&(t.enableVertexAttribArray(b),O[b]=1),V[b]!==N&&(t.vertexAttribDivisor(b,N),V[b]=N)}function y(){const b=s.newAttributes,N=s.enabledAttributes;for(let U=0,O=N.length;U<O;U++)N[U]!==b[U]&&(t.disableVertexAttribArray(U),N[U]=0)}function _(b,N,U,O,V,Y,z){z===!0?t.vertexAttribIPointer(b,N,U,V,Y):t.vertexAttribPointer(b,N,U,O,V,Y)}function w(b,N,U,O){v();const V=O.attributes,Y=U.getAttributes(),z=N.defaultAttributeValues;for(const W in Y){const L=Y[W];if(L.location>=0){let H=V[W];if(H===void 0&&(W==="instanceMatrix"&&b.instanceMatrix&&(H=b.instanceMatrix),W==="instanceColor"&&b.instanceColor&&(H=b.instanceColor)),H!==void 0){const j=H.normalized,ee=H.itemSize,ve=e.get(H);if(ve===void 0)continue;const Be=ve.buffer,Ue=ve.type,Q=ve.bytesPerElement,oe=Ue===t.INT||Ue===t.UNSIGNED_INT||H.gpuType===o0;if(H.isInterleavedBufferAttribute){const X=H.data,he=X.stride,J=H.offset;if(X.isInstancedInterleavedBuffer){for(let q=0;q<L.locationSize;q++)p(L.location+q,X.meshPerAttribute);b.isInstancedMesh!==!0&&O._maxInstanceCount===void 0&&(O._maxInstanceCount=X.meshPerAttribute*X.count)}else for(let q=0;q<L.locationSize;q++)g(L.location+q);t.bindBuffer(t.ARRAY_BUFFER,Be);for(let q=0;q<L.locationSize;q++)_(L.location+q,ee/L.locationSize,Ue,j,he*Q,(J+ee/L.locationSize*q)*Q,oe)}else{if(H.isInstancedBufferAttribute){for(let X=0;X<L.locationSize;X++)p(L.location+X,H.meshPerAttribute);b.isInstancedMesh!==!0&&O._maxInstanceCount===void 0&&(O._maxInstanceCount=H.meshPerAttribute*H.count)}else for(let X=0;X<L.locationSize;X++)g(L.location+X);t.bindBuffer(t.ARRAY_BUFFER,Be);for(let X=0;X<L.locationSize;X++)_(L.location+X,ee/L.locationSize,Ue,j,ee*Q,ee/L.locationSize*X*Q,oe)}}else if(z!==void 0){const j=z[W];if(j!==void 0)switch(j.length){case 2:t.vertexAttrib2fv(L.location,j);break;case 3:t.vertexAttrib3fv(L.location,j);break;case 4:t.vertexAttrib4fv(L.location,j);break;default:t.vertexAttrib1fv(L.location,j)}}}}y()}function E(){P();for(const b in r){const N=r[b];for(const U in N){const O=N[U];for(const V in O)u(O[V].object),delete O[V];delete N[U]}delete r[b]}}function M(b){if(r[b.id]===void 0)return;const N=r[b.id];for(const U in N){const O=N[U];for(const V in O)u(O[V].object),delete O[V];delete N[U]}delete r[b.id]}function T(b){for(const N in r){const U=r[N];if(U[b.id]===void 0)continue;const O=U[b.id];for(const V in O)u(O[V].object),delete O[V];delete U[b.id]}}function P(){C(),o=!0,s!==i&&(s=i,c(s.object))}function C(){i.geometry=null,i.program=null,i.wireframe=!1}return{setup:a,reset:P,resetDefaultState:C,dispose:E,releaseStatesOfGeometry:M,releaseStatesOfProgram:T,initAttributes:v,enableAttribute:g,disableUnusedAttributes:y}}function mj(t,e,n){let r;function i(c){r=c}function s(c,u){t.drawArrays(r,c,u),n.update(u,r,1)}function o(c,u,d){d!==0&&(t.drawArraysInstanced(r,c,u,d),n.update(u,r,d))}function a(c,u,d){if(d===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(r,c,0,u,0,d);let m=0;for(let x=0;x<d;x++)m+=u[x];n.update(m,r,1)}function l(c,u,d,h){if(d===0)return;const m=e.get("WEBGL_multi_draw");if(m===null)for(let x=0;x<c.length;x++)o(c[x],u[x],h[x]);else{m.multiDrawArraysInstancedWEBGL(r,c,0,u,0,h,0,d);let x=0;for(let v=0;v<d;v++)x+=u[v]*h[v];n.update(x,r,1)}}this.setMode=i,this.render=s,this.renderInstances=o,this.renderMultiDraw=a,this.renderMultiDrawInstances=l}function gj(t,e,n,r){let i;function s(){if(i!==void 0)return i;if(e.has("EXT_texture_filter_anisotropic")===!0){const T=e.get("EXT_texture_filter_anisotropic");i=t.getParameter(T.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function o(T){return!(T!==Sr&&r.convert(T)!==t.getParameter(t.IMPLEMENTATION_COLOR_READ_FORMAT))}function a(T){const P=T===fc&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(T!==Wn&&r.convert(T)!==t.getParameter(t.IMPLEMENTATION_COLOR_READ_TYPE)&&T!==oi&&!P)}function l(T){if(T==="highp"){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";T="mediump"}return T==="mediump"&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let c=n.precision!==void 0?n.precision:"highp";const u=l(c);u!==c&&(console.warn("THREE.WebGLRenderer:",c,"not supported, using",u,"instead."),c=u);const d=n.logarithmicDepthBuffer===!0,h=n.reversedDepthBuffer===!0&&e.has("EXT_clip_control"),m=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),x=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),v=t.getParameter(t.MAX_TEXTURE_SIZE),g=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),p=t.getParameter(t.MAX_VERTEX_ATTRIBS),y=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),_=t.getParameter(t.MAX_VARYING_VECTORS),w=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),E=x>0,M=t.getParameter(t.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:s,getMaxPrecision:l,textureFormatReadable:o,textureTypeReadable:a,precision:c,logarithmicDepthBuffer:d,reversedDepthBuffer:h,maxTextures:m,maxVertexTextures:x,maxTextureSize:v,maxCubemapSize:g,maxAttributes:p,maxVertexUniforms:y,maxVaryings:_,maxFragmentUniforms:w,vertexTextures:E,maxSamples:M}}function vj(t){const e=this;let n=null,r=0,i=!1,s=!1;const o=new ks,a=new Ke,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(d,h){const m=d.length!==0||h||r!==0||i;return i=h,r=d.length,m},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(d,h){n=u(d,h,0)},this.setState=function(d,h,m){const x=d.clippingPlanes,v=d.clipIntersection,g=d.clipShadows,p=t.get(d);if(!i||x===null||x.length===0||s&&!g)s?u(null):c();else{const y=s?0:r,_=y*4;let w=p.clippingState||null;l.value=w,w=u(x,h,_,m);for(let E=0;E!==_;++E)w[E]=n[E];p.clippingState=w,this.numIntersection=v?this.numPlanes:0,this.numPlanes+=y}};function c(){l.value!==n&&(l.value=n,l.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}function u(d,h,m,x){const v=d!==null?d.length:0;let g=null;if(v!==0){if(g=l.value,x!==!0||g===null){const p=m+v*4,y=h.matrixWorldInverse;a.getNormalMatrix(y),(g===null||g.length<p)&&(g=new Float32Array(p));for(let _=0,w=m;_!==v;++_,w+=4)o.copy(d[_]).applyMatrix4(y,a),o.normal.toArray(g,w),g[w+3]=o.constant}l.value=g,l.needsUpdate=!0}return e.numPlanes=v,e.numIntersection=0,g}}function xj(t){let e=new WeakMap;function n(o,a){return a===Wm?o.mapping=Ma:a===$m&&(o.mapping=Ca),o}function r(o){if(o&&o.isTexture){const a=o.mapping;if(a===Wm||a===$m)if(e.has(o)){const l=e.get(o).texture;return n(l,o.mapping)}else{const l=o.image;if(l&&l.height>0){const c=new SF(l.height);return c.fromEquirectangularTexture(t,o),e.set(o,c),o.addEventListener("dispose",i),n(c.texture,o.mapping)}else return null}}return o}function i(o){const a=o.target;a.removeEventListener("dispose",i);const l=e.get(a);l!==void 0&&(e.delete(a),l.dispose())}function s(){e=new WeakMap}return{get:r,dispose:s}}const Ko=4,w_=[.125,.215,.35,.446,.526,.582],js=20,ep=new gM,S_=new pt;let tp=null,np=0,rp=0,ip=!1;const Os=(1+Math.sqrt(5))/2,Uo=1/Os,E_=[new Z(-Os,Uo,0),new Z(Os,Uo,0),new Z(-Uo,0,Os),new Z(Uo,0,Os),new Z(0,Os,-Uo),new Z(0,Os,Uo),new Z(-1,1,-1),new Z(1,1,-1),new Z(-1,1,1),new Z(1,1,1)],yj=new Z;class b_{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,n=0,r=.1,i=100,s={}){const{size:o=256,position:a=yj}=s;tp=this._renderer.getRenderTarget(),np=this._renderer.getActiveCubeFace(),rp=this._renderer.getActiveMipmapLevel(),ip=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(o);const l=this._allocateTargets();return l.depthBuffer=!0,this._sceneToCubeUV(e,r,i,l,a),n>0&&this._blur(l,0,0,n),this._applyPMREM(l),this._cleanup(l),l}fromEquirectangular(e,n=null){return this._fromTexture(e,n)}fromCubemap(e,n=null){return this._fromTexture(e,n)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=C_(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=M_(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(tp,np,rp),this._renderer.xr.enabled=ip,e.scissorTest=!1,mu(e,0,0,e.width,e.height)}_fromTexture(e,n){e.mapping===Ma||e.mapping===Ca?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),tp=this._renderer.getRenderTarget(),np=this._renderer.getActiveCubeFace(),rp=this._renderer.getActiveMipmapLevel(),ip=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const r=n||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),n=4*this._cubeSize,r={magFilter:mn,minFilter:mn,generateMipmaps:!1,type:fc,format:Sr,colorSpace:cs,depthBuffer:!1},i=T_(e,n,r);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==n){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=T_(e,n,r);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=_j(s)),this._blurMaterial=wj(s,e,n)}return i}_compileMaterial(e){const n=new Er(this._lodPlanes[0],e);this._renderer.compile(n,ep)}_sceneToCubeUV(e,n,r,i,s){const l=new er(90,1,n,r),c=[1,-1,1,1,1,1],u=[1,1,1,-1,-1,-1],d=this._renderer,h=d.autoClear,m=d.toneMapping;d.getClearColor(S_),d.toneMapping=Qi,d.autoClear=!1,d.state.buffers.depth.getReversed()&&(d.setRenderTarget(i),d.clearDepth(),d.setRenderTarget(null));const v=new p0({name:"PMREM.Background",side:nn,depthWrite:!1,depthTest:!1}),g=new Er(new vc,v);let p=!1;const y=e.background;y?y.isColor&&(v.color.copy(y),e.background=null,p=!0):(v.color.copy(S_),p=!0);for(let _=0;_<6;_++){const w=_%3;w===0?(l.up.set(0,c[_],0),l.position.set(s.x,s.y,s.z),l.lookAt(s.x+u[_],s.y,s.z)):w===1?(l.up.set(0,0,c[_]),l.position.set(s.x,s.y,s.z),l.lookAt(s.x,s.y+u[_],s.z)):(l.up.set(0,c[_],0),l.position.set(s.x,s.y,s.z),l.lookAt(s.x,s.y,s.z+u[_]));const E=this._cubeSize;mu(i,w*E,_>2?E:0,E,E),d.setRenderTarget(i),p&&d.render(g,l),d.render(e,l)}g.geometry.dispose(),g.material.dispose(),d.toneMapping=m,d.autoClear=h,e.background=y}_textureToCubeUV(e,n){const r=this._renderer,i=e.mapping===Ma||e.mapping===Ca;i?(this._cubemapMaterial===null&&(this._cubemapMaterial=C_()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=M_());const s=i?this._cubemapMaterial:this._equirectMaterial,o=new Er(this._lodPlanes[0],s),a=s.uniforms;a.envMap.value=e;const l=this._cubeSize;mu(n,0,0,3*l,2*l),r.setRenderTarget(n),r.render(o,ep)}_applyPMREM(e){const n=this._renderer,r=n.autoClear;n.autoClear=!1;const i=this._lodPlanes.length;for(let s=1;s<i;s++){const o=Math.sqrt(this._sigmas[s]*this._sigmas[s]-this._sigmas[s-1]*this._sigmas[s-1]),a=E_[(i-s-1)%E_.length];this._blur(e,s-1,s,o,a)}n.autoClear=r}_blur(e,n,r,i,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,n,r,i,"latitudinal",s),this._halfBlur(o,e,r,r,i,"longitudinal",s)}_halfBlur(e,n,r,i,s,o,a){const l=this._renderer,c=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const u=3,d=new Er(this._lodPlanes[i],c),h=c.uniforms,m=this._sizeLods[r]-1,x=isFinite(s)?Math.PI/(2*m):2*Math.PI/(2*js-1),v=s/x,g=isFinite(s)?1+Math.floor(u*v):js;g>js&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${g} samples when the maximum is set to ${js}`);const p=[];let y=0;for(let T=0;T<js;++T){const P=T/v,C=Math.exp(-P*P/2);p.push(C),T===0?y+=C:T<g&&(y+=2*C)}for(let T=0;T<p.length;T++)p[T]=p[T]/y;h.envMap.value=e.texture,h.samples.value=g,h.weights.value=p,h.latitudinal.value=o==="latitudinal",a&&(h.poleAxis.value=a);const{_lodMax:_}=this;h.dTheta.value=x,h.mipInt.value=_-r;const w=this._sizeLods[i],E=3*w*(i>_-Ko?i-_+Ko:0),M=4*(this._cubeSize-w);mu(n,E,M,3*w,2*w),l.setRenderTarget(n),l.render(d,ep)}}function _j(t){const e=[],n=[],r=[];let i=t;const s=t-Ko+1+w_.length;for(let o=0;o<s;o++){const a=Math.pow(2,i);n.push(a);let l=1/a;o>t-Ko?l=w_[o-t+Ko-1]:o===0&&(l=0),r.push(l);const c=1/(a-2),u=-c,d=1+c,h=[u,u,d,u,d,d,u,u,d,d,u,d],m=6,x=6,v=3,g=2,p=1,y=new Float32Array(v*x*m),_=new Float32Array(g*x*m),w=new Float32Array(p*x*m);for(let M=0;M<m;M++){const T=M%3*2/3-1,P=M>2?0:-1,C=[T,P,0,T+2/3,P,0,T+2/3,P+1,0,T,P,0,T+2/3,P+1,0,T,P+1,0];y.set(C,v*x*M),_.set(h,g*x*M);const b=[M,M,M,M,M,M];w.set(b,p*x*M)}const E=new _s;E.setAttribute("position",new rr(y,v)),E.setAttribute("uv",new rr(_,g)),E.setAttribute("faceIndex",new rr(w,p)),e.push(E),i>Ko&&i--}return{lodPlanes:e,sizeLods:n,sigmas:r}}function T_(t,e,n){const r=new Pr(t,e,n);return r.texture.mapping=Cf,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function mu(t,e,n,r,i){t.viewport.set(e,n,r,i),t.scissor.set(e,n,r,i)}function wj(t,e,n){const r=new Float32Array(js),i=new Z(0,1,0);return new ar({name:"SphericalGaussianBlur",defines:{n:js,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${t}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:v0(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:zr,depthTest:!1,depthWrite:!1})}function M_(){return new ar({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:v0(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:zr,depthTest:!1,depthWrite:!1})}function C_(){return new ar({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:v0(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:zr,depthTest:!1,depthWrite:!1})}function v0(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function Sj(t){let e=new WeakMap,n=null;function r(a){if(a&&a.isTexture){const l=a.mapping,c=l===Wm||l===$m,u=l===Ma||l===Ca;if(c||u){let d=e.get(a);const h=d!==void 0?d.texture.pmremVersion:0;if(a.isRenderTargetTexture&&a.pmremVersion!==h)return n===null&&(n=new b_(t)),d=c?n.fromEquirectangular(a,d):n.fromCubemap(a,d),d.texture.pmremVersion=a.pmremVersion,e.set(a,d),d.texture;if(d!==void 0)return d.texture;{const m=a.image;return c&&m&&m.height>0||u&&m&&i(m)?(n===null&&(n=new b_(t)),d=c?n.fromEquirectangular(a):n.fromCubemap(a),d.texture.pmremVersion=a.pmremVersion,e.set(a,d),a.addEventListener("dispose",s),d.texture):null}}}return a}function i(a){let l=0;const c=6;for(let u=0;u<c;u++)a[u]!==void 0&&l++;return l===c}function s(a){const l=a.target;l.removeEventListener("dispose",s);const c=e.get(l);c!==void 0&&(e.delete(l),c.dispose())}function o(){e=new WeakMap,n!==null&&(n.dispose(),n=null)}return{get:r,dispose:o}}function Ej(t){const e={};function n(r){if(e[r]!==void 0)return e[r];let i;switch(r){case"WEBGL_depth_texture":i=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=t.getExtension(r)}return e[r]=i,i}return{has:function(r){return n(r)!==null},init:function(){n("EXT_color_buffer_float"),n("WEBGL_clip_cull_distance"),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture"),n("WEBGL_render_shared_exponent")},get:function(r){const i=n(r);return i===null&&la("THREE.WebGLRenderer: "+r+" extension not supported."),i}}}function bj(t,e,n,r){const i={},s=new WeakMap;function o(d){const h=d.target;h.index!==null&&e.remove(h.index);for(const x in h.attributes)e.remove(h.attributes[x]);h.removeEventListener("dispose",o),delete i[h.id];const m=s.get(h);m&&(e.remove(m),s.delete(h)),r.releaseStatesOfGeometry(h),h.isInstancedBufferGeometry===!0&&delete h._maxInstanceCount,n.memory.geometries--}function a(d,h){return i[h.id]===!0||(h.addEventListener("dispose",o),i[h.id]=!0,n.memory.geometries++),h}function l(d){const h=d.attributes;for(const m in h)e.update(h[m],t.ARRAY_BUFFER)}function c(d){const h=[],m=d.index,x=d.attributes.position;let v=0;if(m!==null){const y=m.array;v=m.version;for(let _=0,w=y.length;_<w;_+=3){const E=y[_+0],M=y[_+1],T=y[_+2];h.push(E,M,M,T,T,E)}}else if(x!==void 0){const y=x.array;v=x.version;for(let _=0,w=y.length/3-1;_<w;_+=3){const E=_+0,M=_+1,T=_+2;h.push(E,M,M,T,T,E)}}else return;const g=new(aM(h)?fM:dM)(h,1);g.version=v;const p=s.get(d);p&&e.remove(p),s.set(d,g)}function u(d){const h=s.get(d);if(h){const m=d.index;m!==null&&h.version<m.version&&c(d)}else c(d);return s.get(d)}return{get:a,update:l,getWireframeAttribute:u}}function Tj(t,e,n){let r;function i(h){r=h}let s,o;function a(h){s=h.type,o=h.bytesPerElement}function l(h,m){t.drawElements(r,m,s,h*o),n.update(m,r,1)}function c(h,m,x){x!==0&&(t.drawElementsInstanced(r,m,s,h*o,x),n.update(m,r,x))}function u(h,m,x){if(x===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(r,m,0,s,h,0,x);let g=0;for(let p=0;p<x;p++)g+=m[p];n.update(g,r,1)}function d(h,m,x,v){if(x===0)return;const g=e.get("WEBGL_multi_draw");if(g===null)for(let p=0;p<h.length;p++)c(h[p]/o,m[p],v[p]);else{g.multiDrawElementsInstancedWEBGL(r,m,0,s,h,0,v,0,x);let p=0;for(let y=0;y<x;y++)p+=m[y]*v[y];n.update(p,r,1)}}this.setMode=i,this.setIndex=a,this.render=l,this.renderInstances=c,this.renderMultiDraw=u,this.renderMultiDrawInstances=d}function Mj(t){const e={geometries:0,textures:0},n={frame:0,calls:0,triangles:0,points:0,lines:0};function r(s,o,a){switch(n.calls++,o){case t.TRIANGLES:n.triangles+=a*(s/3);break;case t.LINES:n.lines+=a*(s/2);break;case t.LINE_STRIP:n.lines+=a*(s-1);break;case t.LINE_LOOP:n.lines+=a*s;break;case t.POINTS:n.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function i(){n.calls=0,n.triangles=0,n.points=0,n.lines=0}return{memory:e,render:n,programs:null,autoReset:!0,reset:i,update:r}}function Cj(t,e,n){const r=new WeakMap,i=new Ht;function s(o,a,l){const c=o.morphTargetInfluences,u=a.morphAttributes.position||a.morphAttributes.normal||a.morphAttributes.color,d=u!==void 0?u.length:0;let h=r.get(a);if(h===void 0||h.count!==d){let b=function(){P.dispose(),r.delete(a),a.removeEventListener("dispose",b)};var m=b;h!==void 0&&h.texture.dispose();const x=a.morphAttributes.position!==void 0,v=a.morphAttributes.normal!==void 0,g=a.morphAttributes.color!==void 0,p=a.morphAttributes.position||[],y=a.morphAttributes.normal||[],_=a.morphAttributes.color||[];let w=0;x===!0&&(w=1),v===!0&&(w=2),g===!0&&(w=3);let E=a.attributes.position.count*w,M=1;E>e.maxTextureSize&&(M=Math.ceil(E/e.maxTextureSize),E=e.maxTextureSize);const T=new Float32Array(E*M*4*d),P=new lM(T,E,M,d);P.type=oi,P.needsUpdate=!0;const C=w*4;for(let N=0;N<d;N++){const U=p[N],O=y[N],V=_[N],Y=E*M*4*N;for(let z=0;z<U.count;z++){const W=z*C;x===!0&&(i.fromBufferAttribute(U,z),T[Y+W+0]=i.x,T[Y+W+1]=i.y,T[Y+W+2]=i.z,T[Y+W+3]=0),v===!0&&(i.fromBufferAttribute(O,z),T[Y+W+4]=i.x,T[Y+W+5]=i.y,T[Y+W+6]=i.z,T[Y+W+7]=0),g===!0&&(i.fromBufferAttribute(V,z),T[Y+W+8]=i.x,T[Y+W+9]=i.y,T[Y+W+10]=i.z,T[Y+W+11]=V.itemSize===4?i.w:1)}}h={count:d,texture:P,size:new Qe(E,M)},r.set(a,h),a.addEventListener("dispose",b)}if(o.isInstancedMesh===!0&&o.morphTexture!==null)l.getUniforms().setValue(t,"morphTexture",o.morphTexture,n);else{let x=0;for(let g=0;g<c.length;g++)x+=c[g];const v=a.morphTargetsRelative?1:1-x;l.getUniforms().setValue(t,"morphTargetBaseInfluence",v),l.getUniforms().setValue(t,"morphTargetInfluences",c)}l.getUniforms().setValue(t,"morphTargetsTexture",h.texture,n),l.getUniforms().setValue(t,"morphTargetsTextureSize",h.size)}return{update:s}}function Aj(t,e,n,r){let i=new WeakMap;function s(l){const c=r.render.frame,u=l.geometry,d=e.get(l,u);if(i.get(d)!==c&&(e.update(d),i.set(d,c)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),i.get(l)!==c&&(n.update(l.instanceMatrix,t.ARRAY_BUFFER),l.instanceColor!==null&&n.update(l.instanceColor,t.ARRAY_BUFFER),i.set(l,c))),l.isSkinnedMesh){const h=l.skeleton;i.get(h)!==c&&(h.update(),i.set(h,c))}return d}function o(){i=new WeakMap}function a(l){const c=l.target;c.removeEventListener("dispose",a),n.remove(c.instanceMatrix),c.instanceColor!==null&&n.remove(c.instanceColor)}return{update:s,dispose:o}}const xM=new an,A_=new g0(1,1),yM=new lM,_M=new iF,wM=new pM,R_=[],P_=[],N_=new Float32Array(16),I_=new Float32Array(9),L_=new Float32Array(4);function Ha(t,e,n){const r=t[0];if(r<=0||r>0)return t;const i=e*n;let s=R_[i];if(s===void 0&&(s=new Float32Array(i),R_[i]=s),e!==0){r.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=n,t[o].toArray(s,a)}return s}function Jt(t,e){if(t.length!==e.length)return!1;for(let n=0,r=t.length;n<r;n++)if(t[n]!==e[n])return!1;return!0}function Zt(t,e){for(let n=0,r=e.length;n<r;n++)t[n]=e[n]}function Af(t,e){let n=P_[e];n===void 0&&(n=new Int32Array(e),P_[e]=n);for(let r=0;r!==e;++r)n[r]=t.allocateTextureUnit();return n}function Rj(t,e){const n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function Pj(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Jt(n,e))return;t.uniform2fv(this.addr,e),Zt(n,e)}}function Nj(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(e.r!==void 0)(n[0]!==e.r||n[1]!==e.g||n[2]!==e.b)&&(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(Jt(n,e))return;t.uniform3fv(this.addr,e),Zt(n,e)}}function Ij(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Jt(n,e))return;t.uniform4fv(this.addr,e),Zt(n,e)}}function Lj(t,e){const n=this.cache,r=e.elements;if(r===void 0){if(Jt(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),Zt(n,e)}else{if(Jt(n,r))return;L_.set(r),t.uniformMatrix2fv(this.addr,!1,L_),Zt(n,r)}}function Dj(t,e){const n=this.cache,r=e.elements;if(r===void 0){if(Jt(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),Zt(n,e)}else{if(Jt(n,r))return;I_.set(r),t.uniformMatrix3fv(this.addr,!1,I_),Zt(n,r)}}function Uj(t,e){const n=this.cache,r=e.elements;if(r===void 0){if(Jt(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),Zt(n,e)}else{if(Jt(n,r))return;N_.set(r),t.uniformMatrix4fv(this.addr,!1,N_),Zt(n,r)}}function kj(t,e){const n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function Oj(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2i(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Jt(n,e))return;t.uniform2iv(this.addr,e),Zt(n,e)}}function Fj(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3i(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(Jt(n,e))return;t.uniform3iv(this.addr,e),Zt(n,e)}}function Bj(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4i(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Jt(n,e))return;t.uniform4iv(this.addr,e),Zt(n,e)}}function jj(t,e){const n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function zj(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2ui(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Jt(n,e))return;t.uniform2uiv(this.addr,e),Zt(n,e)}}function Vj(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3ui(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(Jt(n,e))return;t.uniform3uiv(this.addr,e),Zt(n,e)}}function Hj(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4ui(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Jt(n,e))return;t.uniform4uiv(this.addr,e),Zt(n,e)}}function Gj(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i);let s;this.type===t.SAMPLER_2D_SHADOW?(A_.compareFunction=oM,s=A_):s=xM,n.setTexture2D(e||s,i)}function Wj(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(e||_M,i)}function $j(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTextureCube(e||wM,i)}function Xj(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(e||yM,i)}function qj(t){switch(t){case 5126:return Rj;case 35664:return Pj;case 35665:return Nj;case 35666:return Ij;case 35674:return Lj;case 35675:return Dj;case 35676:return Uj;case 5124:case 35670:return kj;case 35667:case 35671:return Oj;case 35668:case 35672:return Fj;case 35669:case 35673:return Bj;case 5125:return jj;case 36294:return zj;case 36295:return Vj;case 36296:return Hj;case 35678:case 36198:case 36298:case 36306:case 35682:return Gj;case 35679:case 36299:case 36307:return Wj;case 35680:case 36300:case 36308:case 36293:return $j;case 36289:case 36303:case 36311:case 36292:return Xj}}function Yj(t,e){t.uniform1fv(this.addr,e)}function Kj(t,e){const n=Ha(e,this.size,2);t.uniform2fv(this.addr,n)}function Jj(t,e){const n=Ha(e,this.size,3);t.uniform3fv(this.addr,n)}function Zj(t,e){const n=Ha(e,this.size,4);t.uniform4fv(this.addr,n)}function Qj(t,e){const n=Ha(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function ez(t,e){const n=Ha(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function tz(t,e){const n=Ha(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function nz(t,e){t.uniform1iv(this.addr,e)}function rz(t,e){t.uniform2iv(this.addr,e)}function iz(t,e){t.uniform3iv(this.addr,e)}function sz(t,e){t.uniform4iv(this.addr,e)}function oz(t,e){t.uniform1uiv(this.addr,e)}function az(t,e){t.uniform2uiv(this.addr,e)}function lz(t,e){t.uniform3uiv(this.addr,e)}function cz(t,e){t.uniform4uiv(this.addr,e)}function uz(t,e,n){const r=this.cache,i=e.length,s=Af(n,i);Jt(r,s)||(t.uniform1iv(this.addr,s),Zt(r,s));for(let o=0;o!==i;++o)n.setTexture2D(e[o]||xM,s[o])}function dz(t,e,n){const r=this.cache,i=e.length,s=Af(n,i);Jt(r,s)||(t.uniform1iv(this.addr,s),Zt(r,s));for(let o=0;o!==i;++o)n.setTexture3D(e[o]||_M,s[o])}function fz(t,e,n){const r=this.cache,i=e.length,s=Af(n,i);Jt(r,s)||(t.uniform1iv(this.addr,s),Zt(r,s));for(let o=0;o!==i;++o)n.setTextureCube(e[o]||wM,s[o])}function hz(t,e,n){const r=this.cache,i=e.length,s=Af(n,i);Jt(r,s)||(t.uniform1iv(this.addr,s),Zt(r,s));for(let o=0;o!==i;++o)n.setTexture2DArray(e[o]||yM,s[o])}function pz(t){switch(t){case 5126:return Yj;case 35664:return Kj;case 35665:return Jj;case 35666:return Zj;case 35674:return Qj;case 35675:return ez;case 35676:return tz;case 5124:case 35670:return nz;case 35667:case 35671:return rz;case 35668:case 35672:return iz;case 35669:case 35673:return sz;case 5125:return oz;case 36294:return az;case 36295:return lz;case 36296:return cz;case 35678:case 36198:case 36298:case 36306:case 35682:return uz;case 35679:case 36299:case 36307:return dz;case 35680:case 36300:case 36308:case 36293:return fz;case 36289:case 36303:case 36311:case 36292:return hz}}class mz{constructor(e,n,r){this.id=e,this.addr=r,this.cache=[],this.type=n.type,this.setValue=qj(n.type)}}class gz{constructor(e,n,r){this.id=e,this.addr=r,this.cache=[],this.type=n.type,this.size=n.size,this.setValue=pz(n.type)}}class vz{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,n,r){const i=this.seq;for(let s=0,o=i.length;s!==o;++s){const a=i[s];a.setValue(e,n[a.id],r)}}}const sp=/(\w+)(\])?(\[|\.)?/g;function D_(t,e){t.seq.push(e),t.map[e.id]=e}function xz(t,e,n){const r=t.name,i=r.length;for(sp.lastIndex=0;;){const s=sp.exec(r),o=sp.lastIndex;let a=s[1];const l=s[2]==="]",c=s[3];if(l&&(a=a|0),c===void 0||c==="["&&o+2===i){D_(n,c===void 0?new mz(a,t,e):new gz(a,t,e));break}else{let d=n.map[a];d===void 0&&(d=new vz(a),D_(n,d)),n=d}}}class ju{constructor(e,n){this.seq=[],this.map={};const r=e.getProgramParameter(n,e.ACTIVE_UNIFORMS);for(let i=0;i<r;++i){const s=e.getActiveUniform(n,i),o=e.getUniformLocation(n,s.name);xz(s,o,this)}}setValue(e,n,r,i){const s=this.map[n];s!==void 0&&s.setValue(e,r,i)}setOptional(e,n,r){const i=n[r];i!==void 0&&this.setValue(e,r,i)}static upload(e,n,r,i){for(let s=0,o=n.length;s!==o;++s){const a=n[s],l=r[a.id];l.needsUpdate!==!1&&a.setValue(e,l.value,i)}}static seqWithValue(e,n){const r=[];for(let i=0,s=e.length;i!==s;++i){const o=e[i];o.id in n&&r.push(o)}return r}}function U_(t,e,n){const r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),r}const yz=37297;let _z=0;function wz(t,e){const n=t.split(`
`),r=[],i=Math.max(e-6,0),s=Math.min(e+6,n.length);for(let o=i;o<s;o++){const a=o+1;r.push(`${a===e?">":" "} ${a}: ${n[o]}`)}return r.join(`
`)}const k_=new Ke;function Sz(t){dt._getMatrix(k_,dt.workingColorSpace,t);const e=`mat3( ${k_.elements.map(n=>n.toFixed(4))} )`;switch(dt.getTransfer(t)){case Md:return[e,"LinearTransferOETF"];case xt:return[e,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",t),[e,"LinearTransferOETF"]}}function O_(t,e,n){const r=t.getShaderParameter(e,t.COMPILE_STATUS),s=(t.getShaderInfoLog(e)||"").trim();if(r&&s==="")return"";const o=/ERROR: 0:(\d+)/.exec(s);if(o){const a=parseInt(o[1]);return n.toUpperCase()+`

`+s+`

`+wz(t.getShaderSource(e),a)}else return s}function Ez(t,e){const n=Sz(e);return[`vec4 ${t}( vec4 value ) {`,`	return ${n[1]}( vec4( value.rgb * ${n[0]}, value.a ) );`,"}"].join(`
`)}function bz(t,e){let n;switch(e){case IO:n="Linear";break;case LO:n="Reinhard";break;case DO:n="Cineon";break;case UO:n="ACESFilmic";break;case OO:n="AgX";break;case FO:n="Neutral";break;case kO:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),n="Linear"}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}const gu=new Z;function Tz(){dt.getLuminanceCoefficients(gu);const t=gu.x.toFixed(4),e=gu.y.toFixed(4),n=gu.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${t}, ${e}, ${n} );`,"	return dot( weights, rgb );","}"].join(`
`)}function Mz(t){return[t.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",t.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(ml).join(`
`)}function Cz(t){const e=[];for(const n in t){const r=t[n];r!==!1&&e.push("#define "+n+" "+r)}return e.join(`
`)}function Az(t,e){const n={},r=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let i=0;i<r;i++){const s=t.getActiveAttrib(e,i),o=s.name;let a=1;s.type===t.FLOAT_MAT2&&(a=2),s.type===t.FLOAT_MAT3&&(a=3),s.type===t.FLOAT_MAT4&&(a=4),n[o]={type:s.type,location:t.getAttribLocation(e,o),locationSize:a}}return n}function ml(t){return t!==""}function F_(t,e){const n=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function B_(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const Rz=/^[ \t]*#include +<([\w\d./]+)>/gm;function bg(t){return t.replace(Rz,Nz)}const Pz=new Map;function Nz(t,e){let n=Je[e];if(n===void 0){const r=Pz.get(e);if(r!==void 0)n=Je[r],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,r);else throw new Error("Can not resolve #include <"+e+">")}return bg(n)}const Iz=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function j_(t){return t.replace(Iz,Lz)}function Lz(t,e,n,r){let i="";for(let s=parseInt(e);s<parseInt(n);s++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return i}function z_(t){let e=`precision ${t.precision} float;
	precision ${t.precision} int;
	precision ${t.precision} sampler2D;
	precision ${t.precision} samplerCube;
	precision ${t.precision} sampler3D;
	precision ${t.precision} sampler2DArray;
	precision ${t.precision} sampler2DShadow;
	precision ${t.precision} samplerCubeShadow;
	precision ${t.precision} sampler2DArrayShadow;
	precision ${t.precision} isampler2D;
	precision ${t.precision} isampler3D;
	precision ${t.precision} isamplerCube;
	precision ${t.precision} isampler2DArray;
	precision ${t.precision} usampler2D;
	precision ${t.precision} usampler3D;
	precision ${t.precision} usamplerCube;
	precision ${t.precision} usampler2DArray;
	`;return t.precision==="highp"?e+=`
#define HIGH_PRECISION`:t.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:t.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function Dz(t){let e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===YT?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===dO?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===ei&&(e="SHADOWMAP_TYPE_VSM"),e}function Uz(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case Ma:case Ca:e="ENVMAP_TYPE_CUBE";break;case Cf:e="ENVMAP_TYPE_CUBE_UV";break}return e}function kz(t){let e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case Ca:e="ENVMAP_MODE_REFRACTION";break}return e}function Oz(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case KT:e="ENVMAP_BLENDING_MULTIPLY";break;case PO:e="ENVMAP_BLENDING_MIX";break;case NO:e="ENVMAP_BLENDING_ADD";break}return e}function Fz(t){const e=t.envMapCubeUVHeight;if(e===null)return null;const n=Math.log2(e)-2,r=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,n),7*16)),texelHeight:r,maxMip:n}}function Bz(t,e,n,r){const i=t.getContext(),s=n.defines;let o=n.vertexShader,a=n.fragmentShader;const l=Dz(n),c=Uz(n),u=kz(n),d=Oz(n),h=Fz(n),m=Mz(n),x=Cz(s),v=i.createProgram();let g,p,y=n.glslVersion?"#version "+n.glslVersion+`
`:"";n.isRawShaderMaterial?(g=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,x].filter(ml).join(`
`),g.length>0&&(g+=`
`),p=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,x].filter(ml).join(`
`),p.length>0&&(p+=`
`)):(g=[z_(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,x,n.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",n.batching?"#define USE_BATCHING":"",n.batchingColor?"#define USE_BATCHING_COLOR":"",n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.instancingMorph?"#define USE_INSTANCING_MORPH":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+u:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&n.flatShading===!1?"#define USE_MORPHNORMALS":"",n.morphColors?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.reversedDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(ml).join(`
`),p=[z_(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,x,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+c:"",n.envMap?"#define "+u:"",n.envMap?"#define "+d:"",h?"#define CUBEUV_TEXEL_WIDTH "+h.texelWidth:"",h?"#define CUBEUV_TEXEL_HEIGHT "+h.texelHeight:"",h?"#define CUBEUV_MAX_MIP "+h.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.dispersion?"#define USE_DISPERSION":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor||n.batchingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.reversedDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==Qi?"#define TONE_MAPPING":"",n.toneMapping!==Qi?Je.tonemapping_pars_fragment:"",n.toneMapping!==Qi?bz("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",Je.colorspace_pars_fragment,Ez("linearToOutputTexel",n.outputColorSpace),Tz(),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"",`
`].filter(ml).join(`
`)),o=bg(o),o=F_(o,n),o=B_(o,n),a=bg(a),a=F_(a,n),a=B_(a,n),o=j_(o),a=j_(a),n.isRawShaderMaterial!==!0&&(y=`#version 300 es
`,g=[m,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+g,p=["#define varying in",n.glslVersion===wg?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===wg?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+p);const _=y+g+o,w=y+p+a,E=U_(i,i.VERTEX_SHADER,_),M=U_(i,i.FRAGMENT_SHADER,w);i.attachShader(v,E),i.attachShader(v,M),n.index0AttributeName!==void 0?i.bindAttribLocation(v,0,n.index0AttributeName):n.morphTargets===!0&&i.bindAttribLocation(v,0,"position"),i.linkProgram(v);function T(N){if(t.debug.checkShaderErrors){const U=i.getProgramInfoLog(v)||"",O=i.getShaderInfoLog(E)||"",V=i.getShaderInfoLog(M)||"",Y=U.trim(),z=O.trim(),W=V.trim();let L=!0,H=!0;if(i.getProgramParameter(v,i.LINK_STATUS)===!1)if(L=!1,typeof t.debug.onShaderError=="function")t.debug.onShaderError(i,v,E,M);else{const j=O_(i,E,"vertex"),ee=O_(i,M,"fragment");console.error("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(v,i.VALIDATE_STATUS)+`

Material Name: `+N.name+`
Material Type: `+N.type+`

Program Info Log: `+Y+`
`+j+`
`+ee)}else Y!==""?console.warn("THREE.WebGLProgram: Program Info Log:",Y):(z===""||W==="")&&(H=!1);H&&(N.diagnostics={runnable:L,programLog:Y,vertexShader:{log:z,prefix:g},fragmentShader:{log:W,prefix:p}})}i.deleteShader(E),i.deleteShader(M),P=new ju(i,v),C=Az(i,v)}let P;this.getUniforms=function(){return P===void 0&&T(this),P};let C;this.getAttributes=function(){return C===void 0&&T(this),C};let b=n.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return b===!1&&(b=i.getProgramParameter(v,yz)),b},this.destroy=function(){r.releaseStatesOfProgram(this),i.deleteProgram(v),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=_z++,this.cacheKey=e,this.usedTimes=1,this.program=v,this.vertexShader=E,this.fragmentShader=M,this}let jz=0;class zz{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const n=e.vertexShader,r=e.fragmentShader,i=this._getShaderStage(n),s=this._getShaderStage(r),o=this._getShaderCacheForMaterial(e);return o.has(i)===!1&&(o.add(i),i.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(e){const n=this.materialCache.get(e);for(const r of n)r.usedTimes--,r.usedTimes===0&&this.shaderCache.delete(r.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const n=this.materialCache;let r=n.get(e);return r===void 0&&(r=new Set,n.set(e,r)),r}_getShaderStage(e){const n=this.shaderCache;let r=n.get(e);return r===void 0&&(r=new Vz(e),n.set(e,r)),r}}class Vz{constructor(e){this.id=jz++,this.code=e,this.usedTimes=0}}function Hz(t,e,n,r,i,s,o){const a=new cM,l=new zz,c=new Set,u=[],d=i.logarithmicDepthBuffer,h=i.vertexTextures;let m=i.precision;const x={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function v(C){return c.add(C),C===0?"uv":`uv${C}`}function g(C,b,N,U,O){const V=U.fog,Y=O.geometry,z=C.isMeshStandardMaterial?U.environment:null,W=(C.isMeshStandardMaterial?n:e).get(C.envMap||z),L=W&&W.mapping===Cf?W.image.height:null,H=x[C.type];C.precision!==null&&(m=i.getMaxPrecision(C.precision),m!==C.precision&&console.warn("THREE.WebGLProgram.getParameters:",C.precision,"not supported, using",m,"instead."));const j=Y.morphAttributes.position||Y.morphAttributes.normal||Y.morphAttributes.color,ee=j!==void 0?j.length:0;let ve=0;Y.morphAttributes.position!==void 0&&(ve=1),Y.morphAttributes.normal!==void 0&&(ve=2),Y.morphAttributes.color!==void 0&&(ve=3);let Be,Ue,Q,oe;if(H){const ht=Dr[H];Be=ht.vertexShader,Ue=ht.fragmentShader}else Be=C.vertexShader,Ue=C.fragmentShader,l.update(C),Q=l.getVertexShaderID(C),oe=l.getFragmentShaderID(C);const X=t.getRenderTarget(),he=t.state.buffers.depth.getReversed(),J=O.isInstancedMesh===!0,q=O.isBatchedMesh===!0,re=!!C.map,ie=!!C.matcap,I=!!W,be=!!C.aoMap,Ee=!!C.lightMap,He=!!C.bumpMap,Me=!!C.normalMap,it=!!C.displacementMap,ge=!!C.emissiveMap,_e=!!C.metalnessMap,Ve=!!C.roughnessMap,et=C.anisotropy>0,D=C.clearcoat>0,A=C.dispersion>0,G=C.iridescence>0,ne=C.sheen>0,ae=C.transmission>0,te=et&&!!C.anisotropyMap,De=D&&!!C.clearcoatMap,pe=D&&!!C.clearcoatNormalMap,Ne=D&&!!C.clearcoatRoughnessMap,Ie=G&&!!C.iridescenceMap,de=G&&!!C.iridescenceThicknessMap,Se=ne&&!!C.sheenColorMap,je=ne&&!!C.sheenRoughnessMap,Le=!!C.specularMap,ye=!!C.specularColorMap,qe=!!C.specularIntensityMap,k=ae&&!!C.transmissionMap,fe=ae&&!!C.thicknessMap,me=!!C.gradientMap,Ae=!!C.alphaMap,ce=C.alphaTest>0,se=!!C.alphaHash,Pe=!!C.extensions;let Ge=Qi;C.toneMapped&&(X===null||X.isXRRenderTarget===!0)&&(Ge=t.toneMapping);const St={shaderID:H,shaderType:C.type,shaderName:C.name,vertexShader:Be,fragmentShader:Ue,defines:C.defines,customVertexShaderID:Q,customFragmentShaderID:oe,isRawShaderMaterial:C.isRawShaderMaterial===!0,glslVersion:C.glslVersion,precision:m,batching:q,batchingColor:q&&O._colorsTexture!==null,instancing:J,instancingColor:J&&O.instanceColor!==null,instancingMorph:J&&O.morphTexture!==null,supportsVertexTextures:h,outputColorSpace:X===null?t.outputColorSpace:X.isXRRenderTarget===!0?X.texture.colorSpace:cs,alphaToCoverage:!!C.alphaToCoverage,map:re,matcap:ie,envMap:I,envMapMode:I&&W.mapping,envMapCubeUVHeight:L,aoMap:be,lightMap:Ee,bumpMap:He,normalMap:Me,displacementMap:h&&it,emissiveMap:ge,normalMapObjectSpace:Me&&C.normalMapType===VO,normalMapTangentSpace:Me&&C.normalMapType===zO,metalnessMap:_e,roughnessMap:Ve,anisotropy:et,anisotropyMap:te,clearcoat:D,clearcoatMap:De,clearcoatNormalMap:pe,clearcoatRoughnessMap:Ne,dispersion:A,iridescence:G,iridescenceMap:Ie,iridescenceThicknessMap:de,sheen:ne,sheenColorMap:Se,sheenRoughnessMap:je,specularMap:Le,specularColorMap:ye,specularIntensityMap:qe,transmission:ae,transmissionMap:k,thicknessMap:fe,gradientMap:me,opaque:C.transparent===!1&&C.blending===aa&&C.alphaToCoverage===!1,alphaMap:Ae,alphaTest:ce,alphaHash:se,combine:C.combine,mapUv:re&&v(C.map.channel),aoMapUv:be&&v(C.aoMap.channel),lightMapUv:Ee&&v(C.lightMap.channel),bumpMapUv:He&&v(C.bumpMap.channel),normalMapUv:Me&&v(C.normalMap.channel),displacementMapUv:it&&v(C.displacementMap.channel),emissiveMapUv:ge&&v(C.emissiveMap.channel),metalnessMapUv:_e&&v(C.metalnessMap.channel),roughnessMapUv:Ve&&v(C.roughnessMap.channel),anisotropyMapUv:te&&v(C.anisotropyMap.channel),clearcoatMapUv:De&&v(C.clearcoatMap.channel),clearcoatNormalMapUv:pe&&v(C.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Ne&&v(C.clearcoatRoughnessMap.channel),iridescenceMapUv:Ie&&v(C.iridescenceMap.channel),iridescenceThicknessMapUv:de&&v(C.iridescenceThicknessMap.channel),sheenColorMapUv:Se&&v(C.sheenColorMap.channel),sheenRoughnessMapUv:je&&v(C.sheenRoughnessMap.channel),specularMapUv:Le&&v(C.specularMap.channel),specularColorMapUv:ye&&v(C.specularColorMap.channel),specularIntensityMapUv:qe&&v(C.specularIntensityMap.channel),transmissionMapUv:k&&v(C.transmissionMap.channel),thicknessMapUv:fe&&v(C.thicknessMap.channel),alphaMapUv:Ae&&v(C.alphaMap.channel),vertexTangents:!!Y.attributes.tangent&&(Me||et),vertexColors:C.vertexColors,vertexAlphas:C.vertexColors===!0&&!!Y.attributes.color&&Y.attributes.color.itemSize===4,pointsUvs:O.isPoints===!0&&!!Y.attributes.uv&&(re||Ae),fog:!!V,useFog:C.fog===!0,fogExp2:!!V&&V.isFogExp2,flatShading:C.flatShading===!0&&C.wireframe===!1,sizeAttenuation:C.sizeAttenuation===!0,logarithmicDepthBuffer:d,reversedDepthBuffer:he,skinning:O.isSkinnedMesh===!0,morphTargets:Y.morphAttributes.position!==void 0,morphNormals:Y.morphAttributes.normal!==void 0,morphColors:Y.morphAttributes.color!==void 0,morphTargetsCount:ee,morphTextureStride:ve,numDirLights:b.directional.length,numPointLights:b.point.length,numSpotLights:b.spot.length,numSpotLightMaps:b.spotLightMap.length,numRectAreaLights:b.rectArea.length,numHemiLights:b.hemi.length,numDirLightShadows:b.directionalShadowMap.length,numPointLightShadows:b.pointShadowMap.length,numSpotLightShadows:b.spotShadowMap.length,numSpotLightShadowsWithMaps:b.numSpotLightShadowsWithMaps,numLightProbes:b.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:C.dithering,shadowMapEnabled:t.shadowMap.enabled&&N.length>0,shadowMapType:t.shadowMap.type,toneMapping:Ge,decodeVideoTexture:re&&C.map.isVideoTexture===!0&&dt.getTransfer(C.map.colorSpace)===xt,decodeVideoTextureEmissive:ge&&C.emissiveMap.isVideoTexture===!0&&dt.getTransfer(C.emissiveMap.colorSpace)===xt,premultipliedAlpha:C.premultipliedAlpha,doubleSided:C.side===Bn,flipSided:C.side===nn,useDepthPacking:C.depthPacking>=0,depthPacking:C.depthPacking||0,index0AttributeName:C.index0AttributeName,extensionClipCullDistance:Pe&&C.extensions.clipCullDistance===!0&&r.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(Pe&&C.extensions.multiDraw===!0||q)&&r.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:r.has("KHR_parallel_shader_compile"),customProgramCacheKey:C.customProgramCacheKey()};return St.vertexUv1s=c.has(1),St.vertexUv2s=c.has(2),St.vertexUv3s=c.has(3),c.clear(),St}function p(C){const b=[];if(C.shaderID?b.push(C.shaderID):(b.push(C.customVertexShaderID),b.push(C.customFragmentShaderID)),C.defines!==void 0)for(const N in C.defines)b.push(N),b.push(C.defines[N]);return C.isRawShaderMaterial===!1&&(y(b,C),_(b,C),b.push(t.outputColorSpace)),b.push(C.customProgramCacheKey),b.join()}function y(C,b){C.push(b.precision),C.push(b.outputColorSpace),C.push(b.envMapMode),C.push(b.envMapCubeUVHeight),C.push(b.mapUv),C.push(b.alphaMapUv),C.push(b.lightMapUv),C.push(b.aoMapUv),C.push(b.bumpMapUv),C.push(b.normalMapUv),C.push(b.displacementMapUv),C.push(b.emissiveMapUv),C.push(b.metalnessMapUv),C.push(b.roughnessMapUv),C.push(b.anisotropyMapUv),C.push(b.clearcoatMapUv),C.push(b.clearcoatNormalMapUv),C.push(b.clearcoatRoughnessMapUv),C.push(b.iridescenceMapUv),C.push(b.iridescenceThicknessMapUv),C.push(b.sheenColorMapUv),C.push(b.sheenRoughnessMapUv),C.push(b.specularMapUv),C.push(b.specularColorMapUv),C.push(b.specularIntensityMapUv),C.push(b.transmissionMapUv),C.push(b.thicknessMapUv),C.push(b.combine),C.push(b.fogExp2),C.push(b.sizeAttenuation),C.push(b.morphTargetsCount),C.push(b.morphAttributeCount),C.push(b.numDirLights),C.push(b.numPointLights),C.push(b.numSpotLights),C.push(b.numSpotLightMaps),C.push(b.numHemiLights),C.push(b.numRectAreaLights),C.push(b.numDirLightShadows),C.push(b.numPointLightShadows),C.push(b.numSpotLightShadows),C.push(b.numSpotLightShadowsWithMaps),C.push(b.numLightProbes),C.push(b.shadowMapType),C.push(b.toneMapping),C.push(b.numClippingPlanes),C.push(b.numClipIntersection),C.push(b.depthPacking)}function _(C,b){a.disableAll(),b.supportsVertexTextures&&a.enable(0),b.instancing&&a.enable(1),b.instancingColor&&a.enable(2),b.instancingMorph&&a.enable(3),b.matcap&&a.enable(4),b.envMap&&a.enable(5),b.normalMapObjectSpace&&a.enable(6),b.normalMapTangentSpace&&a.enable(7),b.clearcoat&&a.enable(8),b.iridescence&&a.enable(9),b.alphaTest&&a.enable(10),b.vertexColors&&a.enable(11),b.vertexAlphas&&a.enable(12),b.vertexUv1s&&a.enable(13),b.vertexUv2s&&a.enable(14),b.vertexUv3s&&a.enable(15),b.vertexTangents&&a.enable(16),b.anisotropy&&a.enable(17),b.alphaHash&&a.enable(18),b.batching&&a.enable(19),b.dispersion&&a.enable(20),b.batchingColor&&a.enable(21),b.gradientMap&&a.enable(22),C.push(a.mask),a.disableAll(),b.fog&&a.enable(0),b.useFog&&a.enable(1),b.flatShading&&a.enable(2),b.logarithmicDepthBuffer&&a.enable(3),b.reversedDepthBuffer&&a.enable(4),b.skinning&&a.enable(5),b.morphTargets&&a.enable(6),b.morphNormals&&a.enable(7),b.morphColors&&a.enable(8),b.premultipliedAlpha&&a.enable(9),b.shadowMapEnabled&&a.enable(10),b.doubleSided&&a.enable(11),b.flipSided&&a.enable(12),b.useDepthPacking&&a.enable(13),b.dithering&&a.enable(14),b.transmission&&a.enable(15),b.sheen&&a.enable(16),b.opaque&&a.enable(17),b.pointsUvs&&a.enable(18),b.decodeVideoTexture&&a.enable(19),b.decodeVideoTextureEmissive&&a.enable(20),b.alphaToCoverage&&a.enable(21),C.push(a.mask)}function w(C){const b=x[C.type];let N;if(b){const U=Dr[b];N=xF.clone(U.uniforms)}else N=C.uniforms;return N}function E(C,b){let N;for(let U=0,O=u.length;U<O;U++){const V=u[U];if(V.cacheKey===b){N=V,++N.usedTimes;break}}return N===void 0&&(N=new Bz(t,b,C,s),u.push(N)),N}function M(C){if(--C.usedTimes===0){const b=u.indexOf(C);u[b]=u[u.length-1],u.pop(),C.destroy()}}function T(C){l.remove(C)}function P(){l.dispose()}return{getParameters:g,getProgramCacheKey:p,getUniforms:w,acquireProgram:E,releaseProgram:M,releaseShaderCache:T,programs:u,dispose:P}}function Gz(){let t=new WeakMap;function e(o){return t.has(o)}function n(o){let a=t.get(o);return a===void 0&&(a={},t.set(o,a)),a}function r(o){t.delete(o)}function i(o,a,l){t.get(o)[a]=l}function s(){t=new WeakMap}return{has:e,get:n,remove:r,update:i,dispose:s}}function Wz(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function V_(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function H_(){const t=[];let e=0;const n=[],r=[],i=[];function s(){e=0,n.length=0,r.length=0,i.length=0}function o(d,h,m,x,v,g){let p=t[e];return p===void 0?(p={id:d.id,object:d,geometry:h,material:m,groupOrder:x,renderOrder:d.renderOrder,z:v,group:g},t[e]=p):(p.id=d.id,p.object=d,p.geometry=h,p.material=m,p.groupOrder=x,p.renderOrder=d.renderOrder,p.z=v,p.group=g),e++,p}function a(d,h,m,x,v,g){const p=o(d,h,m,x,v,g);m.transmission>0?r.push(p):m.transparent===!0?i.push(p):n.push(p)}function l(d,h,m,x,v,g){const p=o(d,h,m,x,v,g);m.transmission>0?r.unshift(p):m.transparent===!0?i.unshift(p):n.unshift(p)}function c(d,h){n.length>1&&n.sort(d||Wz),r.length>1&&r.sort(h||V_),i.length>1&&i.sort(h||V_)}function u(){for(let d=e,h=t.length;d<h;d++){const m=t[d];if(m.id===null)break;m.id=null,m.object=null,m.geometry=null,m.material=null,m.group=null}}return{opaque:n,transmissive:r,transparent:i,init:s,push:a,unshift:l,finish:u,sort:c}}function $z(){let t=new WeakMap;function e(r,i){const s=t.get(r);let o;return s===void 0?(o=new H_,t.set(r,[o])):i>=s.length?(o=new H_,s.push(o)):o=s[i],o}function n(){t=new WeakMap}return{get:e,dispose:n}}function Xz(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new Z,color:new pt};break;case"SpotLight":n={position:new Z,direction:new Z,color:new pt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new Z,color:new pt,distance:0,decay:0};break;case"HemisphereLight":n={direction:new Z,skyColor:new pt,groundColor:new pt};break;case"RectAreaLight":n={color:new pt,position:new Z,halfWidth:new Z,halfHeight:new Z};break}return t[e.id]=n,n}}}function qz(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Qe};break;case"SpotLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Qe};break;case"PointLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Qe,shadowCameraNear:1,shadowCameraFar:1e3};break}return t[e.id]=n,n}}}let Yz=0;function Kz(t,e){return(e.castShadow?2:0)-(t.castShadow?2:0)+(e.map?1:0)-(t.map?1:0)}function Jz(t){const e=new Xz,n=qz(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let c=0;c<9;c++)r.probe.push(new Z);const i=new Z,s=new Kt,o=new Kt;function a(c){let u=0,d=0,h=0;for(let C=0;C<9;C++)r.probe[C].set(0,0,0);let m=0,x=0,v=0,g=0,p=0,y=0,_=0,w=0,E=0,M=0,T=0;c.sort(Kz);for(let C=0,b=c.length;C<b;C++){const N=c[C],U=N.color,O=N.intensity,V=N.distance,Y=N.shadow&&N.shadow.map?N.shadow.map.texture:null;if(N.isAmbientLight)u+=U.r*O,d+=U.g*O,h+=U.b*O;else if(N.isLightProbe){for(let z=0;z<9;z++)r.probe[z].addScaledVector(N.sh.coefficients[z],O);T++}else if(N.isDirectionalLight){const z=e.get(N);if(z.color.copy(N.color).multiplyScalar(N.intensity),N.castShadow){const W=N.shadow,L=n.get(N);L.shadowIntensity=W.intensity,L.shadowBias=W.bias,L.shadowNormalBias=W.normalBias,L.shadowRadius=W.radius,L.shadowMapSize=W.mapSize,r.directionalShadow[m]=L,r.directionalShadowMap[m]=Y,r.directionalShadowMatrix[m]=N.shadow.matrix,y++}r.directional[m]=z,m++}else if(N.isSpotLight){const z=e.get(N);z.position.setFromMatrixPosition(N.matrixWorld),z.color.copy(U).multiplyScalar(O),z.distance=V,z.coneCos=Math.cos(N.angle),z.penumbraCos=Math.cos(N.angle*(1-N.penumbra)),z.decay=N.decay,r.spot[v]=z;const W=N.shadow;if(N.map&&(r.spotLightMap[E]=N.map,E++,W.updateMatrices(N),N.castShadow&&M++),r.spotLightMatrix[v]=W.matrix,N.castShadow){const L=n.get(N);L.shadowIntensity=W.intensity,L.shadowBias=W.bias,L.shadowNormalBias=W.normalBias,L.shadowRadius=W.radius,L.shadowMapSize=W.mapSize,r.spotShadow[v]=L,r.spotShadowMap[v]=Y,w++}v++}else if(N.isRectAreaLight){const z=e.get(N);z.color.copy(U).multiplyScalar(O),z.halfWidth.set(N.width*.5,0,0),z.halfHeight.set(0,N.height*.5,0),r.rectArea[g]=z,g++}else if(N.isPointLight){const z=e.get(N);if(z.color.copy(N.color).multiplyScalar(N.intensity),z.distance=N.distance,z.decay=N.decay,N.castShadow){const W=N.shadow,L=n.get(N);L.shadowIntensity=W.intensity,L.shadowBias=W.bias,L.shadowNormalBias=W.normalBias,L.shadowRadius=W.radius,L.shadowMapSize=W.mapSize,L.shadowCameraNear=W.camera.near,L.shadowCameraFar=W.camera.far,r.pointShadow[x]=L,r.pointShadowMap[x]=Y,r.pointShadowMatrix[x]=N.shadow.matrix,_++}r.point[x]=z,x++}else if(N.isHemisphereLight){const z=e.get(N);z.skyColor.copy(N.color).multiplyScalar(O),z.groundColor.copy(N.groundColor).multiplyScalar(O),r.hemi[p]=z,p++}}g>0&&(t.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=xe.LTC_FLOAT_1,r.rectAreaLTC2=xe.LTC_FLOAT_2):(r.rectAreaLTC1=xe.LTC_HALF_1,r.rectAreaLTC2=xe.LTC_HALF_2)),r.ambient[0]=u,r.ambient[1]=d,r.ambient[2]=h;const P=r.hash;(P.directionalLength!==m||P.pointLength!==x||P.spotLength!==v||P.rectAreaLength!==g||P.hemiLength!==p||P.numDirectionalShadows!==y||P.numPointShadows!==_||P.numSpotShadows!==w||P.numSpotMaps!==E||P.numLightProbes!==T)&&(r.directional.length=m,r.spot.length=v,r.rectArea.length=g,r.point.length=x,r.hemi.length=p,r.directionalShadow.length=y,r.directionalShadowMap.length=y,r.pointShadow.length=_,r.pointShadowMap.length=_,r.spotShadow.length=w,r.spotShadowMap.length=w,r.directionalShadowMatrix.length=y,r.pointShadowMatrix.length=_,r.spotLightMatrix.length=w+E-M,r.spotLightMap.length=E,r.numSpotLightShadowsWithMaps=M,r.numLightProbes=T,P.directionalLength=m,P.pointLength=x,P.spotLength=v,P.rectAreaLength=g,P.hemiLength=p,P.numDirectionalShadows=y,P.numPointShadows=_,P.numSpotShadows=w,P.numSpotMaps=E,P.numLightProbes=T,r.version=Yz++)}function l(c,u){let d=0,h=0,m=0,x=0,v=0;const g=u.matrixWorldInverse;for(let p=0,y=c.length;p<y;p++){const _=c[p];if(_.isDirectionalLight){const w=r.directional[d];w.direction.setFromMatrixPosition(_.matrixWorld),i.setFromMatrixPosition(_.target.matrixWorld),w.direction.sub(i),w.direction.transformDirection(g),d++}else if(_.isSpotLight){const w=r.spot[m];w.position.setFromMatrixPosition(_.matrixWorld),w.position.applyMatrix4(g),w.direction.setFromMatrixPosition(_.matrixWorld),i.setFromMatrixPosition(_.target.matrixWorld),w.direction.sub(i),w.direction.transformDirection(g),m++}else if(_.isRectAreaLight){const w=r.rectArea[x];w.position.setFromMatrixPosition(_.matrixWorld),w.position.applyMatrix4(g),o.identity(),s.copy(_.matrixWorld),s.premultiply(g),o.extractRotation(s),w.halfWidth.set(_.width*.5,0,0),w.halfHeight.set(0,_.height*.5,0),w.halfWidth.applyMatrix4(o),w.halfHeight.applyMatrix4(o),x++}else if(_.isPointLight){const w=r.point[h];w.position.setFromMatrixPosition(_.matrixWorld),w.position.applyMatrix4(g),h++}else if(_.isHemisphereLight){const w=r.hemi[v];w.direction.setFromMatrixPosition(_.matrixWorld),w.direction.transformDirection(g),v++}}}return{setup:a,setupView:l,state:r}}function G_(t){const e=new Jz(t),n=[],r=[];function i(u){c.camera=u,n.length=0,r.length=0}function s(u){n.push(u)}function o(u){r.push(u)}function a(){e.setup(n)}function l(u){e.setupView(n,u)}const c={lightsArray:n,shadowsArray:r,camera:null,lights:e,transmissionRenderTarget:{}};return{init:i,state:c,setupLights:a,setupLightsView:l,pushLight:s,pushShadow:o}}function Zz(t){let e=new WeakMap;function n(i,s=0){const o=e.get(i);let a;return o===void 0?(a=new G_(t),e.set(i,[a])):s>=o.length?(a=new G_(t),o.push(a)):a=o[s],a}function r(){e=new WeakMap}return{get:n,dispose:r}}const Qz=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,e5=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function t5(t,e,n){let r=new mM;const i=new Qe,s=new Qe,o=new Ht,a=new CF({depthPacking:jO}),l=new AF,c={},u=n.maxTextureSize,d={[gi]:nn,[nn]:gi,[Bn]:Bn},h=new ar({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Qe},radius:{value:4}},vertexShader:Qz,fragmentShader:e5}),m=h.clone();m.defines.HORIZONTAL_PASS=1;const x=new _s;x.setAttribute("position",new rr(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const v=new Er(x,h),g=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=YT;let p=this.type;this.render=function(M,T,P){if(g.enabled===!1||g.autoUpdate===!1&&g.needsUpdate===!1||M.length===0)return;const C=t.getRenderTarget(),b=t.getActiveCubeFace(),N=t.getActiveMipmapLevel(),U=t.state;U.setBlending(zr),U.buffers.depth.getReversed()?U.buffers.color.setClear(0,0,0,0):U.buffers.color.setClear(1,1,1,1),U.buffers.depth.setTest(!0),U.setScissorTest(!1);const O=p!==ei&&this.type===ei,V=p===ei&&this.type!==ei;for(let Y=0,z=M.length;Y<z;Y++){const W=M[Y],L=W.shadow;if(L===void 0){console.warn("THREE.WebGLShadowMap:",W,"has no shadow.");continue}if(L.autoUpdate===!1&&L.needsUpdate===!1)continue;i.copy(L.mapSize);const H=L.getFrameExtents();if(i.multiply(H),s.copy(L.mapSize),(i.x>u||i.y>u)&&(i.x>u&&(s.x=Math.floor(u/H.x),i.x=s.x*H.x,L.mapSize.x=s.x),i.y>u&&(s.y=Math.floor(u/H.y),i.y=s.y*H.y,L.mapSize.y=s.y)),L.map===null||O===!0||V===!0){const ee=this.type!==ei?{minFilter:Mr,magFilter:Mr}:{};L.map!==null&&L.map.dispose(),L.map=new Pr(i.x,i.y,ee),L.map.texture.name=W.name+".shadowMap",L.camera.updateProjectionMatrix()}t.setRenderTarget(L.map),t.clear();const j=L.getViewportCount();for(let ee=0;ee<j;ee++){const ve=L.getViewport(ee);o.set(s.x*ve.x,s.y*ve.y,s.x*ve.z,s.y*ve.w),U.viewport(o),L.updateMatrices(W,ee),r=L.getFrustum(),w(T,P,L.camera,W,this.type)}L.isPointLightShadow!==!0&&this.type===ei&&y(L,P),L.needsUpdate=!1}p=this.type,g.needsUpdate=!1,t.setRenderTarget(C,b,N)};function y(M,T){const P=e.update(v);h.defines.VSM_SAMPLES!==M.blurSamples&&(h.defines.VSM_SAMPLES=M.blurSamples,m.defines.VSM_SAMPLES=M.blurSamples,h.needsUpdate=!0,m.needsUpdate=!0),M.mapPass===null&&(M.mapPass=new Pr(i.x,i.y)),h.uniforms.shadow_pass.value=M.map.texture,h.uniforms.resolution.value=M.mapSize,h.uniforms.radius.value=M.radius,t.setRenderTarget(M.mapPass),t.clear(),t.renderBufferDirect(T,null,P,h,v,null),m.uniforms.shadow_pass.value=M.mapPass.texture,m.uniforms.resolution.value=M.mapSize,m.uniforms.radius.value=M.radius,t.setRenderTarget(M.map),t.clear(),t.renderBufferDirect(T,null,P,m,v,null)}function _(M,T,P,C){let b=null;const N=P.isPointLight===!0?M.customDistanceMaterial:M.customDepthMaterial;if(N!==void 0)b=N;else if(b=P.isPointLight===!0?l:a,t.localClippingEnabled&&T.clipShadows===!0&&Array.isArray(T.clippingPlanes)&&T.clippingPlanes.length!==0||T.displacementMap&&T.displacementScale!==0||T.alphaMap&&T.alphaTest>0||T.map&&T.alphaTest>0||T.alphaToCoverage===!0){const U=b.uuid,O=T.uuid;let V=c[U];V===void 0&&(V={},c[U]=V);let Y=V[O];Y===void 0&&(Y=b.clone(),V[O]=Y,T.addEventListener("dispose",E)),b=Y}if(b.visible=T.visible,b.wireframe=T.wireframe,C===ei?b.side=T.shadowSide!==null?T.shadowSide:T.side:b.side=T.shadowSide!==null?T.shadowSide:d[T.side],b.alphaMap=T.alphaMap,b.alphaTest=T.alphaToCoverage===!0?.5:T.alphaTest,b.map=T.map,b.clipShadows=T.clipShadows,b.clippingPlanes=T.clippingPlanes,b.clipIntersection=T.clipIntersection,b.displacementMap=T.displacementMap,b.displacementScale=T.displacementScale,b.displacementBias=T.displacementBias,b.wireframeLinewidth=T.wireframeLinewidth,b.linewidth=T.linewidth,P.isPointLight===!0&&b.isMeshDistanceMaterial===!0){const U=t.properties.get(b);U.light=P}return b}function w(M,T,P,C,b){if(M.visible===!1)return;if(M.layers.test(T.layers)&&(M.isMesh||M.isLine||M.isPoints)&&(M.castShadow||M.receiveShadow&&b===ei)&&(!M.frustumCulled||r.intersectsObject(M))){M.modelViewMatrix.multiplyMatrices(P.matrixWorldInverse,M.matrixWorld);const O=e.update(M),V=M.material;if(Array.isArray(V)){const Y=O.groups;for(let z=0,W=Y.length;z<W;z++){const L=Y[z],H=V[L.materialIndex];if(H&&H.visible){const j=_(M,H,C,b);M.onBeforeShadow(t,M,T,P,O,j,L),t.renderBufferDirect(P,null,O,j,M,L),M.onAfterShadow(t,M,T,P,O,j,L)}}}else if(V.visible){const Y=_(M,V,C,b);M.onBeforeShadow(t,M,T,P,O,Y,null),t.renderBufferDirect(P,null,O,Y,M,null),M.onAfterShadow(t,M,T,P,O,Y,null)}}const U=M.children;for(let O=0,V=U.length;O<V;O++)w(U[O],T,P,C,b)}function E(M){M.target.removeEventListener("dispose",E);for(const P in c){const C=c[P],b=M.target.uuid;b in C&&(C[b].dispose(),delete C[b])}}}const n5={[Fm]:Bm,[jm]:Hm,[zm]:Gm,[Ta]:Vm,[Bm]:Fm,[Hm]:jm,[Gm]:zm,[Vm]:Ta};function r5(t,e){function n(){let k=!1;const fe=new Ht;let me=null;const Ae=new Ht(0,0,0,0);return{setMask:function(ce){me!==ce&&!k&&(t.colorMask(ce,ce,ce,ce),me=ce)},setLocked:function(ce){k=ce},setClear:function(ce,se,Pe,Ge,St){St===!0&&(ce*=Ge,se*=Ge,Pe*=Ge),fe.set(ce,se,Pe,Ge),Ae.equals(fe)===!1&&(t.clearColor(ce,se,Pe,Ge),Ae.copy(fe))},reset:function(){k=!1,me=null,Ae.set(-1,0,0,0)}}}function r(){let k=!1,fe=!1,me=null,Ae=null,ce=null;return{setReversed:function(se){if(fe!==se){const Pe=e.get("EXT_clip_control");se?Pe.clipControlEXT(Pe.LOWER_LEFT_EXT,Pe.ZERO_TO_ONE_EXT):Pe.clipControlEXT(Pe.LOWER_LEFT_EXT,Pe.NEGATIVE_ONE_TO_ONE_EXT),fe=se;const Ge=ce;ce=null,this.setClear(Ge)}},getReversed:function(){return fe},setTest:function(se){se?X(t.DEPTH_TEST):he(t.DEPTH_TEST)},setMask:function(se){me!==se&&!k&&(t.depthMask(se),me=se)},setFunc:function(se){if(fe&&(se=n5[se]),Ae!==se){switch(se){case Fm:t.depthFunc(t.NEVER);break;case Bm:t.depthFunc(t.ALWAYS);break;case jm:t.depthFunc(t.LESS);break;case Ta:t.depthFunc(t.LEQUAL);break;case zm:t.depthFunc(t.EQUAL);break;case Vm:t.depthFunc(t.GEQUAL);break;case Hm:t.depthFunc(t.GREATER);break;case Gm:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}Ae=se}},setLocked:function(se){k=se},setClear:function(se){ce!==se&&(fe&&(se=1-se),t.clearDepth(se),ce=se)},reset:function(){k=!1,me=null,Ae=null,ce=null,fe=!1}}}function i(){let k=!1,fe=null,me=null,Ae=null,ce=null,se=null,Pe=null,Ge=null,St=null;return{setTest:function(ht){k||(ht?X(t.STENCIL_TEST):he(t.STENCIL_TEST))},setMask:function(ht){fe!==ht&&!k&&(t.stencilMask(ht),fe=ht)},setFunc:function(ht,$r,Nr){(me!==ht||Ae!==$r||ce!==Nr)&&(t.stencilFunc(ht,$r,Nr),me=ht,Ae=$r,ce=Nr)},setOp:function(ht,$r,Nr){(se!==ht||Pe!==$r||Ge!==Nr)&&(t.stencilOp(ht,$r,Nr),se=ht,Pe=$r,Ge=Nr)},setLocked:function(ht){k=ht},setClear:function(ht){St!==ht&&(t.clearStencil(ht),St=ht)},reset:function(){k=!1,fe=null,me=null,Ae=null,ce=null,se=null,Pe=null,Ge=null,St=null}}}const s=new n,o=new r,a=new i,l=new WeakMap,c=new WeakMap;let u={},d={},h=new WeakMap,m=[],x=null,v=!1,g=null,p=null,y=null,_=null,w=null,E=null,M=null,T=new pt(0,0,0),P=0,C=!1,b=null,N=null,U=null,O=null,V=null;const Y=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let z=!1,W=0;const L=t.getParameter(t.VERSION);L.indexOf("WebGL")!==-1?(W=parseFloat(/^WebGL (\d)/.exec(L)[1]),z=W>=1):L.indexOf("OpenGL ES")!==-1&&(W=parseFloat(/^OpenGL ES (\d)/.exec(L)[1]),z=W>=2);let H=null,j={};const ee=t.getParameter(t.SCISSOR_BOX),ve=t.getParameter(t.VIEWPORT),Be=new Ht().fromArray(ee),Ue=new Ht().fromArray(ve);function Q(k,fe,me,Ae){const ce=new Uint8Array(4),se=t.createTexture();t.bindTexture(k,se),t.texParameteri(k,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(k,t.TEXTURE_MAG_FILTER,t.NEAREST);for(let Pe=0;Pe<me;Pe++)k===t.TEXTURE_3D||k===t.TEXTURE_2D_ARRAY?t.texImage3D(fe,0,t.RGBA,1,1,Ae,0,t.RGBA,t.UNSIGNED_BYTE,ce):t.texImage2D(fe+Pe,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,ce);return se}const oe={};oe[t.TEXTURE_2D]=Q(t.TEXTURE_2D,t.TEXTURE_2D,1),oe[t.TEXTURE_CUBE_MAP]=Q(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),oe[t.TEXTURE_2D_ARRAY]=Q(t.TEXTURE_2D_ARRAY,t.TEXTURE_2D_ARRAY,1,1),oe[t.TEXTURE_3D]=Q(t.TEXTURE_3D,t.TEXTURE_3D,1,1),s.setClear(0,0,0,1),o.setClear(1),a.setClear(0),X(t.DEPTH_TEST),o.setFunc(Ta),He(!1),Me(Jy),X(t.CULL_FACE),be(zr);function X(k){u[k]!==!0&&(t.enable(k),u[k]=!0)}function he(k){u[k]!==!1&&(t.disable(k),u[k]=!1)}function J(k,fe){return d[k]!==fe?(t.bindFramebuffer(k,fe),d[k]=fe,k===t.DRAW_FRAMEBUFFER&&(d[t.FRAMEBUFFER]=fe),k===t.FRAMEBUFFER&&(d[t.DRAW_FRAMEBUFFER]=fe),!0):!1}function q(k,fe){let me=m,Ae=!1;if(k){me=h.get(fe),me===void 0&&(me=[],h.set(fe,me));const ce=k.textures;if(me.length!==ce.length||me[0]!==t.COLOR_ATTACHMENT0){for(let se=0,Pe=ce.length;se<Pe;se++)me[se]=t.COLOR_ATTACHMENT0+se;me.length=ce.length,Ae=!0}}else me[0]!==t.BACK&&(me[0]=t.BACK,Ae=!0);Ae&&t.drawBuffers(me)}function re(k){return x!==k?(t.useProgram(k),x=k,!0):!1}const ie={[Bs]:t.FUNC_ADD,[hO]:t.FUNC_SUBTRACT,[pO]:t.FUNC_REVERSE_SUBTRACT};ie[mO]=t.MIN,ie[gO]=t.MAX;const I={[vO]:t.ZERO,[xO]:t.ONE,[yO]:t.SRC_COLOR,[km]:t.SRC_ALPHA,[TO]:t.SRC_ALPHA_SATURATE,[EO]:t.DST_COLOR,[wO]:t.DST_ALPHA,[_O]:t.ONE_MINUS_SRC_COLOR,[Om]:t.ONE_MINUS_SRC_ALPHA,[bO]:t.ONE_MINUS_DST_COLOR,[SO]:t.ONE_MINUS_DST_ALPHA,[MO]:t.CONSTANT_COLOR,[CO]:t.ONE_MINUS_CONSTANT_COLOR,[AO]:t.CONSTANT_ALPHA,[RO]:t.ONE_MINUS_CONSTANT_ALPHA};function be(k,fe,me,Ae,ce,se,Pe,Ge,St,ht){if(k===zr){v===!0&&(he(t.BLEND),v=!1);return}if(v===!1&&(X(t.BLEND),v=!0),k!==fO){if(k!==g||ht!==C){if((p!==Bs||w!==Bs)&&(t.blendEquation(t.FUNC_ADD),p=Bs,w=Bs),ht)switch(k){case aa:t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case Zy:t.blendFunc(t.ONE,t.ONE);break;case Qy:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case e_:t.blendFuncSeparate(t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ZERO,t.ONE);break;default:console.error("THREE.WebGLState: Invalid blending: ",k);break}else switch(k){case aa:t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case Zy:t.blendFuncSeparate(t.SRC_ALPHA,t.ONE,t.ONE,t.ONE);break;case Qy:console.error("THREE.WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case e_:console.error("THREE.WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:console.error("THREE.WebGLState: Invalid blending: ",k);break}y=null,_=null,E=null,M=null,T.set(0,0,0),P=0,g=k,C=ht}return}ce=ce||fe,se=se||me,Pe=Pe||Ae,(fe!==p||ce!==w)&&(t.blendEquationSeparate(ie[fe],ie[ce]),p=fe,w=ce),(me!==y||Ae!==_||se!==E||Pe!==M)&&(t.blendFuncSeparate(I[me],I[Ae],I[se],I[Pe]),y=me,_=Ae,E=se,M=Pe),(Ge.equals(T)===!1||St!==P)&&(t.blendColor(Ge.r,Ge.g,Ge.b,St),T.copy(Ge),P=St),g=k,C=!1}function Ee(k,fe){k.side===Bn?he(t.CULL_FACE):X(t.CULL_FACE);let me=k.side===nn;fe&&(me=!me),He(me),k.blending===aa&&k.transparent===!1?be(zr):be(k.blending,k.blendEquation,k.blendSrc,k.blendDst,k.blendEquationAlpha,k.blendSrcAlpha,k.blendDstAlpha,k.blendColor,k.blendAlpha,k.premultipliedAlpha),o.setFunc(k.depthFunc),o.setTest(k.depthTest),o.setMask(k.depthWrite),s.setMask(k.colorWrite);const Ae=k.stencilWrite;a.setTest(Ae),Ae&&(a.setMask(k.stencilWriteMask),a.setFunc(k.stencilFunc,k.stencilRef,k.stencilFuncMask),a.setOp(k.stencilFail,k.stencilZFail,k.stencilZPass)),ge(k.polygonOffset,k.polygonOffsetFactor,k.polygonOffsetUnits),k.alphaToCoverage===!0?X(t.SAMPLE_ALPHA_TO_COVERAGE):he(t.SAMPLE_ALPHA_TO_COVERAGE)}function He(k){b!==k&&(k?t.frontFace(t.CW):t.frontFace(t.CCW),b=k)}function Me(k){k!==cO?(X(t.CULL_FACE),k!==N&&(k===Jy?t.cullFace(t.BACK):k===uO?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):he(t.CULL_FACE),N=k}function it(k){k!==U&&(z&&t.lineWidth(k),U=k)}function ge(k,fe,me){k?(X(t.POLYGON_OFFSET_FILL),(O!==fe||V!==me)&&(t.polygonOffset(fe,me),O=fe,V=me)):he(t.POLYGON_OFFSET_FILL)}function _e(k){k?X(t.SCISSOR_TEST):he(t.SCISSOR_TEST)}function Ve(k){k===void 0&&(k=t.TEXTURE0+Y-1),H!==k&&(t.activeTexture(k),H=k)}function et(k,fe,me){me===void 0&&(H===null?me=t.TEXTURE0+Y-1:me=H);let Ae=j[me];Ae===void 0&&(Ae={type:void 0,texture:void 0},j[me]=Ae),(Ae.type!==k||Ae.texture!==fe)&&(H!==me&&(t.activeTexture(me),H=me),t.bindTexture(k,fe||oe[k]),Ae.type=k,Ae.texture=fe)}function D(){const k=j[H];k!==void 0&&k.type!==void 0&&(t.bindTexture(k.type,null),k.type=void 0,k.texture=void 0)}function A(){try{t.compressedTexImage2D(...arguments)}catch(k){console.error("THREE.WebGLState:",k)}}function G(){try{t.compressedTexImage3D(...arguments)}catch(k){console.error("THREE.WebGLState:",k)}}function ne(){try{t.texSubImage2D(...arguments)}catch(k){console.error("THREE.WebGLState:",k)}}function ae(){try{t.texSubImage3D(...arguments)}catch(k){console.error("THREE.WebGLState:",k)}}function te(){try{t.compressedTexSubImage2D(...arguments)}catch(k){console.error("THREE.WebGLState:",k)}}function De(){try{t.compressedTexSubImage3D(...arguments)}catch(k){console.error("THREE.WebGLState:",k)}}function pe(){try{t.texStorage2D(...arguments)}catch(k){console.error("THREE.WebGLState:",k)}}function Ne(){try{t.texStorage3D(...arguments)}catch(k){console.error("THREE.WebGLState:",k)}}function Ie(){try{t.texImage2D(...arguments)}catch(k){console.error("THREE.WebGLState:",k)}}function de(){try{t.texImage3D(...arguments)}catch(k){console.error("THREE.WebGLState:",k)}}function Se(k){Be.equals(k)===!1&&(t.scissor(k.x,k.y,k.z,k.w),Be.copy(k))}function je(k){Ue.equals(k)===!1&&(t.viewport(k.x,k.y,k.z,k.w),Ue.copy(k))}function Le(k,fe){let me=c.get(fe);me===void 0&&(me=new WeakMap,c.set(fe,me));let Ae=me.get(k);Ae===void 0&&(Ae=t.getUniformBlockIndex(fe,k.name),me.set(k,Ae))}function ye(k,fe){const Ae=c.get(fe).get(k);l.get(fe)!==Ae&&(t.uniformBlockBinding(fe,Ae,k.__bindingPointIndex),l.set(fe,Ae))}function qe(){t.disable(t.BLEND),t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SCISSOR_TEST),t.disable(t.STENCIL_TEST),t.disable(t.SAMPLE_ALPHA_TO_COVERAGE),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ZERO),t.blendFuncSeparate(t.ONE,t.ZERO,t.ONE,t.ZERO),t.blendColor(0,0,0,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(t.LESS),o.setReversed(!1),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(t.ALWAYS,0,4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.clearStencil(0),t.cullFace(t.BACK),t.frontFace(t.CCW),t.polygonOffset(0,0),t.activeTexture(t.TEXTURE0),t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),t.bindFramebuffer(t.READ_FRAMEBUFFER,null),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),u={},H=null,j={},d={},h=new WeakMap,m=[],x=null,v=!1,g=null,p=null,y=null,_=null,w=null,E=null,M=null,T=new pt(0,0,0),P=0,C=!1,b=null,N=null,U=null,O=null,V=null,Be.set(0,0,t.canvas.width,t.canvas.height),Ue.set(0,0,t.canvas.width,t.canvas.height),s.reset(),o.reset(),a.reset()}return{buffers:{color:s,depth:o,stencil:a},enable:X,disable:he,bindFramebuffer:J,drawBuffers:q,useProgram:re,setBlending:be,setMaterial:Ee,setFlipSided:He,setCullFace:Me,setLineWidth:it,setPolygonOffset:ge,setScissorTest:_e,activeTexture:Ve,bindTexture:et,unbindTexture:D,compressedTexImage2D:A,compressedTexImage3D:G,texImage2D:Ie,texImage3D:de,updateUBOMapping:Le,uniformBlockBinding:ye,texStorage2D:pe,texStorage3D:Ne,texSubImage2D:ne,texSubImage3D:ae,compressedTexSubImage2D:te,compressedTexSubImage3D:De,scissor:Se,viewport:je,reset:qe}}function i5(t,e,n,r,i,s,o){const a=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,l=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),c=new Qe,u=new WeakMap;let d;const h=new WeakMap;let m=!1;try{m=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function x(D,A){return m?new OffscreenCanvas(D,A):Ad("canvas")}function v(D,A,G){let ne=1;const ae=et(D);if((ae.width>G||ae.height>G)&&(ne=G/Math.max(ae.width,ae.height)),ne<1)if(typeof HTMLImageElement<"u"&&D instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&D instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&D instanceof ImageBitmap||typeof VideoFrame<"u"&&D instanceof VideoFrame){const te=Math.floor(ne*ae.width),De=Math.floor(ne*ae.height);d===void 0&&(d=x(te,De));const pe=A?x(te,De):d;return pe.width=te,pe.height=De,pe.getContext("2d").drawImage(D,0,0,te,De),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+ae.width+"x"+ae.height+") to ("+te+"x"+De+")."),pe}else return"data"in D&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+ae.width+"x"+ae.height+")."),D;return D}function g(D){return D.generateMipmaps}function p(D){t.generateMipmap(D)}function y(D){return D.isWebGLCubeRenderTarget?t.TEXTURE_CUBE_MAP:D.isWebGL3DRenderTarget?t.TEXTURE_3D:D.isWebGLArrayRenderTarget||D.isCompressedArrayTexture?t.TEXTURE_2D_ARRAY:t.TEXTURE_2D}function _(D,A,G,ne,ae=!1){if(D!==null){if(t[D]!==void 0)return t[D];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+D+"'")}let te=A;if(A===t.RED&&(G===t.FLOAT&&(te=t.R32F),G===t.HALF_FLOAT&&(te=t.R16F),G===t.UNSIGNED_BYTE&&(te=t.R8)),A===t.RED_INTEGER&&(G===t.UNSIGNED_BYTE&&(te=t.R8UI),G===t.UNSIGNED_SHORT&&(te=t.R16UI),G===t.UNSIGNED_INT&&(te=t.R32UI),G===t.BYTE&&(te=t.R8I),G===t.SHORT&&(te=t.R16I),G===t.INT&&(te=t.R32I)),A===t.RG&&(G===t.FLOAT&&(te=t.RG32F),G===t.HALF_FLOAT&&(te=t.RG16F),G===t.UNSIGNED_BYTE&&(te=t.RG8)),A===t.RG_INTEGER&&(G===t.UNSIGNED_BYTE&&(te=t.RG8UI),G===t.UNSIGNED_SHORT&&(te=t.RG16UI),G===t.UNSIGNED_INT&&(te=t.RG32UI),G===t.BYTE&&(te=t.RG8I),G===t.SHORT&&(te=t.RG16I),G===t.INT&&(te=t.RG32I)),A===t.RGB_INTEGER&&(G===t.UNSIGNED_BYTE&&(te=t.RGB8UI),G===t.UNSIGNED_SHORT&&(te=t.RGB16UI),G===t.UNSIGNED_INT&&(te=t.RGB32UI),G===t.BYTE&&(te=t.RGB8I),G===t.SHORT&&(te=t.RGB16I),G===t.INT&&(te=t.RGB32I)),A===t.RGBA_INTEGER&&(G===t.UNSIGNED_BYTE&&(te=t.RGBA8UI),G===t.UNSIGNED_SHORT&&(te=t.RGBA16UI),G===t.UNSIGNED_INT&&(te=t.RGBA32UI),G===t.BYTE&&(te=t.RGBA8I),G===t.SHORT&&(te=t.RGBA16I),G===t.INT&&(te=t.RGBA32I)),A===t.RGB&&G===t.UNSIGNED_INT_5_9_9_9_REV&&(te=t.RGB9_E5),A===t.RGBA){const De=ae?Md:dt.getTransfer(ne);G===t.FLOAT&&(te=t.RGBA32F),G===t.HALF_FLOAT&&(te=t.RGBA16F),G===t.UNSIGNED_BYTE&&(te=De===xt?t.SRGB8_ALPHA8:t.RGBA8),G===t.UNSIGNED_SHORT_4_4_4_4&&(te=t.RGBA4),G===t.UNSIGNED_SHORT_5_5_5_1&&(te=t.RGB5_A1)}return(te===t.R16F||te===t.R32F||te===t.RG16F||te===t.RG32F||te===t.RGBA16F||te===t.RGBA32F)&&e.get("EXT_color_buffer_float"),te}function w(D,A){let G;return D?A===null||A===ls||A===Aa?G=t.DEPTH24_STENCIL8:A===oi?G=t.DEPTH32F_STENCIL8:A===Zl&&(G=t.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):A===null||A===ls||A===Aa?G=t.DEPTH_COMPONENT24:A===oi?G=t.DEPTH_COMPONENT32F:A===Zl&&(G=t.DEPTH_COMPONENT16),G}function E(D,A){return g(D)===!0||D.isFramebufferTexture&&D.minFilter!==Mr&&D.minFilter!==mn?Math.log2(Math.max(A.width,A.height))+1:D.mipmaps!==void 0&&D.mipmaps.length>0?D.mipmaps.length:D.isCompressedTexture&&Array.isArray(D.image)?A.mipmaps.length:1}function M(D){const A=D.target;A.removeEventListener("dispose",M),P(A),A.isVideoTexture&&u.delete(A)}function T(D){const A=D.target;A.removeEventListener("dispose",T),b(A)}function P(D){const A=r.get(D);if(A.__webglInit===void 0)return;const G=D.source,ne=h.get(G);if(ne){const ae=ne[A.__cacheKey];ae.usedTimes--,ae.usedTimes===0&&C(D),Object.keys(ne).length===0&&h.delete(G)}r.remove(D)}function C(D){const A=r.get(D);t.deleteTexture(A.__webglTexture);const G=D.source,ne=h.get(G);delete ne[A.__cacheKey],o.memory.textures--}function b(D){const A=r.get(D);if(D.depthTexture&&(D.depthTexture.dispose(),r.remove(D.depthTexture)),D.isWebGLCubeRenderTarget)for(let ne=0;ne<6;ne++){if(Array.isArray(A.__webglFramebuffer[ne]))for(let ae=0;ae<A.__webglFramebuffer[ne].length;ae++)t.deleteFramebuffer(A.__webglFramebuffer[ne][ae]);else t.deleteFramebuffer(A.__webglFramebuffer[ne]);A.__webglDepthbuffer&&t.deleteRenderbuffer(A.__webglDepthbuffer[ne])}else{if(Array.isArray(A.__webglFramebuffer))for(let ne=0;ne<A.__webglFramebuffer.length;ne++)t.deleteFramebuffer(A.__webglFramebuffer[ne]);else t.deleteFramebuffer(A.__webglFramebuffer);if(A.__webglDepthbuffer&&t.deleteRenderbuffer(A.__webglDepthbuffer),A.__webglMultisampledFramebuffer&&t.deleteFramebuffer(A.__webglMultisampledFramebuffer),A.__webglColorRenderbuffer)for(let ne=0;ne<A.__webglColorRenderbuffer.length;ne++)A.__webglColorRenderbuffer[ne]&&t.deleteRenderbuffer(A.__webglColorRenderbuffer[ne]);A.__webglDepthRenderbuffer&&t.deleteRenderbuffer(A.__webglDepthRenderbuffer)}const G=D.textures;for(let ne=0,ae=G.length;ne<ae;ne++){const te=r.get(G[ne]);te.__webglTexture&&(t.deleteTexture(te.__webglTexture),o.memory.textures--),r.remove(G[ne])}r.remove(D)}let N=0;function U(){N=0}function O(){const D=N;return D>=i.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+D+" texture units while this GPU supports only "+i.maxTextures),N+=1,D}function V(D){const A=[];return A.push(D.wrapS),A.push(D.wrapT),A.push(D.wrapR||0),A.push(D.magFilter),A.push(D.minFilter),A.push(D.anisotropy),A.push(D.internalFormat),A.push(D.format),A.push(D.type),A.push(D.generateMipmaps),A.push(D.premultiplyAlpha),A.push(D.flipY),A.push(D.unpackAlignment),A.push(D.colorSpace),A.join()}function Y(D,A){const G=r.get(D);if(D.isVideoTexture&&_e(D),D.isRenderTargetTexture===!1&&D.isExternalTexture!==!0&&D.version>0&&G.__version!==D.version){const ne=D.image;if(ne===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(ne.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{oe(G,D,A);return}}else D.isExternalTexture&&(G.__webglTexture=D.sourceTexture?D.sourceTexture:null);n.bindTexture(t.TEXTURE_2D,G.__webglTexture,t.TEXTURE0+A)}function z(D,A){const G=r.get(D);if(D.isRenderTargetTexture===!1&&D.version>0&&G.__version!==D.version){oe(G,D,A);return}n.bindTexture(t.TEXTURE_2D_ARRAY,G.__webglTexture,t.TEXTURE0+A)}function W(D,A){const G=r.get(D);if(D.isRenderTargetTexture===!1&&D.version>0&&G.__version!==D.version){oe(G,D,A);return}n.bindTexture(t.TEXTURE_3D,G.__webglTexture,t.TEXTURE0+A)}function L(D,A){const G=r.get(D);if(D.version>0&&G.__version!==D.version){X(G,D,A);return}n.bindTexture(t.TEXTURE_CUBE_MAP,G.__webglTexture,t.TEXTURE0+A)}const H={[Xm]:t.REPEAT,[Gs]:t.CLAMP_TO_EDGE,[qm]:t.MIRRORED_REPEAT},j={[Mr]:t.NEAREST,[BO]:t.NEAREST_MIPMAP_NEAREST,[Yc]:t.NEAREST_MIPMAP_LINEAR,[mn]:t.LINEAR,[Rh]:t.LINEAR_MIPMAP_NEAREST,[Ws]:t.LINEAR_MIPMAP_LINEAR},ee={[HO]:t.NEVER,[YO]:t.ALWAYS,[GO]:t.LESS,[oM]:t.LEQUAL,[WO]:t.EQUAL,[qO]:t.GEQUAL,[$O]:t.GREATER,[XO]:t.NOTEQUAL};function ve(D,A){if(A.type===oi&&e.has("OES_texture_float_linear")===!1&&(A.magFilter===mn||A.magFilter===Rh||A.magFilter===Yc||A.magFilter===Ws||A.minFilter===mn||A.minFilter===Rh||A.minFilter===Yc||A.minFilter===Ws)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),t.texParameteri(D,t.TEXTURE_WRAP_S,H[A.wrapS]),t.texParameteri(D,t.TEXTURE_WRAP_T,H[A.wrapT]),(D===t.TEXTURE_3D||D===t.TEXTURE_2D_ARRAY)&&t.texParameteri(D,t.TEXTURE_WRAP_R,H[A.wrapR]),t.texParameteri(D,t.TEXTURE_MAG_FILTER,j[A.magFilter]),t.texParameteri(D,t.TEXTURE_MIN_FILTER,j[A.minFilter]),A.compareFunction&&(t.texParameteri(D,t.TEXTURE_COMPARE_MODE,t.COMPARE_REF_TO_TEXTURE),t.texParameteri(D,t.TEXTURE_COMPARE_FUNC,ee[A.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(A.magFilter===Mr||A.minFilter!==Yc&&A.minFilter!==Ws||A.type===oi&&e.has("OES_texture_float_linear")===!1)return;if(A.anisotropy>1||r.get(A).__currentAnisotropy){const G=e.get("EXT_texture_filter_anisotropic");t.texParameterf(D,G.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(A.anisotropy,i.getMaxAnisotropy())),r.get(A).__currentAnisotropy=A.anisotropy}}}function Be(D,A){let G=!1;D.__webglInit===void 0&&(D.__webglInit=!0,A.addEventListener("dispose",M));const ne=A.source;let ae=h.get(ne);ae===void 0&&(ae={},h.set(ne,ae));const te=V(A);if(te!==D.__cacheKey){ae[te]===void 0&&(ae[te]={texture:t.createTexture(),usedTimes:0},o.memory.textures++,G=!0),ae[te].usedTimes++;const De=ae[D.__cacheKey];De!==void 0&&(ae[D.__cacheKey].usedTimes--,De.usedTimes===0&&C(A)),D.__cacheKey=te,D.__webglTexture=ae[te].texture}return G}function Ue(D,A,G){return Math.floor(Math.floor(D/G)/A)}function Q(D,A,G,ne){const te=D.updateRanges;if(te.length===0)n.texSubImage2D(t.TEXTURE_2D,0,0,0,A.width,A.height,G,ne,A.data);else{te.sort((de,Se)=>de.start-Se.start);let De=0;for(let de=1;de<te.length;de++){const Se=te[De],je=te[de],Le=Se.start+Se.count,ye=Ue(je.start,A.width,4),qe=Ue(Se.start,A.width,4);je.start<=Le+1&&ye===qe&&Ue(je.start+je.count-1,A.width,4)===ye?Se.count=Math.max(Se.count,je.start+je.count-Se.start):(++De,te[De]=je)}te.length=De+1;const pe=t.getParameter(t.UNPACK_ROW_LENGTH),Ne=t.getParameter(t.UNPACK_SKIP_PIXELS),Ie=t.getParameter(t.UNPACK_SKIP_ROWS);t.pixelStorei(t.UNPACK_ROW_LENGTH,A.width);for(let de=0,Se=te.length;de<Se;de++){const je=te[de],Le=Math.floor(je.start/4),ye=Math.ceil(je.count/4),qe=Le%A.width,k=Math.floor(Le/A.width),fe=ye,me=1;t.pixelStorei(t.UNPACK_SKIP_PIXELS,qe),t.pixelStorei(t.UNPACK_SKIP_ROWS,k),n.texSubImage2D(t.TEXTURE_2D,0,qe,k,fe,me,G,ne,A.data)}D.clearUpdateRanges(),t.pixelStorei(t.UNPACK_ROW_LENGTH,pe),t.pixelStorei(t.UNPACK_SKIP_PIXELS,Ne),t.pixelStorei(t.UNPACK_SKIP_ROWS,Ie)}}function oe(D,A,G){let ne=t.TEXTURE_2D;(A.isDataArrayTexture||A.isCompressedArrayTexture)&&(ne=t.TEXTURE_2D_ARRAY),A.isData3DTexture&&(ne=t.TEXTURE_3D);const ae=Be(D,A),te=A.source;n.bindTexture(ne,D.__webglTexture,t.TEXTURE0+G);const De=r.get(te);if(te.version!==De.__version||ae===!0){n.activeTexture(t.TEXTURE0+G);const pe=dt.getPrimaries(dt.workingColorSpace),Ne=A.colorSpace===Or?null:dt.getPrimaries(A.colorSpace),Ie=A.colorSpace===Or||pe===Ne?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,A.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,A.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,A.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,Ie);let de=v(A.image,!1,i.maxTextureSize);de=Ve(A,de);const Se=s.convert(A.format,A.colorSpace),je=s.convert(A.type);let Le=_(A.internalFormat,Se,je,A.colorSpace,A.isVideoTexture);ve(ne,A);let ye;const qe=A.mipmaps,k=A.isVideoTexture!==!0,fe=De.__version===void 0||ae===!0,me=te.dataReady,Ae=E(A,de);if(A.isDepthTexture)Le=w(A.format===Ra,A.type),fe&&(k?n.texStorage2D(t.TEXTURE_2D,1,Le,de.width,de.height):n.texImage2D(t.TEXTURE_2D,0,Le,de.width,de.height,0,Se,je,null));else if(A.isDataTexture)if(qe.length>0){k&&fe&&n.texStorage2D(t.TEXTURE_2D,Ae,Le,qe[0].width,qe[0].height);for(let ce=0,se=qe.length;ce<se;ce++)ye=qe[ce],k?me&&n.texSubImage2D(t.TEXTURE_2D,ce,0,0,ye.width,ye.height,Se,je,ye.data):n.texImage2D(t.TEXTURE_2D,ce,Le,ye.width,ye.height,0,Se,je,ye.data);A.generateMipmaps=!1}else k?(fe&&n.texStorage2D(t.TEXTURE_2D,Ae,Le,de.width,de.height),me&&Q(A,de,Se,je)):n.texImage2D(t.TEXTURE_2D,0,Le,de.width,de.height,0,Se,je,de.data);else if(A.isCompressedTexture)if(A.isCompressedArrayTexture){k&&fe&&n.texStorage3D(t.TEXTURE_2D_ARRAY,Ae,Le,qe[0].width,qe[0].height,de.depth);for(let ce=0,se=qe.length;ce<se;ce++)if(ye=qe[ce],A.format!==Sr)if(Se!==null)if(k){if(me)if(A.layerUpdates.size>0){const Pe=__(ye.width,ye.height,A.format,A.type);for(const Ge of A.layerUpdates){const St=ye.data.subarray(Ge*Pe/ye.data.BYTES_PER_ELEMENT,(Ge+1)*Pe/ye.data.BYTES_PER_ELEMENT);n.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,ce,0,0,Ge,ye.width,ye.height,1,Se,St)}A.clearLayerUpdates()}else n.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,ce,0,0,0,ye.width,ye.height,de.depth,Se,ye.data)}else n.compressedTexImage3D(t.TEXTURE_2D_ARRAY,ce,Le,ye.width,ye.height,de.depth,0,ye.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else k?me&&n.texSubImage3D(t.TEXTURE_2D_ARRAY,ce,0,0,0,ye.width,ye.height,de.depth,Se,je,ye.data):n.texImage3D(t.TEXTURE_2D_ARRAY,ce,Le,ye.width,ye.height,de.depth,0,Se,je,ye.data)}else{k&&fe&&n.texStorage2D(t.TEXTURE_2D,Ae,Le,qe[0].width,qe[0].height);for(let ce=0,se=qe.length;ce<se;ce++)ye=qe[ce],A.format!==Sr?Se!==null?k?me&&n.compressedTexSubImage2D(t.TEXTURE_2D,ce,0,0,ye.width,ye.height,Se,ye.data):n.compressedTexImage2D(t.TEXTURE_2D,ce,Le,ye.width,ye.height,0,ye.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):k?me&&n.texSubImage2D(t.TEXTURE_2D,ce,0,0,ye.width,ye.height,Se,je,ye.data):n.texImage2D(t.TEXTURE_2D,ce,Le,ye.width,ye.height,0,Se,je,ye.data)}else if(A.isDataArrayTexture)if(k){if(fe&&n.texStorage3D(t.TEXTURE_2D_ARRAY,Ae,Le,de.width,de.height,de.depth),me)if(A.layerUpdates.size>0){const ce=__(de.width,de.height,A.format,A.type);for(const se of A.layerUpdates){const Pe=de.data.subarray(se*ce/de.data.BYTES_PER_ELEMENT,(se+1)*ce/de.data.BYTES_PER_ELEMENT);n.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,se,de.width,de.height,1,Se,je,Pe)}A.clearLayerUpdates()}else n.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,0,de.width,de.height,de.depth,Se,je,de.data)}else n.texImage3D(t.TEXTURE_2D_ARRAY,0,Le,de.width,de.height,de.depth,0,Se,je,de.data);else if(A.isData3DTexture)k?(fe&&n.texStorage3D(t.TEXTURE_3D,Ae,Le,de.width,de.height,de.depth),me&&n.texSubImage3D(t.TEXTURE_3D,0,0,0,0,de.width,de.height,de.depth,Se,je,de.data)):n.texImage3D(t.TEXTURE_3D,0,Le,de.width,de.height,de.depth,0,Se,je,de.data);else if(A.isFramebufferTexture){if(fe)if(k)n.texStorage2D(t.TEXTURE_2D,Ae,Le,de.width,de.height);else{let ce=de.width,se=de.height;for(let Pe=0;Pe<Ae;Pe++)n.texImage2D(t.TEXTURE_2D,Pe,Le,ce,se,0,Se,je,null),ce>>=1,se>>=1}}else if(qe.length>0){if(k&&fe){const ce=et(qe[0]);n.texStorage2D(t.TEXTURE_2D,Ae,Le,ce.width,ce.height)}for(let ce=0,se=qe.length;ce<se;ce++)ye=qe[ce],k?me&&n.texSubImage2D(t.TEXTURE_2D,ce,0,0,Se,je,ye):n.texImage2D(t.TEXTURE_2D,ce,Le,Se,je,ye);A.generateMipmaps=!1}else if(k){if(fe){const ce=et(de);n.texStorage2D(t.TEXTURE_2D,Ae,Le,ce.width,ce.height)}me&&n.texSubImage2D(t.TEXTURE_2D,0,0,0,Se,je,de)}else n.texImage2D(t.TEXTURE_2D,0,Le,Se,je,de);g(A)&&p(ne),De.__version=te.version,A.onUpdate&&A.onUpdate(A)}D.__version=A.version}function X(D,A,G){if(A.image.length!==6)return;const ne=Be(D,A),ae=A.source;n.bindTexture(t.TEXTURE_CUBE_MAP,D.__webglTexture,t.TEXTURE0+G);const te=r.get(ae);if(ae.version!==te.__version||ne===!0){n.activeTexture(t.TEXTURE0+G);const De=dt.getPrimaries(dt.workingColorSpace),pe=A.colorSpace===Or?null:dt.getPrimaries(A.colorSpace),Ne=A.colorSpace===Or||De===pe?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,A.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,A.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,A.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,Ne);const Ie=A.isCompressedTexture||A.image[0].isCompressedTexture,de=A.image[0]&&A.image[0].isDataTexture,Se=[];for(let se=0;se<6;se++)!Ie&&!de?Se[se]=v(A.image[se],!0,i.maxCubemapSize):Se[se]=de?A.image[se].image:A.image[se],Se[se]=Ve(A,Se[se]);const je=Se[0],Le=s.convert(A.format,A.colorSpace),ye=s.convert(A.type),qe=_(A.internalFormat,Le,ye,A.colorSpace),k=A.isVideoTexture!==!0,fe=te.__version===void 0||ne===!0,me=ae.dataReady;let Ae=E(A,je);ve(t.TEXTURE_CUBE_MAP,A);let ce;if(Ie){k&&fe&&n.texStorage2D(t.TEXTURE_CUBE_MAP,Ae,qe,je.width,je.height);for(let se=0;se<6;se++){ce=Se[se].mipmaps;for(let Pe=0;Pe<ce.length;Pe++){const Ge=ce[Pe];A.format!==Sr?Le!==null?k?me&&n.compressedTexSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+se,Pe,0,0,Ge.width,Ge.height,Le,Ge.data):n.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+se,Pe,qe,Ge.width,Ge.height,0,Ge.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):k?me&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+se,Pe,0,0,Ge.width,Ge.height,Le,ye,Ge.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+se,Pe,qe,Ge.width,Ge.height,0,Le,ye,Ge.data)}}}else{if(ce=A.mipmaps,k&&fe){ce.length>0&&Ae++;const se=et(Se[0]);n.texStorage2D(t.TEXTURE_CUBE_MAP,Ae,qe,se.width,se.height)}for(let se=0;se<6;se++)if(de){k?me&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+se,0,0,0,Se[se].width,Se[se].height,Le,ye,Se[se].data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+se,0,qe,Se[se].width,Se[se].height,0,Le,ye,Se[se].data);for(let Pe=0;Pe<ce.length;Pe++){const St=ce[Pe].image[se].image;k?me&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+se,Pe+1,0,0,St.width,St.height,Le,ye,St.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+se,Pe+1,qe,St.width,St.height,0,Le,ye,St.data)}}else{k?me&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+se,0,0,0,Le,ye,Se[se]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+se,0,qe,Le,ye,Se[se]);for(let Pe=0;Pe<ce.length;Pe++){const Ge=ce[Pe];k?me&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+se,Pe+1,0,0,Le,ye,Ge.image[se]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+se,Pe+1,qe,Le,ye,Ge.image[se])}}}g(A)&&p(t.TEXTURE_CUBE_MAP),te.__version=ae.version,A.onUpdate&&A.onUpdate(A)}D.__version=A.version}function he(D,A,G,ne,ae,te){const De=s.convert(G.format,G.colorSpace),pe=s.convert(G.type),Ne=_(G.internalFormat,De,pe,G.colorSpace),Ie=r.get(A),de=r.get(G);if(de.__renderTarget=A,!Ie.__hasExternalTextures){const Se=Math.max(1,A.width>>te),je=Math.max(1,A.height>>te);ae===t.TEXTURE_3D||ae===t.TEXTURE_2D_ARRAY?n.texImage3D(ae,te,Ne,Se,je,A.depth,0,De,pe,null):n.texImage2D(ae,te,Ne,Se,je,0,De,pe,null)}n.bindFramebuffer(t.FRAMEBUFFER,D),ge(A)?a.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,ne,ae,de.__webglTexture,0,it(A)):(ae===t.TEXTURE_2D||ae>=t.TEXTURE_CUBE_MAP_POSITIVE_X&&ae<=t.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&t.framebufferTexture2D(t.FRAMEBUFFER,ne,ae,de.__webglTexture,te),n.bindFramebuffer(t.FRAMEBUFFER,null)}function J(D,A,G){if(t.bindRenderbuffer(t.RENDERBUFFER,D),A.depthBuffer){const ne=A.depthTexture,ae=ne&&ne.isDepthTexture?ne.type:null,te=w(A.stencilBuffer,ae),De=A.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,pe=it(A);ge(A)?a.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,pe,te,A.width,A.height):G?t.renderbufferStorageMultisample(t.RENDERBUFFER,pe,te,A.width,A.height):t.renderbufferStorage(t.RENDERBUFFER,te,A.width,A.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,De,t.RENDERBUFFER,D)}else{const ne=A.textures;for(let ae=0;ae<ne.length;ae++){const te=ne[ae],De=s.convert(te.format,te.colorSpace),pe=s.convert(te.type),Ne=_(te.internalFormat,De,pe,te.colorSpace),Ie=it(A);G&&ge(A)===!1?t.renderbufferStorageMultisample(t.RENDERBUFFER,Ie,Ne,A.width,A.height):ge(A)?a.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,Ie,Ne,A.width,A.height):t.renderbufferStorage(t.RENDERBUFFER,Ne,A.width,A.height)}}t.bindRenderbuffer(t.RENDERBUFFER,null)}function q(D,A){if(A&&A.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(t.FRAMEBUFFER,D),!(A.depthTexture&&A.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const ne=r.get(A.depthTexture);ne.__renderTarget=A,(!ne.__webglTexture||A.depthTexture.image.width!==A.width||A.depthTexture.image.height!==A.height)&&(A.depthTexture.image.width=A.width,A.depthTexture.image.height=A.height,A.depthTexture.needsUpdate=!0),Y(A.depthTexture,0);const ae=ne.__webglTexture,te=it(A);if(A.depthTexture.format===Ql)ge(A)?a.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,ae,0,te):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,ae,0);else if(A.depthTexture.format===Ra)ge(A)?a.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,ae,0,te):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,ae,0);else throw new Error("Unknown depthTexture format")}function re(D){const A=r.get(D),G=D.isWebGLCubeRenderTarget===!0;if(A.__boundDepthTexture!==D.depthTexture){const ne=D.depthTexture;if(A.__depthDisposeCallback&&A.__depthDisposeCallback(),ne){const ae=()=>{delete A.__boundDepthTexture,delete A.__depthDisposeCallback,ne.removeEventListener("dispose",ae)};ne.addEventListener("dispose",ae),A.__depthDisposeCallback=ae}A.__boundDepthTexture=ne}if(D.depthTexture&&!A.__autoAllocateDepthBuffer){if(G)throw new Error("target.depthTexture not supported in Cube render targets");const ne=D.texture.mipmaps;ne&&ne.length>0?q(A.__webglFramebuffer[0],D):q(A.__webglFramebuffer,D)}else if(G){A.__webglDepthbuffer=[];for(let ne=0;ne<6;ne++)if(n.bindFramebuffer(t.FRAMEBUFFER,A.__webglFramebuffer[ne]),A.__webglDepthbuffer[ne]===void 0)A.__webglDepthbuffer[ne]=t.createRenderbuffer(),J(A.__webglDepthbuffer[ne],D,!1);else{const ae=D.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,te=A.__webglDepthbuffer[ne];t.bindRenderbuffer(t.RENDERBUFFER,te),t.framebufferRenderbuffer(t.FRAMEBUFFER,ae,t.RENDERBUFFER,te)}}else{const ne=D.texture.mipmaps;if(ne&&ne.length>0?n.bindFramebuffer(t.FRAMEBUFFER,A.__webglFramebuffer[0]):n.bindFramebuffer(t.FRAMEBUFFER,A.__webglFramebuffer),A.__webglDepthbuffer===void 0)A.__webglDepthbuffer=t.createRenderbuffer(),J(A.__webglDepthbuffer,D,!1);else{const ae=D.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,te=A.__webglDepthbuffer;t.bindRenderbuffer(t.RENDERBUFFER,te),t.framebufferRenderbuffer(t.FRAMEBUFFER,ae,t.RENDERBUFFER,te)}}n.bindFramebuffer(t.FRAMEBUFFER,null)}function ie(D,A,G){const ne=r.get(D);A!==void 0&&he(ne.__webglFramebuffer,D,D.texture,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,0),G!==void 0&&re(D)}function I(D){const A=D.texture,G=r.get(D),ne=r.get(A);D.addEventListener("dispose",T);const ae=D.textures,te=D.isWebGLCubeRenderTarget===!0,De=ae.length>1;if(De||(ne.__webglTexture===void 0&&(ne.__webglTexture=t.createTexture()),ne.__version=A.version,o.memory.textures++),te){G.__webglFramebuffer=[];for(let pe=0;pe<6;pe++)if(A.mipmaps&&A.mipmaps.length>0){G.__webglFramebuffer[pe]=[];for(let Ne=0;Ne<A.mipmaps.length;Ne++)G.__webglFramebuffer[pe][Ne]=t.createFramebuffer()}else G.__webglFramebuffer[pe]=t.createFramebuffer()}else{if(A.mipmaps&&A.mipmaps.length>0){G.__webglFramebuffer=[];for(let pe=0;pe<A.mipmaps.length;pe++)G.__webglFramebuffer[pe]=t.createFramebuffer()}else G.__webglFramebuffer=t.createFramebuffer();if(De)for(let pe=0,Ne=ae.length;pe<Ne;pe++){const Ie=r.get(ae[pe]);Ie.__webglTexture===void 0&&(Ie.__webglTexture=t.createTexture(),o.memory.textures++)}if(D.samples>0&&ge(D)===!1){G.__webglMultisampledFramebuffer=t.createFramebuffer(),G.__webglColorRenderbuffer=[],n.bindFramebuffer(t.FRAMEBUFFER,G.__webglMultisampledFramebuffer);for(let pe=0;pe<ae.length;pe++){const Ne=ae[pe];G.__webglColorRenderbuffer[pe]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,G.__webglColorRenderbuffer[pe]);const Ie=s.convert(Ne.format,Ne.colorSpace),de=s.convert(Ne.type),Se=_(Ne.internalFormat,Ie,de,Ne.colorSpace,D.isXRRenderTarget===!0),je=it(D);t.renderbufferStorageMultisample(t.RENDERBUFFER,je,Se,D.width,D.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+pe,t.RENDERBUFFER,G.__webglColorRenderbuffer[pe])}t.bindRenderbuffer(t.RENDERBUFFER,null),D.depthBuffer&&(G.__webglDepthRenderbuffer=t.createRenderbuffer(),J(G.__webglDepthRenderbuffer,D,!0)),n.bindFramebuffer(t.FRAMEBUFFER,null)}}if(te){n.bindTexture(t.TEXTURE_CUBE_MAP,ne.__webglTexture),ve(t.TEXTURE_CUBE_MAP,A);for(let pe=0;pe<6;pe++)if(A.mipmaps&&A.mipmaps.length>0)for(let Ne=0;Ne<A.mipmaps.length;Ne++)he(G.__webglFramebuffer[pe][Ne],D,A,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+pe,Ne);else he(G.__webglFramebuffer[pe],D,A,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+pe,0);g(A)&&p(t.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(De){for(let pe=0,Ne=ae.length;pe<Ne;pe++){const Ie=ae[pe],de=r.get(Ie);let Se=t.TEXTURE_2D;(D.isWebGL3DRenderTarget||D.isWebGLArrayRenderTarget)&&(Se=D.isWebGL3DRenderTarget?t.TEXTURE_3D:t.TEXTURE_2D_ARRAY),n.bindTexture(Se,de.__webglTexture),ve(Se,Ie),he(G.__webglFramebuffer,D,Ie,t.COLOR_ATTACHMENT0+pe,Se,0),g(Ie)&&p(Se)}n.unbindTexture()}else{let pe=t.TEXTURE_2D;if((D.isWebGL3DRenderTarget||D.isWebGLArrayRenderTarget)&&(pe=D.isWebGL3DRenderTarget?t.TEXTURE_3D:t.TEXTURE_2D_ARRAY),n.bindTexture(pe,ne.__webglTexture),ve(pe,A),A.mipmaps&&A.mipmaps.length>0)for(let Ne=0;Ne<A.mipmaps.length;Ne++)he(G.__webglFramebuffer[Ne],D,A,t.COLOR_ATTACHMENT0,pe,Ne);else he(G.__webglFramebuffer,D,A,t.COLOR_ATTACHMENT0,pe,0);g(A)&&p(pe),n.unbindTexture()}D.depthBuffer&&re(D)}function be(D){const A=D.textures;for(let G=0,ne=A.length;G<ne;G++){const ae=A[G];if(g(ae)){const te=y(D),De=r.get(ae).__webglTexture;n.bindTexture(te,De),p(te),n.unbindTexture()}}}const Ee=[],He=[];function Me(D){if(D.samples>0){if(ge(D)===!1){const A=D.textures,G=D.width,ne=D.height;let ae=t.COLOR_BUFFER_BIT;const te=D.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,De=r.get(D),pe=A.length>1;if(pe)for(let Ie=0;Ie<A.length;Ie++)n.bindFramebuffer(t.FRAMEBUFFER,De.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+Ie,t.RENDERBUFFER,null),n.bindFramebuffer(t.FRAMEBUFFER,De.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+Ie,t.TEXTURE_2D,null,0);n.bindFramebuffer(t.READ_FRAMEBUFFER,De.__webglMultisampledFramebuffer);const Ne=D.texture.mipmaps;Ne&&Ne.length>0?n.bindFramebuffer(t.DRAW_FRAMEBUFFER,De.__webglFramebuffer[0]):n.bindFramebuffer(t.DRAW_FRAMEBUFFER,De.__webglFramebuffer);for(let Ie=0;Ie<A.length;Ie++){if(D.resolveDepthBuffer&&(D.depthBuffer&&(ae|=t.DEPTH_BUFFER_BIT),D.stencilBuffer&&D.resolveStencilBuffer&&(ae|=t.STENCIL_BUFFER_BIT)),pe){t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,De.__webglColorRenderbuffer[Ie]);const de=r.get(A[Ie]).__webglTexture;t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,de,0)}t.blitFramebuffer(0,0,G,ne,0,0,G,ne,ae,t.NEAREST),l===!0&&(Ee.length=0,He.length=0,Ee.push(t.COLOR_ATTACHMENT0+Ie),D.depthBuffer&&D.resolveDepthBuffer===!1&&(Ee.push(te),He.push(te),t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,He)),t.invalidateFramebuffer(t.READ_FRAMEBUFFER,Ee))}if(n.bindFramebuffer(t.READ_FRAMEBUFFER,null),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),pe)for(let Ie=0;Ie<A.length;Ie++){n.bindFramebuffer(t.FRAMEBUFFER,De.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+Ie,t.RENDERBUFFER,De.__webglColorRenderbuffer[Ie]);const de=r.get(A[Ie]).__webglTexture;n.bindFramebuffer(t.FRAMEBUFFER,De.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+Ie,t.TEXTURE_2D,de,0)}n.bindFramebuffer(t.DRAW_FRAMEBUFFER,De.__webglMultisampledFramebuffer)}else if(D.depthBuffer&&D.resolveDepthBuffer===!1&&l){const A=D.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,[A])}}}function it(D){return Math.min(i.maxSamples,D.samples)}function ge(D){const A=r.get(D);return D.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&A.__useRenderToTexture!==!1}function _e(D){const A=o.render.frame;u.get(D)!==A&&(u.set(D,A),D.update())}function Ve(D,A){const G=D.colorSpace,ne=D.format,ae=D.type;return D.isCompressedTexture===!0||D.isVideoTexture===!0||G!==cs&&G!==Or&&(dt.getTransfer(G)===xt?(ne!==Sr||ae!==Wn)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",G)),A}function et(D){return typeof HTMLImageElement<"u"&&D instanceof HTMLImageElement?(c.width=D.naturalWidth||D.width,c.height=D.naturalHeight||D.height):typeof VideoFrame<"u"&&D instanceof VideoFrame?(c.width=D.displayWidth,c.height=D.displayHeight):(c.width=D.width,c.height=D.height),c}this.allocateTextureUnit=O,this.resetTextureUnits=U,this.setTexture2D=Y,this.setTexture2DArray=z,this.setTexture3D=W,this.setTextureCube=L,this.rebindTextures=ie,this.setupRenderTarget=I,this.updateRenderTargetMipmap=be,this.updateMultisampleRenderTarget=Me,this.setupDepthRenderbuffer=re,this.setupFrameBufferTexture=he,this.useMultisampledRTT=ge}function s5(t,e){function n(r,i=Or){let s;const o=dt.getTransfer(i);if(r===Wn)return t.UNSIGNED_BYTE;if(r===a0)return t.UNSIGNED_SHORT_4_4_4_4;if(r===l0)return t.UNSIGNED_SHORT_5_5_5_1;if(r===eM)return t.UNSIGNED_INT_5_9_9_9_REV;if(r===ZT)return t.BYTE;if(r===QT)return t.SHORT;if(r===Zl)return t.UNSIGNED_SHORT;if(r===o0)return t.INT;if(r===ls)return t.UNSIGNED_INT;if(r===oi)return t.FLOAT;if(r===fc)return t.HALF_FLOAT;if(r===tM)return t.ALPHA;if(r===nM)return t.RGB;if(r===Sr)return t.RGBA;if(r===Ql)return t.DEPTH_COMPONENT;if(r===Ra)return t.DEPTH_STENCIL;if(r===rM)return t.RED;if(r===c0)return t.RED_INTEGER;if(r===iM)return t.RG;if(r===u0)return t.RG_INTEGER;if(r===d0)return t.RGBA_INTEGER;if(r===Uu||r===ku||r===Ou||r===Fu)if(o===xt)if(s=e.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(r===Uu)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(r===ku)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(r===Ou)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(r===Fu)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=e.get("WEBGL_compressed_texture_s3tc"),s!==null){if(r===Uu)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(r===ku)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(r===Ou)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(r===Fu)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(r===Ym||r===Km||r===Jm||r===Zm)if(s=e.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(r===Ym)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(r===Km)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(r===Jm)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(r===Zm)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(r===Qm||r===eg||r===tg)if(s=e.get("WEBGL_compressed_texture_etc"),s!==null){if(r===Qm||r===eg)return o===xt?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(r===tg)return o===xt?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(r===ng||r===rg||r===ig||r===sg||r===og||r===ag||r===lg||r===cg||r===ug||r===dg||r===fg||r===hg||r===pg||r===mg)if(s=e.get("WEBGL_compressed_texture_astc"),s!==null){if(r===ng)return o===xt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(r===rg)return o===xt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(r===ig)return o===xt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(r===sg)return o===xt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(r===og)return o===xt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(r===ag)return o===xt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(r===lg)return o===xt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(r===cg)return o===xt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(r===ug)return o===xt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(r===dg)return o===xt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(r===fg)return o===xt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(r===hg)return o===xt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(r===pg)return o===xt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(r===mg)return o===xt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(r===Bu||r===gg||r===vg)if(s=e.get("EXT_texture_compression_bptc"),s!==null){if(r===Bu)return o===xt?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(r===gg)return s.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(r===vg)return s.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(r===sM||r===xg||r===yg||r===_g)if(s=e.get("EXT_texture_compression_rgtc"),s!==null){if(r===Bu)return s.COMPRESSED_RED_RGTC1_EXT;if(r===xg)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(r===yg)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(r===_g)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return r===Aa?t.UNSIGNED_INT_24_8:t[r]!==void 0?t[r]:null}return{convert:n}}class SM extends an{constructor(e=null){super(),this.sourceTexture=e,this.isExternalTexture=!0}}const o5=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,a5=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class l5{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,n){if(this.texture===null){const r=new SM(e.texture);(e.depthNear!==n.depthNear||e.depthFar!==n.depthFar)&&(this.depthNear=e.depthNear,this.depthFar=e.depthFar),this.texture=r}}getMesh(e){if(this.texture!==null&&this.mesh===null){const n=e.cameras[0].viewport,r=new ar({vertexShader:o5,fragmentShader:a5,uniforms:{depthColor:{value:this.texture},depthWidth:{value:n.z},depthHeight:{value:n.w}}});this.mesh=new Er(new xc(20,20),r)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class c5 extends ys{constructor(e,n){super();const r=this;let i=null,s=1,o=null,a="local-floor",l=1,c=null,u=null,d=null,h=null,m=null,x=null;const v=new l5,g={},p=n.getContextAttributes();let y=null,_=null;const w=[],E=[],M=new Qe;let T=null;const P=new er;P.viewport=new Ht;const C=new er;C.viewport=new Ht;const b=[P,C],N=new RF;let U=null,O=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(Q){let oe=w[Q];return oe===void 0&&(oe=new Zh,w[Q]=oe),oe.getTargetRaySpace()},this.getControllerGrip=function(Q){let oe=w[Q];return oe===void 0&&(oe=new Zh,w[Q]=oe),oe.getGripSpace()},this.getHand=function(Q){let oe=w[Q];return oe===void 0&&(oe=new Zh,w[Q]=oe),oe.getHandSpace()};function V(Q){const oe=E.indexOf(Q.inputSource);if(oe===-1)return;const X=w[oe];X!==void 0&&(X.update(Q.inputSource,Q.frame,c||o),X.dispatchEvent({type:Q.type,data:Q.inputSource}))}function Y(){i.removeEventListener("select",V),i.removeEventListener("selectstart",V),i.removeEventListener("selectend",V),i.removeEventListener("squeeze",V),i.removeEventListener("squeezestart",V),i.removeEventListener("squeezeend",V),i.removeEventListener("end",Y),i.removeEventListener("inputsourceschange",z);for(let Q=0;Q<w.length;Q++){const oe=E[Q];oe!==null&&(E[Q]=null,w[Q].disconnect(oe))}U=null,O=null,v.reset();for(const Q in g)delete g[Q];e.setRenderTarget(y),m=null,h=null,d=null,i=null,_=null,Ue.stop(),r.isPresenting=!1,e.setPixelRatio(T),e.setSize(M.width,M.height,!1),r.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(Q){s=Q,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Q){a=Q,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||o},this.setReferenceSpace=function(Q){c=Q},this.getBaseLayer=function(){return h!==null?h:m},this.getBinding=function(){return d},this.getFrame=function(){return x},this.getSession=function(){return i},this.setSession=async function(Q){if(i=Q,i!==null){if(y=e.getRenderTarget(),i.addEventListener("select",V),i.addEventListener("selectstart",V),i.addEventListener("selectend",V),i.addEventListener("squeeze",V),i.addEventListener("squeezestart",V),i.addEventListener("squeezeend",V),i.addEventListener("end",Y),i.addEventListener("inputsourceschange",z),p.xrCompatible!==!0&&await n.makeXRCompatible(),T=e.getPixelRatio(),e.getSize(M),typeof XRWebGLBinding<"u"&&(d=new XRWebGLBinding(i,n)),d!==null&&"createProjectionLayer"in XRWebGLBinding.prototype){let X=null,he=null,J=null;p.depth&&(J=p.stencil?n.DEPTH24_STENCIL8:n.DEPTH_COMPONENT24,X=p.stencil?Ra:Ql,he=p.stencil?Aa:ls);const q={colorFormat:n.RGBA8,depthFormat:J,scaleFactor:s};h=d.createProjectionLayer(q),i.updateRenderState({layers:[h]}),e.setPixelRatio(1),e.setSize(h.textureWidth,h.textureHeight,!1),_=new Pr(h.textureWidth,h.textureHeight,{format:Sr,type:Wn,depthTexture:new g0(h.textureWidth,h.textureHeight,he,void 0,void 0,void 0,void 0,void 0,void 0,X),stencilBuffer:p.stencil,colorSpace:e.outputColorSpace,samples:p.antialias?4:0,resolveDepthBuffer:h.ignoreDepthValues===!1,resolveStencilBuffer:h.ignoreDepthValues===!1})}else{const X={antialias:p.antialias,alpha:!0,depth:p.depth,stencil:p.stencil,framebufferScaleFactor:s};m=new XRWebGLLayer(i,n,X),i.updateRenderState({baseLayer:m}),e.setPixelRatio(1),e.setSize(m.framebufferWidth,m.framebufferHeight,!1),_=new Pr(m.framebufferWidth,m.framebufferHeight,{format:Sr,type:Wn,colorSpace:e.outputColorSpace,stencilBuffer:p.stencil,resolveDepthBuffer:m.ignoreDepthValues===!1,resolveStencilBuffer:m.ignoreDepthValues===!1})}_.isXRRenderTarget=!0,this.setFoveation(l),c=null,o=await i.requestReferenceSpace(a),Ue.setContext(i),Ue.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(i!==null)return i.environmentBlendMode},this.getDepthTexture=function(){return v.getDepthTexture()};function z(Q){for(let oe=0;oe<Q.removed.length;oe++){const X=Q.removed[oe],he=E.indexOf(X);he>=0&&(E[he]=null,w[he].disconnect(X))}for(let oe=0;oe<Q.added.length;oe++){const X=Q.added[oe];let he=E.indexOf(X);if(he===-1){for(let q=0;q<w.length;q++)if(q>=E.length){E.push(X),he=q;break}else if(E[q]===null){E[q]=X,he=q;break}if(he===-1)break}const J=w[he];J&&J.connect(X)}}const W=new Z,L=new Z;function H(Q,oe,X){W.setFromMatrixPosition(oe.matrixWorld),L.setFromMatrixPosition(X.matrixWorld);const he=W.distanceTo(L),J=oe.projectionMatrix.elements,q=X.projectionMatrix.elements,re=J[14]/(J[10]-1),ie=J[14]/(J[10]+1),I=(J[9]+1)/J[5],be=(J[9]-1)/J[5],Ee=(J[8]-1)/J[0],He=(q[8]+1)/q[0],Me=re*Ee,it=re*He,ge=he/(-Ee+He),_e=ge*-Ee;if(oe.matrixWorld.decompose(Q.position,Q.quaternion,Q.scale),Q.translateX(_e),Q.translateZ(ge),Q.matrixWorld.compose(Q.position,Q.quaternion,Q.scale),Q.matrixWorldInverse.copy(Q.matrixWorld).invert(),J[10]===-1)Q.projectionMatrix.copy(oe.projectionMatrix),Q.projectionMatrixInverse.copy(oe.projectionMatrixInverse);else{const Ve=re+ge,et=ie+ge,D=Me-_e,A=it+(he-_e),G=I*ie/et*Ve,ne=be*ie/et*Ve;Q.projectionMatrix.makePerspective(D,A,G,ne,Ve,et),Q.projectionMatrixInverse.copy(Q.projectionMatrix).invert()}}function j(Q,oe){oe===null?Q.matrixWorld.copy(Q.matrix):Q.matrixWorld.multiplyMatrices(oe.matrixWorld,Q.matrix),Q.matrixWorldInverse.copy(Q.matrixWorld).invert()}this.updateCamera=function(Q){if(i===null)return;let oe=Q.near,X=Q.far;v.texture!==null&&(v.depthNear>0&&(oe=v.depthNear),v.depthFar>0&&(X=v.depthFar)),N.near=C.near=P.near=oe,N.far=C.far=P.far=X,(U!==N.near||O!==N.far)&&(i.updateRenderState({depthNear:N.near,depthFar:N.far}),U=N.near,O=N.far),N.layers.mask=Q.layers.mask|6,P.layers.mask=N.layers.mask&3,C.layers.mask=N.layers.mask&5;const he=Q.parent,J=N.cameras;j(N,he);for(let q=0;q<J.length;q++)j(J[q],he);J.length===2?H(N,P,C):N.projectionMatrix.copy(P.projectionMatrix),ee(Q,N,he)};function ee(Q,oe,X){X===null?Q.matrix.copy(oe.matrixWorld):(Q.matrix.copy(X.matrixWorld),Q.matrix.invert(),Q.matrix.multiply(oe.matrixWorld)),Q.matrix.decompose(Q.position,Q.quaternion,Q.scale),Q.updateMatrixWorld(!0),Q.projectionMatrix.copy(oe.projectionMatrix),Q.projectionMatrixInverse.copy(oe.projectionMatrixInverse),Q.isPerspectiveCamera&&(Q.fov=Sg*2*Math.atan(1/Q.projectionMatrix.elements[5]),Q.zoom=1)}this.getCamera=function(){return N},this.getFoveation=function(){if(!(h===null&&m===null))return l},this.setFoveation=function(Q){l=Q,h!==null&&(h.fixedFoveation=Q),m!==null&&m.fixedFoveation!==void 0&&(m.fixedFoveation=Q)},this.hasDepthSensing=function(){return v.texture!==null},this.getDepthSensingMesh=function(){return v.getMesh(N)},this.getCameraTexture=function(Q){return g[Q]};let ve=null;function Be(Q,oe){if(u=oe.getViewerPose(c||o),x=oe,u!==null){const X=u.views;m!==null&&(e.setRenderTargetFramebuffer(_,m.framebuffer),e.setRenderTarget(_));let he=!1;X.length!==N.cameras.length&&(N.cameras.length=0,he=!0);for(let ie=0;ie<X.length;ie++){const I=X[ie];let be=null;if(m!==null)be=m.getViewport(I);else{const He=d.getViewSubImage(h,I);be=He.viewport,ie===0&&(e.setRenderTargetTextures(_,He.colorTexture,He.depthStencilTexture),e.setRenderTarget(_))}let Ee=b[ie];Ee===void 0&&(Ee=new er,Ee.layers.enable(ie),Ee.viewport=new Ht,b[ie]=Ee),Ee.matrix.fromArray(I.transform.matrix),Ee.matrix.decompose(Ee.position,Ee.quaternion,Ee.scale),Ee.projectionMatrix.fromArray(I.projectionMatrix),Ee.projectionMatrixInverse.copy(Ee.projectionMatrix).invert(),Ee.viewport.set(be.x,be.y,be.width,be.height),ie===0&&(N.matrix.copy(Ee.matrix),N.matrix.decompose(N.position,N.quaternion,N.scale)),he===!0&&N.cameras.push(Ee)}const J=i.enabledFeatures;if(J&&J.includes("depth-sensing")&&i.depthUsage=="gpu-optimized"&&d){const ie=d.getDepthInformation(X[0]);ie&&ie.isValid&&ie.texture&&v.init(ie,i.renderState)}if(J&&J.includes("camera-access")&&(e.state.unbindTexture(),d))for(let ie=0;ie<X.length;ie++){const I=X[ie].camera;if(I){let be=g[I];be||(be=new SM,g[I]=be);const Ee=d.getCameraImage(I);be.sourceTexture=Ee}}}for(let X=0;X<w.length;X++){const he=E[X],J=w[X];he!==null&&J!==void 0&&J.update(he,oe,c||o)}ve&&ve(Q,oe),oe.detectedPlanes&&r.dispatchEvent({type:"planesdetected",data:oe}),x=null}const Ue=new vM;Ue.setAnimationLoop(Be),this.setAnimationLoop=function(Q){ve=Q},this.dispose=function(){}}}const Ns=new vi,u5=new Kt;function d5(t,e){function n(g,p){g.matrixAutoUpdate===!0&&g.updateMatrix(),p.value.copy(g.matrix)}function r(g,p){p.color.getRGB(g.fogColor.value,hM(t)),p.isFog?(g.fogNear.value=p.near,g.fogFar.value=p.far):p.isFogExp2&&(g.fogDensity.value=p.density)}function i(g,p,y,_,w){p.isMeshBasicMaterial||p.isMeshLambertMaterial?s(g,p):p.isMeshToonMaterial?(s(g,p),d(g,p)):p.isMeshPhongMaterial?(s(g,p),u(g,p)):p.isMeshStandardMaterial?(s(g,p),h(g,p),p.isMeshPhysicalMaterial&&m(g,p,w)):p.isMeshMatcapMaterial?(s(g,p),x(g,p)):p.isMeshDepthMaterial?s(g,p):p.isMeshDistanceMaterial?(s(g,p),v(g,p)):p.isMeshNormalMaterial?s(g,p):p.isLineBasicMaterial?(o(g,p),p.isLineDashedMaterial&&a(g,p)):p.isPointsMaterial?l(g,p,y,_):p.isSpriteMaterial?c(g,p):p.isShadowMaterial?(g.color.value.copy(p.color),g.opacity.value=p.opacity):p.isShaderMaterial&&(p.uniformsNeedUpdate=!1)}function s(g,p){g.opacity.value=p.opacity,p.color&&g.diffuse.value.copy(p.color),p.emissive&&g.emissive.value.copy(p.emissive).multiplyScalar(p.emissiveIntensity),p.map&&(g.map.value=p.map,n(p.map,g.mapTransform)),p.alphaMap&&(g.alphaMap.value=p.alphaMap,n(p.alphaMap,g.alphaMapTransform)),p.bumpMap&&(g.bumpMap.value=p.bumpMap,n(p.bumpMap,g.bumpMapTransform),g.bumpScale.value=p.bumpScale,p.side===nn&&(g.bumpScale.value*=-1)),p.normalMap&&(g.normalMap.value=p.normalMap,n(p.normalMap,g.normalMapTransform),g.normalScale.value.copy(p.normalScale),p.side===nn&&g.normalScale.value.negate()),p.displacementMap&&(g.displacementMap.value=p.displacementMap,n(p.displacementMap,g.displacementMapTransform),g.displacementScale.value=p.displacementScale,g.displacementBias.value=p.displacementBias),p.emissiveMap&&(g.emissiveMap.value=p.emissiveMap,n(p.emissiveMap,g.emissiveMapTransform)),p.specularMap&&(g.specularMap.value=p.specularMap,n(p.specularMap,g.specularMapTransform)),p.alphaTest>0&&(g.alphaTest.value=p.alphaTest);const y=e.get(p),_=y.envMap,w=y.envMapRotation;_&&(g.envMap.value=_,Ns.copy(w),Ns.x*=-1,Ns.y*=-1,Ns.z*=-1,_.isCubeTexture&&_.isRenderTargetTexture===!1&&(Ns.y*=-1,Ns.z*=-1),g.envMapRotation.value.setFromMatrix4(u5.makeRotationFromEuler(Ns)),g.flipEnvMap.value=_.isCubeTexture&&_.isRenderTargetTexture===!1?-1:1,g.reflectivity.value=p.reflectivity,g.ior.value=p.ior,g.refractionRatio.value=p.refractionRatio),p.lightMap&&(g.lightMap.value=p.lightMap,g.lightMapIntensity.value=p.lightMapIntensity,n(p.lightMap,g.lightMapTransform)),p.aoMap&&(g.aoMap.value=p.aoMap,g.aoMapIntensity.value=p.aoMapIntensity,n(p.aoMap,g.aoMapTransform))}function o(g,p){g.diffuse.value.copy(p.color),g.opacity.value=p.opacity,p.map&&(g.map.value=p.map,n(p.map,g.mapTransform))}function a(g,p){g.dashSize.value=p.dashSize,g.totalSize.value=p.dashSize+p.gapSize,g.scale.value=p.scale}function l(g,p,y,_){g.diffuse.value.copy(p.color),g.opacity.value=p.opacity,g.size.value=p.size*y,g.scale.value=_*.5,p.map&&(g.map.value=p.map,n(p.map,g.uvTransform)),p.alphaMap&&(g.alphaMap.value=p.alphaMap,n(p.alphaMap,g.alphaMapTransform)),p.alphaTest>0&&(g.alphaTest.value=p.alphaTest)}function c(g,p){g.diffuse.value.copy(p.color),g.opacity.value=p.opacity,g.rotation.value=p.rotation,p.map&&(g.map.value=p.map,n(p.map,g.mapTransform)),p.alphaMap&&(g.alphaMap.value=p.alphaMap,n(p.alphaMap,g.alphaMapTransform)),p.alphaTest>0&&(g.alphaTest.value=p.alphaTest)}function u(g,p){g.specular.value.copy(p.specular),g.shininess.value=Math.max(p.shininess,1e-4)}function d(g,p){p.gradientMap&&(g.gradientMap.value=p.gradientMap)}function h(g,p){g.metalness.value=p.metalness,p.metalnessMap&&(g.metalnessMap.value=p.metalnessMap,n(p.metalnessMap,g.metalnessMapTransform)),g.roughness.value=p.roughness,p.roughnessMap&&(g.roughnessMap.value=p.roughnessMap,n(p.roughnessMap,g.roughnessMapTransform)),p.envMap&&(g.envMapIntensity.value=p.envMapIntensity)}function m(g,p,y){g.ior.value=p.ior,p.sheen>0&&(g.sheenColor.value.copy(p.sheenColor).multiplyScalar(p.sheen),g.sheenRoughness.value=p.sheenRoughness,p.sheenColorMap&&(g.sheenColorMap.value=p.sheenColorMap,n(p.sheenColorMap,g.sheenColorMapTransform)),p.sheenRoughnessMap&&(g.sheenRoughnessMap.value=p.sheenRoughnessMap,n(p.sheenRoughnessMap,g.sheenRoughnessMapTransform))),p.clearcoat>0&&(g.clearcoat.value=p.clearcoat,g.clearcoatRoughness.value=p.clearcoatRoughness,p.clearcoatMap&&(g.clearcoatMap.value=p.clearcoatMap,n(p.clearcoatMap,g.clearcoatMapTransform)),p.clearcoatRoughnessMap&&(g.clearcoatRoughnessMap.value=p.clearcoatRoughnessMap,n(p.clearcoatRoughnessMap,g.clearcoatRoughnessMapTransform)),p.clearcoatNormalMap&&(g.clearcoatNormalMap.value=p.clearcoatNormalMap,n(p.clearcoatNormalMap,g.clearcoatNormalMapTransform),g.clearcoatNormalScale.value.copy(p.clearcoatNormalScale),p.side===nn&&g.clearcoatNormalScale.value.negate())),p.dispersion>0&&(g.dispersion.value=p.dispersion),p.iridescence>0&&(g.iridescence.value=p.iridescence,g.iridescenceIOR.value=p.iridescenceIOR,g.iridescenceThicknessMinimum.value=p.iridescenceThicknessRange[0],g.iridescenceThicknessMaximum.value=p.iridescenceThicknessRange[1],p.iridescenceMap&&(g.iridescenceMap.value=p.iridescenceMap,n(p.iridescenceMap,g.iridescenceMapTransform)),p.iridescenceThicknessMap&&(g.iridescenceThicknessMap.value=p.iridescenceThicknessMap,n(p.iridescenceThicknessMap,g.iridescenceThicknessMapTransform))),p.transmission>0&&(g.transmission.value=p.transmission,g.transmissionSamplerMap.value=y.texture,g.transmissionSamplerSize.value.set(y.width,y.height),p.transmissionMap&&(g.transmissionMap.value=p.transmissionMap,n(p.transmissionMap,g.transmissionMapTransform)),g.thickness.value=p.thickness,p.thicknessMap&&(g.thicknessMap.value=p.thicknessMap,n(p.thicknessMap,g.thicknessMapTransform)),g.attenuationDistance.value=p.attenuationDistance,g.attenuationColor.value.copy(p.attenuationColor)),p.anisotropy>0&&(g.anisotropyVector.value.set(p.anisotropy*Math.cos(p.anisotropyRotation),p.anisotropy*Math.sin(p.anisotropyRotation)),p.anisotropyMap&&(g.anisotropyMap.value=p.anisotropyMap,n(p.anisotropyMap,g.anisotropyMapTransform))),g.specularIntensity.value=p.specularIntensity,g.specularColor.value.copy(p.specularColor),p.specularColorMap&&(g.specularColorMap.value=p.specularColorMap,n(p.specularColorMap,g.specularColorMapTransform)),p.specularIntensityMap&&(g.specularIntensityMap.value=p.specularIntensityMap,n(p.specularIntensityMap,g.specularIntensityMapTransform))}function x(g,p){p.matcap&&(g.matcap.value=p.matcap)}function v(g,p){const y=e.get(p).light;g.referencePosition.value.setFromMatrixPosition(y.matrixWorld),g.nearDistance.value=y.shadow.camera.near,g.farDistance.value=y.shadow.camera.far}return{refreshFogUniforms:r,refreshMaterialUniforms:i}}function f5(t,e,n,r){let i={},s={},o=[];const a=t.getParameter(t.MAX_UNIFORM_BUFFER_BINDINGS);function l(y,_){const w=_.program;r.uniformBlockBinding(y,w)}function c(y,_){let w=i[y.id];w===void 0&&(x(y),w=u(y),i[y.id]=w,y.addEventListener("dispose",g));const E=_.program;r.updateUBOMapping(y,E);const M=e.render.frame;s[y.id]!==M&&(h(y),s[y.id]=M)}function u(y){const _=d();y.__bindingPointIndex=_;const w=t.createBuffer(),E=y.__size,M=y.usage;return t.bindBuffer(t.UNIFORM_BUFFER,w),t.bufferData(t.UNIFORM_BUFFER,E,M),t.bindBuffer(t.UNIFORM_BUFFER,null),t.bindBufferBase(t.UNIFORM_BUFFER,_,w),w}function d(){for(let y=0;y<a;y++)if(o.indexOf(y)===-1)return o.push(y),y;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function h(y){const _=i[y.id],w=y.uniforms,E=y.__cache;t.bindBuffer(t.UNIFORM_BUFFER,_);for(let M=0,T=w.length;M<T;M++){const P=Array.isArray(w[M])?w[M]:[w[M]];for(let C=0,b=P.length;C<b;C++){const N=P[C];if(m(N,M,C,E)===!0){const U=N.__offset,O=Array.isArray(N.value)?N.value:[N.value];let V=0;for(let Y=0;Y<O.length;Y++){const z=O[Y],W=v(z);typeof z=="number"||typeof z=="boolean"?(N.__data[0]=z,t.bufferSubData(t.UNIFORM_BUFFER,U+V,N.__data)):z.isMatrix3?(N.__data[0]=z.elements[0],N.__data[1]=z.elements[1],N.__data[2]=z.elements[2],N.__data[3]=0,N.__data[4]=z.elements[3],N.__data[5]=z.elements[4],N.__data[6]=z.elements[5],N.__data[7]=0,N.__data[8]=z.elements[6],N.__data[9]=z.elements[7],N.__data[10]=z.elements[8],N.__data[11]=0):(z.toArray(N.__data,V),V+=W.storage/Float32Array.BYTES_PER_ELEMENT)}t.bufferSubData(t.UNIFORM_BUFFER,U,N.__data)}}}t.bindBuffer(t.UNIFORM_BUFFER,null)}function m(y,_,w,E){const M=y.value,T=_+"_"+w;if(E[T]===void 0)return typeof M=="number"||typeof M=="boolean"?E[T]=M:E[T]=M.clone(),!0;{const P=E[T];if(typeof M=="number"||typeof M=="boolean"){if(P!==M)return E[T]=M,!0}else if(P.equals(M)===!1)return P.copy(M),!0}return!1}function x(y){const _=y.uniforms;let w=0;const E=16;for(let T=0,P=_.length;T<P;T++){const C=Array.isArray(_[T])?_[T]:[_[T]];for(let b=0,N=C.length;b<N;b++){const U=C[b],O=Array.isArray(U.value)?U.value:[U.value];for(let V=0,Y=O.length;V<Y;V++){const z=O[V],W=v(z),L=w%E,H=L%W.boundary,j=L+H;w+=H,j!==0&&E-j<W.storage&&(w+=E-j),U.__data=new Float32Array(W.storage/Float32Array.BYTES_PER_ELEMENT),U.__offset=w,w+=W.storage}}}const M=w%E;return M>0&&(w+=E-M),y.__size=w,y.__cache={},this}function v(y){const _={boundary:0,storage:0};return typeof y=="number"||typeof y=="boolean"?(_.boundary=4,_.storage=4):y.isVector2?(_.boundary=8,_.storage=8):y.isVector3||y.isColor?(_.boundary=16,_.storage=12):y.isVector4?(_.boundary=16,_.storage=16):y.isMatrix3?(_.boundary=48,_.storage=48):y.isMatrix4?(_.boundary=64,_.storage=64):y.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",y),_}function g(y){const _=y.target;_.removeEventListener("dispose",g);const w=o.indexOf(_.__bindingPointIndex);o.splice(w,1),t.deleteBuffer(i[_.id]),delete i[_.id],delete s[_.id]}function p(){for(const y in i)t.deleteBuffer(i[y]);o=[],i={},s={}}return{bind:l,update:c,dispose:p}}class h5{constructor(e={}){const{canvas:n=JO(),context:r=null,depth:i=!0,stencil:s=!1,alpha:o=!1,antialias:a=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:c=!1,powerPreference:u="default",failIfMajorPerformanceCaveat:d=!1,reversedDepthBuffer:h=!1}=e;this.isWebGLRenderer=!0;let m;if(r!==null){if(typeof WebGLRenderingContext<"u"&&r instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");m=r.getContextAttributes().alpha}else m=o;const x=new Uint32Array(4),v=new Int32Array(4);let g=null,p=null;const y=[],_=[];this.domElement=n,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=Qi,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const w=this;let E=!1;this._outputColorSpace=zt;let M=0,T=0,P=null,C=-1,b=null;const N=new Ht,U=new Ht;let O=null;const V=new pt(0);let Y=0,z=n.width,W=n.height,L=1,H=null,j=null;const ee=new Ht(0,0,z,W),ve=new Ht(0,0,z,W);let Be=!1;const Ue=new mM;let Q=!1,oe=!1;const X=new Kt,he=new Z,J=new Ht,q={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let re=!1;function ie(){return P===null?L:1}let I=r;function be(R,F){return n.getContext(R,F)}try{const R={alpha:!0,depth:i,stencil:s,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:c,powerPreference:u,failIfMajorPerformanceCaveat:d};if("setAttribute"in n&&n.setAttribute("data-engine",`three.js r${Mf}`),n.addEventListener("webglcontextlost",me,!1),n.addEventListener("webglcontextrestored",Ae,!1),n.addEventListener("webglcontextcreationerror",ce,!1),I===null){const F="webgl2";if(I=be(F,R),I===null)throw be(F)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(R){throw console.error("THREE.WebGLRenderer: "+R.message),R}let Ee,He,Me,it,ge,_e,Ve,et,D,A,G,ne,ae,te,De,pe,Ne,Ie,de,Se,je,Le,ye,qe;function k(){Ee=new Ej(I),Ee.init(),Le=new s5(I,Ee),He=new gj(I,Ee,e,Le),Me=new r5(I,Ee),He.reversedDepthBuffer&&h&&Me.buffers.depth.setReversed(!0),it=new Mj(I),ge=new Gz,_e=new i5(I,Ee,Me,ge,He,Le,it),Ve=new xj(w),et=new Sj(w),D=new IF(I),ye=new pj(I,D),A=new bj(I,D,it,ye),G=new Aj(I,A,D,it),de=new Cj(I,He,_e),pe=new vj(ge),ne=new Hz(w,Ve,et,Ee,He,ye,pe),ae=new d5(w,ge),te=new $z,De=new Zz(Ee),Ie=new hj(w,Ve,et,Me,G,m,l),Ne=new t5(w,G,He),qe=new f5(I,it,He,Me),Se=new mj(I,Ee,it),je=new Tj(I,Ee,it),it.programs=ne.programs,w.capabilities=He,w.extensions=Ee,w.properties=ge,w.renderLists=te,w.shadowMap=Ne,w.state=Me,w.info=it}k();const fe=new c5(w,I);this.xr=fe,this.getContext=function(){return I},this.getContextAttributes=function(){return I.getContextAttributes()},this.forceContextLoss=function(){const R=Ee.get("WEBGL_lose_context");R&&R.loseContext()},this.forceContextRestore=function(){const R=Ee.get("WEBGL_lose_context");R&&R.restoreContext()},this.getPixelRatio=function(){return L},this.setPixelRatio=function(R){R!==void 0&&(L=R,this.setSize(z,W,!1))},this.getSize=function(R){return R.set(z,W)},this.setSize=function(R,F,$=!0){if(fe.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}z=R,W=F,n.width=Math.floor(R*L),n.height=Math.floor(F*L),$===!0&&(n.style.width=R+"px",n.style.height=F+"px"),this.setViewport(0,0,R,F)},this.getDrawingBufferSize=function(R){return R.set(z*L,W*L).floor()},this.setDrawingBufferSize=function(R,F,$){z=R,W=F,L=$,n.width=Math.floor(R*$),n.height=Math.floor(F*$),this.setViewport(0,0,R,F)},this.getCurrentViewport=function(R){return R.copy(N)},this.getViewport=function(R){return R.copy(ee)},this.setViewport=function(R,F,$,K){R.isVector4?ee.set(R.x,R.y,R.z,R.w):ee.set(R,F,$,K),Me.viewport(N.copy(ee).multiplyScalar(L).round())},this.getScissor=function(R){return R.copy(ve)},this.setScissor=function(R,F,$,K){R.isVector4?ve.set(R.x,R.y,R.z,R.w):ve.set(R,F,$,K),Me.scissor(U.copy(ve).multiplyScalar(L).round())},this.getScissorTest=function(){return Be},this.setScissorTest=function(R){Me.setScissorTest(Be=R)},this.setOpaqueSort=function(R){H=R},this.setTransparentSort=function(R){j=R},this.getClearColor=function(R){return R.copy(Ie.getClearColor())},this.setClearColor=function(){Ie.setClearColor(...arguments)},this.getClearAlpha=function(){return Ie.getClearAlpha()},this.setClearAlpha=function(){Ie.setClearAlpha(...arguments)},this.clear=function(R=!0,F=!0,$=!0){let K=0;if(R){let B=!1;if(P!==null){const ue=P.texture.format;B=ue===d0||ue===u0||ue===c0}if(B){const ue=P.texture.type,we=ue===Wn||ue===ls||ue===Zl||ue===Aa||ue===a0||ue===l0,Re=Ie.getClearColor(),Ce=Ie.getClearAlpha(),Fe=Re.r,ze=Re.g,ke=Re.b;we?(x[0]=Fe,x[1]=ze,x[2]=ke,x[3]=Ce,I.clearBufferuiv(I.COLOR,0,x)):(v[0]=Fe,v[1]=ze,v[2]=ke,v[3]=Ce,I.clearBufferiv(I.COLOR,0,v))}else K|=I.COLOR_BUFFER_BIT}F&&(K|=I.DEPTH_BUFFER_BIT),$&&(K|=I.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),I.clear(K)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){n.removeEventListener("webglcontextlost",me,!1),n.removeEventListener("webglcontextrestored",Ae,!1),n.removeEventListener("webglcontextcreationerror",ce,!1),Ie.dispose(),te.dispose(),De.dispose(),ge.dispose(),Ve.dispose(),et.dispose(),G.dispose(),ye.dispose(),qe.dispose(),ne.dispose(),fe.dispose(),fe.removeEventListener("sessionstart",Nr),fe.removeEventListener("sessionend",x0),Ss.stop()};function me(R){R.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),E=!0}function Ae(){console.log("THREE.WebGLRenderer: Context Restored."),E=!1;const R=it.autoReset,F=Ne.enabled,$=Ne.autoUpdate,K=Ne.needsUpdate,B=Ne.type;k(),it.autoReset=R,Ne.enabled=F,Ne.autoUpdate=$,Ne.needsUpdate=K,Ne.type=B}function ce(R){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",R.statusMessage)}function se(R){const F=R.target;F.removeEventListener("dispose",se),Pe(F)}function Pe(R){Ge(R),ge.remove(R)}function Ge(R){const F=ge.get(R).programs;F!==void 0&&(F.forEach(function($){ne.releaseProgram($)}),R.isShaderMaterial&&ne.releaseShaderCache(R))}this.renderBufferDirect=function(R,F,$,K,B,ue){F===null&&(F=q);const we=B.isMesh&&B.matrixWorld.determinant()<0,Re=TM(R,F,$,K,B);Me.setMaterial(K,we);let Ce=$.index,Fe=1;if(K.wireframe===!0){if(Ce=A.getWireframeAttribute($),Ce===void 0)return;Fe=2}const ze=$.drawRange,ke=$.attributes.position;let st=ze.start*Fe,vt=(ze.start+ze.count)*Fe;ue!==null&&(st=Math.max(st,ue.start*Fe),vt=Math.min(vt,(ue.start+ue.count)*Fe)),Ce!==null?(st=Math.max(st,0),vt=Math.min(vt,Ce.count)):ke!=null&&(st=Math.max(st,0),vt=Math.min(vt,ke.count));const Ot=vt-st;if(Ot<0||Ot===1/0)return;ye.setup(B,K,Re,$,Ce);let Tt,yt=Se;if(Ce!==null&&(Tt=D.get(Ce),yt=je,yt.setIndex(Tt)),B.isMesh)K.wireframe===!0?(Me.setLineWidth(K.wireframeLinewidth*ie()),yt.setMode(I.LINES)):yt.setMode(I.TRIANGLES);else if(B.isLine){let Oe=K.linewidth;Oe===void 0&&(Oe=1),Me.setLineWidth(Oe*ie()),B.isLineSegments?yt.setMode(I.LINES):B.isLineLoop?yt.setMode(I.LINE_LOOP):yt.setMode(I.LINE_STRIP)}else B.isPoints?yt.setMode(I.POINTS):B.isSprite&&yt.setMode(I.TRIANGLES);if(B.isBatchedMesh)if(B._multiDrawInstances!==null)la("THREE.WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),yt.renderMultiDrawInstances(B._multiDrawStarts,B._multiDrawCounts,B._multiDrawCount,B._multiDrawInstances);else if(Ee.get("WEBGL_multi_draw"))yt.renderMultiDraw(B._multiDrawStarts,B._multiDrawCounts,B._multiDrawCount);else{const Oe=B._multiDrawStarts,Pt=B._multiDrawCounts,ut=B._multiDrawCount,Ln=Ce?D.get(Ce).bytesPerElement:1,uo=ge.get(K).currentProgram.getUniforms();for(let Dn=0;Dn<ut;Dn++)uo.setValue(I,"_gl_DrawID",Dn),yt.render(Oe[Dn]/Ln,Pt[Dn])}else if(B.isInstancedMesh)yt.renderInstances(st,Ot,B.count);else if($.isInstancedBufferGeometry){const Oe=$._maxInstanceCount!==void 0?$._maxInstanceCount:1/0,Pt=Math.min($.instanceCount,Oe);yt.renderInstances(st,Ot,Pt)}else yt.render(st,Ot)};function St(R,F,$){R.transparent===!0&&R.side===Bn&&R.forceSinglePass===!1?(R.side=nn,R.needsUpdate=!0,_c(R,F,$),R.side=gi,R.needsUpdate=!0,_c(R,F,$),R.side=Bn):_c(R,F,$)}this.compile=function(R,F,$=null){$===null&&($=R),p=De.get($),p.init(F),_.push(p),$.traverseVisible(function(B){B.isLight&&B.layers.test(F.layers)&&(p.pushLight(B),B.castShadow&&p.pushShadow(B))}),R!==$&&R.traverseVisible(function(B){B.isLight&&B.layers.test(F.layers)&&(p.pushLight(B),B.castShadow&&p.pushShadow(B))}),p.setupLights();const K=new Set;return R.traverse(function(B){if(!(B.isMesh||B.isPoints||B.isLine||B.isSprite))return;const ue=B.material;if(ue)if(Array.isArray(ue))for(let we=0;we<ue.length;we++){const Re=ue[we];St(Re,$,B),K.add(Re)}else St(ue,$,B),K.add(ue)}),p=_.pop(),K},this.compileAsync=function(R,F,$=null){const K=this.compile(R,F,$);return new Promise(B=>{function ue(){if(K.forEach(function(we){ge.get(we).currentProgram.isReady()&&K.delete(we)}),K.size===0){B(R);return}setTimeout(ue,10)}Ee.get("KHR_parallel_shader_compile")!==null?ue():setTimeout(ue,10)})};let ht=null;function $r(R){ht&&ht(R)}function Nr(){Ss.stop()}function x0(){Ss.start()}const Ss=new vM;Ss.setAnimationLoop($r),typeof self<"u"&&Ss.setContext(self),this.setAnimationLoop=function(R){ht=R,fe.setAnimationLoop(R),R===null?Ss.stop():Ss.start()},fe.addEventListener("sessionstart",Nr),fe.addEventListener("sessionend",x0),this.render=function(R,F){if(F!==void 0&&F.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(E===!0)return;if(R.matrixWorldAutoUpdate===!0&&R.updateMatrixWorld(),F.parent===null&&F.matrixWorldAutoUpdate===!0&&F.updateMatrixWorld(),fe.enabled===!0&&fe.isPresenting===!0&&(fe.cameraAutoUpdate===!0&&fe.updateCamera(F),F=fe.getCamera()),R.isScene===!0&&R.onBeforeRender(w,R,F,P),p=De.get(R,_.length),p.init(F),_.push(p),X.multiplyMatrices(F.projectionMatrix,F.matrixWorldInverse),Ue.setFromProjectionMatrix(X,Fr,F.reversedDepth),oe=this.localClippingEnabled,Q=pe.init(this.clippingPlanes,oe),g=te.get(R,y.length),g.init(),y.push(g),fe.enabled===!0&&fe.isPresenting===!0){const ue=w.xr.getDepthSensingMesh();ue!==null&&Rf(ue,F,-1/0,w.sortObjects)}Rf(R,F,0,w.sortObjects),g.finish(),w.sortObjects===!0&&g.sort(H,j),re=fe.enabled===!1||fe.isPresenting===!1||fe.hasDepthSensing()===!1,re&&Ie.addToRenderList(g,R),this.info.render.frame++,Q===!0&&pe.beginShadows();const $=p.state.shadowsArray;Ne.render($,R,F),Q===!0&&pe.endShadows(),this.info.autoReset===!0&&this.info.reset();const K=g.opaque,B=g.transmissive;if(p.setupLights(),F.isArrayCamera){const ue=F.cameras;if(B.length>0)for(let we=0,Re=ue.length;we<Re;we++){const Ce=ue[we];_0(K,B,R,Ce)}re&&Ie.render(R);for(let we=0,Re=ue.length;we<Re;we++){const Ce=ue[we];y0(g,R,Ce,Ce.viewport)}}else B.length>0&&_0(K,B,R,F),re&&Ie.render(R),y0(g,R,F);P!==null&&T===0&&(_e.updateMultisampleRenderTarget(P),_e.updateRenderTargetMipmap(P)),R.isScene===!0&&R.onAfterRender(w,R,F),ye.resetDefaultState(),C=-1,b=null,_.pop(),_.length>0?(p=_[_.length-1],Q===!0&&pe.setGlobalState(w.clippingPlanes,p.state.camera)):p=null,y.pop(),y.length>0?g=y[y.length-1]:g=null};function Rf(R,F,$,K){if(R.visible===!1)return;if(R.layers.test(F.layers)){if(R.isGroup)$=R.renderOrder;else if(R.isLOD)R.autoUpdate===!0&&R.update(F);else if(R.isLight)p.pushLight(R),R.castShadow&&p.pushShadow(R);else if(R.isSprite){if(!R.frustumCulled||Ue.intersectsSprite(R)){K&&J.setFromMatrixPosition(R.matrixWorld).applyMatrix4(X);const we=G.update(R),Re=R.material;Re.visible&&g.push(R,we,Re,$,J.z,null)}}else if((R.isMesh||R.isLine||R.isPoints)&&(!R.frustumCulled||Ue.intersectsObject(R))){const we=G.update(R),Re=R.material;if(K&&(R.boundingSphere!==void 0?(R.boundingSphere===null&&R.computeBoundingSphere(),J.copy(R.boundingSphere.center)):(we.boundingSphere===null&&we.computeBoundingSphere(),J.copy(we.boundingSphere.center)),J.applyMatrix4(R.matrixWorld).applyMatrix4(X)),Array.isArray(Re)){const Ce=we.groups;for(let Fe=0,ze=Ce.length;Fe<ze;Fe++){const ke=Ce[Fe],st=Re[ke.materialIndex];st&&st.visible&&g.push(R,we,st,$,J.z,ke)}}else Re.visible&&g.push(R,we,Re,$,J.z,null)}}const ue=R.children;for(let we=0,Re=ue.length;we<Re;we++)Rf(ue[we],F,$,K)}function y0(R,F,$,K){const B=R.opaque,ue=R.transmissive,we=R.transparent;p.setupLightsView($),Q===!0&&pe.setGlobalState(w.clippingPlanes,$),K&&Me.viewport(N.copy(K)),B.length>0&&yc(B,F,$),ue.length>0&&yc(ue,F,$),we.length>0&&yc(we,F,$),Me.buffers.depth.setTest(!0),Me.buffers.depth.setMask(!0),Me.buffers.color.setMask(!0),Me.setPolygonOffset(!1)}function _0(R,F,$,K){if(($.isScene===!0?$.overrideMaterial:null)!==null)return;p.state.transmissionRenderTarget[K.id]===void 0&&(p.state.transmissionRenderTarget[K.id]=new Pr(1,1,{generateMipmaps:!0,type:Ee.has("EXT_color_buffer_half_float")||Ee.has("EXT_color_buffer_float")?fc:Wn,minFilter:Ws,samples:4,stencilBuffer:s,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:dt.workingColorSpace}));const ue=p.state.transmissionRenderTarget[K.id],we=K.viewport||N;ue.setSize(we.z*w.transmissionResolutionScale,we.w*w.transmissionResolutionScale);const Re=w.getRenderTarget(),Ce=w.getActiveCubeFace(),Fe=w.getActiveMipmapLevel();w.setRenderTarget(ue),w.getClearColor(V),Y=w.getClearAlpha(),Y<1&&w.setClearColor(16777215,.5),w.clear(),re&&Ie.render($);const ze=w.toneMapping;w.toneMapping=Qi;const ke=K.viewport;if(K.viewport!==void 0&&(K.viewport=void 0),p.setupLightsView(K),Q===!0&&pe.setGlobalState(w.clippingPlanes,K),yc(R,$,K),_e.updateMultisampleRenderTarget(ue),_e.updateRenderTargetMipmap(ue),Ee.has("WEBGL_multisampled_render_to_texture")===!1){let st=!1;for(let vt=0,Ot=F.length;vt<Ot;vt++){const Tt=F[vt],yt=Tt.object,Oe=Tt.geometry,Pt=Tt.material,ut=Tt.group;if(Pt.side===Bn&&yt.layers.test(K.layers)){const Ln=Pt.side;Pt.side=nn,Pt.needsUpdate=!0,w0(yt,$,K,Oe,Pt,ut),Pt.side=Ln,Pt.needsUpdate=!0,st=!0}}st===!0&&(_e.updateMultisampleRenderTarget(ue),_e.updateRenderTargetMipmap(ue))}w.setRenderTarget(Re,Ce,Fe),w.setClearColor(V,Y),ke!==void 0&&(K.viewport=ke),w.toneMapping=ze}function yc(R,F,$){const K=F.isScene===!0?F.overrideMaterial:null;for(let B=0,ue=R.length;B<ue;B++){const we=R[B],Re=we.object,Ce=we.geometry,Fe=we.group;let ze=we.material;ze.allowOverride===!0&&K!==null&&(ze=K),Re.layers.test($.layers)&&w0(Re,F,$,Ce,ze,Fe)}}function w0(R,F,$,K,B,ue){R.onBeforeRender(w,F,$,K,B,ue),R.modelViewMatrix.multiplyMatrices($.matrixWorldInverse,R.matrixWorld),R.normalMatrix.getNormalMatrix(R.modelViewMatrix),B.onBeforeRender(w,F,$,K,R,ue),B.transparent===!0&&B.side===Bn&&B.forceSinglePass===!1?(B.side=nn,B.needsUpdate=!0,w.renderBufferDirect($,F,K,B,R,ue),B.side=gi,B.needsUpdate=!0,w.renderBufferDirect($,F,K,B,R,ue),B.side=Bn):w.renderBufferDirect($,F,K,B,R,ue),R.onAfterRender(w,F,$,K,B,ue)}function _c(R,F,$){F.isScene!==!0&&(F=q);const K=ge.get(R),B=p.state.lights,ue=p.state.shadowsArray,we=B.state.version,Re=ne.getParameters(R,B.state,ue,F,$),Ce=ne.getProgramCacheKey(Re);let Fe=K.programs;K.environment=R.isMeshStandardMaterial?F.environment:null,K.fog=F.fog,K.envMap=(R.isMeshStandardMaterial?et:Ve).get(R.envMap||K.environment),K.envMapRotation=K.environment!==null&&R.envMap===null?F.environmentRotation:R.envMapRotation,Fe===void 0&&(R.addEventListener("dispose",se),Fe=new Map,K.programs=Fe);let ze=Fe.get(Ce);if(ze!==void 0){if(K.currentProgram===ze&&K.lightsStateVersion===we)return E0(R,Re),ze}else Re.uniforms=ne.getUniforms(R),R.onBeforeCompile(Re,w),ze=ne.acquireProgram(Re,Ce),Fe.set(Ce,ze),K.uniforms=Re.uniforms;const ke=K.uniforms;return(!R.isShaderMaterial&&!R.isRawShaderMaterial||R.clipping===!0)&&(ke.clippingPlanes=pe.uniform),E0(R,Re),K.needsLights=CM(R),K.lightsStateVersion=we,K.needsLights&&(ke.ambientLightColor.value=B.state.ambient,ke.lightProbe.value=B.state.probe,ke.directionalLights.value=B.state.directional,ke.directionalLightShadows.value=B.state.directionalShadow,ke.spotLights.value=B.state.spot,ke.spotLightShadows.value=B.state.spotShadow,ke.rectAreaLights.value=B.state.rectArea,ke.ltc_1.value=B.state.rectAreaLTC1,ke.ltc_2.value=B.state.rectAreaLTC2,ke.pointLights.value=B.state.point,ke.pointLightShadows.value=B.state.pointShadow,ke.hemisphereLights.value=B.state.hemi,ke.directionalShadowMap.value=B.state.directionalShadowMap,ke.directionalShadowMatrix.value=B.state.directionalShadowMatrix,ke.spotShadowMap.value=B.state.spotShadowMap,ke.spotLightMatrix.value=B.state.spotLightMatrix,ke.spotLightMap.value=B.state.spotLightMap,ke.pointShadowMap.value=B.state.pointShadowMap,ke.pointShadowMatrix.value=B.state.pointShadowMatrix),K.currentProgram=ze,K.uniformsList=null,ze}function S0(R){if(R.uniformsList===null){const F=R.currentProgram.getUniforms();R.uniformsList=ju.seqWithValue(F.seq,R.uniforms)}return R.uniformsList}function E0(R,F){const $=ge.get(R);$.outputColorSpace=F.outputColorSpace,$.batching=F.batching,$.batchingColor=F.batchingColor,$.instancing=F.instancing,$.instancingColor=F.instancingColor,$.instancingMorph=F.instancingMorph,$.skinning=F.skinning,$.morphTargets=F.morphTargets,$.morphNormals=F.morphNormals,$.morphColors=F.morphColors,$.morphTargetsCount=F.morphTargetsCount,$.numClippingPlanes=F.numClippingPlanes,$.numIntersection=F.numClipIntersection,$.vertexAlphas=F.vertexAlphas,$.vertexTangents=F.vertexTangents,$.toneMapping=F.toneMapping}function TM(R,F,$,K,B){F.isScene!==!0&&(F=q),_e.resetTextureUnits();const ue=F.fog,we=K.isMeshStandardMaterial?F.environment:null,Re=P===null?w.outputColorSpace:P.isXRRenderTarget===!0?P.texture.colorSpace:cs,Ce=(K.isMeshStandardMaterial?et:Ve).get(K.envMap||we),Fe=K.vertexColors===!0&&!!$.attributes.color&&$.attributes.color.itemSize===4,ze=!!$.attributes.tangent&&(!!K.normalMap||K.anisotropy>0),ke=!!$.morphAttributes.position,st=!!$.morphAttributes.normal,vt=!!$.morphAttributes.color;let Ot=Qi;K.toneMapped&&(P===null||P.isXRRenderTarget===!0)&&(Ot=w.toneMapping);const Tt=$.morphAttributes.position||$.morphAttributes.normal||$.morphAttributes.color,yt=Tt!==void 0?Tt.length:0,Oe=ge.get(K),Pt=p.state.lights;if(Q===!0&&(oe===!0||R!==b)){const xn=R===b&&K.id===C;pe.setState(K,R,xn)}let ut=!1;K.version===Oe.__version?(Oe.needsLights&&Oe.lightsStateVersion!==Pt.state.version||Oe.outputColorSpace!==Re||B.isBatchedMesh&&Oe.batching===!1||!B.isBatchedMesh&&Oe.batching===!0||B.isBatchedMesh&&Oe.batchingColor===!0&&B.colorTexture===null||B.isBatchedMesh&&Oe.batchingColor===!1&&B.colorTexture!==null||B.isInstancedMesh&&Oe.instancing===!1||!B.isInstancedMesh&&Oe.instancing===!0||B.isSkinnedMesh&&Oe.skinning===!1||!B.isSkinnedMesh&&Oe.skinning===!0||B.isInstancedMesh&&Oe.instancingColor===!0&&B.instanceColor===null||B.isInstancedMesh&&Oe.instancingColor===!1&&B.instanceColor!==null||B.isInstancedMesh&&Oe.instancingMorph===!0&&B.morphTexture===null||B.isInstancedMesh&&Oe.instancingMorph===!1&&B.morphTexture!==null||Oe.envMap!==Ce||K.fog===!0&&Oe.fog!==ue||Oe.numClippingPlanes!==void 0&&(Oe.numClippingPlanes!==pe.numPlanes||Oe.numIntersection!==pe.numIntersection)||Oe.vertexAlphas!==Fe||Oe.vertexTangents!==ze||Oe.morphTargets!==ke||Oe.morphNormals!==st||Oe.morphColors!==vt||Oe.toneMapping!==Ot||Oe.morphTargetsCount!==yt)&&(ut=!0):(ut=!0,Oe.__version=K.version);let Ln=Oe.currentProgram;ut===!0&&(Ln=_c(K,F,B));let uo=!1,Dn=!1,Ga=!1;const Nt=Ln.getUniforms(),Yn=Oe.uniforms;if(Me.useProgram(Ln.program)&&(uo=!0,Dn=!0,Ga=!0),K.id!==C&&(C=K.id,Dn=!0),uo||b!==R){Me.buffers.depth.getReversed()&&R.reversedDepth!==!0&&(R._reversedDepth=!0,R.updateProjectionMatrix()),Nt.setValue(I,"projectionMatrix",R.projectionMatrix),Nt.setValue(I,"viewMatrix",R.matrixWorldInverse);const bn=Nt.map.cameraPosition;bn!==void 0&&bn.setValue(I,he.setFromMatrixPosition(R.matrixWorld)),He.logarithmicDepthBuffer&&Nt.setValue(I,"logDepthBufFC",2/(Math.log(R.far+1)/Math.LN2)),(K.isMeshPhongMaterial||K.isMeshToonMaterial||K.isMeshLambertMaterial||K.isMeshBasicMaterial||K.isMeshStandardMaterial||K.isShaderMaterial)&&Nt.setValue(I,"isOrthographic",R.isOrthographicCamera===!0),b!==R&&(b=R,Dn=!0,Ga=!0)}if(B.isSkinnedMesh){Nt.setOptional(I,B,"bindMatrix"),Nt.setOptional(I,B,"bindMatrixInverse");const xn=B.skeleton;xn&&(xn.boneTexture===null&&xn.computeBoneTexture(),Nt.setValue(I,"boneTexture",xn.boneTexture,_e))}B.isBatchedMesh&&(Nt.setOptional(I,B,"batchingTexture"),Nt.setValue(I,"batchingTexture",B._matricesTexture,_e),Nt.setOptional(I,B,"batchingIdTexture"),Nt.setValue(I,"batchingIdTexture",B._indirectTexture,_e),Nt.setOptional(I,B,"batchingColorTexture"),B._colorsTexture!==null&&Nt.setValue(I,"batchingColorTexture",B._colorsTexture,_e));const Kn=$.morphAttributes;if((Kn.position!==void 0||Kn.normal!==void 0||Kn.color!==void 0)&&de.update(B,$,Ln),(Dn||Oe.receiveShadow!==B.receiveShadow)&&(Oe.receiveShadow=B.receiveShadow,Nt.setValue(I,"receiveShadow",B.receiveShadow)),K.isMeshGouraudMaterial&&K.envMap!==null&&(Yn.envMap.value=Ce,Yn.flipEnvMap.value=Ce.isCubeTexture&&Ce.isRenderTargetTexture===!1?-1:1),K.isMeshStandardMaterial&&K.envMap===null&&F.environment!==null&&(Yn.envMapIntensity.value=F.environmentIntensity),Dn&&(Nt.setValue(I,"toneMappingExposure",w.toneMappingExposure),Oe.needsLights&&MM(Yn,Ga),ue&&K.fog===!0&&ae.refreshFogUniforms(Yn,ue),ae.refreshMaterialUniforms(Yn,K,L,W,p.state.transmissionRenderTarget[R.id]),ju.upload(I,S0(Oe),Yn,_e)),K.isShaderMaterial&&K.uniformsNeedUpdate===!0&&(ju.upload(I,S0(Oe),Yn,_e),K.uniformsNeedUpdate=!1),K.isSpriteMaterial&&Nt.setValue(I,"center",B.center),Nt.setValue(I,"modelViewMatrix",B.modelViewMatrix),Nt.setValue(I,"normalMatrix",B.normalMatrix),Nt.setValue(I,"modelMatrix",B.matrixWorld),K.isShaderMaterial||K.isRawShaderMaterial){const xn=K.uniformsGroups;for(let bn=0,Pf=xn.length;bn<Pf;bn++){const Es=xn[bn];qe.update(Es,Ln),qe.bind(Es,Ln)}}return Ln}function MM(R,F){R.ambientLightColor.needsUpdate=F,R.lightProbe.needsUpdate=F,R.directionalLights.needsUpdate=F,R.directionalLightShadows.needsUpdate=F,R.pointLights.needsUpdate=F,R.pointLightShadows.needsUpdate=F,R.spotLights.needsUpdate=F,R.spotLightShadows.needsUpdate=F,R.rectAreaLights.needsUpdate=F,R.hemisphereLights.needsUpdate=F}function CM(R){return R.isMeshLambertMaterial||R.isMeshToonMaterial||R.isMeshPhongMaterial||R.isMeshStandardMaterial||R.isShadowMaterial||R.isShaderMaterial&&R.lights===!0}this.getActiveCubeFace=function(){return M},this.getActiveMipmapLevel=function(){return T},this.getRenderTarget=function(){return P},this.setRenderTargetTextures=function(R,F,$){const K=ge.get(R);K.__autoAllocateDepthBuffer=R.resolveDepthBuffer===!1,K.__autoAllocateDepthBuffer===!1&&(K.__useRenderToTexture=!1),ge.get(R.texture).__webglTexture=F,ge.get(R.depthTexture).__webglTexture=K.__autoAllocateDepthBuffer?void 0:$,K.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(R,F){const $=ge.get(R);$.__webglFramebuffer=F,$.__useDefaultFramebuffer=F===void 0};const AM=I.createFramebuffer();this.setRenderTarget=function(R,F=0,$=0){P=R,M=F,T=$;let K=!0,B=null,ue=!1,we=!1;if(R){const Ce=ge.get(R);if(Ce.__useDefaultFramebuffer!==void 0)Me.bindFramebuffer(I.FRAMEBUFFER,null),K=!1;else if(Ce.__webglFramebuffer===void 0)_e.setupRenderTarget(R);else if(Ce.__hasExternalTextures)_e.rebindTextures(R,ge.get(R.texture).__webglTexture,ge.get(R.depthTexture).__webglTexture);else if(R.depthBuffer){const ke=R.depthTexture;if(Ce.__boundDepthTexture!==ke){if(ke!==null&&ge.has(ke)&&(R.width!==ke.image.width||R.height!==ke.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");_e.setupDepthRenderbuffer(R)}}const Fe=R.texture;(Fe.isData3DTexture||Fe.isDataArrayTexture||Fe.isCompressedArrayTexture)&&(we=!0);const ze=ge.get(R).__webglFramebuffer;R.isWebGLCubeRenderTarget?(Array.isArray(ze[F])?B=ze[F][$]:B=ze[F],ue=!0):R.samples>0&&_e.useMultisampledRTT(R)===!1?B=ge.get(R).__webglMultisampledFramebuffer:Array.isArray(ze)?B=ze[$]:B=ze,N.copy(R.viewport),U.copy(R.scissor),O=R.scissorTest}else N.copy(ee).multiplyScalar(L).floor(),U.copy(ve).multiplyScalar(L).floor(),O=Be;if($!==0&&(B=AM),Me.bindFramebuffer(I.FRAMEBUFFER,B)&&K&&Me.drawBuffers(R,B),Me.viewport(N),Me.scissor(U),Me.setScissorTest(O),ue){const Ce=ge.get(R.texture);I.framebufferTexture2D(I.FRAMEBUFFER,I.COLOR_ATTACHMENT0,I.TEXTURE_CUBE_MAP_POSITIVE_X+F,Ce.__webglTexture,$)}else if(we){const Ce=F;for(let Fe=0;Fe<R.textures.length;Fe++){const ze=ge.get(R.textures[Fe]);I.framebufferTextureLayer(I.FRAMEBUFFER,I.COLOR_ATTACHMENT0+Fe,ze.__webglTexture,$,Ce)}}else if(R!==null&&$!==0){const Ce=ge.get(R.texture);I.framebufferTexture2D(I.FRAMEBUFFER,I.COLOR_ATTACHMENT0,I.TEXTURE_2D,Ce.__webglTexture,$)}C=-1},this.readRenderTargetPixels=function(R,F,$,K,B,ue,we,Re=0){if(!(R&&R.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Ce=ge.get(R).__webglFramebuffer;if(R.isWebGLCubeRenderTarget&&we!==void 0&&(Ce=Ce[we]),Ce){Me.bindFramebuffer(I.FRAMEBUFFER,Ce);try{const Fe=R.textures[Re],ze=Fe.format,ke=Fe.type;if(!He.textureFormatReadable(ze)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!He.textureTypeReadable(ke)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}F>=0&&F<=R.width-K&&$>=0&&$<=R.height-B&&(R.textures.length>1&&I.readBuffer(I.COLOR_ATTACHMENT0+Re),I.readPixels(F,$,K,B,Le.convert(ze),Le.convert(ke),ue))}finally{const Fe=P!==null?ge.get(P).__webglFramebuffer:null;Me.bindFramebuffer(I.FRAMEBUFFER,Fe)}}},this.readRenderTargetPixelsAsync=async function(R,F,$,K,B,ue,we,Re=0){if(!(R&&R.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Ce=ge.get(R).__webglFramebuffer;if(R.isWebGLCubeRenderTarget&&we!==void 0&&(Ce=Ce[we]),Ce)if(F>=0&&F<=R.width-K&&$>=0&&$<=R.height-B){Me.bindFramebuffer(I.FRAMEBUFFER,Ce);const Fe=R.textures[Re],ze=Fe.format,ke=Fe.type;if(!He.textureFormatReadable(ze))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!He.textureTypeReadable(ke))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const st=I.createBuffer();I.bindBuffer(I.PIXEL_PACK_BUFFER,st),I.bufferData(I.PIXEL_PACK_BUFFER,ue.byteLength,I.STREAM_READ),R.textures.length>1&&I.readBuffer(I.COLOR_ATTACHMENT0+Re),I.readPixels(F,$,K,B,Le.convert(ze),Le.convert(ke),0);const vt=P!==null?ge.get(P).__webglFramebuffer:null;Me.bindFramebuffer(I.FRAMEBUFFER,vt);const Ot=I.fenceSync(I.SYNC_GPU_COMMANDS_COMPLETE,0);return I.flush(),await ZO(I,Ot,4),I.bindBuffer(I.PIXEL_PACK_BUFFER,st),I.getBufferSubData(I.PIXEL_PACK_BUFFER,0,ue),I.deleteBuffer(st),I.deleteSync(Ot),ue}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function(R,F=null,$=0){const K=Math.pow(2,-$),B=Math.floor(R.image.width*K),ue=Math.floor(R.image.height*K),we=F!==null?F.x:0,Re=F!==null?F.y:0;_e.setTexture2D(R,0),I.copyTexSubImage2D(I.TEXTURE_2D,$,0,0,we,Re,B,ue),Me.unbindTexture()};const RM=I.createFramebuffer(),PM=I.createFramebuffer();this.copyTextureToTexture=function(R,F,$=null,K=null,B=0,ue=null){ue===null&&(B!==0?(la("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),ue=B,B=0):ue=0);let we,Re,Ce,Fe,ze,ke,st,vt,Ot;const Tt=R.isCompressedTexture?R.mipmaps[ue]:R.image;if($!==null)we=$.max.x-$.min.x,Re=$.max.y-$.min.y,Ce=$.isBox3?$.max.z-$.min.z:1,Fe=$.min.x,ze=$.min.y,ke=$.isBox3?$.min.z:0;else{const Kn=Math.pow(2,-B);we=Math.floor(Tt.width*Kn),Re=Math.floor(Tt.height*Kn),R.isDataArrayTexture?Ce=Tt.depth:R.isData3DTexture?Ce=Math.floor(Tt.depth*Kn):Ce=1,Fe=0,ze=0,ke=0}K!==null?(st=K.x,vt=K.y,Ot=K.z):(st=0,vt=0,Ot=0);const yt=Le.convert(F.format),Oe=Le.convert(F.type);let Pt;F.isData3DTexture?(_e.setTexture3D(F,0),Pt=I.TEXTURE_3D):F.isDataArrayTexture||F.isCompressedArrayTexture?(_e.setTexture2DArray(F,0),Pt=I.TEXTURE_2D_ARRAY):(_e.setTexture2D(F,0),Pt=I.TEXTURE_2D),I.pixelStorei(I.UNPACK_FLIP_Y_WEBGL,F.flipY),I.pixelStorei(I.UNPACK_PREMULTIPLY_ALPHA_WEBGL,F.premultiplyAlpha),I.pixelStorei(I.UNPACK_ALIGNMENT,F.unpackAlignment);const ut=I.getParameter(I.UNPACK_ROW_LENGTH),Ln=I.getParameter(I.UNPACK_IMAGE_HEIGHT),uo=I.getParameter(I.UNPACK_SKIP_PIXELS),Dn=I.getParameter(I.UNPACK_SKIP_ROWS),Ga=I.getParameter(I.UNPACK_SKIP_IMAGES);I.pixelStorei(I.UNPACK_ROW_LENGTH,Tt.width),I.pixelStorei(I.UNPACK_IMAGE_HEIGHT,Tt.height),I.pixelStorei(I.UNPACK_SKIP_PIXELS,Fe),I.pixelStorei(I.UNPACK_SKIP_ROWS,ze),I.pixelStorei(I.UNPACK_SKIP_IMAGES,ke);const Nt=R.isDataArrayTexture||R.isData3DTexture,Yn=F.isDataArrayTexture||F.isData3DTexture;if(R.isDepthTexture){const Kn=ge.get(R),xn=ge.get(F),bn=ge.get(Kn.__renderTarget),Pf=ge.get(xn.__renderTarget);Me.bindFramebuffer(I.READ_FRAMEBUFFER,bn.__webglFramebuffer),Me.bindFramebuffer(I.DRAW_FRAMEBUFFER,Pf.__webglFramebuffer);for(let Es=0;Es<Ce;Es++)Nt&&(I.framebufferTextureLayer(I.READ_FRAMEBUFFER,I.COLOR_ATTACHMENT0,ge.get(R).__webglTexture,B,ke+Es),I.framebufferTextureLayer(I.DRAW_FRAMEBUFFER,I.COLOR_ATTACHMENT0,ge.get(F).__webglTexture,ue,Ot+Es)),I.blitFramebuffer(Fe,ze,we,Re,st,vt,we,Re,I.DEPTH_BUFFER_BIT,I.NEAREST);Me.bindFramebuffer(I.READ_FRAMEBUFFER,null),Me.bindFramebuffer(I.DRAW_FRAMEBUFFER,null)}else if(B!==0||R.isRenderTargetTexture||ge.has(R)){const Kn=ge.get(R),xn=ge.get(F);Me.bindFramebuffer(I.READ_FRAMEBUFFER,RM),Me.bindFramebuffer(I.DRAW_FRAMEBUFFER,PM);for(let bn=0;bn<Ce;bn++)Nt?I.framebufferTextureLayer(I.READ_FRAMEBUFFER,I.COLOR_ATTACHMENT0,Kn.__webglTexture,B,ke+bn):I.framebufferTexture2D(I.READ_FRAMEBUFFER,I.COLOR_ATTACHMENT0,I.TEXTURE_2D,Kn.__webglTexture,B),Yn?I.framebufferTextureLayer(I.DRAW_FRAMEBUFFER,I.COLOR_ATTACHMENT0,xn.__webglTexture,ue,Ot+bn):I.framebufferTexture2D(I.DRAW_FRAMEBUFFER,I.COLOR_ATTACHMENT0,I.TEXTURE_2D,xn.__webglTexture,ue),B!==0?I.blitFramebuffer(Fe,ze,we,Re,st,vt,we,Re,I.COLOR_BUFFER_BIT,I.NEAREST):Yn?I.copyTexSubImage3D(Pt,ue,st,vt,Ot+bn,Fe,ze,we,Re):I.copyTexSubImage2D(Pt,ue,st,vt,Fe,ze,we,Re);Me.bindFramebuffer(I.READ_FRAMEBUFFER,null),Me.bindFramebuffer(I.DRAW_FRAMEBUFFER,null)}else Yn?R.isDataTexture||R.isData3DTexture?I.texSubImage3D(Pt,ue,st,vt,Ot,we,Re,Ce,yt,Oe,Tt.data):F.isCompressedArrayTexture?I.compressedTexSubImage3D(Pt,ue,st,vt,Ot,we,Re,Ce,yt,Tt.data):I.texSubImage3D(Pt,ue,st,vt,Ot,we,Re,Ce,yt,Oe,Tt):R.isDataTexture?I.texSubImage2D(I.TEXTURE_2D,ue,st,vt,we,Re,yt,Oe,Tt.data):R.isCompressedTexture?I.compressedTexSubImage2D(I.TEXTURE_2D,ue,st,vt,Tt.width,Tt.height,yt,Tt.data):I.texSubImage2D(I.TEXTURE_2D,ue,st,vt,we,Re,yt,Oe,Tt);I.pixelStorei(I.UNPACK_ROW_LENGTH,ut),I.pixelStorei(I.UNPACK_IMAGE_HEIGHT,Ln),I.pixelStorei(I.UNPACK_SKIP_PIXELS,uo),I.pixelStorei(I.UNPACK_SKIP_ROWS,Dn),I.pixelStorei(I.UNPACK_SKIP_IMAGES,Ga),ue===0&&F.generateMipmaps&&I.generateMipmap(Pt),Me.unbindTexture()},this.copyTextureToTexture3D=function(R,F,$=null,K=null,B=0){return la('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(R,F,$,K,B)},this.initRenderTarget=function(R){ge.get(R).__webglFramebuffer===void 0&&_e.setupRenderTarget(R)},this.initTexture=function(R){R.isCubeTexture?_e.setTextureCube(R,0):R.isData3DTexture?_e.setTexture3D(R,0):R.isDataArrayTexture||R.isCompressedArrayTexture?_e.setTexture2DArray(R,0):_e.setTexture2D(R,0),Me.unbindTexture()},this.resetState=function(){M=0,T=0,P=null,Me.reset(),ye.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Fr}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const n=this.getContext();n.drawingBufferColorSpace=dt._getDrawingBufferColorSpace(e),n.unpackColorSpace=dt._getUnpackColorSpace()}}/**
 * postprocessing v6.37.7 build Mon Aug 04 2025
 * https://github.com/pmndrs/postprocessing
 * Copyright 2015-2025 Raoul van Rüschen
 * @license Zlib
 */var op=1/1e3,p5=1e3,m5=class{constructor(){this.startTime=performance.now(),this.previousTime=0,this.currentTime=0,this._delta=0,this._elapsed=0,this._fixedDelta=1e3/60,this.timescale=1,this.useFixedDelta=!1,this._autoReset=!1}get autoReset(){return this._autoReset}set autoReset(t){typeof document<"u"&&document.hidden!==void 0&&(t?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this._autoReset=t)}get delta(){return this._delta*op}get fixedDelta(){return this._fixedDelta*op}set fixedDelta(t){this._fixedDelta=t*p5}get elapsed(){return this._elapsed*op}update(t){this.useFixedDelta?this._delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=(t!==void 0?t:performance.now())-this.startTime,this._delta=this.currentTime-this.previousTime),this._delta*=this.timescale,this._elapsed+=this._delta}reset(){this._delta=0,this._elapsed=0,this.currentTime=performance.now()-this.startTime}getDelta(){return this.delta}getElapsed(){return this.elapsed}handleEvent(t){document.hidden||(this.currentTime=performance.now()-this.startTime)}dispose(){this.autoReset=!1}},g5=(()=>{const t=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),e=new Float32Array([0,0,2,0,0,2]),n=new _s;return n.setAttribute("position",new rr(t,3)),n.setAttribute("uv",new rr(e,2)),n})(),ws=class Tg{static get fullscreenGeometry(){return g5}constructor(e="Pass",n=new Eg,r=new m0){this.name=e,this.renderer=null,this.scene=n,this.camera=r,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(e){if(this.rtt===e){const n=this.fullscreenMaterial;n!==null&&(n.needsUpdate=!0),this.rtt=!e}}set mainScene(e){}set mainCamera(e){}setRenderer(e){this.renderer=e}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(e){let n=this.screen;n!==null?n.material=e:(n=new Er(Tg.fullscreenGeometry,e),n.frustumCulled=!1,this.scene===null&&(this.scene=new Eg),this.scene.add(n),this.screen=n)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(e){this.fullscreenMaterial=e}getDepthTexture(){return null}setDepthTexture(e,n=hc){}render(e,n,r,i,s){throw new Error("Render method not implemented!")}setSize(e,n){}initialize(e,n,r){}dispose(){for(const e of Object.keys(this)){const n=this[e];(n instanceof Pr||n instanceof Va||n instanceof an||n instanceof Tg)&&this[e].dispose()}this.fullscreenMaterial!==null&&this.fullscreenMaterial.dispose()}},v5=class extends ws{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(t,e,n,r,i){const s=t.state.buffers.stencil;s.setLocked(!1),s.setTest(!1)}},x5=`#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;
#include <colorspace_fragment>
#include <dithering_fragment>
}`,y5="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",_5=class extends ar{constructor(){super({name:"CopyMaterial",uniforms:{inputBuffer:new Xt(null),opacity:new Xt(1)},blending:zr,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:x5,vertexShader:y5})}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.uniforms.inputBuffer.value=t}getOpacity(t){return this.uniforms.opacity.value}setOpacity(t){this.uniforms.opacity.value=t}},w5=class extends ws{constructor(t,e=!0){super("CopyPass"),this.fullscreenMaterial=new _5,this.needsSwap=!1,this.renderTarget=t,t===void 0&&(this.renderTarget=new Pr(1,1,{minFilter:mn,magFilter:mn,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=e}get resize(){return this.autoResize}set resize(t){this.autoResize=t}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(t){this.autoResize=t}render(t,e,n,r,i){this.fullscreenMaterial.inputBuffer=e.texture,t.setRenderTarget(this.renderToScreen?null:this.renderTarget),t.render(this.scene,this.camera)}setSize(t,e){this.autoResize&&this.renderTarget.setSize(t,e)}initialize(t,e,n){n!==void 0&&(this.renderTarget.texture.type=n,n!==Wn?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":t!==null&&t.outputColorSpace===zt&&(this.renderTarget.texture.colorSpace=zt))}},W_=new pt,EM=class extends ws{constructor(t=!0,e=!0,n=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=t,this.depth=e,this.stencil=n,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(t,e,n){this.color=t,this.depth=e,this.stencil=n}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(t){this.overrideClearColor=t}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(t){this.overrideClearAlpha=t}render(t,e,n,r,i){const s=this.overrideClearColor,o=this.overrideClearAlpha,a=t.getClearAlpha(),l=s!==null,c=o>=0;l?(t.getClearColor(W_),t.setClearColor(s,c?o:a)):c&&t.setClearAlpha(o),t.setRenderTarget(this.renderToScreen?null:e),t.clear(this.color,this.depth,this.stencil),l?t.setClearColor(W_,a):c&&t.setClearAlpha(a)}},S5=class extends ws{constructor(t,e){super("MaskPass",t,e),this.needsSwap=!1,this.clearPass=new EM(!1,!1,!0),this.inverse=!1}set mainScene(t){this.scene=t}set mainCamera(t){this.camera=t}get inverted(){return this.inverse}set inverted(t){this.inverse=t}get clear(){return this.clearPass.enabled}set clear(t){this.clearPass.enabled=t}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(t){this.inverted=t}render(t,e,n,r,i){const s=t.getContext(),o=t.state.buffers,a=this.scene,l=this.camera,c=this.clearPass,u=this.inverted?0:1,d=1-u;o.color.setMask(!1),o.depth.setMask(!1),o.color.setLocked(!0),o.depth.setLocked(!0),o.stencil.setTest(!0),o.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),o.stencil.setFunc(s.ALWAYS,u,4294967295),o.stencil.setClear(d),o.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?c.render(t,null):(c.render(t,e),c.render(t,n))),this.renderToScreen?(t.setRenderTarget(null),t.render(a,l)):(t.setRenderTarget(e),t.render(a,l),t.setRenderTarget(n),t.render(a,l)),o.color.setLocked(!1),o.depth.setLocked(!1),o.stencil.setLocked(!1),o.stencil.setFunc(s.EQUAL,1,4294967295),o.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),o.stencil.setLocked(!0)}},$_=class{constructor(t=null,{depthBuffer:e=!0,stencilBuffer:n=!1,multisampling:r=0,frameBufferType:i}={}){this.renderer=null,this.inputBuffer=this.createBuffer(e,n,i,r),this.outputBuffer=this.inputBuffer.clone(),this.copyPass=new w5,this.depthTexture=null,this.passes=[],this.timer=new m5,this.autoRenderToScreen=!0,this.setRenderer(t)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(t){const e=this.inputBuffer,n=this.multisampling;n>0&&t>0?(this.inputBuffer.samples=t,this.outputBuffer.samples=t,this.inputBuffer.dispose(),this.outputBuffer.dispose()):n!==t&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),this.inputBuffer=this.createBuffer(e.depthBuffer,e.stencilBuffer,e.texture.type,t),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(t){if(this.renderer=t,t!==null){const e=t.getSize(new Qe),n=t.getContext().getContextAttributes().alpha,r=this.inputBuffer.texture.type;r===Wn&&t.outputColorSpace===zt&&(this.inputBuffer.texture.colorSpace=zt,this.outputBuffer.texture.colorSpace=zt,this.inputBuffer.dispose(),this.outputBuffer.dispose()),t.autoClear=!1,this.setSize(e.width,e.height);for(const i of this.passes)i.initialize(t,n,r)}}replaceRenderer(t,e=!0){const n=this.renderer,r=n.domElement.parentNode;return this.setRenderer(t),e&&r!==null&&(r.removeChild(n.domElement),r.appendChild(t.domElement)),n}createDepthTexture(){const t=this.depthTexture=new g0;return this.inputBuffer.depthTexture=t,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(t.format=Ra,t.type=Aa):t.type=ls,t}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(const t of this.passes)t.setDepthTexture(null)}}createBuffer(t,e,n,r){const i=this.renderer,s=i===null?new Qe:i.getDrawingBufferSize(new Qe),o={minFilter:mn,magFilter:mn,stencilBuffer:e,depthBuffer:t,type:n},a=new Pr(s.width,s.height,o);return r>0&&(a.ignoreDepthForMultisampleCopy=!1,a.samples=r),n===Wn&&i!==null&&i.outputColorSpace===zt&&(a.texture.colorSpace=zt),a.texture.name="EffectComposer.Buffer",a.texture.generateMipmaps=!1,a}setMainScene(t){for(const e of this.passes)e.mainScene=t}setMainCamera(t){for(const e of this.passes)e.mainCamera=t}addPass(t,e){const n=this.passes,r=this.renderer,i=r.getDrawingBufferSize(new Qe),s=r.getContext().getContextAttributes().alpha,o=this.inputBuffer.texture.type;if(t.setRenderer(r),t.setSize(i.width,i.height),t.initialize(r,s,o),this.autoRenderToScreen&&(n.length>0&&(n[n.length-1].renderToScreen=!1),t.renderToScreen&&(this.autoRenderToScreen=!1)),e!==void 0?n.splice(e,0,t):n.push(t),this.autoRenderToScreen&&(n[n.length-1].renderToScreen=!0),t.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){const a=this.createDepthTexture();for(t of n)t.setDepthTexture(a)}else t.setDepthTexture(this.depthTexture)}removePass(t){const e=this.passes,n=e.indexOf(t);if(n!==-1&&e.splice(n,1).length>0){if(this.depthTexture!==null){const s=(a,l)=>a||l.needsDepthTexture;e.reduce(s,!1)||(t.getDepthTexture()===this.depthTexture&&t.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&n===e.length&&(t.renderToScreen=!1,e.length>0&&(e[e.length-1].renderToScreen=!0))}}removeAllPasses(){const t=this.passes;this.deleteDepthTexture(),t.length>0&&(this.autoRenderToScreen&&(t[t.length-1].renderToScreen=!1),this.passes=[])}render(t){const e=this.renderer,n=this.copyPass;let r=this.inputBuffer,i=this.outputBuffer,s=!1,o,a,l;t===void 0&&(this.timer.update(),t=this.timer.getDelta());for(const c of this.passes)c.enabled&&(c.render(e,r,i,t,s),c.needsSwap&&(s&&(n.renderToScreen=c.renderToScreen,o=e.getContext(),a=e.state.buffers.stencil,a.setFunc(o.NOTEQUAL,1,4294967295),n.render(e,r,i,t,s),a.setFunc(o.EQUAL,1,4294967295)),l=r,r=i,i=l),c instanceof S5?s=!0:c instanceof v5&&(s=!1))}setSize(t,e,n){const r=this.renderer,i=r.getSize(new Qe);(t===void 0||e===void 0)&&(t=i.width,e=i.height),(i.width!==t||i.height!==e)&&r.setSize(t,e,n);const s=r.getDrawingBufferSize(new Qe);this.inputBuffer.setSize(s.width,s.height),this.outputBuffer.setSize(s.width,s.height);for(const o of this.passes)o.setSize(s.width,s.height)}reset(){this.dispose(),this.autoRenderToScreen=!0}dispose(){for(const t of this.passes)t.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose(),ws.fullscreenGeometry.dispose()}},Js={NONE:0,DEPTH:1,CONVOLUTION:2},ft={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},E5=class{constructor(){this.shaderParts=new Map([[ft.FRAGMENT_HEAD,null],[ft.FRAGMENT_MAIN_UV,null],[ft.FRAGMENT_MAIN_IMAGE,null],[ft.VERTEX_HEAD,null],[ft.VERTEX_MAIN_SUPPORT,null]]),this.defines=new Map,this.uniforms=new Map,this.blendModes=new Map,this.extensions=new Set,this.attributes=Js.NONE,this.varyings=new Set,this.uvTransformation=!1,this.readDepth=!1,this.colorSpace=cs}},ap=!1,X_=class{constructor(t=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(t),this.meshCount=0,this.replaceMaterial=e=>{if(e.isMesh){let n;if(e.material.flatShading)switch(e.material.side){case Bn:n=this.materialsFlatShadedDoubleSide;break;case nn:n=this.materialsFlatShadedBackSide;break;default:n=this.materialsFlatShaded;break}else switch(e.material.side){case Bn:n=this.materialsDoubleSide;break;case nn:n=this.materialsBackSide;break;default:n=this.materials;break}this.originalMaterials.set(e,e.material),e.isSkinnedMesh?e.material=n[2]:e.isInstancedMesh?e.material=n[1]:e.material=n[0],++this.meshCount}}}cloneMaterial(t){if(!(t instanceof ar))return t.clone();const e=t.uniforms,n=new Map;for(const i in e){const s=e[i].value;s.isRenderTargetTexture&&(e[i].value=null,n.set(i,s))}const r=t.clone();for(const i of n)e[i[0]].value=i[1],r.uniforms[i[0]].value=i[1];return r}setMaterial(t){if(this.disposeMaterials(),this.material=t,t!==null){const e=this.materials=[this.cloneMaterial(t),this.cloneMaterial(t),this.cloneMaterial(t)];for(const n of e)n.uniforms=Object.assign({},t.uniforms),n.side=gi;e[2].skinning=!0,this.materialsBackSide=e.map(n=>{const r=this.cloneMaterial(n);return r.uniforms=Object.assign({},t.uniforms),r.side=nn,r}),this.materialsDoubleSide=e.map(n=>{const r=this.cloneMaterial(n);return r.uniforms=Object.assign({},t.uniforms),r.side=Bn,r}),this.materialsFlatShaded=e.map(n=>{const r=this.cloneMaterial(n);return r.uniforms=Object.assign({},t.uniforms),r.flatShading=!0,r}),this.materialsFlatShadedBackSide=e.map(n=>{const r=this.cloneMaterial(n);return r.uniforms=Object.assign({},t.uniforms),r.flatShading=!0,r.side=nn,r}),this.materialsFlatShadedDoubleSide=e.map(n=>{const r=this.cloneMaterial(n);return r.uniforms=Object.assign({},t.uniforms),r.flatShading=!0,r.side=Bn,r})}}render(t,e,n){const r=t.shadowMap.enabled;if(t.shadowMap.enabled=!1,ap){const i=this.originalMaterials;this.meshCount=0,e.traverse(this.replaceMaterial),t.render(e,n);for(const s of i)s[0].material=s[1];this.meshCount!==i.size&&i.clear()}else{const i=e.overrideMaterial;e.overrideMaterial=this.material,t.render(e,n),e.overrideMaterial=i}t.shadowMap.enabled=r}disposeMaterials(){if(this.material!==null){const t=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(const e of t)e.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return ap}static set workaroundEnabled(t){ap=t}},ot={SKIP:9,SET:30,ADD:0,ALPHA:1,AVERAGE:2,COLOR:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,DIVIDE:8,DST:9,EXCLUSION:10,HARD_LIGHT:11,HARD_MIX:12,HUE:13,INVERT:14,INVERT_RGB:15,LIGHTEN:16,LINEAR_BURN:17,LINEAR_DODGE:18,LINEAR_LIGHT:19,LUMINOSITY:20,MULTIPLY:21,NEGATION:22,NORMAL:23,OVERLAY:24,PIN_LIGHT:25,REFLECT:26,SATURATION:27,SCREEN:28,SOFT_LIGHT:29,SRC:30,SUBTRACT:31,VIVID_LIGHT:32},b5="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(x.rgb+y.rgb,y.a),opacity);}",T5="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y,y.a*opacity);}",M5="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4((x.rgb+y.rgb)*0.5,y.a),opacity);}",C5="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.xy,xHSL.z));return mix(x,vec4(z,y.a),opacity);}",A5="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 a=x.rgb,b=y.rgb;vec3 z=mix(step(0.0,b)*(1.0-min(vec3(1.0),(1.0-a)/b)),vec3(1.0),step(1.0,a));return mix(x,vec4(z,y.a),opacity);}",R5="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 a=x.rgb,b=y.rgb;vec3 z=step(0.0,a)*mix(min(vec3(1.0),a/max(1.0-b,1e-9)),vec3(1.0),step(1.0,b));return mix(x,vec4(z,y.a),opacity);}",P5="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(min(x.rgb,y.rgb),y.a),opacity);}",N5="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(abs(x.rgb-y.rgb),y.a),opacity);}",I5="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(x.rgb/max(y.rgb,1e-12),y.a),opacity);}",L5="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4((x.rgb+y.rgb-2.0*x.rgb*y.rgb),y.a),opacity);}",D5="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 a=min(x.rgb,1.0);vec3 b=min(y.rgb,1.0);vec3 z=mix(2.0*a*b,1.0-2.0*(1.0-a)*(1.0-b),step(0.5,b));return mix(x,vec4(z,y.a),opacity);}",U5="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(step(1.0,x.rgb+y.rgb),y.a),opacity);}",k5="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.x,xHSL.yz));return mix(x,vec4(z,y.a),opacity);}",O5="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(1.0-y.rgb,y.a),opacity);}",F5="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(y.rgb*(1.0-x.rgb),y.a),opacity);}",B5="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(max(x.rgb,y.rgb),y.a),opacity);}",j5="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(clamp(y.rgb+x.rgb-1.0,0.0,1.0),y.a),opacity);}",z5="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(min(x.rgb+y.rgb,1.0),y.a),opacity);}",V5="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(clamp(2.0*y.rgb+x.rgb-1.0,0.0,1.0),y.a),opacity);}",H5="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.xy,yHSL.z));return mix(x,vec4(z,y.a),opacity);}",G5="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(x.rgb*y.rgb,y.a),opacity);}",W5="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(1.0-abs(1.0-x.rgb-y.rgb),y.a),opacity);}",$5="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y,opacity);}",X5="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 z=mix(2.0*y.rgb*x.rgb,1.0-2.0*(1.0-y.rgb)*(1.0-x.rgb),step(0.5,x.rgb));return mix(x,vec4(z,y.a),opacity);}",q5="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 y2=2.0*y.rgb;vec3 z=mix(mix(y2,x.rgb,step(0.5*x.rgb,y.rgb)),max(y2-1.0,vec3(0.0)),step(x.rgb,y2-1.0));return mix(x,vec4(z,y.a),opacity);}",Y5="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 z=mix(min(x.rgb*x.rgb/max(1.0-y.rgb,1e-12),1.0),y.rgb,step(1.0,y.rgb));return mix(x,vec4(z,y.a),opacity);}",K5="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.x,yHSL.y,xHSL.z));return mix(x,vec4(z,y.a),opacity);}",J5="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(x.rgb+y.rgb-min(x.rgb*y.rgb,1.0),y.a),opacity);}",Z5="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 a=x.rgb;vec3 b=y.rgb;vec3 y2=2.0*b;vec3 w=step(0.5,b);vec3 c=a-(1.0-y2)*a*(1.0-a);vec3 d=mix(a+(y2-1.0)*(sqrt(a)-a),a+(y2-1.0)*a*((16.0*a-12.0)*a+3.0),w*(1.0-step(0.25,a)));vec3 z=mix(c,d,w);return mix(x,vec4(z,y.a),opacity);}",Q5="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y;}",eV="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(max(x.rgb+y.rgb-1.0,0.0),y.a),opacity);}",tV="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 z=mix(max(1.0-min((1.0-x.rgb)/(2.0*y.rgb),1.0),0.0),min(x.rgb/(2.0*(1.0-y.rgb)),1.0),step(0.5,y.rgb));return mix(x,vec4(z,y.a),opacity);}",nV=new Map([[ot.ADD,b5],[ot.ALPHA,T5],[ot.AVERAGE,M5],[ot.COLOR,C5],[ot.COLOR_BURN,A5],[ot.COLOR_DODGE,R5],[ot.DARKEN,P5],[ot.DIFFERENCE,N5],[ot.DIVIDE,I5],[ot.DST,null],[ot.EXCLUSION,L5],[ot.HARD_LIGHT,D5],[ot.HARD_MIX,U5],[ot.HUE,k5],[ot.INVERT,O5],[ot.INVERT_RGB,F5],[ot.LIGHTEN,B5],[ot.LINEAR_BURN,j5],[ot.LINEAR_DODGE,z5],[ot.LINEAR_LIGHT,V5],[ot.LUMINOSITY,H5],[ot.MULTIPLY,G5],[ot.NEGATION,W5],[ot.NORMAL,$5],[ot.OVERLAY,X5],[ot.PIN_LIGHT,q5],[ot.REFLECT,Y5],[ot.SATURATION,K5],[ot.SCREEN,J5],[ot.SOFT_LIGHT,Z5],[ot.SRC,Q5],[ot.SUBTRACT,eV],[ot.VIVID_LIGHT,tV]]),rV=class extends ys{constructor(t,e=1){super(),this._blendFunction=t,this.opacity=new Xt(e)}getOpacity(){return this.opacity.value}setOpacity(t){this.opacity.value=t}get blendFunction(){return this._blendFunction}set blendFunction(t){this._blendFunction=t,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(t){this.blendFunction=t}getShaderCode(){return nV.get(this.blendFunction)}},bM=class extends ys{constructor(t,e,{attributes:n=Js.NONE,blendFunction:r=ot.NORMAL,defines:i=new Map,uniforms:s=new Map,extensions:o=null,vertexShader:a=null}={}){super(),this.name=t,this.renderer=null,this.attributes=n,this.fragmentShader=e,this.vertexShader=a,this.defines=i,this.uniforms=s,this.extensions=o,this.blendMode=new rV(r),this.blendMode.addEventListener("change",l=>this.setChanged()),this._inputColorSpace=cs,this._outputColorSpace=Or}get inputColorSpace(){return this._inputColorSpace}set inputColorSpace(t){this._inputColorSpace=t,this.setChanged()}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(t){this._outputColorSpace=t,this.setChanged()}set mainScene(t){}set mainCamera(t){}getName(){return this.name}setRenderer(t){this.renderer=t}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(t){this.attributes=t,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(t){this.fragmentShader=t,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(t){this.vertexShader=t,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(t,e=hc){}update(t,e,n){}setSize(t,e){}initialize(t,e,n){}dispose(){for(const t of Object.keys(this)){const e=this[t];(e instanceof Pr||e instanceof Va||e instanceof an||e instanceof ws)&&this[t].dispose()}}},q_=class extends ws{constructor(t,e,n=null){super("RenderPass",t,e),this.needsSwap=!1,this.clearPass=new EM,this.overrideMaterialManager=n===null?null:new X_(n),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}set mainScene(t){this.scene=t}set mainCamera(t){this.camera=t}get renderToScreen(){return super.renderToScreen}set renderToScreen(t){super.renderToScreen=t,this.clearPass.renderToScreen=t}get overrideMaterial(){const t=this.overrideMaterialManager;return t!==null?t.material:null}set overrideMaterial(t){const e=this.overrideMaterialManager;t!==null?e!==null?e.setMaterial(t):this.overrideMaterialManager=new X_(t):e!==null&&(e.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(t){this.overrideMaterial=t}get clear(){return this.clearPass.enabled}set clear(t){this.clearPass.enabled=t}getSelection(){return this.selection}setSelection(t){this.selection=t}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(t){this.ignoreBackground=t}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(t){this.skipShadowMapUpdate=t}getClearPass(){return this.clearPass}render(t,e,n,r,i){const s=this.scene,o=this.camera,a=this.selection,l=o.layers.mask,c=s.background,u=t.shadowMap.autoUpdate,d=this.renderToScreen?null:e;a!==null&&o.layers.set(a.getLayer()),this.skipShadowMapUpdate&&(t.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(s.background=null),this.clearPass.enabled&&this.clearPass.render(t,e),t.setRenderTarget(d),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(t,s,o):t.render(s,o),o.layers.mask=l,s.background=c,t.shadowMap.autoUpdate=u}},iV=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#if DEPTH_PACKING == 3201
uniform lowp sampler2D depthBuffer;
#elif defined(GL_FRAGMENT_PRECISION_HIGH)
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;vec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}vec3 RGBToHCV(const in vec3 RGB){vec4 P=mix(vec4(RGB.bg,-1.0,2.0/3.0),vec4(RGB.gb,0.0,-1.0/3.0),step(RGB.b,RGB.g));vec4 Q=mix(vec4(P.xyw,RGB.r),vec4(RGB.r,P.yzx),step(P.x,RGB.r));float C=Q.x-min(Q.w,Q.y);float H=abs((Q.w-Q.y)/(6.0*C+EPSILON)+Q.z);return vec3(H,C,Q.x);}vec3 RGBToHSL(const in vec3 RGB){vec3 HCV=RGBToHCV(RGB);float L=HCV.z-HCV.y*0.5;float S=HCV.y/(1.0-abs(L*2.0-1.0)+EPSILON);return vec3(HCV.x,S,L);}vec3 HueToRGB(const in float H){float R=abs(H*6.0-3.0)-1.0;float G=2.0-abs(H*6.0-2.0);float B=2.0-abs(H*6.0-4.0);return clamp(vec3(R,G,B),0.0,1.0);}vec3 HSLToRGB(const in vec3 HSL){vec3 RGB=HueToRGB(HSL.x);float C=(1.0-abs(2.0*HSL.z-1.0))*HSL.y;return(RGB-0.5)*C+HSL.z;}FRAGMENT_HEAD void main(){FRAGMENT_MAIN_UV vec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGE color0.a=clamp(color0.a,0.0,1.0);gl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <colorspace_fragment>
#endif
#include <dithering_fragment>
}`,sV="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEAD void main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORT gl_Position=vec4(position.xy,1.0,1.0);}",oV=class extends ar{constructor(t,e,n,r,i=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:Mf.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new Xt(null),depthBuffer:new Xt(null),resolution:new Xt(new Qe),texelSize:new Xt(new Qe),cameraNear:new Xt(.3),cameraFar:new Xt(1e3),aspect:new Xt(1),time:new Xt(0)},blending:zr,toneMapped:!1,depthWrite:!1,depthTest:!1,dithering:i}),t&&this.setShaderParts(t),e&&this.setDefines(e),n&&this.setUniforms(n),this.copyCameraSettings(r)}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.uniforms.inputBuffer.value=t}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(t){this.uniforms.depthBuffer.value=t}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(t){this.defines.DEPTH_PACKING=t.toFixed(0),this.needsUpdate=!0}setDepthBuffer(t,e=hc){this.depthBuffer=t,this.depthPacking=e}setShaderData(t){this.setShaderParts(t.shaderParts),this.setDefines(t.defines),this.setUniforms(t.uniforms),this.setExtensions(t.extensions)}setShaderParts(t){return this.fragmentShader=iV.replace(ft.FRAGMENT_HEAD,t.get(ft.FRAGMENT_HEAD)||"").replace(ft.FRAGMENT_MAIN_UV,t.get(ft.FRAGMENT_MAIN_UV)||"").replace(ft.FRAGMENT_MAIN_IMAGE,t.get(ft.FRAGMENT_MAIN_IMAGE)||""),this.vertexShader=sV.replace(ft.VERTEX_HEAD,t.get(ft.VERTEX_HEAD)||"").replace(ft.VERTEX_MAIN_SUPPORT,t.get(ft.VERTEX_MAIN_SUPPORT)||""),this.needsUpdate=!0,this}setDefines(t){for(const e of t.entries())this.defines[e[0]]=e[1];return this.needsUpdate=!0,this}setUniforms(t){for(const e of t.entries())this.uniforms[e[0]]=e[1];return this}setExtensions(t){this.extensions={};for(const e of t)this.extensions[e]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(t){this.encodeOutput!==t&&(t?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(t){return this.encodeOutput}setOutputEncodingEnabled(t){this.encodeOutput=t}get time(){return this.uniforms.time.value}set time(t){this.uniforms.time.value=t}setDeltaTime(t){this.uniforms.time.value+=t}adoptCameraSettings(t){this.copyCameraSettings(t)}copyCameraSettings(t){t&&(this.uniforms.cameraNear.value=t.near,this.uniforms.cameraFar.value=t.far,t instanceof er?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(t,e){const n=this.uniforms;n.resolution.value.set(t,e),n.texelSize.value.set(1/t,1/e),n.aspect.value=t/e}static get Section(){return ft}};function Y_(t,e,n){for(const r of e){const i="$1"+t+r.charAt(0).toUpperCase()+r.slice(1),s=new RegExp("([^\\.])(\\b"+r+"\\b)","g");for(const o of n.entries())o[1]!==null&&n.set(o[0],o[1].replace(s,i))}}function aV(t,e,n){let r=e.getFragmentShader(),i=e.getVertexShader();const s=r!==void 0&&/mainImage/.test(r),o=r!==void 0&&/mainUv/.test(r);if(n.attributes|=e.getAttributes(),r===void 0)throw new Error(`Missing fragment shader (${e.name})`);if(o&&n.attributes&Js.CONVOLUTION)throw new Error(`Effects that transform UVs are incompatible with convolution effects (${e.name})`);if(!s&&!o)throw new Error(`Could not find mainImage or mainUv function (${e.name})`);{const a=/\w+\s+(\w+)\([\w\s,]*\)\s*{/g,l=n.shaderParts;let c=l.get(ft.FRAGMENT_HEAD)||"",u=l.get(ft.FRAGMENT_MAIN_UV)||"",d=l.get(ft.FRAGMENT_MAIN_IMAGE)||"",h=l.get(ft.VERTEX_HEAD)||"",m=l.get(ft.VERTEX_MAIN_SUPPORT)||"";const x=new Set,v=new Set;if(o&&(u+=`	${t}MainUv(UV);
`,n.uvTransformation=!0),i!==null&&/mainSupport/.test(i)){const y=/mainSupport *\([\w\s]*?uv\s*?\)/.test(i);m+=`	${t}MainSupport(`,m+=y?`vUv);
`:`);
`;for(const _ of i.matchAll(/(?:varying\s+\w+\s+([\S\s]*?);)/g))for(const w of _[1].split(/\s*,\s*/))n.varyings.add(w),x.add(w),v.add(w);for(const _ of i.matchAll(a))v.add(_[1])}for(const y of r.matchAll(a))v.add(y[1]);for(const y of e.defines.keys())v.add(y.replace(/\([\w\s,]*\)/g,""));for(const y of e.uniforms.keys())v.add(y);v.delete("while"),v.delete("for"),v.delete("if"),e.uniforms.forEach((y,_)=>n.uniforms.set(t+_.charAt(0).toUpperCase()+_.slice(1),y)),e.defines.forEach((y,_)=>n.defines.set(t+_.charAt(0).toUpperCase()+_.slice(1),y));const g=new Map([["fragment",r],["vertex",i]]);Y_(t,v,n.defines),Y_(t,v,g),r=g.get("fragment"),i=g.get("vertex");const p=e.blendMode;if(n.blendModes.set(p.blendFunction,p),s){e.inputColorSpace!==null&&e.inputColorSpace!==n.colorSpace&&(d+=e.inputColorSpace===zt?`color0 = sRGBTransferOETF(color0);
	`:`color0 = sRGBToLinear(color0);
	`),e.outputColorSpace!==Or?n.colorSpace=e.outputColorSpace:e.inputColorSpace!==null&&(n.colorSpace=e.inputColorSpace);const y=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/;d+=`${t}MainImage(color0, UV, `,n.attributes&Js.DEPTH&&y.test(r)&&(d+="depth, ",n.readDepth=!0),d+=`color1);
	`;const _=t+"BlendOpacity";n.uniforms.set(_,p.opacity),d+=`color0 = blend${p.blendFunction}(color0, color1, ${_});

	`,c+=`uniform float ${_};

`}if(c+=r+`
`,i!==null&&(h+=i+`
`),l.set(ft.FRAGMENT_HEAD,c),l.set(ft.FRAGMENT_MAIN_UV,u),l.set(ft.FRAGMENT_MAIN_IMAGE,d),l.set(ft.VERTEX_HEAD,h),l.set(ft.VERTEX_MAIN_SUPPORT,m),e.extensions!==null)for(const y of e.extensions)n.extensions.add(y)}}var K_=class extends ws{constructor(t,...e){super("EffectPass"),this.fullscreenMaterial=new oV(null,null,null,t),this.listener=n=>this.handleEvent(n),this.effects=[],this.setEffects(e),this.skipRendering=!1,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY,this.timeScale=1}set mainScene(t){for(const e of this.effects)e.mainScene=t}set mainCamera(t){this.fullscreenMaterial.copyCameraSettings(t);for(const e of this.effects)e.mainCamera=t}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(t){this.fullscreenMaterial.encodeOutput=t}get dithering(){return this.fullscreenMaterial.dithering}set dithering(t){const e=this.fullscreenMaterial;e.dithering=t,e.needsUpdate=!0}setEffects(t){for(const e of this.effects)e.removeEventListener("change",this.listener);this.effects=t.sort((e,n)=>n.attributes-e.attributes);for(const e of this.effects)e.addEventListener("change",this.listener)}updateMaterial(){const t=new E5;let e=0;for(const o of this.effects)if(o.blendMode.blendFunction===ot.DST)t.attributes|=o.getAttributes()&Js.DEPTH;else{if(t.attributes&o.getAttributes()&Js.CONVOLUTION)throw new Error(`Convolution effects cannot be merged (${o.name})`);aV("e"+e++,o,t)}let n=t.shaderParts.get(ft.FRAGMENT_HEAD),r=t.shaderParts.get(ft.FRAGMENT_MAIN_IMAGE),i=t.shaderParts.get(ft.FRAGMENT_MAIN_UV);const s=/\bblend\b/g;for(const o of t.blendModes.values())n+=o.getShaderCode().replace(s,`blend${o.blendFunction}`)+`
`;t.attributes&Js.DEPTH?(t.readDepth&&(r=`float depth = readDepth(UV);

	`+r),this.needsDepthTexture=this.getDepthTexture()===null):this.needsDepthTexture=!1,t.colorSpace===zt&&(r+=`color0 = sRGBToLinear(color0);
	`),t.uvTransformation?(i=`vec2 transformedUv = vUv;
`+i,t.defines.set("UV","transformedUv")):t.defines.set("UV","vUv"),t.shaderParts.set(ft.FRAGMENT_HEAD,n),t.shaderParts.set(ft.FRAGMENT_MAIN_IMAGE,r),t.shaderParts.set(ft.FRAGMENT_MAIN_UV,i);for(const[o,a]of t.shaderParts)a!==null&&t.shaderParts.set(o,a.trim().replace(/^#/,`
#`));this.skipRendering=e===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderData(t)}recompile(){this.updateMaterial()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(t,e=hc){this.fullscreenMaterial.depthBuffer=t,this.fullscreenMaterial.depthPacking=e;for(const n of this.effects)n.setDepthTexture(t,e)}render(t,e,n,r,i){for(const s of this.effects)s.update(t,e,r);if(!this.skipRendering||this.renderToScreen){const s=this.fullscreenMaterial;s.inputBuffer=e.texture,s.time+=r*this.timeScale,t.setRenderTarget(this.renderToScreen?null:n),t.render(this.scene,this.camera)}}setSize(t,e){this.fullscreenMaterial.setSize(t,e);for(const n of this.effects)n.setSize(t,e)}initialize(t,e,n){this.renderer=t;for(const r of this.effects)r.initialize(t,e,n);this.updateMaterial(),n!==void 0&&n!==Wn&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(const t of this.effects)t.removeEventListener("change",this.listener),t.dispose()}handleEvent(t){switch(t.type){case"change":this.recompile();break}}};const lV=()=>{const e=document.createElement("canvas");e.width=64,e.height=64;const n=e.getContext("2d");if(!n)throw new Error("2D context not available");n.fillStyle="black",n.fillRect(0,0,e.width,e.height);const r=new an(e);r.minFilter=mn,r.magFilter=mn,r.generateMipmaps=!1;const i=[];let s=null;const o=64;let a=.1*64;const l=1/o,c=()=>{n.fillStyle="black",n.fillRect(0,0,e.width,e.height)},u=m=>{const x={x:m.x*64,y:(1-m.y)*64};let v=1;const g=w=>Math.sin(w*Math.PI/2),p=w=>-w*(w-2);m.age<o*.3?v=g(m.age/(o*.3)):v=p(1-(m.age-o*.3)/(o*.7))||0,v*=m.force;const y=`${(m.vx+1)/2*255}, ${(m.vy+1)/2*255}, ${v*255}`,_=64*5;n.shadowOffsetX=_,n.shadowOffsetY=_,n.shadowBlur=a,n.shadowColor=`rgba(${y},${.22*v})`,n.beginPath(),n.fillStyle="rgba(255,0,0,1)",n.arc(x.x-_,x.y-_,a,0,Math.PI*2),n.fill()};return{canvas:e,texture:r,addTouch:m=>{let x=0,v=0,g=0;if(s){const p=m.x-s.x,y=m.y-s.y;if(p===0&&y===0)return;const _=p*p+y*y,w=Math.sqrt(_);v=p/(w||1),g=y/(w||1),x=Math.min(_*1e4,1)}s={x:m.x,y:m.y},i.push({x:m.x,y:m.y,age:0,force:x,vx:v,vy:g})},update:()=>{c();for(let m=i.length-1;m>=0;m--){const x=i[m],v=x.force*l*(1-x.age/o);x.x+=x.vx*v,x.y+=x.vy*v,x.age++,x.age>o&&i.splice(m,1)}for(let m=0;m<i.length;m++)u(i[m]);r.needsUpdate=!0},set radiusScale(m){a=.1*64*m},get radiusScale(){return a/(.1*64)},size:64}},cV=(t,e)=>{const n=`
    uniform sampler2D uTexture;
    uniform float uStrength;
    uniform float uTime;
    uniform float uFreq;

    void mainUv(inout vec2 uv) {
      vec4 tex = texture2D(uTexture, uv);
      float vx = tex.r * 2.0 - 1.0;
      float vy = tex.g * 2.0 - 1.0;
      float intensity = tex.b;

      float wave = 0.5 + 0.5 * sin(uTime * uFreq + intensity * 6.2831853);

      float amt = uStrength * intensity * wave;

      uv += vec2(vx, vy) * amt;
    }
    `;return new bM("LiquidEffect",n,{uniforms:new Map([["uTexture",new Xt(t)],["uStrength",new Xt((e==null?void 0:e.strength)??.025)],["uTime",new Xt(0)],["uFreq",new Xt((e==null?void 0:e.freq)??4.5)]])})},J_={square:0,circle:1,triangle:2,diamond:3},uV=`
void main() {
  gl_Position = vec4(position, 1.0);
}
`,dV=`
precision highp float;

uniform vec3  uColor;
uniform vec2  uResolution;
uniform float uTime;
uniform float uPixelSize;
uniform float uScale;
uniform float uDensity;
uniform float uPixelJitter;
uniform int   uEnableRipples;
uniform float uRippleSpeed;
uniform float uRippleThickness;
uniform float uRippleIntensity;
uniform float uEdgeFade;

uniform int   uShapeType;
const int SHAPE_SQUARE   = 0;
const int SHAPE_CIRCLE   = 1;
const int SHAPE_TRIANGLE = 2;
const int SHAPE_DIAMOND  = 3;

const int   MAX_CLICKS = 10;

uniform vec2  uClickPos  [MAX_CLICKS];
uniform float uClickTimes[MAX_CLICKS];

out vec4 fragColor;

float Bayer2(vec2 a) {
  a = floor(a);
  return fract(a.x / 2. + a.y * a.y * .75);
}
#define Bayer4(a) (Bayer2(.5*(a))*0.25 + Bayer2(a))
#define Bayer8(a) (Bayer4(.5*(a))*0.25 + Bayer2(a))

#define FBM_OCTAVES     5
#define FBM_LACUNARITY  1.25
#define FBM_GAIN        1.0

float hash11(float n){ return fract(sin(n)*43758.5453); }

float vnoise(vec3 p){
  vec3 ip = floor(p);
  vec3 fp = fract(p);
  float n000 = hash11(dot(ip + vec3(0.0,0.0,0.0), vec3(1.0,57.0,113.0)));
  float n100 = hash11(dot(ip + vec3(1.0,0.0,0.0), vec3(1.0,57.0,113.0)));
  float n010 = hash11(dot(ip + vec3(0.0,1.0,0.0), vec3(1.0,57.0,113.0)));
  float n110 = hash11(dot(ip + vec3(1.0,1.0,0.0), vec3(1.0,57.0,113.0)));
  float n001 = hash11(dot(ip + vec3(0.0,0.0,1.0), vec3(1.0,57.0,113.0)));
  float n101 = hash11(dot(ip + vec3(1.0,0.0,1.0), vec3(1.0,57.0,113.0)));
  float n011 = hash11(dot(ip + vec3(0.0,1.0,1.0), vec3(1.0,57.0,113.0)));
  float n111 = hash11(dot(ip + vec3(1.0,1.0,1.0), vec3(1.0,57.0,113.0)));
  vec3 w = fp*fp*fp*(fp*(fp*6.0-15.0)+10.0);
  float x00 = mix(n000, n100, w.x);
  float x10 = mix(n010, n110, w.x);
  float x01 = mix(n001, n101, w.x);
  float x11 = mix(n011, n111, w.x);
  float y0  = mix(x00, x10, w.y);
  float y1  = mix(x01, x11, w.y);
  return mix(y0, y1, w.z) * 2.0 - 1.0;
}

float fbm2(vec2 uv, float t){
  vec3 p = vec3(uv * uScale, t);
  float amp = 1.0;
  float freq = 1.0;
  float sum = 1.0;
  for (int i = 0; i < FBM_OCTAVES; ++i){
    sum  += amp * vnoise(p * freq);
    freq *= FBM_LACUNARITY;
    amp  *= FBM_GAIN;
  }
  return sum * 0.5 + 0.5;
}

float maskCircle(vec2 p, float cov){
  float r = sqrt(cov) * .25;
  float d = length(p - 0.5) - r;
  float aa = 0.5 * fwidth(d);
  return cov * (1.0 - smoothstep(-aa, aa, d * 2.0));
}

float maskTriangle(vec2 p, vec2 id, float cov){
  bool flip = mod(id.x + id.y, 2.0) > 0.5;
  if (flip) p.x = 1.0 - p.x;
  float r = sqrt(cov);
  float d  = p.y - r*(1.0 - p.x);
  float aa = fwidth(d);
  return cov * clamp(0.5 - d/aa, 0.0, 1.0);
}

float maskDiamond(vec2 p, float cov){
  float r = sqrt(cov) * 0.564;
  return step(abs(p.x - 0.49) + abs(p.y - 0.49), r);
}

void main(){
  float pixelSize = uPixelSize;
  vec2 fragCoord = gl_FragCoord.xy - uResolution * .5;
  float aspectRatio = uResolution.x / uResolution.y;

  vec2 pixelId = floor(fragCoord / pixelSize);
  vec2 pixelUV = fract(fragCoord / pixelSize);

  float cellPixelSize = 8.0 * pixelSize;
  vec2 cellId = floor(fragCoord / cellPixelSize);
  vec2 cellCoord = cellId * cellPixelSize;
  vec2 uv = cellCoord / uResolution * vec2(aspectRatio, 1.0);

  float base = fbm2(uv, uTime * 0.05);
  base = base * 0.5 - 0.65;

  float feed = base + (uDensity - 0.5) * 0.3;

  float speed     = uRippleSpeed;
  float thickness = uRippleThickness;
  const float dampT     = 1.0;
  const float dampR     = 10.0;

  if (uEnableRipples == 1) {
    for (int i = 0; i < MAX_CLICKS; ++i){
      vec2 pos = uClickPos[i];
      if (pos.x < 0.0) continue;
      float cellPixelSize = 8.0 * pixelSize;
      vec2 cuv = (((pos - uResolution * .5 - cellPixelSize * .5) / (uResolution))) * vec2(aspectRatio, 1.0);
      float t = max(uTime - uClickTimes[i], 0.0);
      float r = distance(uv, cuv);
      float waveR = speed * t;
      float ring  = exp(-pow((r - waveR) / thickness, 2.0));
      float atten = exp(-dampT * t) * exp(-dampR * r);
      feed = max(feed, ring * atten * uRippleIntensity);
    }
  }

  float bayer = Bayer8(fragCoord / uPixelSize) - 0.5;
  float bw = step(0.5, feed + bayer);

  float h = fract(sin(dot(floor(fragCoord / uPixelSize), vec2(127.1, 311.7))) * 43758.5453);
  float jitterScale = 1.0 + (h - 0.5) * uPixelJitter;
  float coverage = bw * jitterScale;
  float M;
  if      (uShapeType == SHAPE_CIRCLE)   M = maskCircle (pixelUV, coverage);
  else if (uShapeType == SHAPE_TRIANGLE) M = maskTriangle(pixelUV, pixelId, coverage);
  else if (uShapeType == SHAPE_DIAMOND)  M = maskDiamond(pixelUV, coverage);
  else                                   M = coverage;

  if (uEdgeFade > 0.0) {
    vec2 norm = gl_FragCoord.xy / uResolution;
    float edge = min(min(norm.x, norm.y), min(1.0 - norm.x, 1.0 - norm.y));
    float fade = smoothstep(0.0, uEdgeFade, edge);
    M *= fade;
  }

  vec3 color = uColor;
  fragColor = vec4(color, M);
}
`,lp=10,fV=({variant:t="square",pixelSize:e=3,color:n="#B19EEF",className:r,style:i,antialias:s=!0,patternScale:o=2,patternDensity:a=1,liquid:l=!1,liquidStrength:c=.1,liquidRadius:u=1,pixelSizeJitter:d=0,enableRipples:h=!0,rippleIntensityScale:m=1,rippleThickness:x=.1,rippleSpeed:v=.3,liquidWobbleSpeed:g=4.5,autoPauseOffscreen:p=!0,speed:y=.5,transparent:_=!0,edgeFade:w=.5,noiseAmount:E=0})=>{const M=S.useRef(null),T=S.useRef({visible:!0}),P=S.useRef(y),C=S.useRef(null),b=S.useRef(null);return S.useEffect(()=>{var Y,z,W;const N=M.current;if(!N)return;P.current=y;const U=["antialias","liquid","noiseAmount"],O={antialias:s,liquid:l,noiseAmount:E};let V=!1;if(!C.current)V=!0;else if(b.current){for(const L of U)if(b.current[L]!==O[L]){V=!0;break}}if(V){if(C.current){const _e=C.current;(Y=_e.resizeObserver)==null||Y.disconnect(),cancelAnimationFrame(_e.raf),(z=_e.quad)==null||z.geometry.dispose(),_e.material.dispose(),(W=_e.composer)==null||W.dispose(),_e.renderer.dispose(),_e.renderer.domElement.parentElement===N&&N.removeChild(_e.renderer.domElement),C.current=null}const L=document.createElement("canvas"),H=L.getContext("webgl2",{antialias:s,alpha:!0});if(!H){console.warn("WebGL2 not supported");return}console.log("PixelBlast: WebGL2 context created");const j=new h5({canvas:L,context:H,antialias:s,alpha:!0,premultipliedAlpha:!1});j.setClearColor(0,0),console.log("PixelBlast: Renderer created with transparent background"),j.domElement.style.width="100%",j.domElement.style.height="100%",j.domElement.style.position="absolute",j.domElement.style.top="0",j.domElement.style.left="0",j.domElement.style.zIndex="1",j.domElement.style.pointerEvents="auto",j.setPixelRatio(Math.min(window.devicePixelRatio||1,2)),N.appendChild(j.domElement),console.log("PixelBlast: Canvas added to container");const ee={uResolution:{value:new Qe(0,0)},uTime:{value:0},uColor:{value:new pt(n)},uClickPos:{value:Array.from({length:lp},()=>new Qe(-1,-1))},uClickTimes:{value:new Float32Array(lp)},uShapeType:{value:J_[t]??0},uPixelSize:{value:e*j.getPixelRatio()},uScale:{value:o},uDensity:{value:a},uPixelJitter:{value:d},uEnableRipples:{value:h?1:0},uRippleSpeed:{value:v},uRippleThickness:{value:x},uRippleIntensity:{value:m},uEdgeFade:{value:w}},ve=new Eg,Be=new gM(-1,1,1,-1,0,1);let Ue;try{Ue=new ar({vertexShader:uV,fragmentShader:dV,uniforms:ee,transparent:!0,glslVersion:wg,depthTest:!1,depthWrite:!1}),console.log("PixelBlast: Shader material created successfully")}catch(_e){console.error("PixelBlast: Shader compilation failed:",_e),Ue=new p0({color:11640559,transparent:!0,opacity:.5}),console.log("PixelBlast: Using fallback basic material")}const Q=new xc(2,2),oe=new Er(Q,Ue);ve.add(oe);const X=new PF,he=()=>{var et;const _e=N.clientWidth||1,Ve=N.clientHeight||1;j.setSize(_e,Ve,!1),ee.uResolution.value.set(j.domElement.width,j.domElement.height),(et=C.current)!=null&&et.composer&&C.current.composer.setSize(j.domElement.width,j.domElement.height),ee.uPixelSize.value=e*j.getPixelRatio(),console.log("PixelBlast: Size set to",_e,"x",Ve,"pixelSize:",ee.uPixelSize.value,"density:",ee.uDensity.value)};he();const J=new ResizeObserver(he);J.observe(N);const re=(()=>{var _e;if(typeof window<"u"&&((_e=window.crypto)!=null&&_e.getRandomValues)){const Ve=new Uint32Array(1);return window.crypto.getRandomValues(Ve),Ve[0]/4294967295}return Math.random()})()*1e3;let ie,I,be;if(l){I=lV(),I.radiusScale=u,ie=new $_(j);const _e=new q_(ve,Be);be=cV(I.texture,{strength:c,freq:g});const Ve=new K_(Be,be);Ve.renderToScreen=!0,ie.addPass(_e),ie.addPass(Ve)}if(E>0){ie||(ie=new $_(j),ie.addPass(new q_(ve,Be)));const _e=new bM("NoiseEffect","uniform float uTime; uniform float uAmount; float hash(vec2 p){ return fract(sin(dot(p, vec2(127.1,311.7))) * 43758.5453);} void mainUv(inout vec2 uv){} void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){ float n=hash(floor(uv*vec2(1920.0,1080.0))+floor(uTime*60.0)); float g=(n-0.5)*uAmount; outputColor=inputColor+vec4(vec3(g),0.0);} ",{uniforms:new Map([["uTime",new Xt(0)],["uAmount",new Xt(E)]])}),Ve=new K_(Be,_e);Ve.renderToScreen=!0,ie&&ie.passes.length>0&&ie.passes.forEach(et=>et.renderToScreen=!1),ie.addPass(Ve)}ie&&ie.setSize(j.domElement.width,j.domElement.height);const Ee=_e=>{const Ve=j.domElement.getBoundingClientRect(),et=j.domElement.width/Ve.width,D=j.domElement.height/Ve.height,A=(_e.clientX-Ve.left)*et,G=(Ve.height-(_e.clientY-Ve.top))*D;return{fx:A,fy:G,w:j.domElement.width,h:j.domElement.height}},He=_e=>{var A;const{fx:Ve,fy:et}=Ee(_e),D=((A=C.current)==null?void 0:A.clickIx)??0;ee.uClickPos.value[D].set(Ve,et),ee.uClickTimes.value[D]=ee.uTime.value,C.current&&(C.current.clickIx=(D+1)%lp)},Me=_e=>{if(!I)return;const{fx:Ve,fy:et,w:D,h:A}=Ee(_e);I.addTouch({x:Ve/D,y:et/A})};j.domElement.addEventListener("pointerdown",He,{passive:!0}),j.domElement.addEventListener("pointermove",Me,{passive:!0});let it=0;const ge=()=>{if(ee.uTime.value===0&&console.log("PixelBlast: First animate() call"),p&&!T.current.visible){it=requestAnimationFrame(ge);return}ee.uTime.value=re+X.getElapsedTime()*P.current,be&&(be.uniforms.get("uTime").value=ee.uTime.value),ie?(I&&I.update(),ie.passes.forEach(_e=>{const Ve=_e.effects;Ve&&Ve.forEach(et=>{var A;const D=(A=et.uniforms)==null?void 0:A.get("uTime");D&&(D.value=ee.uTime.value)})}),ie.render(),ee.uTime.value<1&&console.log("PixelBlast: Composer rendering, time:",ee.uTime.value,"density:",ee.uDensity.value)):(j.render(ve,Be),ee.uTime.value<1&&console.log("PixelBlast: Rendering frame, time:",ee.uTime.value,"density:",ee.uDensity.value)),it=requestAnimationFrame(ge)};it=requestAnimationFrame(ge),console.log("PixelBlast: Animation loop started"),C.current={renderer:j,scene:ve,camera:Be,material:Ue,clock:X,clickIx:0,uniforms:ee,resizeObserver:J,raf:it,quad:oe,timeOffset:re,composer:ie,touch:I,liquidEffect:be}}else{const L=C.current;if(L.uniforms.uShapeType.value=J_[t]??0,L.uniforms.uPixelSize.value=e*L.renderer.getPixelRatio(),L.uniforms.uColor.value.set(n),L.uniforms.uScale.value=o,L.uniforms.uDensity.value=a,L.uniforms.uPixelJitter.value=d,L.uniforms.uEnableRipples.value=h?1:0,L.uniforms.uRippleIntensity.value=m,L.uniforms.uRippleThickness.value=x,L.uniforms.uRippleSpeed.value=v,L.uniforms.uEdgeFade.value=w,_?(L.renderer.setClearAlpha(0),console.log("PixelBlast: Set to transparent")):(L.renderer.setClearColor(0,1),console.log("PixelBlast: Set to black background")),L.liquidEffect){const H=L.liquidEffect.uniforms.get("uStrength");H&&(H.value=c);const j=L.liquidEffect.uniforms.get("uFreq");j&&(j.value=g)}L.touch&&(L.touch.radiusScale=u)}return b.current=O,()=>{var H,j,ee;if(C.current&&V||!C.current)return;const L=C.current;(H=L.resizeObserver)==null||H.disconnect(),cancelAnimationFrame(L.raf),(j=L.quad)==null||j.geometry.dispose(),L.material.dispose(),(ee=L.composer)==null||ee.dispose(),L.renderer.dispose(),L.renderer.domElement.parentElement===N&&N.removeChild(L.renderer.domElement),C.current=null}},[s,l,E,e,o,a,h,m,x,v,d,w,_,c,u,g,p,t,n,y]),f.jsx("div",{ref:M,className:`w-full h-full relative overflow-hidden ${r??""}`,style:{...i,background:`
          radial-gradient(circle at 25% 25%, ${n}20 0%, transparent 50%),
          radial-gradient(circle at 75% 75%, ${n}15 0%, transparent 50%),
          radial-gradient(circle at 50% 50%, ${n}10 0%, transparent 70%),
          linear-gradient(135deg, hsl(220 26% 14%), hsl(220 23% 17%))
        `},"aria-label":"PixelBlast interactive background",children:f.jsx("div",{className:"absolute inset-0 opacity-10",style:{backgroundImage:`
            repeating-linear-gradient(0deg, 
              ${n}30 0px, 
              ${n}30 1px,
              transparent 1px, 
              transparent ${e*3}px
            ),
            repeating-linear-gradient(90deg, 
              ${n}30 0px, 
              ${n}30 1px,
              transparent 1px, 
              transparent ${e*3}px
            )
          `,backgroundSize:`${e*3}px ${e*3}px`,animation:"pixelShift 8s linear infinite"}})})},hV=()=>f.jsxs("div",{className:"relative min-h-screen",children:[f.jsx("div",{style:{width:"100%",height:"100vh",position:"fixed",top:0,left:0,zIndex:-1},children:f.jsx(fV,{variant:"circle",pixelSize:6,color:"#B19EEF",patternScale:2,patternDensity:1.8,pixelSizeJitter:.3,enableRipples:!0,rippleSpeed:.6,rippleThickness:.15,rippleIntensityScale:1.8,liquid:!1,liquidStrength:.12,liquidRadius:1.2,liquidWobbleSpeed:5,speed:1.2,edgeFade:.2,transparent:!0})}),f.jsx("div",{className:"relative z-10",children:f.jsx(ZR,{children:f.jsxs(qR,{children:[f.jsx(Ds,{path:"/",element:f.jsx(TU,{})}),f.jsx(Ds,{path:"/history",element:f.jsx(MU,{})}),f.jsx(Ds,{path:"/control",element:f.jsx(KU,{})}),f.jsx(Ds,{path:"/post/:id",element:f.jsx(yk,{})}),f.jsx(Ds,{path:"/success",element:f.jsx(aO,{})}),f.jsx(Ds,{path:"*",element:f.jsx(lO,{})})]})})})]});f1(document.getElementById("root")).render(f.jsx(hV,{}));
