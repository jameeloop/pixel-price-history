const n=()=>{const t=Date.now(),e=new Uint8Array(16);crypto.getRandomValues(e);const r=Array.from(e).map(s=>s.toString(16).padStart(2,"0")).join("");return`user_${t}_${r}`},a=()=>{const t="pixperiment_secure_user_id";let e=sessionStorage.getItem(t);return(!e||!o(e))&&(e=n(),sessionStorage.setItem(t,e)),e},o=t=>/^user_\d+_[a-f0-9]{32}$/.test(t);export{n as generateSecureUserId,a as getOrCreateSecureUserId,o as validateUserId};
